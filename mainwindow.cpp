#include "mainwindow.h"
#include "service.h"
#include "ui_mainwindow.h"
#include "version.h"
#include <QChar>
#include <QDebug>
#include <QDesktopServices>
#include <QFileDialog>
#include <QLatin1Char>
#include <QMessageBox>
#include <QPixmap>
#include <QProcess>
#include <QRandomGenerator>
#include <QScreen>
#include <QSerialPort>
#include <QSettings>
#include <QString>
#include <QStringList>
#include <QTabBar>

#include <QTabWidget>
#include <QTimer>
#include <QUrl>
#include <QtMath>
#include <algorithm>
#include <time.h>

// #include <QGraphicsScene>
// #include <QTableView>
// #include <QtCharts/QChartView>
// #include <QtCharts/QLineSeries>
// #include <QtCharts>

/* Version / Bugfixing
 * 1.0.132  linePA_actpos_degree_tilt -> Resolution falscher Motor
 * 1.0.56   help integriert
 *
 */

int i = 0;
int bestfitid = 0;
int normincorr = 0;
int smaxid = 0;
int smax = 0;
int tmpid = 0;
int zoffset = 0;

API APIid = none; // Enumeration
// SMIF SMIFid = sfNONE;
STAGE STAGEid = nc;
MIC MICid = ncmic;

QString filename = QDateTime::currentDateTime().toString("yyyy-MM-dd_hh-mm'_INSBox.log'");
QString smiffilename = QDateTime::currentDateTime().toString("yyyy-MM-dd_hh-mm'_INSBox.smiflog'");
QString busfilename = QDateTime::currentDateTime().toString("yyyy-MM-dd_hh-mm'_INSBox.buslog'");
//QString pos_statistic = "pos_statistic.tmp";
QString portdeffile = "C:/INSBox/Feedersetup/comportsetup.txt";
QString helpfile = "C:/INSBox/Servicetool/Files/help_contents.txt";
QString LOGFILE2OPEN = "C:/INSBox/Log/" + filename;
QString SMIFLOGFILE2OPEN = "C:/INSBox/Log/" + smiffilename;
QString BUSLOGFILE2OPEN = "C:/INSBox/Log/" + busfilename;
//QString POSFILE2OPEN = "C:/INSBox/Log/" + pos_statistic;
QFile logfile(LOGFILE2OPEN);
QFile smiflogfile(SMIFLOGFILE2OPEN);
QFile buslogfile(BUSLOGFILE2OPEN);
//QFile posfile(POSFILE2OPEN);
QTextStream logout(&logfile);
QTextStream smiflogout(&smiflogfile);
QTextStream buslogout(&buslogfile);
//QTextStream posout(&posfile);
QSettings settings("settings.ini", QSettings::IniFormat);
QSettings loguser("C:/INSBox/User/user.ini", QSettings::IniFormat);
QProcess process;

QCPCurve *newCurve;
QCPCurve *newCurve_2;

MainWindow::MainWindow(QWidget *parent)
    : QMainWindow(parent), ui(new Ui::MainWindow)
{
    ui->setupUi(this);
    MainWindow::resize(200, 200);
    MainWindow::setMaximumSize(200, 200);
    ui->line_USER->setText("oper");
    ui->line_PW->setText("oper");

    version = QString::number(VERSION_MAJOR) + "." + QString::number(VERSION_MINOR) + "." + QString::number(VERSION_BUILD);

    MainWindow::setWindowTitle("INSBox setup tool version " + version); /*(build: " + verstr + ")*/
    MainWindow::setWindowIcon(QIcon("logo.ico"));

    newCurve = new QCPCurve(ui->widget_spline->xAxis, ui->widget_spline->yAxis);
    newCurve_2 = new QCPCurve(ui->widget_spline_2->xAxis, ui->widget_spline_2->yAxis);

    /* ausgeblendete */
    // ui->buttonGroup->setExclusive(0); // Gruppierung in der mainwindow_ui vornehmen
    /*ui->hSlide_L1_LDH->installEventFilter(this);
    ui->hSlide_L1_WSH->installEventFilter(this);
    ui->hSlide_L1_operH->installEventFilter(this);
    ui->hSlide_L1_TiltOff->installEventFilter(this);
    ui->hSlide_L1_TiltOn->installEventFilter(this);
    ui->hSlide_L2_LDH->installEventFilter(this);
    ui->hSlide_L2_WSH->installEventFilter(this);
    ui->hSlide_L2_operH->installEventFilter(this);
    ui->hSlide_L2_TiltOff->installEventFilter(this);
    ui->hSlide_L2_TiltOn->installEventFilter(this);
    ui->hSlide_PA_LDH->installEventFilter(this);
    ui->hSlide_PA_CHH->installEventFilter(this);
    ui->hSlide_PA_PAH->installEventFilter(this);
    ui->hSlide_PA_bLDH->installEventFilter(this);
    ui->hSlide_PA_aLDH->installEventFilter(this);
    ui->hSlide_PA_SensAngle->installEventFilter(this);
    ui->hSlide_PA_WORot->installEventFilter(this);
    ui->hSlide_PA_WOTilt->installEventFilter(this)*/;
//  ui->hSlide_PA_alignFront->installEventFilter(this);
//    ui->hSlide_WC_CHH->installEventFilter(this);
//    ui->hSlide_WC_aCHH->installEventFilter(this);
    // ui->hSlide_WC_bCHH->installEventFilter(this);
    // ui->hSlide_WC_left->installEventFilter(this);
    // ui->hSlide_WC_middle->installEventFilter(this);
    // ui->hSlide_WC_right->installEventFilter(this);
    // ui->hSlide_LDX_L2->installEventFilter(this);
    // ui->hSlide_LDX_PAfree->installEventFilter(this);
    // ui->hSlide_LDX_L1->installEventFilter(this);
    // ui->hSlide_LDX_PA->installEventFilter(this);
    // ui->hSlide_LDY_L1in->installEventFilter(this);
    // ui->hSlide_LDY_L2in->installEventFilter(this);
    // ui->hSlide_LDY_Lout->installEventFilter(this);
    // ui->hSlide_LDY_PA->installEventFilter(this);
    ui->spinCass_firstSlot->installEventFilter(this);
    ui->spinCass_SlotDist->installEventFilter(this);
    ui->spinCass_SlotPos->installEventFilter(this);
    ui->spinCass_SlotWdw->installEventFilter(this);
    ui->spinCass_WafSizeWdw->installEventFilter(this);
    ui->spinCass_WafheightOff->installEventFilter(this);
    ui->spinCass_fingerHeightOff->installEventFilter(this);

    ui->line_lift1_xyloader_height->installEventFilter(this);
    ui->line_lift1_wafersensor_height->installEventFilter(this);
    ui->line_lift1_unload_height->installEventFilter(this);
    ui->line_lift1_tiltactpos->installEventFilter(this);
    ui->line_lift1_tiltinactpos->installEventFilter(this);

    ui->line_lift2_xyloader_height->installEventFilter(this);
    ui->line_lift2_wafersensor_height->installEventFilter(this);
    ui->line_lift2_unload_height->installEventFilter(this);
    ui->line_lift2_tiltactpos->installEventFilter(this);
    ui->line_lift2_tiltinactpos->installEventFilter(this);

    ui->line_loader_xlift1pos->installEventFilter(this);
    ui->line_loader_xlift2pos->installEventFilter(this);
    ui->line_loader_xpreapos->installEventFilter(this);
    ui->line_loader_xpreafreepos->installEventFilter(this);
    ui->line_loader_ylift1inpos->installEventFilter(this);
    ui->line_loader_ylift2inpos->installEventFilter(this);
    ui->line_loader_youtlift->installEventFilter(this);
    ui->line_loader_ypreapos->installEventFilter(this);

    ui->line_aboveloader->installEventFilter(this);
    ui->line_loaderheight->installEventFilter(this);
    ui->line_belowloader->installEventFilter(this);
    ui->line_chuckheight->installEventFilter(this);
    ui->line_preaheight->installEventFilter(this);
    ui->line_preasensangle->installEventFilter(this);
//  ui->line_wobphispeed->installEventFilter(this);
    ui->line_wobbtiltangle->installEventFilter(this);
    ui->line_wobrotpos->installEventFilter(this);

    ui->line_wc_abovechuckheight->installEventFilter(this);
    ui->line_wc_chuckheight->installEventFilter(this);
    ui->line_wc_belowchuckheight->installEventFilter(this);
    ui->line_wc_leftpos->installEventFilter(this);
    ui->line_wc_middlepos->installEventFilter(this);
    ui->line_wc_rightpos->installEventFilter(this);
    // int cbh = ui->combo_motorselect->minimumSizeHint().height();
    // ui->combo_motorselect->view()->setMinimumHeight(cbh);

    //f_setSlidecolor();

    if (!serial_feeder) serial_feeder = new QSerialPort(this);
    if (!serial_stage) serial_stage = new QSerialPort(this);
    if (!serial_mic) serial_mic = new QSerialPort(this);
    if (!serial_due) serial_due = new QSerialPort(this);
    if (!serial_api) serial_api = new QSerialPort(this);
    if (!serial_smif2) serial_smif2 = new QSerialPort(this);
    list_COMPORTS();
    ui->combo_portlist_api->setStyleSheet(backLightGrey);
    ui->combo_portlist_feeder->setStyleSheet(backLightGrey);
    ui->combo_portlist_Stage->setStyleSheet(backLightGrey);
    ui->combo_portlist_Micro->setStyleSheet(backLightGrey);
    ui->combo_portlist_DUE->setStyleSheet(backLightGrey);
    ui->p_log_feederlist->setStyleSheet(backLightGrey);
    ui->push_lift1_store->setStyleSheet(backLightGrey);
    ui->push_lift2_store->setStyleSheet(backLightGrey);
    ui->p_PA_store->setStyleSheet(backLightGrey);
    ui->p_loader_store->setStyleSheet(backLightGrey);
    ui->p_wc_store->setStyleSheet(backLightGrey);
    ui->p_clean_waferdetection->setStyleSheet(backLightGrey);
    ui->p_clean_completereset->setStyleSheet(backLightGrey);
    ui->push_wid_cass_Store->setStyleSheet(backLightGrey);
    ui->p_vac_download->setStyleSheet(backLightGrey);
    ui->p_joy_store->setStyleSheet(backLightGrey);
    ui->p_lock_download->setStyleSheet(backLightGrey);
    ui->p_lock_download_2->setStyleSheet(backLightGrey);
    ui->checkCass_lift1->setStyleSheet("background: lightgreen");
    ui->groupBox_setparam->setStyleSheet(col_smartred);
    ui->groupBox_getparam->setStyleSheet(col_smartgreen);
    ui->p_macros_testLDY->setStyleSheet(col_smartred2);
    // ui->checkBox_alignenable->hide();
    ui->label_rotspeed->hide();
    ui->label_rotspeed_2->hide();
    ui->line_wobphispeed->hide();
    ui->line_wobphispeed_2->hide();
    ui->push_wid_cass_Calib->hide();
    ui->checkBox_mainvacoff->hide();
    ui->frame_COMPORTS->hide();
    ui->frame_inifiles->hide();
    ui->push_mot_readrac->hide();
    ui->push_mot_readrac_2->hide();
    ui->check_param1->hide();
    ui->check_param1->setChecked(false);
    ui->check_param2->hide();
    ui->check_param2->setChecked(false);
    ui->label_API_no8->show();
    ui->label_API_no6->show();
    ui->label_API_no5->show();
    ui->label_API_no4->show();
    ui->combo_8inchsel_api->hide();
    ui->combo_6inchsel_api->hide();
    ui->combo_5inchsel_api->hide();
    ui->combo_4inchsel_api->hide();
    ui->p_setboardParam->hide();
    ui->frame_smif_map->setDisabled(1);
    ui->frame_clean_wc->setDisabled(1);
    ui->frame_clean_prea->setDisabled(1);
    ui->frame_clean_setpos->setDisabled(1);
    ui->frame_lift1_defaultcass->hide();
    ui->frame_lift2_defaultcass->hide();
    ui->frame_stationlist->hide();
    ui->frame_API_assistant->hide();
    ui->frame_SMIF_ISIM->hide();
    // ui->frame_Tower->hide();
    ui->frame_pa_rot_2->hide();
    ui->groupBox_SMIF_service->hide();
    // ui->line_aboveloaderthin->hide();
    // ui->line_aboveloaderthin_2->hide();
    // ui->line_belowloaderthin->hide();
    // ui->line_belowloaderthin_2->hide();
    //    ui->p_PA_Align->hide();
    //    ui->line_wobphispeed->hide();
    //    ui->line_wobphispeed_2->hide();
    //   ui->hSlide_PA_alignFront->hide();
    //ui->radio_prea_stepsmm->hide();
   // ui->radio_loader_stepsmm->hide();
    //ui->radio_wc_stepsmm->hide();
    ui->frame_motset->setStyleSheet(col_Saharasand);
    ui->frame_lift1type->setStyleSheet(col_Saharasand);
    ui->frame_lift2type->setStyleSheet(col_Saharasand);
    // ui->frame_IN->setStyleSheet("QFrame {border-color: col_Pistazie}");
    ui->line_fastdecel->setStyleSheet(col_Saharasand);
    ui->push_mot_try->setStyleSheet(col_Saharasand);
    ui->push_mot_try_2->setStyleSheet(col_Pistazie);
    ui->line_stdbycurr->setStyleSheet(col_Pistazie);
    ui->line_currrisetime->setStyleSheet(col_Pistazie);
    ui->line_motresolution->setStyleSheet(col_Pistazie);
    ui->line_encresolution->setStyleSheet(col_Pistazie);
    ui->line_gear1->setStyleSheet(col_Pistazie);
    ui->line_gear2->setStyleSheet(col_Pistazie);
    ui->line_upsoftlimit->setStyleSheet(col_Pistazie);
    ui->line_lowsoftlimit->setStyleSheet(col_Pistazie);
    ui->check_usesoftlimit->setStyleSheet(col_Pistazie);
    ui->check_useupsensor->setStyleSheet(col_Pistazie);
    ui->check_uselowsensor->setStyleSheet(col_Pistazie);
    ui->line_senspolar->setStyleSheet(col_Pistazie);
    ui->line_initdistance->setStyleSheet(col_Pistazie);
    ui->check_enconmotor->setStyleSheet(col_Pistazie);
    ui->check_posencoder->setStyleSheet(col_Pistazie);
    ui->check_stopatmaxdev->setStyleSheet(col_Pistazie);
    ui->check_closedloop->setStyleSheet(col_Pistazie);
    ui->check_initbymove->setStyleSheet(col_Pistazie);
    ui->check_interpolator->setStyleSheet(col_Pistazie);
    ui->check_checkmotvolt->setStyleSheet(col_Pistazie);
    ui->check_checkpos->setStyleSheet(col_Pistazie);
    ui->line_maxdeviation->setStyleSheet(col_Pistazie);
    ui->line_posdelay->setStyleSheet(col_Pistazie);
    ui->line_posretrycount->setStyleSheet(col_Pistazie);
    ui->line_lincorr->setStyleSheet(col_Pistazie);
    ui->line_ramptype->setStyleSheet(col_Pistazie);
    ui->frame_checklog->setStyleSheet("background-color: lightyellow");
    ui->p_API_START->setStyleSheet(col_greywhite);
    ui->p_macros_runmacro->setStyleSheet(col_greywhite);

    ui->rad_LDvac->setStyleSheet("border-color: red");
    ui->rad_PAvac->setStyleSheet("color: green ");
    ui->rad_WC1vac->setStyleSheet("QRadioButton { color: red }");
    ui->rad_WC2vac->setStyleSheet("QRadioButton { color: red }");
    ui->rad_CH4vac->setStyleSheet("QRadioButton { color: red }");
    ui->rad_CH6vac->setStyleSheet("QRadioButton { color: red }");
    ui->rad_CH8vac->setStyleSheet("QRadioButton { color: green }");

    ui->tableWidget_ASYST_readconfig->setColumnWidth(0,150);
    ui->tableWidget_ASYST_readconfig->setColumnWidth(1,100);
    ui->tableWidget_ASYST_readconfig->setColumnWidth(2,100);
    ui->tableWidget_ASYST_readconfig->setColumnWidth(3,200);
    ui->tableWidget_ASYST_readconfig->setColumnWidth(4,100);
    ui->tableWidget_ASYST_readconfig->setColumnWidth(5,100);

    ui->p_ASYST_setconfig->setDisabled(1);

    casslift = 1;
    setStyleSheets();
    setStyleSheetFrames();
    progEnd = new QTimer(this); // wartet bis Prog beendet ist
    syspoll = new QTimer(this);
    polltimer = new QTimer(this);
    cmdtimeout = new QTimer(this);   // Service CMD timeout
    apitimeout = new QTimer(this);   // API CMD timeout
    stagetimeout = new QTimer(this); // Stage CMD timeout
    setSendTimer = new QTimer(this);
    cmdSTA = new QTimer(this);   // API Statuspolling
    stageSTA = new QTimer(this); // Stage Statuspolling
    stageCAL = new QTimer(this); // Stage CAL Timeout
    poll_IN = new QTimer(this);
    macromaker = new QTimer(this);
    macrotest = new QTimer(this);
    APIlooptimer = new QTimer(this);
    apitestpolling = new QTimer(this);

    delay = new QTimer(this);
    vactest = new QTimer(this);
    connect(syspoll, SIGNAL(timeout()), this, SLOT(pollcmd()));
    connect(polltimer, SIGNAL(timeout()), this, SLOT(vacaddcmd()));
    connect(setSendTimer, SIGNAL(timeout()), this, SLOT(f_cleanmacro_vac()));
    connect(cmdtimeout, SIGNAL(timeout()), this, SLOT(on_p_INIT_resetcmdfeeder_clicked())); // Timeout Service CMDs
    connect(apitimeout, SIGNAL(timeout()), this, SLOT(resetapicmd_clicked())); // Timeout API CMDs
    connect(stagetimeout, SIGNAL(timeout()), this, SLOT(resetstagecmd()));
    connect(cmdSTA, SIGNAL(timeout()), this, SLOT(APIstatus()));
    connect(stageSTA, SIGNAL(timeout()), this, SLOT(on_p_transfer_stage_status_clicked()));
    connect(stageCAL, SIGNAL(timeout()), this, SLOT(on_p_transfer_stage_status_clicked()));
    connect(poll_IN, SIGNAL(timeout()), this, SLOT(on_p_API_IN_clicked()));
    connect(progEnd, SIGNAL(timeout()), this, SLOT(progTimer()));
    connect(macromaker, SIGNAL(timeout()), this, SLOT(f_macrocheck()));
    connect(macrotest, SIGNAL(timeout()), this, SLOT(f_stepteststring()));
    connect(APIlooptimer, SIGNAL(timeout()), this, SLOT(api_loop()));
    connect(delay, SIGNAL(timeout()), this, SLOT(timeoutDelay()));
    connect(apitestpolling, SIGNAL(timeout()), this, SLOT(f_apitestpolling()));
    connect(vactest, SIGNAL(timeout()), this, SLOT(f_vactest()));
    ui->combo_fui->setMaxVisibleItems(100);
    ui->combo_fui->setEditable(true);

    if (cmdfile.open(QIODevice::ReadOnly | QIODevice::Text)) // cmd list macro register
    {
        while (!cmdfile.atEnd())
        {
            cmdline = cmdfile.readLine();
            ui->combo_cmd->addItem(cmdline.trimmed());
        }
        cmdfile.close();
    }

    on_p_LOGIN_clicked(); // autostart user "oper"
}

void MainWindow::timeoutDelay()
{
    svc10 = 0;
}
MainWindow::~MainWindow()
{
    if (buslogfile.isOpen()) err_msgbox("Close Buslog first.");
    else
    {
        if (serial_feeder->isOpen()) serial_feeder->close();
        if (serial_stage->isOpen()) serial_stage->close();
        if (serial_mic->isOpen()) serial_mic->close();
        if (serial_due->isOpen()) serial_due->close();
        if (serial_api->isOpen()) serial_api->close();
        if (serial_smif2->isOpen()) serial_smif2->close();
        if (logfile.isOpen()) logfile.close();
        if (smiflogfile.isOpen()) smiflogfile.close();

        delete serial_feeder;
        delete serial_stage;
        delete serial_mic;
        delete serial_due;
        delete serial_api;
        delete serial_smif2;

        delete ui;
    }
}
void MainWindow::on_tabWidget_tabBarClicked(int index)
{
    qDebug() << "Widget" << index;
    //    if(index != ui->tabWidget->currentIndex()) hideWidget();        //
    //    aktives Widget bleibt erhalten
    ui->tabWidget->setCurrentIndex(index);
}
void MainWindow::vacaddcmd()
{
    qDebug() << "polltimer";
    polltimer->stop();

    if (cmdfeeder == 0)
    {
        if (LDvac2)
        {
            if (ui->check_vac_loader_2->isChecked()) on_check_vac_loader_2_clicked(1);
            else on_check_vac_loader_2_clicked(0);
        }
        else if (PAvac2)
        {
            if (ui->check_vac_aligner_2->isChecked()) on_check_vac_aligner_2_clicked(1);
            else on_check_vac_aligner_2_clicked(0);
        }
        else if (WC2vac2)
        {
            if (ui->check_vac_wcright_2->isChecked()) on_check_vac_wcright_2_clicked(1);
            else on_check_vac_wcright_2_clicked(0);
        }
        else if (WC1vac2)
        {
            if (ui->check_vac_wcleft_2->isChecked()) on_check_vac_wcleft_2_clicked(1);
            else on_check_vac_wcleft_2_clicked(0);
        }
        else if (CH4vac2)
        {
            if (ui->check_vac_chuck4_2->isChecked()) on_check_vac_chuck4_2_clicked(1);
            else on_check_vac_chuck4_2_clicked(0);
        }
        else if (CH6vac2)
        {
            if (ui->check_vac_chuck6_2->isChecked()) on_check_vac_chuck6_2_clicked(1);
            else on_check_vac_chuck6_2_clicked(0);
        }
        else if (CH8vac2)
        {
            if (ui->check_vac_chuck8_2->isChecked()) on_check_vac_chuck8_2_clicked(1);
            else on_check_vac_chuck8_2_clicked(0);
        }
    }
    else if (polltimer->isActive() == 0) polltimer->start(100);
}
void MainWindow::list_COMPORTS()
{
    portlist.clear();
    ui->combo_portlist_feeder->clear();
    ui->combo_portlist_Stage->clear();
    ui->combo_portlist_Micro->clear();
    ui->combo_portlist_DUE->clear();
    ui->combo_portlist_api->clear();

    QFile f(portdeffile); // Daten aus comportsetup.txt einlesen
    if (f.open(QIODevice::ReadOnly | QIODevice::Text))
    {
        qDebug() << "portfile" << portdeffile;
        line.clear();
        QString tmpline;
        tmpline.clear();

        while (!f.atEnd())
        {
            line = f.readLine();
            if (line.at(0) == '[') // Strings, die mit [ beginnen
            {
                qDebug() << line.trimmed().mid(1, line.size() - 3);

                if (line.mid(1, line.size() - 3) == "MIC")
                {
                    line = f.readLine();
                    ui->combo_portlist_Micro->addItem("COM" + line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                }
                else if (line.mid(1, line.size() - 3) == "STAGE")
                {
                    line = f.readLine();
                    ui->combo_portlist_Stage->addItem("COM" + line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                }
                else if (line.mid(1, line.size() - 3) == "API")
                {
                    line = f.readLine();
                    ui->combo_portlist_api->addItem("COM" + line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                }
                else if (line.mid(1, line.size() - 3) == "SERVICE")
                {
                    line = f.readLine();
                    ui->combo_portlist_feeder->addItem("COM" + line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                }
                else if (line.mid(1, line.size() - 3) == "PAMEAS")
                {
                    line = f.readLine();
                    ui->combo_portlist_DUE->addItem("COM" + line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                }
                else if (line.mid(1, line.size() - 3) == "SMIF2")
                {
                    line = f.readLine();
                    portSmif2 = "COM" + line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                }
            }
            else if(line.at(0) == '#') // Strings, die mit # beginnen
            {
                IDstring.append(line.mid(line.indexOf("#") + 1, line.indexOf('\n')-1).trimmed());
                IDstring.append(" ");
                qDebug() << "IDstring" << IDstring;
            }
        }
        f.close();
    }
    else
    {
        foreach (const QSerialPortInfo &serialPortInfo, QSerialPortInfo::availablePorts())
        {
            if (serialPortInfo.portName() != port)
            {
                portlist << serialPortInfo.portName();
                qDebug() << "portlist" << portlist;
            }
        }
        if (portlist.contains("COM4")) ui->combo_portlist_feeder->addItem("COM4");
        else ui->combo_portlist_feeder->addItems(portlist);
        if (portlist.contains("COM3")) ui->combo_portlist_api->addItem("COM3");
        else ui->combo_portlist_api->addItems(portlist);
        if (portlist.contains("COM5")) ui->combo_portlist_DUE->addItem("COM5");
        else ui->combo_portlist_DUE->addItems(portlist);
        if (portlist.contains("COM2")) ui->combo_portlist_Stage->addItem("COM2");
        else ui->combo_portlist_Stage->addItems(portlist);
        if (portlist.contains("COM1")) ui->combo_portlist_Micro->addItem("COM1");
        else ui->combo_portlist_Micro->addItems(portlist);
    }
}
void MainWindow::on_combo_portlist_feeder_currentTextChanged(const QString &arg1)
{
    portC = arg1;
}
void MainWindow::on_combo_portlist_Stage_currentTextChanged(const QString &arg1)
{
    portS = arg1;
}
void MainWindow::on_combo_portlist_DUE_currentTextChanged(const QString &arg1)
{
    portD = arg1;
}
void MainWindow::on_combo_portlist_Micro_currentTextChanged(const QString &arg1)
{
    portM = arg1;
}
void MainWindow::on_combo_portlist_api_currentTextChanged(const QString &arg1)
{
    portA = arg1;
    qDebug() << "portA" << portA;
}
void MainWindow::on_b_connect_feeder_clicked()
{
    if (serial_feeder->isOpen())
    {
        if (ui->check_loader_releasemotoY->isChecked()) // Haltestrom Loader Y wieder aktivieren
        {
            waitrepeat = 1;
            on_check_loader_releasemotoY_clicked(0);
            ui->check_loader_releasemotoY->setChecked(0);
        }
        else if (ui->check_loader_releasemotoX->isChecked()) // Haltestrom Loader X wieder aktivieren
        {
            waitrepeat = 1;
            on_check_loader_releasemotoX_clicked(0);
            ui->check_loader_releasemotoX->setChecked(0);
        }
        else
        {
            serial_feeder->close();
            resetFlags();
            ui->check_vac_poll->setChecked(0);
            setusertab(userindex);
            ui->b_connect_feeder->setText("connect");
            stopTimer();
            on_p_INIT_resetcmdfeeder_clicked();
            if (logfile.isOpen()) logfile.close();
        }
    }
    else
    {
        serial_feeder->setPortName(portC);
        serial_feeder->setBaudRate(14400);
        serial_feeder->setDataBits(QSerialPort::Data8);
        serial_feeder->setParity(QSerialPort::NoParity);
        serial_feeder->setStopBits(QSerialPort::OneStop);
        serial_feeder->setFlowControl(QSerialPort::NoFlowControl);

        if (serial_feeder->open(QIODevice::ReadWrite))
        {
            connect(serial_feeder, SIGNAL(readyRead()), this, SLOT(serialReceivedFeeder()));
            ui->tabWidget_2->setTabEnabled(0, 1);
            ui->b_connect_feeder->setText("disconnect");
            ui->combo_portlist_feeder->setStyleSheet(backLightGreen);
            serial_feeder->flush();
            setRESLabelRed(); // Resetanzeige zurücksetzen

            setusertab(userindex);
            waitACTpos = 0;

          //  auto placeholder = qDebug() << "logfile" << logfile;
            if (!logfile.open(QIODevice::Append | QIODevice::Text)) err_msgbox("LOG-File not open");
            else
            {
                ui->check_XRAX_file->setStyleSheet(radioGreen);
                ui->line_xlogfile->setText(LOGFILE2OPEN);               
            }
        }
        else
        {
            err_msgbox("error open Comport");
            serial_feeder->close();
        }
    }
}
void MainWindow::on_b_connect_Stage_clicked() {
    if (serial_stage->isOpen()) {
        ui->b_connect_Stage->setText("connect");
        serial_stage->close();
        ui->tab_transferpos->setDisabled(true);
        ui->combo_portlist_Stage->setStyleSheet(backLightGrey);
    } else {
        serial_stage->setPortName(portS);
        serial_stage->setBaudRate(9600);
        serial_stage->setDataBits(QSerialPort::Data8);
        serial_stage->setParity(QSerialPort::NoParity);
        serial_stage->setStopBits(QSerialPort::OneStop);
        serial_stage->setFlowControl(QSerialPort::NoFlowControl);
        if (serial_stage->open(QIODevice::ReadWrite))
        {
            connect(serial_stage, SIGNAL(readyRead()), this, SLOT(serialReceived_stage()));
            ui->b_connect_Stage->setText("disconnect");
            ui->tab_transferpos->setDisabled(false);
            ui->combo_portlist_Stage->setStyleSheet(backLightGreen);
            SETUP_STAGEFILE();
        }
        else
        {
            err_msgbox("error open Comport");
            serial_feeder->close();
        }
    }
}
void MainWindow::on_b_connect_Micro_clicked()
{
    if (serial_mic->isOpen())
    {
        ui->b_connect_Micro->setText("connect");
        serial_mic->close();
        ui->combo_portlist_Micro->setStyleSheet(backLightGrey);
    }
    else
    {
        serial_mic->setPortName(portM);
        serial_mic->setBaudRate(9600);
        serial_mic->setDataBits(QSerialPort::Data8);
        serial_mic->setParity(QSerialPort::NoParity);
        serial_mic->setStopBits(QSerialPort::OneStop);
        serial_mic->setFlowControl(QSerialPort::NoFlowControl);
        if (serial_mic->open(QIODevice::ReadWrite))
        {
            connect(serial_mic, SIGNAL(readyRead()), this, SLOT(serialReceived_Mic()));
            ui->b_connect_Micro->setText("disconnect");
            ui->combo_portlist_Micro->setStyleSheet(backLightGreen);
        }
        else
        {
            err_msgbox("error open Comport");
            serial_feeder->close();
        }
    }
}
void MainWindow::on_b_connect_api_clicked()
{
    if (serial_api->isOpen())
    {
        ui->b_connect_api->setText("connect");
        serial_api->close();
        ui->API->setDisabled(true);
        // ui->SYSTEM->setDisabled(true);
        ui->combo_portlist_api->setStyleSheet(backLightGrey);
        serialapi = 0;
    }
    else
    {
        f_setAPIPort();
        if (serial_api->open(QIODevice::ReadWrite))
        {
            serialapi = 1;
            connect(serial_api, SIGNAL(readyRead()), this, SLOT(serialReceived_Api()));
            ui->b_connect_api->setText("disconnect");
            ui->API->setDisabled(false);
            // ui->SYSTEM->setDisabled(false);
            ui->combo_portlist_api->setStyleSheet(backLightGreen);
        }
        else err_msgbox("PORT API not available");
    }
}
void MainWindow::f_setAPIPort()
{
    serial_api->setPortName(portA);
    serial_api->setBaudRate(38400);
    serial_api->setDataBits(QSerialPort::Data8);
    serial_api->setParity(QSerialPort::NoParity);
    serial_api->setStopBits(QSerialPort::OneStop);
    serial_api->setFlowControl(QSerialPort::NoFlowControl);
}
void MainWindow::on_b_connect_DUE_clicked()
{
    if (serial_due->isOpen())
    {
        ui->b_connect_DUE->setText("connect");
        serial_due->close();
        ui->ALIGNER->setDisabled(1);
        ui->combo_portlist_DUE->setStyleSheet(backLightGrey);
    }
    else
    {
        serial_due->setPortName(portD);
        serial_due->setBaudRate(230400);
        serial_due->setDataBits(QSerialPort::Data8);
        serial_due->setParity(QSerialPort::NoParity);
        serial_due->setStopBits(QSerialPort::OneStop);
        serial_due->setFlowControl(QSerialPort::NoFlowControl);
        serial_due->open(QIODevice::ReadWrite);
        if (connect(serial_due, SIGNAL(readyRead()), this, SLOT(serialReceived_DUE())))
        {
            ui->b_connect_DUE->setText("disconnect");
            ui->ALIGNER->setDisabled(0);
            ui->combo_portlist_DUE->setStyleSheet(backLightGreen);
        }
    }
}
void MainWindow::connectSMIF2(int state)
{
    if (state == 0)
    {
        if (serial_smif2->isOpen()) serial_smif2->close();
        if (smiflogfile.isOpen()) smiflogfile.close();
        // err_msgbox("close SMIF port "+portSmif2);
    }
    else if (state == 1)
    {
        serial_smif2->setPortName(portSmif2);
        serial_smif2->setBaudRate(9600);
        serial_smif2->setDataBits(QSerialPort::Data8);
        serial_smif2->setParity(QSerialPort::NoParity);
        serial_smif2->setStopBits(QSerialPort::OneStop);
        serial_smif2->setFlowControl(QSerialPort::NoFlowControl);

        if (serial_smif2->open(QIODevice::ReadOnly))
        {
            connect(serial_smif2, SIGNAL(readyRead()), this, SLOT(serialReceived_SMIF2()));
            if (!smiflogfile.open(QIODevice::Append | QIODevice::Text)) err_msgbox("LOG-File not open");
            else
            {
                ui->check_smiflog_file->setStyleSheet(radioGreen);
                ui->line_smiflogfile->setText(SMIFLOGFILE2OPEN);

                smiflogout << "SMIFLOG " + QDateTime::currentDateTime().toString() + '\n';
            }
        }
        else err_msgbox("could not connect to SMIF port " + portSmif2);
    }
}
void MainWindow::on_p_INIT_refreshports_clicked() { list_COMPORTS(); }
void MainWindow::serialSendFeeder(QByteArray arg)
{
    if (errlog)
    {
        qDebug() << "savedata" << arg << "next errlogwait";
        senddata = arg; // Sendedaten zwischen speichern
        errlog = 0;
        errlogwait = 1;
        logswitch(0);
    }
    else
    {
        if (arg != "$SET_2=1\r\n") // feedertimeout (Responsetime) setzen (außer RAC Reset)
        {
            if (cleansequenz != 255 || feedertimeout == 0) feedertimeout = 10000;
            qDebug() << "cmdtimeout0" << cmdtimeout->isActive();
            cmdtimeout->start(feedertimeout);
            qDebug() << "cmdtimeout" << cmdtimeout->isActive() << "feedertimeout" << feedertimeout;
        }

        if (serial_feeder->isOpen())
        {
            if (cmdfeeder == 0)
            {
                qDebug() << "send" << arg;
                lastcmd = arg;
                serial_feeder->write(arg);
                cmdfeeder = 1;
                QString log = f_decode_servicecmd(arg.trimmed());
                if(log == "0")
                {
                    logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "send: " << arg.trimmed() << "\n";
                    ui->plainText_sendlog->appendPlainText(QTime::currentTime().toString("hh:mm:ss.zzz' '") + "send: " + arg.trimmed());
                }
                else
                {
                    logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "send: " << log << " (" << arg.trimmed() << ")" << "\n";
                    ui->plainText_sendlog->appendPlainText(QTime::currentTime().toString("hh:mm:ss.zzz' '") + "send: " + log + " (" + arg.trimmed() + ")" );
                }
            }
            else
            {
                qDebug() << "senddata message" << arg;
                logout << QTime::currentTime().toString("hh:mm:ss.zzz' '")
                       << "new command cannot send -> last command still waiting for " "response\n";
                err_msgbox("new command cannot send -> last command still waiting for " "response: " + arg);
            }
        }
        else
        {
            qDebug() << "senddata port closed" << arg;
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "Connect to Service Port and try again\n";
            err_msgbox("Connect to Service Port and try again");
        }
    }
}
QString MainWindow::f_decode_servicecmd(QByteArray arg)
{
    QString cat;
    QString cmd = "0";
    QString id;
    QString val = "-";
    QString respval = "-";
    int index = 0;

    if(!arg.isNull())
    {      
        if(arg.indexOf(":") != -1) id = arg.mid(arg.indexOf("_")+1,arg.indexOf(":") - (arg.indexOf("_") + 1));
        else id = arg.mid(arg.indexOf("_")+1,arg.indexOf("=") - (arg.indexOf("_") + 1));
        if(arg.indexOf("=") != -1) val = arg.mid(arg.indexOf("=")+1,(-1 - (arg.indexOf("_") + 1)));
        else if(arg.indexOf(":") != -1) respval = QString::number(arg.mid(arg.indexOf(":")+1,(-1 - (arg.indexOf("_") + 1))).toUInt(&ok,16));
        index = id.toUInt(&ok,10);
        cat = arg.mid(arg.indexOf("$")+1,arg.indexOf("_")-1);


        if(cat == "SMIF") cmd = ISE_cmd[index];
        else if(cat == "SET") cmd = SET_cmd[index-1];
        else if(cat == "GET") cmd = GET_cmd[index];
        else if(cat == "READ") cmd = READ_cmd[index-1];
        else if(cat == "SETVAC") cmd = SETVAC_cmd[index-1];

        qDebug() << "arg=" << arg << "cat" << cat <<"id=" << id << "index=" << index << "cmd=" << cmd << "val=" << val << "respval=" << respval;
    }

    if(val != "-")
    {
        cmd.append(" " + val);
    }
    else if(respval != "-")
    {
        cmd.append(" " + respval);
    }
    return cmd;
}
void MainWindow::serialSendAPI(QByteArray arg)
{
    if (apitimeout->isActive() == 0)
    {
        if (arg != BoxReset) apitimeout->start(APIcmdtimeout); // Reset-Timeout wird schon vorher gestartet
    }
    if (serial_api->isOpen())
    {
        if (cmdAPI == 0)
        {
            qDebug() << arg;
            if (arg != BoxReset) cmdAPI = 1;
            serial_api->write(arg);
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "<-" << arg << "\n";
            ui->plainTextEdit_API_logerr->appendPlainText(QTime::currentTime().toString("hh:mm:ss.zzz' '") + " <-" + arg.trimmed());
        }
        else
        {
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "API Cmd - wait for Response\n";
            QMessageBox msgBox;
            msgBox.setText("API Cmd - wait for Response");
            msgBox.exec();
        }
    }
    else
    {
        logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "Connect to API Port and try again\n";
        QMessageBox msgBox;
        msgBox.setText("Connect to API Port and try again");
        msgBox.exec();
    }
}
void MainWindow::serialSendStage(QByteArray arg)
{
    if (stagetimer == 0) // clean schaltet joystick ein -> keine Response
    {
        if (stagetimeout->isActive() == 0) stagetimeout->start(stagecmdtimeout);
    }

    if (serial_stage->isOpen())
    {
        if (stagecmd == 0)
        {
            qDebug() << arg;
            serial_stage->write(arg);

            if (logfile.isOpen())
            {
                logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "<-" << arg.append('\n');
            }
            else if (!logfile.open(QIODevice::Append | QIODevice::Text)) err_msgbox("LOG-File not open");
            else logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "<-" << arg.append('\n');
            ui->plainTextEdit_stage_loger->appendPlainText("<-" + arg.trimmed());
            if (STAGECAL == 0 && stagetimer == 0) stagecmd = 1;
            stagetimer = 0;
        }
        else
        {
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "STAGE Cmd - wait for Response\n";
            QMessageBox msgBox;
            msgBox.setText("STAGE Cmd - wait for Response");
            msgBox.exec();
        }
    }
    else
    {
        logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "Stage COM Port not available\n";
        QMessageBox msgBox;
        msgBox.setText("Stage COM Port not available");
        msgBox.exec();
    }
}
void MainWindow::serialSendMic(QByteArray arg)
{
    if (serial_mic->isOpen())
    {
        if (miccmd == 0)
        {
            qDebug() << arg;
            serial_mic->write(arg);

            if (logfile.isOpen())
            {
                logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "mic <-" << arg.append('\n');
            }
            else if (!logfile.open(QIODevice::Append | QIODevice::Text)) err_msgbox("LOG-File not open");
            else logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "mic <- " << arg.append('\n');
            ui->plainTextEdit_mic_loger->appendPlainText("<-" + arg.trimmed());
            miccmd = 1;
        }
        else
        {
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "mic cmd - wait for Response\n";
            QMessageBox msgBox;
            msgBox.setText("mic cmd - wait for Response");
            msgBox.exec();
        }
    }
    else
    {
        logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "Connect to Micro Port and try again\n";
        QMessageBox msgBox;
        msgBox.setText("Connect to Micro Port and try again");
        msgBox.exec();
    }
}
void MainWindow::serialSendDUE(QByteArray arg)
{
    if (serial_due->isOpen())
    {
        qDebug() << arg;
        serial_due->write(arg);

        if (logfile.isOpen())
        {
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "<-" << arg.append('\n');
        }
        else if (!logfile.open(QIODevice::Append | QIODevice::Text)) err_msgbox("LOG-File not open");
        else logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "<-" << arg.append('\n');
        if (testdata == 0) ui->plainText_sendlog->appendPlainText("<-" + arg.trimmed());
    }
    else
    {
        logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "Connect to PA/MEAS Port and try again\n";
        QMessageBox msgBox;
        msgBox.setText("Connect to PA/MEAS Port and try again");
        msgBox.exec();
    }
}
void MainWindow::serialReceivedFeeder()
{
    if (cmdtimeout->isActive()) cmdtimeout->stop();
    feedertimeout = 0; // Timeout auf Standardwert zurückstellen
    while (serial_feeder->canReadLine())
    {
        usbdata = serial_feeder->readLine();
        QString log = f_decode_servicecmd(usbdata.trimmed());
        if(log == "0")
        {
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "recv: " << usbdata.trimmed() << "\n";
            ui->plainText_sendlog->appendPlainText(QTime::currentTime().toString("hh:mm:ss.zzz' '") + "recv: " + usbdata.trimmed());
        }
        else
        {
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "recv: " << log << " (" << usbdata.trimmed() << ")" << "\n";
            ui->plainText_sendlog->appendPlainText(QTime::currentTime().toString("hh:mm:ss.zzz' '") + "recv: " + log + " (" + usbdata.trimmed() + ")" );
        }

        cmdfeeder = 0;

        if (usbdata.left(1) == "@") f_receiveAPI(usbdata);
        else if (usbdata.left(1) == "$") f_receiveSVC(usbdata);
        else if (usbdata.left(1) == "&") f_receiveSVC(usbdata);
        else if (usbdata.left(1) == "/") f_receiveLOG(usbdata);
        else if (usbdata.left(1) == "#") f_receiveX2(usbdata);
        else if (usbdata.left(1) == "?") f_receiveSVC(usbdata);
        else if (usbdata.left(2) == "!W") f_receiveLOG(usbdata);
        else if (usbdata.left(5) == "IND> ") f_receiveSVC(usbdata);
        else ui->line_feed_mem->setText(usbdata.trimmed());

        usbdata = 0;
    }
    logout.flush();
}
void MainWindow::f_receiveX2(QByteArray str) // Erkennungszeichen # ->str enthält nur Daten
{
    QString abspos;
    QString actspeed;
    QString limitsw;
    QString Byte[33];
    int tmpstat = 0;   

    // Bytes 1-4   IST Abs Value
    //       5-8   IST Speed
    //         9   Endschalter/Sensoren

    QString datain = str.mid(1, str.indexOf('\r') - 1);
    qDebug() << "datain" << datain;

    if (datain.size() > 0)
    {
        int i = 0;
        do
        {
            if (i < 2) Byte[1] = datain.mid(i, 2);
            else if (i < 4) Byte[2] = datain.mid(i, 2);
            else if (i < 6) Byte[3] = datain.mid(i, 2);
            else if (i < 8) Byte[4] = datain.mid(i, 2);
            else if (i < 10) Byte[5] = datain.mid(i, 2);
            else if (i < 12) Byte[6] = datain.mid(i, 2);
            else if (i < 14) Byte[7] = datain.mid(i, 2);
            else if (i < 16) Byte[8] = datain.mid(i, 2);
            else if (i < 18) Byte[9] = datain.mid(i, 2);
            else if (i < 20) Byte[10] = datain.mid(i, 2);
            else if (i < 22) Byte[11] = datain.mid(i, 2);
            else if (i < 24) Byte[12] = datain.mid(i, 2);
            else if (i < 26) Byte[13] = datain.mid(i, 2);
            else if (i < 28) Byte[14] = datain.mid(i, 2);
            else if (i < 30) Byte[15] = datain.mid(i, 2);
            else if (i < 32) Byte[16] = datain.mid(i, 2);
            else if (i < 34) Byte[17] = datain.mid(i, 2);
            else if (i < 36) Byte[18] = datain.mid(i, 2);
            else if (i < 38) Byte[19] = datain.mid(i, 2);
            else if (i < 40) Byte[20] = datain.mid(i, 2);
            else if (i < 42) Byte[21] = datain.mid(i, 2);
            else if (i < 44) Byte[22] = datain.mid(i, 2);
            else if (i < 46) Byte[23] = datain.mid(i, 2);
            else if (i < 48) Byte[24] = datain.mid(i, 2);
            else if (i < 50) Byte[25] = datain.mid(i, 2);
            else if (i < 52) Byte[26] = datain.mid(i, 2);
            else if (i < 54) Byte[27] = datain.mid(i, 2);
            else if (i < 56) Byte[28] = datain.mid(i, 2);
            else if (i < 58) Byte[29] = datain.mid(i, 2);
            else if (i < 60) Byte[30] = datain.mid(i, 2);
            else if (i < 62) Byte[31] = datain.mid(i, 2);
            else if (i < 64) Byte[32] = datain.mid(i, 2);
            i += 2;
        }
        while (datain.size() > i);

        abspos = QString::number((Byte[1].toInt(&ok, 16) << 24) + (Byte[2].toInt(&ok, 16) << 16) + (Byte[3].toInt(&ok, 16) << 8) + Byte[4].toInt(&ok, 16)); //
        actspeed = QString::number((Byte[5].toInt(&ok, 16) << 24) + (Byte[6].toInt(&ok, 16) << 16) + (Byte[7].toInt(&ok, 16) << 8) + Byte[8].toInt(&ok, 16)); //
        limitsw = QString::number(Byte[9].toInt(&ok, 16));           //

        qDebug() << "datain.size" << datain.size() << "macromacro" << macromacro
                 << "mstep2" << mstep2 << "countmacro" << countmacro << "waitACTpos"
                 << waitACTpos << "getpara" << getpara << "setpara" << setpara
                 << "errlogwait" << errlogwait << "waitlog" << waitlog;

        if (macromacro) // macro maker aktiv
        {
            qDebug() << "lastcmd" << lastcmd.mid(16, 1); // &X0,0,3,1,0,0,0,5,9

            if (lastcmd.mid(16, 1) == "4" || lastcmd.mid(16, 1) == "5") // SET_VALUE, GET_VALUE
            {
                ui->plainTextEdit_macroresponse_setget->appendPlainText("value " + Byte[1]);
            }
            else if (lastcmd.mid(16, 1) == "1") // POS_ABS
            {
                ui->plainTextEdit_macroresponse_posabs->appendPlainText("pos " + abspos + ", MP " + Byte[5]);
                if(WCPmakrostring)
                {
                    int WCPleft = ui->line_wc_leftpos->text().toInt(&ok, 10);
                    int WCPmiddle = ui->line_wc_middlepos->text().toInt(&ok, 10);
                    int WCPright = ui->line_wc_rightpos->text().toInt(&ok, 10);

                    int val = (Byte[1].toInt(&ok, 16) << 24) + (Byte[2].toInt(&ok, 16) << 16) + (Byte[3].toInt(&ok, 16) << 8) + Byte[4].toInt(&ok, 16);
                    if(makrostringstep == 1)
                    {
                        if(abs(ui->line_macro_absdiff->text().toInt(&ok, 10)) < (abs(WCPleft - val)))
                        ui->line_macro_absdiff->setText(QString::number(WCPleft - val));
                    }
                    else if(makrostringstep == 2)
                    {
                        if(abs(ui->line_macro_absdiff->text().toInt(&ok, 10)) < (abs(WCPmiddle - val)))
                        ui->line_macro_absdiff->setText(QString::number(WCPmiddle - val));
                    }
                    else if(makrostringstep == 3)
                    {
                        if(abs(ui->line_macro_absdiff->text().toInt(&ok, 10)) < (abs(WCPright - val)))
                        ui->line_macro_absdiff->setText(QString::number(WCPright - val));
                    }
                }
            }
            else if (lastcmd.mid(16, 1) == "2") // POS_CONST
            {
                ui->plainTextEdit_macroresponse_posconst->appendPlainText("pos " + abspos);
            }
            else if (lastcmd.mid(16, 1) == "3") // READ_POS
            {
                ui->plainTextEdit_macroresponse_readpos->appendPlainText("pos " + abspos + ", speed " + actspeed + ", limit " + limitsw);
            }
            else if (lastcmd.mid(16, 1) == "7") // GET_PARAMETER
            {
                if (lastcmd.mid(6, 1) == "7")
                {
                    // logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "->"
                    // << usbdata.trimmed() << "\n";
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Pulstime LD " + Byte[1]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Timeout LD " + Byte[2]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold ON LD " + Byte[3]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold OFF LD " + Byte[4]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Pulstime WC1 " + Byte[5]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Timeout WC1 " + Byte[6]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold ON WC1 " + Byte[7]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold OFF WC1 " + Byte[8]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Pulstime WC2 " + Byte[9]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Timeout WC2 " + Byte[10]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold ON WC2 " + Byte[11]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold OFF WC2 " + Byte[12]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Pulstime PA " + Byte[13]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Timeout PA " + Byte[14]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold ON PA " + Byte[15]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold OFF PA " + Byte[16]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("-- " + Byte[17]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("-- " + Byte[18]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("-- " + Byte[19]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("-- " + Byte[20]);
                }
                if (lastcmd.mid(6, 1) == "8") //
                {
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Pulstime CH4 " + Byte[1]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Timeout CH4 " + Byte[2]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold ON CH4 " + Byte[3]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold OFF CH4 " + Byte[4]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Pulstime def " + Byte[5]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Timeout def " + Byte[6]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold def " + Byte[7]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold OFF def " + Byte[8]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Pulstime CH6 " + Byte[9]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Timeout CH6 " + Byte[10]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold ON CH6 " + Byte[11]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold OFF CH6 " + Byte[12]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Pulstime CH8 " + Byte[13]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Timeout CH8 " + Byte[14]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold ON CH8 " + Byte[15]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold OFF CH8 " + Byte[16]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Pulstime Main vac " + Byte[17]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Timeout Main vac " + Byte[18]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold ON Main vac " + Byte[19]);
                    ui->plainTextEdit_macroresponse_setget->appendPlainText("Threshold OFF Main vac " + Byte[20]);
                }
            }

            if (ui->check_macro_delay->isChecked())
            {
                if (macromaker->isActive() == 0)
                {
                    macromaker->start(ui->line_macro_standarddelay->text().toInt(&ok, 10)); // Timeout startet f_macromaker()
                    if (countmacro >= mstep2 + 2) waitlog = 1;
                }
            }
            else if (countmacro >= mstep2 + 2)
            {
                qDebug() << "mstep2" << mstep2;
                if (mstep < 25) ++mstep2;
                else if (ui->check_ma_loop->isChecked()) mstep2 = 0;
                else macromacro = 0;
                waitlog = 1;
                f_macromaker();
            }
            else if (ui->check_ma_loop->isChecked())
            {
                mstep2 = 0;
                f_macromaker();
            }
            else
            {
                macromacro = 0;
                waitlog = 0;
            }
        }
        else if (makrostring)
        {
            if (lastcmd.mid(16, 1) == "4" || lastcmd.mid(16, 1) == "5")
            {
                ui->plainTextEdit_macroresponse_setget->appendPlainText("value " + Byte[1]);
            }
            else if (lastcmd.mid(16, 1) == "1") // POS_ABS
            {
            //    qDebug() << "target " << ui->line_macro_target->text() << "abspos " << abspos << "diff " << QString::number(ui->line_macro_target->text().toInt(&ok,10) - abspos.toInt(&ok,10));
                ui->line_macro_count->setText(QString::number(zaehler += 1));
                int target = ui->line_macro_target->text().toInt(&ok,10);  // Sollposition
                int maxdiff = ui->line_macro_maxdiff->text().toInt(&ok,10);
                int diff = target - abspos.toInt(&ok,10);
                if(abs(diff) > abs(maxdiff))
                {
                    ui->line_macro_maxdiff->setText(QString::number(diff));
                    ui->line_macro_maxdiff_count->setText(QString::number(zaehler));
                    ui->line_macro_maxdiff_target->setText(ui->line_macro_target->text());   // Sollposition bei maxdiff
                }
                ui->line_macro_diff->setText(QString::number(diff));
                ui->plainTextEdit_macroresponse_posabs->appendPlainText("pos " + abspos + ", MP " + Byte[5]);
            }
            else if (lastcmd.mid(16, 1) == "2") // POS_CONST
            {
                ui->plainTextEdit_macroresponse_posconst->appendPlainText("pos " + abspos);
            }
            else if (lastcmd.mid(16, 1) == "3") // READ_POS
            {
                ui->plainTextEdit_macroresponse_readpos->appendPlainText("pos " + abspos + ", speed " + actspeed + ", limit " + limitsw);
            }

            if (ui->check_macro_delay->isChecked())
            {
                if (macrotest->isActive() == 0) macrotest->start(ui->line_macro_standarddelay->text().toInt(&ok, 10));
            }
            else f_stepteststring();
        }
        else if (svc0) // Daten Boardversion
        {
            QString version;
            version.clear();
            for (int i = 1; i < 30; i++)
            {
                if (Byte[i] == "2D") Byte[i] = "-";
                else if (Byte[i] == "2E") Byte[i] = ".";
                else if (Byte[i] == "20") Byte[i] = " ";
                else if (Byte[i] == "56") Byte[i] = "V";
                else if (Byte[i] == "00") break;
                else Byte[i] = QString::number(Byte[i].toInt(&ok, 10) - 30);
                version.append(Byte[i]);
            }
            if (boardno == 2) ui->line_motorboard2->setText(version);
            if (boardno == 3) ui->line_motorboard3->setText(version);
            if (boardno == 4) ui->line_motorboard4->setText(version);
            if (boardno == 5) ui->line_motorboard5->setText(version);
            if (boardno == 6) ui->line_motorboard6->setText(version);
            if (boardno == 7) ui->line_sensorboard7->setText(version);
            if (boardno == 8) ui->line_sensorboard8->setText(version);
            // if (boardno == 9) ui->line_sensorboard9->setText(version);
            if (boardno == 15) ui->line_alignerboard->setText(version);
            svc0 = 0;
        }
        else if (pollflagPS) // PA Wafersize Sensorwerte
        {
            QString s;
            if (Byte[2] == "8") s = "8";
            else if (Byte[2] == "4") s = "6";
            else if (Byte[2] == "2") s = "5";
            else if (Byte[2] == "1") s = "4";
            else if (Byte[2] == "0") s = "--";
            ui->lineEdit_sens_L1sens->setText(s);
        }
        else if (getCarrSens1) // Lift1 Wafersize Sensorwerte
        {
            QString s;
            if (Byte[2] == "8") s = "8";
            else if (Byte[2] == "4") s = "6";
            else if (Byte[2] == "2") s = "5";
            else if (Byte[2] == "1") s = "4";
            else if (Byte[2] == "0") s = "--";
            ui->line_lift1_cassswitch->setText(s);
            getCarrSens1 = 0;
        }
        else if (getCarrSens2) // Lift2 Wafersize Sensorwerte
        {
            QString s;
            if (Byte[2] == "8") s = "8";
            else if (Byte[2] == "4") s = "6";
            else if (Byte[2] == "2") s = "5";
            else if (Byte[2] == "1") s = "4";
            else if (Byte[2] == "0") s = "--";
            ui->line_lift2_cassswitch->setText(s);
            getCarrSens2 = 0;
        }
        else if (cmdid) // Makroprofil
        {
            ui->plainText_sendlog->appendPlainText("cmdid: " +
                                                   QString::number(cmdid)); // DEBUG
            cmdid = 0;
            if (macro_profil == 1)
                macroProfil(true);
        }
        else if (calSensHeight) // cal Lift1 pos Loder height
        {
            feedertimeout = 30000;
            serialSendFeeder("$SET_35=1\r\n");
        }
        else if (calSensHeight2) // cal Lift2 pos Loder height
        {
            feedertimeout = 30000;
            serialSendFeeder("$SET_35=2\r\n");
        }
        else if (calsens == 2)
        {
            if (str.size() > 0)
            {
                int i = 0;
                do
                {
                    if (i < 2) Byte[1] = datain.mid(i, 2);
                    else if (i < 4) Byte[2] = datain.mid(i, 2);
                    i += 2;
                }
                while (str.size() > i);
            }

            value = Byte[2].toInt(&ok, 16);
            serialSendFeeder("&X0,0,7,1,0,0,0,5,80,\r\n"); // Amplifikation
            calsens = 3;
        }
        else if (calsens == 3)
        {
            if (str.size() > 0)
            {
                int i = 0;
                do
                {
                    if (i < 2) Byte[1] = datain.mid(i, 2);
                    else if (i < 4) Byte[2] = datain.mid(i, 2);
                    i += 2;
                }
                while (str.size() > i);
            }

            ampl = Byte[2].toInt(&ok, 16);
            if (macroL1sens == 0) err_msgbox("SensorValue: " + QString::number(value) + ", " + "Amplifier: " + QString::number(ampl));
            else if (macroL1sens == 1)
            {
                macroL1sens = 0;
                ui->line_Laser_Amplification->setText(QString::number(ampl));
                ui->line_Laser_Value->setText(QString::number(value));
            }
            calsens = 0;
        }
        else if (calsens2 == 2)
        {
            if (str.size() > 0)
            {
                int i = 0;
                do
                {
                    if (i < 2) Byte[1] = datain.mid(i, 2);
                    else if (i < 4) Byte[2] = datain.mid(i, 2);
                    i += 2;
                } while (str.size() > i);
            }
            value = Byte[2].toInt(&ok, 16);
            serialSendFeeder("&X0,0,7,1,0,0,0,5,82,\r\n"); // Amplifikation sensor lift2
            calsens2 = 3;
        }
        else if (calsens2 == 3)
        {
            if (str.size() > 0)
            {
                int i = 0;
                do
                {
                    if (i < 2) Byte[1] = datain.mid(i, 2);
                    else if (i < 4) Byte[2] = datain.mid(i, 2);
                    i += 2;
                }
                while (str.size() > i);
            }

            ampl = Byte[2].toInt(&ok, 16);
            if (macroL2sens == 0) err_msgbox("SensorValue: " + QString::number(value) + ", " + "Amplifier: " + QString::number(ampl));
            else if (macroL2sens == 1)
            {
                macroL2sens = 0;
                ui->line_Laser_Amplification->setText(QString::number(ampl));
                ui->line_Laser_Value->setText(QString::number(value));
            }
            calsens2 = 0;
        }
        else if (rXcmd)
        {
            if (rXcmd == MeasAnalog)
            {
                if (pollflagWS) ui->line_WafSens_Value->setText(QString::number(datain.toInt(&ok, 16)));
                else ui->line_alignvalue->setText(QString::number(datain.toInt(&ok, 16))); // Response Messwert von der Prealigner-Messkarte
                if (xrepeat) on_p_align_analogval_clicked();
            }
            else if (rXcmd == MeasAmplif)
            {
                if (pollflagWS) ui->line_WafSens_Ampli->setText(QString::number(datain.toInt(&ok, 16)));
                ui->line_alignamplifi->setText(QString::number(datain.toInt(&ok, 16))); // Response Verstärkung Prealigner-Messkarte
            }
            else if (rXcmd == getPreaPhi)
            {
                ui->line_align_getpos->setText(abspos); // Response PA Phi pos
                float flt = abspos.toInt(&ok, 10);
                float res = getResolution("Prealigner phi motor").toFloat();
                s = QString::number(flt / res, 10, 2); // 2 Nachkommastellen
                ui->line_align_getpos_degree->setText(s);
            }
            else rXcmd = 0;
        }
        if (waitACTpos) // Zuordnung der Pos Values zu Widget Line über waitACTpos index
        {
            if (waitACTpos == 3 || waitACTpos == 4) {
                if (waitaction) // pos const Lift height
                {
                    ui->lineCass_actHeightPos->setText(
                                abspos); // aktuelle lift height pos zwischenspeichern
                    float flt = abspos.toInt(&ok, 10);
                    s = QString::number(flt / 360.00, 10, 4);
                    ui->lineCass_actpos_mm->setText(s);

                    if (ui->checkCass_lift1->isChecked()) {
                        if (ui->check_cass_constfast->isChecked()) {
                            serialSendFeeder(
                                        "$X_2,0,0,3,1,0,0,0,2,1,255,251,200,128\r\n"); // Fast
                            ui->p_cass_constpos->setStyleSheet(backLightGreen);
                        } else if (ui->check_cass_constslow->isChecked()) {
                            serialSendFeeder(
                                        "$X_2,0,0,3,1,0,0,0,2,1,255,255,10,128\r\n"); // Slow
                            ui->p_cass_constpos->setStyleSheet(backLightGreen);
                        } else
                            err_msgbox("select speed first");
                    } else if (ui->checkCass_lift2->isChecked()) {
                        if (ui->check_cass_constfast->isChecked()) {
                            serialSendFeeder(
                                        "$X_2,0,0,2,1,0,0,0,2,1,255,251,200,128\r\n"); // Fast
                            ui->p_cass_constpos->setStyleSheet(backLightGreen);
                        } else if (ui->check_cass_constslow->isChecked()) {
                            serialSendFeeder(
                                        "$X_2,0,0,2,1,0,0,0,2,1,255,255,10,128\r\n"); // Slow
                            ui->p_cass_constpos->setStyleSheet(backLightGreen);
                        } else
                            err_msgbox("select speed first");
                    } else
                        err_msgbox("select lift first");
                } else if (getliftpos2) {
                    ui->lineCass_newHeightPos->setText(abspos);
                    int pos1 = ui->lineCass_actHeightPos->text().toInt(&ok, 10);
                    int diff = abspos.toInt(&ok, 10) - pos1;
                    ui->lineCass_HeightPos_diff->setText(QString::number(diff));
                    getliftpos2 = 0;
                } else {
                    ui->lineCass_actHeightPos->setText(abspos);
                    float flt = abspos.toInt(&ok, 10);
                    s = QString::number(flt / 360.00, 10, 4);
                    ui->lineCass_actpos_mm->setText(s);
                    ui->p_cass_getheight->setStyleSheet("background-color: lightgreen");
                }
            } else if (waitACTpos == getLift1) // Widget get Height Lift1 (5)
            {
                if (macrounitpos) {
                    //                        int posist = abspos.toInt(&ok, 10);
                    //                        int possoll =
                    //                        ui->line_lift1_xyloader_height->text().toInt(&ok,10);
                    //                        int maxdev =
                    //                        ui->line_maxdeviation->text().toInt(&ok,10);
                    //    if((possoll - posist) < maxdev);
                } else {
                    ui->lineL1_actHeightPos->setText(abspos);
                    float flt = abspos.toInt(&ok, 10);
                    float res = 1;
                    res = getResolution("Lift1 height motor").toFloat();
                    s = QString::number(flt / res, 10, 4);
                    ui->lineL1_actpos_mm->setText(s);
                    ui->p_L1_getheight->setStyleSheet(backLightGreen);
                }
            } else if (waitACTpos == getTilt1) // Widget get Tilt Lift1
            {
                ui->lineL1_actTiltPos->setText(abspos);
                float flt = abspos.toInt(&ok, 10);
                float res = 1;
                res = getResolution("Lift1 tilt motor").toFloat();
                s = QString::number(flt / res, 10, 4);
                ui->lineL1_acttiltpos_mm->setText(s);
                ui->p_L1_gettilt->setStyleSheet(backLightGreen);
            } else if (waitACTpos == getLift2) // Widget get Height Lift2
            {
                ui->lineL2_actHeightPos->setText(abspos);
                float flt = abspos.toInt(&ok, 10);
                float res = 1;
                res = getResolution("Lift2 height motor").toFloat();
                s = QString::number(flt / res, 10, 4);
                ui->lineL2_actpos_mm->setText(s);
                ui->p_L2_getheight->setStyleSheet("background-color: lightgreen");
            } else if (waitACTpos == getTilt2) // Widget get Tilt Lift2
            {
                ui->lineL2_actTiltPos->setText(abspos);
                float flt = abspos.toInt(&ok, 10);
                float res = 1;
                res = getResolution("Lift2 tilt motor").toFloat();
                s = QString::number(flt / res, 10, 4);
                ui->lineL2_acttiltpos_mm->setText(s);
                ui->p_L2_gettilt->setStyleSheet(backLightGreen);
            } else if (waitACTpos == getLoader_X) // Widget get X Loader
            {
                if (cleanman) {
                    //                        ui->horizontalSlider_clean_moveLDX->setValue(abspos.toInt(&ok,10));
                    //                        ui->line_clean_moveLDX->setText(abspos);
                } else {
                    ui->lineLD_actXPos->setText(abspos);
                    float flt = abspos.toInt(&ok, 10);
                    float res = 1;
                    res = getResolution("Loader x - motor").toFloat();
                    s = QString::number(flt / res, 10, 4);
                    ui->lineLD_actpos_mm->setText(s);
                    ui->p_LD_getXpos->setStyleSheet(backLightGreen);
                }
            } else if (waitACTpos == getLoader_Y) // Widget get Y Loader
            {
                ui->lineLD_actYPos->setText(abspos);

                float flt = abspos.toInt(&ok, 10);
                float res = 1;
                res = getResolution("Loader y - motor").toFloat();
                s = QString::number(flt / res, 10, 4);
                ui->lineLD_actposY_mm->setText(s);
                ui->p_LD_getYpos->setStyleSheet(backLightGreen);
            } else if (waitACTpos == getPrea) // Widget get Prea Height
            {
                if (cleanman) {
                    //                        qDebug()<<"abspos"<<abspos;
                    //                        ui->horizontalSlider_clean_movePAH->setValue(abspos.toInt(&ok,10));
                    //                        ui->line_clean_movePAH->setText(abspos);
                } else {
                    ui->linePA_actHeightPos->setText(abspos);
                    float flt = abspos.toInt(&ok, 10);
                    float res = 1;
                    res = getResolution("Prealigner height motor").toFloat();
                    s = QString::number(flt / res, 10, 4);
                    ui->linePA_actpos_mm->setText(s);
                    ui->p_PA_getheight->setStyleSheet(backLightGreen);
                }
            } else if (waitACTpos == getPreaPhi) // Widget get Prea Phi
            {
                ui->linePA_actPhiPos->setText(abspos);
                float flt = abspos.toInt(&ok, 10);
                float res = getResolution("Prealigner phi motor").toFloat();
                s = QString::number(flt / res, 10, 4);
                ui->linePA_actpos_degree->setText(s);
                ui->p_PA_getPhi->setStyleSheet(backLightGreen);
            } else if (waitACTpos == getWC) // Widget get WC
            {
                if (cleanman) {
                    //                        ui->horizontalSlider_clean_moveWCH->setValue(abspos.toInt(&ok,10));
                    //                        ui->horizontalSlider_clean_moveWCH->setValue(abspos.toInt(&ok,10));
                    //                        ui->line_clean_moveWCH->setText(abspos);
                } else {
                    ui->lineWC_actHeightPos->setText(abspos);
                    float flt = abspos.toInt(&ok, 10);
                    float res = 1;
                    res = getResolution("Waferchanger height motor").toFloat();
                    s = QString::number(flt / res, 10, 4);
                    ui->lineWC_actpos_mm->setText(s);
                    ui->p_WC_getheight->setStyleSheet(backLightGreen);
                }
            } else if (waitACTpos == getWCPhi) // Widget get WC Phi
            {
                if (cleanman) {
                    //                        ui->horizontalSlider_clean_moveWCP->setValue(abspos.toInt(&ok,10));
                    //                        ui->line_clean_moveWCP->setText(abspos);
                } else {
                    ui->lineWC_actPhitPos->setText(abspos);
                    float flt = abspos.toInt(&ok, 10);
                    float res = 1;
                    res = getResolution("Waferchanger phi motor").toFloat();
                    if (flt < 0) {
                        s = QString::number(flt / res, 'f', 3);
                    } else
                        s = QString::number(flt / res, 10, 4);
                    ui->lineWC_actpos_degree->setText(s);
                }
                ui->p_WC_getPhi->setStyleSheet(backLightGreen);
            } else if (waitACTpos == getTilt) // get PA Tilt
            {
                ui->linePA_actTiltPos->setText(abspos);
                float flt = abspos.toInt(&ok, 10);
                float res = getResolution("Wobbler phi motor").toFloat();
                s = QString::number(flt / res, 10, 4);
                ui->linePA_actpos_degree_tilt->setText(s);
                ui->p_PA_getTilt->setStyleSheet(backLightGreen);
            } else if (waitACTpos == getRotPos) // get PA RotPos
            {
                ui->linePA_actRotPos->setText(abspos);
                ui->linePA_actRotPos_2->setText(abspos);
                float flt = abspos.toInt(&ok, 10);
                float res = getResolution("Wobbler rotation motor").toFloat();
                s = QString::number(flt / res, 10, 4);
                ui->linePA_actpos_degree_rot->setText(s);
                ui->p_PA_getRot->setStyleSheet(backLightGreen);
                ui->p_PA_getRot_2->setStyleSheet(backLightGreen);
            } else if (waitACTpos == readmotstat) {
                ui->line_mot_pos->setText(abspos);
                ui->line_mot_speed->setText(actspeed);
                if (limitsw.toInt(&ok, 10) & 0b00001000)
                    ui->check_mot_lowlimit->setChecked(1);
                else
                    ui->check_mot_lowlimit->setChecked(0);
                if (limitsw.toInt(&ok, 10) & 0b00010000)
                    ui->check_mot_upperlimit->setChecked(1);
                else
                    ui->check_mot_upperlimit->setChecked(0);
                if (limitsw.toInt(&ok, 10) & 0b00100000)
                    ui->check_mot_initsensor->setChecked(1);
                ui->check_mot_initsensor->setChecked(0);
                if (limitsw.toInt(&ok, 10) & 0b01000000)
                    ui->check_mot_emostop->setChecked(1);
                ui->check_mot_emostop->setChecked(0);
                if (ui->p_motstat_LOADER_X->styleSheet() == backLightYello)
                    ui->p_motstat_LOADER_X->setStyleSheet(backLightGreen);
                else if (ui->p_motstat_LOADER_Y->styleSheet() == backLightYello)
                    ui->p_motstat_LOADER_Y->setStyleSheet(backLightGreen);
                else if (ui->p_motstat_L1_Tilt->styleSheet() == backLightYello)
                    ui->p_motstat_L1_Tilt->setStyleSheet(backLightGreen);
                else if (ui->p_motstat_L1_Height->styleSheet() == backLightYello)
                    ui->p_motstat_L1_Height->setStyleSheet(backLightGreen);
                else if (ui->p_motstat_L2_Tilt->styleSheet() == backLightYello)
                    ui->p_motstat_L2_Tilt->setStyleSheet(backLightGreen);
                else if (ui->p_motstat_L2_Height->styleSheet() == backLightYello)
                    ui->p_motstat_L2_Height->setStyleSheet(backLightGreen);
                else if (ui->p_motstat_PREA_Height->styleSheet() == backLightYello)
                    ui->p_motstat_PREA_Height->setStyleSheet(backLightGreen);
                else if (ui->p_motstat_PREA_PHI->styleSheet() == backLightYello)
                    ui->p_motstat_PREA_PHI->setStyleSheet(backLightGreen);
                else if (ui->p_motstat_PREA_TILT->styleSheet() == backLightYello)
                    ui->p_motstat_PREA_TILT->setStyleSheet(backLightGreen);
                else if (ui->p_motstat_PREA_ROTPOS->styleSheet() == backLightYello)
                    ui->p_motstat_PREA_ROTPOS->setStyleSheet(backLightGreen);
                else if (ui->p_motstat_WCH->styleSheet() == backLightYello)
                    ui->p_motstat_WCH->setStyleSheet(backLightGreen);
                else if (ui->p_motstat_WCP->styleSheet() == backLightYello)
                    ui->p_motstat_WCP->setStyleSheet(backLightGreen);
            } else if (waitACTpos == getVacParamLD) {
                ui->line_vac_LD_puls->setText(QString::number(Byte[1].toInt(&ok, 16)));
                ui->line_vac_LD_timeout->setText(
                            QString::number(Byte[2].toInt(&ok, 16)));
                if (ui->check_vac_lowactive->isChecked()) {
                    ui->line_vac_LD_ThrsON_2->setPalette(palSchrift);
                    ui->line_vac_LD_ThrsON->setPalette(palSchrift0);
                    ui->line_vac_LD_ThrsON->setText(
                                QString::number(Byte[3].toInt(&ok, 16)));
                    ui->line_vac_WC1_ThrsON_2->setPalette(palSchrift);
                    ui->line_vac_WC1_ThrsON->setPalette(palSchrift0);
                    ui->line_vac_WC1_ThrsON->setText(
                                QString::number(Byte[7].toInt(&ok, 16)));
                    ui->line_vac_WC2_ThrsON_2->setPalette(palSchrift);
                    ui->line_vac_WC2_ThrsON->setPalette(palSchrift0);
                    ui->line_vac_WC2_ThrsON->setText(
                                QString::number(Byte[11].toInt(&ok, 16)));
                    ui->line_vac_PA_ThrsON_2->setPalette(palSchrift);
                    ui->line_vac_PA_ThrsON->setPalette(palSchrift0);
                    ui->line_vac_PA_ThrsON->setText(
                                QString::number(Byte[15].toInt(&ok, 16)));
                } else {
                    ui->line_vac_LD_ThrsON->setPalette(palSchrift);
                    ui->line_vac_LD_ThrsON_2->setPalette(palSchrift0);
                    ui->line_vac_LD_ThrsON->setText(
                                QString::number(Byte[3].toInt(&ok, 16)));
                    ui->line_vac_WC1_ThrsON->setPalette(palSchrift);
                    ui->line_vac_WC1_ThrsON_2->setPalette(palSchrift0);
                    ui->line_vac_WC1_ThrsON->setText(
                                QString::number(Byte[7].toInt(&ok, 16)));
                    ui->line_vac_WC2_ThrsON->setPalette(palSchrift);
                    ui->line_vac_WC2_ThrsON_2->setPalette(palSchrift0);
                    ui->line_vac_WC2_ThrsON->setText(
                                QString::number(Byte[11].toInt(&ok, 16)));
                    ui->line_vac_PA_ThrsON->setPalette(palSchrift);
                    ui->line_vac_PA_ThrsON_2->setPalette(palSchrift0);
                    ui->line_vac_PA_ThrsON->setText(
                                QString::number(Byte[15].toInt(&ok, 16)));
                }
                ui->line_vac_LD_ThrsOFF->setText(
                            QString::number(Byte[4].toInt(&ok, 16)));
                ui->line_vac_WC1_puls->setText(QString::number(Byte[5].toInt(&ok, 16)));
                ui->line_vac_WC1_Timeout->setText(
                            QString::number(Byte[6].toInt(&ok, 16)));
                // ui->line_vac_WC1_ThrsON->setText(QString::number(Byte[7].toInt(&ok,16)));
                ui->line_vac_WC1_ThrsOFF->setText(
                            QString::number(Byte[8].toInt(&ok, 16)));
                ui->line_vac_WC2_puls->setText(QString::number(Byte[9].toInt(&ok, 16)));
                ui->line_vac_WC2_Timeout->setText(
                            QString::number(Byte[10].toInt(&ok, 16)));
                // ui->line_vac_WC2_ThrsON->setText(QString::number(Byte[11].toInt(&ok,16)));
                ui->line_vac_WC2_ThrsOFF->setText(
                            QString::number(Byte[12].toInt(&ok, 16)));
                ui->line_vac_PA_puls->setText(QString::number(Byte[13].toInt(&ok, 16)));
                ui->line_vac_PA_Timeout->setText(
                            QString::number(Byte[14].toInt(&ok, 16)));
                // ui->line_vac_PA_ThrsON->setText(QString::number(Byte[15].toInt(&ok,16)));
                ui->line_vac_PA_ThrsOFF->setText(
                            QString::number(Byte[16].toInt(&ok, 16)));
            } else if (waitACTpos == getVacParamPA)
            {
                ui->line_vac_CH4_puls->setText(QString::number(Byte[1].toInt(&ok, 16)));
                ui->line_vac_CH4_Timeout->setText(QString::number(Byte[2].toInt(&ok, 16)));
                if (ui->check_vac_lowactive->isChecked())
                {
                    ui->line_vac_CH4_ThrsON_2->setPalette(palSchrift);
                    ui->line_vac_CH4_ThrsON->setPalette(palSchrift0);
                    ui->line_vac_CH4_ThrsON->setText(QString::number(Byte[3].toInt(&ok, 16)));
                }
                else
                {
                    ui->line_vac_CH4_ThrsON->setPalette(palSchrift);
                    ui->line_vac_CH4_ThrsON_2->setPalette(palSchrift0);
                    ui->line_vac_CH4_ThrsON->setText(QString::number(Byte[3].toInt(&ok, 16)));
                }
                ui->line_vac_CH4_ThrsOFF->setText(QString::number(Byte[4].toInt(&ok, 16)));
                ui->line_vac_CH6_puls->setText(QString::number(Byte[9].toInt(&ok, 16)));
                ui->line_vac_CH6_Timeout->setText(QString::number(Byte[10].toInt(&ok, 16)));
                ui->line_vac_CH6_ThrsON->setText(QString::number(Byte[11].toInt(&ok, 16)));
                ui->line_vac_CH6_ThrsOFF->setText(QString::number(Byte[12].toInt(&ok, 16)));
                ui->line_vac_CH8_puls->setText(QString::number(Byte[13].toInt(&ok, 16)));
                ui->line_vac_CH8_Timeout->setText(QString::number(Byte[14].toInt(&ok, 16)));
                ui->line_vac_CH8_ThrsON->setText(QString::number(Byte[15].toInt(&ok, 16)));
                ui->line_vac_CH8_ThrsOFF->setText(QString::number(Byte[16].toInt(&ok, 16)));
                ui->line_vac_MainVac_puls->setText(QString::number(Byte[17].toInt(&ok, 16)));
                ui->line_vac_MainVac_Timeout->setText(QString::number(Byte[18].toInt(&ok, 16)));
                ui->line_vac_MainVac_ThrsON->setText(QString::number(Byte[19].toInt(&ok, 16)));
                ui->line_vac_MainVac_ThrsOFF->setText(QString::number(Byte[20].toInt(&ok, 16)));
                waitlog = 0;
            } else if (waitACTpos == getLock1Param) {
                //    Byte 1      Delaytime
                //    Byte 2      Lockvoltage 1
                //    Byte 3      Lockvoltage 2
                //    Byte 4      Lockvoltage 3
                //    Byte 5      Lockvoltage 4
                //    Byte 6      Lockvoltage 5
                //    Byte 7      Unlockvoltage 1
                //    Byte 8      Unlockvoltage 2
                //    Byte 9      Unlockvoltage 3
                //    Byte 10    Unlockvoltage 4
                //    Byte 11    Unlockvoltage 5
                //    Byte 12    Vacummnummer

                ui->line_lock_delaytime->setPalette(palSchrift);
                ui->line_lock_delaytime->setText(
                            QString::number(Byte[1].toInt(&ok, 16)));

                ui->line_lock_vacnumber->setPalette(palSchrift);
                ui->line_lock_vacnumber->setText(
                            QString::number(Byte[12].toInt(&ok, 16)));

                ui->line_lock_v1->setPalette(palSchrift);
                ui->line_lock_v1->setText(QString::number(Byte[2].toInt(&ok, 16)));

                ui->line_lock_v2->setPalette(palSchrift);
                ui->line_lock_v2->setText(QString::number(Byte[3].toInt(&ok, 16)));

                ui->line_lock_v3->setPalette(palSchrift);
                ui->line_lock_v3->setText(QString::number(Byte[4].toInt(&ok, 16)));

                ui->line_lock_v4->setPalette(palSchrift);
                ui->line_lock_v4->setText(QString::number(Byte[5].toInt(&ok, 16)));

                ui->line_lock_v5->setPalette(palSchrift);
                ui->line_lock_v5->setText(QString::number(Byte[6].toInt(&ok, 16)));

                ui->line_unlock_v1->setPalette(palSchrift);
                ui->line_unlock_v1->setText(QString::number(Byte[7].toInt(&ok, 16)));

                ui->line_unlock_v2->setPalette(palSchrift);
                ui->line_unlock_v2->setText(QString::number(Byte[8].toInt(&ok, 16)));

                ui->line_unlock_v3->setPalette(palSchrift);
                ui->line_unlock_v3->setText(QString::number(Byte[9].toInt(&ok, 16)));

                ui->line_unlock_v4->setPalette(palSchrift);
                ui->line_unlock_v4->setText(QString::number(Byte[10].toInt(&ok, 16)));

                ui->line_unlock_v5->setPalette(palSchrift);
                ui->line_unlock_v5->setText(QString::number(Byte[11].toInt(&ok, 16)));
            } else if (waitACTpos == getLock2Param) {
                ui->line_lock_delaytime_2->setPalette(palSchrift);
                ui->line_lock_delaytime_2->setText(
                            QString::number(Byte[1].toInt(&ok, 16)));

                ui->line_lock_vacnumber_2->setPalette(palSchrift);
                ui->line_lock_vacnumber_2->setText(
                            QString::number(Byte[12].toInt(&ok, 16)));

                ui->line_lock_v1_2->setPalette(palSchrift);
                ui->line_lock_v1_2->setText(QString::number(Byte[2].toInt(&ok, 16)));

                ui->line_lock_v2_2->setPalette(palSchrift);
                ui->line_lock_v2_2->setText(QString::number(Byte[3].toInt(&ok, 16)));

                ui->line_lock_v3_2->setPalette(palSchrift);
                ui->line_lock_v3_2->setText(QString::number(Byte[4].toInt(&ok, 16)));

                ui->line_lock_v4_2->setPalette(palSchrift);
                ui->line_lock_v4_2->setText(QString::number(Byte[5].toInt(&ok, 16)));

                ui->line_lock_v5_2->setPalette(palSchrift);
                ui->line_lock_v5_2->setText(QString::number(Byte[6].toInt(&ok, 16)));

                ui->line_unlock_v1_2->setPalette(palSchrift);
                ui->line_unlock_v1_2->setText(QString::number(Byte[7].toInt(&ok, 16)));

                ui->line_unlock_v2_2->setPalette(palSchrift);
                ui->line_unlock_v2_2->setText(QString::number(Byte[8].toInt(&ok, 16)));

                ui->line_unlock_v3_2->setPalette(palSchrift);
                ui->line_unlock_v3_2->setText(QString::number(Byte[9].toInt(&ok, 16)));

                ui->line_unlock_v4_2->setPalette(palSchrift);
                ui->line_unlock_v4_2->setText(QString::number(Byte[10].toInt(&ok, 16)));

                ui->line_unlock_v5_2->setPalette(palSchrift);
                ui->line_unlock_v5_2->setText(QString::number(Byte[11].toInt(&ok, 16)));
            }
            waitACTpos = 0;
            if (getpara)
            {
                cmdfeeder = 0;
                getpara = 0;
                f_getparam_board8(); // Board 8 Vakuumdaten lesen
            }
            else if (setpara)
            {
                cmdfeeder = 0;
                setpara = 0;
                tmpstat = 1;
                f_setparam_board8(); // Board 8 Vakuumdaten schreiben
            }
            else if (setvacdata)
            {
                cmdfeeder = 0;
                setvacdata = 0;
                tmpstat = 1;
                STORE_FILE_partVAC();
            }
            else if (setLock1data)
            {
                cmdfeeder = 0;
                setLock1data = 0;
                tmpstat = 1;
                STORE_FILE_partLOCK(1);
            }
            else if (setLock2data)
            {
                cmdfeeder = 0;
                setLock2data = 0;
                tmpstat = 1;
                STORE_FILE_partLOCK(2);
            }

            if (cleanman)
            {
                cleanman = 0;
                f_cleanGetPos();
            }
        }
    }
    else if (calsens == 1) // cal sensor lift1 Sensorkalibrierung: bei calib_ok kommt nur # zurück
    {
        serialSendFeeder("&X0,0,7,1,0,0,0,5,76,\r\n"); // GET_VALUE lift1 Sensor
        calsens = 2;
    }
    else if (calsens2 == 1) // cal sensor lift2 bei calib_ok kommt nur # zurück
    {
        serialSendFeeder("&X0,0,7,1,0,0,0,5,77,\r\n"); // GET_VALUE lift2 Sensor
        calsens2 = 2;
    }

    if (errlogwait && getpara == 0 && setpara == 0 && setvacdata == 0 && setLock1data == 0 && setLock2data == 0 && waitlog == 0) 
    {
        qDebug() << "errlogwait" << errlogwait;
        errlogwait = 0;
        r_logon = 1;
        serialSendFeeder(senddata);
    }
    else if (r_logon && tmpstat == 0 && waitlog == 0)
    {
        qDebug() << "r_logon" << r_logon;
        r_logon = 0;
        logswitch(1);
    }
}
void MainWindow::serialReceived_Api()
{
    if (apitimeout->isActive()) apitimeout->stop();
    APIcmdtimeout = 2000; // Timeout auf Standardwert zurückstellen

    while (serial_api->canReadLine())
    {
        usbAPIdata = serial_api->readLine();
    //   qDebug() <<"receive: "<< usbAPIdata;
        logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "->" << usbAPIdata.trimmed() << "\n";
        ui->plainTextEdit_API_logerr->appendPlainText(QTime::currentTime().toString("hh:mm:ss.zzz' '") + " ->" + usbAPIdata.trimmed());

        if (usbAPIdata.left(1) == "@") f_receiveAPI(usbAPIdata);
        else if (usbAPIdata.left(8) == "Fehlernr") ui->plainTextEdit_API_logerr_2->appendPlainText(usbAPIdata.trimmed());

        usbAPIdata = 0;
    }
    logout.flush();
}
void MainWindow::f_receiveAPI(QByteArray str)
{
    cmdAPI = 0;
    QString apicmd = str.left(str.indexOf("_")).trimmed();
    QString apidata = str.right(str.indexOf('\r') - str.indexOf("_") + 1).trimmed();

    // qDebug()<<"apicmd"<<apicmd<<"apidata"<<apidata<<"APIactive"<<APIactive<<"APIpassive"<<APIpassive;

    if (apireset)
    {
        serial_api->close();
        qDebug() << "Status serial_api error receive" << (serial_api->error());
        ui->b_connect_api->setText("connect");
        ui->combo_portlist_api->setStyleSheet(backLightGrey);
        ui->p_INIT_boxreset_setup->setStyleSheet(backLightGreen);
        ui->API->setDisabled(true);
        serialapi = 0;
        apireset = 0;
    }
    else if (APIactive)
    {
        APIactive = 0;
        if (apidata == "RET=0")
        {
            APIsta = 1;
            serialSendAPI("@STAT\r\n");
        }
        else
        {
            APIerr = 1;
            serialSendAPI("@GETERR\r\n");
        }
    }
    else if (APIsta)
    {
        ui->line_stat->setText(apidata);
        if (apidata == "1") // nächste STAT Abfrage nach Timerablauf
        {
            cmdSTA->start(100);
        }
        else if (apidata == "-1") // GETERR senden
        {
            APIsta = 0;
            serialSendAPI("@GETERR\r\n");
            APIerr = 1;
        }
        else if (apidata == "0")
        {
            APIsta = 0;
            f_APIid(apidata, FALSE);
        }
    }
    else if (APIerr)
    {
        APIid = cGETERR;
        f_APIid(apidata, TRUE);
        APIerr = 0;
    }
    else if (APIpassive)
    {
        APIpassive = 0;
        f_APIid(apidata, FALSE);
    }
}
void MainWindow::f_receiveSVC(QByteArray str)
{
    int tmpdata;
    int hexdata;
    int tmpjob;
    int hexjob;
    int retdata;
    int read;
    int retflag = 0; // 1= return mit RET=
    int tmpstat = 0;
    QString data;
    QString strjob;
    QByteArray map;

    data = str.mid(str.indexOf(":") + 1, str.indexOf("\r") - str.indexOf(":") - 1); // datenstring
    tmpdata = str.mid(str.indexOf(":") + 1, str.indexOf("\r") - str.indexOf(":") - 1).toInt(&ok, 10); // daten als dezimalzahl
    hexdata = str.mid(str.indexOf(":") + 1, str.indexOf("\r") - str.indexOf(":") - 1).toInt(&ok, 16); // daten als hexzahl
    retdata = str.mid(str.indexOf("=") + 1, str.indexOf("\r") - str.indexOf("=") - 1).toInt(&ok, 16); // daten als hexzahl
    tmpjob = str.mid(str.indexOf("_") + 1, str.indexOf(":") - str.indexOf("_") - 1).toInt(&ok, 10); // job als dezimalzahl
    hexjob = str.mid(str.indexOf("_") + 1, str.indexOf(":") - str.indexOf("_") - 1).toInt(&ok, 16); // job als hexzahl
    strjob = str.mid(str.indexOf("_") + 1, str.indexOf(":") - str.indexOf("_") - 1); // jobstring

    if(cmdASYSTlog) on_p_ASYST_readconfig_clicked();
    else if (cmdASYSTstat) on_p_ASYST_status_clicked();
    else if (svclog)
    {
        if (str.at(0) == '?') // servicemode log
        {
            QString count;
            QString node;
            QString cmd;
            QString fui;

            if (data.mid(1, 2) != "00") count = data.mid(1, 2); // counter
            else count = "--";
            qDebug() << "counter" << data.mid(1, 2) << count;

            if (data.mid(3, 2) != "00") node = data.mid(3, 2); // Node
            else node = "--";
            qDebug() << "Node" << data.mid(3, 2) << node;

            if (data.mid(5, 2) != "00") cmd = decodeRespHex(data.mid(5, 2)); // CMD
            else cmd = "--";
            qDebug() << "CMD" << data.mid(5, 2) << cmd;

            if (data.mid(7, 2) != "00") fui = decodeFUIhex(data.mid(7, 2)); // FUI
            else fui = "--";
            qDebug() << "FUI" << data.mid(7, 2);

            ui->plainText_log_time->appendPlainText(QTime::currentTime().toString("hh:mm:ss.zzz' '") + "\t" + count + "\t" + node + "\t" + cmd + "\t\t" + fui);
            if(buslogfile.isOpen()) buslogout << QTime::currentTime().toString("hh:mm:ss.zzz") << "," << count << "," << node << "," << cmd << "," << fui << "\n";
            else err_msgbox("Bus-LOG-File not open");
        }
    }
    if (macroaktiv_ld || macro_decenter)
    {
        ui->plainText_sendlog->appendPlainText("macro ld" + str.left(5)); // DEBUG

        if (mstep == 1 && str.left(5) == QString(rSET).left(5)) macrostep_lddispl(1); // PA Phi set
        else if (mstep == 2 && str.left(5) == QString(rSET).left(5)) macrostep_lddispl(2); // PA over LD
        else if (mstep == 3 && str.left(5) == QString(rSET).left(5)) macrostep_lddispl(3); // LD PA pos
        else if (mstep == 4 && str.left(5) == QString(rSET).left(5)) macrostep_lddispl(4); // PA LD pos
        else if (mstep == 5 && str.left(8) == QString(rSETVAC).left(8)) macrostep_lddispl(5); // LD VAC ON "$SETVAC_"
        else if (mstep == 6) macrostep_lddispl(6);
        else if (mstep == 7) macrostep_lddispl(7);
        else if (mstep == 8) macrostep_lddispl(8);
        else if (mstep == 9) macrostep_lddispl(9);
        else if (mstep == 10) macrostep_lddispl(10);
        else if (mstep == 11) macrostep_lddispl(11);
        else if (mstep == 12) macrostep_lddispl(12);
        else if (mstep == 13) macrostep_lddispl(13);
        else if (mstep == 14) macrostep_lddispl(14);
    }

    qDebug() << "r_logon" << r_logon << "cmdfeeder" << cmdfeeder << "getpara"
             << getpara << "errlogwait" << errlogwait << "getAVoper" << getAVoper
             << "waitlog" << waitlog;

    if (str.left(6) == QString(INIT_).left(6)) // INIT RESET "$INIT_"
    {
        uint unit = str.mid(6, 2).toUInt(&ok, 10);

        if (unit == 0) // RESET Loder Y
        {
            if (cleanman) f_clean_reset(2); // res LD X
            // if (cleansequenz == 2 || cleansequenz == 3) f_clean_reset(2); // res LD X
            // else if (cleansequenz == 4)
            // {
            //     err_msgbox("Loader Y axis is safe. Click ok to reset all other axes");
            //     on_p_clean_completereset_clicked();
            // }
            ui->label_res_LDY->setStyleSheet("QLabel { background-color: green }");
            ui->p_loader_initydrive->setStyleSheet(backLightGreen);
        }
        else if (unit == 1) // RESET Loder X
        {
            if (cleanman) f_clean_reset(8); // res L1 Height
            // if (cleansequenz == 2 || cleansequenz == 3) on_p_PA_abovLDhgt_clicked(); // pos PAH above LD
            // if (cleansequenz == 4)
            // {
            //     err_msgbox("Loader X axis is safe. Click ok to reset all other axes");
            //     on_p_clean_completereset_clicked();
            // }

            ui->label_res_LDX->setStyleSheet("QLabel { background-color: green }");
            ui->p_loader_initxdrive->setStyleSheet(backLightGreen);
        }
        else if (unit == 2) // RESET Lift1 Height
        {
            if (cleanman) f_clean_reset(9); // res L1 Tilt
            ui->label_res_L1H->setStyleSheet("QLabel { background-color: green }");
            ui->push_lift1_init_height->setStyleSheet(backLightGreen);
        }
        else if (unit == 3) // RESET Lift2 Height
        {
            ui->label_res_L2H->setStyleSheet("QLabel { background-color: green }");
            ui->p_lift2_init_height->setStyleSheet(backLightGreen);
        }
        else if (unit == 4) // RESET WC Height
        {
            if (cleanman) f_clean_reset(7); // res WCP
            ui->label_resWCH->setStyleSheet("QLabel { background-color: green }");
            ui->p_wc_initheight->setStyleSheet(backLightGreen);
        }
        else if (unit == 5) // RESET WC Phi
        {
            if (res2pos) wc_pos_middle();
            else
            {
                ui->label_WCP->setStyleSheet("QLabel { background-color: green }");
                ui->p_wc_initangle->setStyleSheet(backLightGreen);
            }
        }
        else if (unit == 6) // RESET PA Tilt
        {
            if (res2pos) on_p_PA_WOtilt_clicked();
            else
            {
                ui->label_resPAT->setStyleSheet("QLabel { background-color: green }");
                ui->p_INIT_PA_Tilt->setStyleSheet(backLightGreen);
            }
        }
        else if (unit == 7) // RESET PA RotPos
        {
            if (cleanman) on_p_PA_WOrotpos_clicked();
            ui->label_resPAR->setStyleSheet("QLabel { background-color: green }");
            ui->p_INIT_PA_RotPos->setStyleSheet(backLightGreen);
        }
        else if (unit == 8) // RESET PA Height
        {
            //   if(cleanman) f_clean_reset(9);          // res PA PHI
            // if (cleansequenz == 2 || cleansequenz == 3) // reset LDY
            // {
            //     f_clean_reset(1); // reset LDY
            // }
            ui->label_res_PAH->setStyleSheet("QLabel { background-color: green }");
            ui->p_INIT_PA_Height->setStyleSheet(backLightGreen);
        }
        else if (unit == 9) // RESET PA Phi
        {
            if (cleanman) f_clean_reset(4); // res PA Tilt
            ui->label_resPAP->setStyleSheet("QLabel { background-color: green }");
            ui->p_INIT_PA_Phi->setStyleSheet(backLightGreen);
            if (macro_profil) macroProfil(true);
        }
        else if (unit == 10) // RESET Lift1 Tilt
        {
            ui->label_res_L1T->setStyleSheet("QLabel { background-color: green }");
            ui->push_lift1_init_tilt->setStyleSheet(backLightGreen);
        }
        else if (unit == 11) // RESET Lift2 Tilt
        {
            ui->label_res_L2T->setStyleSheet("QLabel { background-color: green }");
            ui->p_lift2_init_tilt->setStyleSheet(backLightGreen);
        }
        else if (unit == 30) // RESET alle response
        {
            if (tmpdata == 0)
            {
                on_p_systemstate_clicked(); // Systemstatus auslesen für INITOK Status
            }
            else err_msgbox("RESET error " + data);
        }
        logout << "RESET: " << unit << '\n';
    }
    else if (str.left(5) == QString(rGET).left(5)) // Response auf $GET_
    {
        if (strjob == "err")
        {
            f_errtext(hexdata);
        }
        else
        {
            data = str.mid(str.indexOf(":") + 1,str.indexOf("\r") - str.indexOf(":") - 1);

            if (tmpjob == 22)
            {
                ui->line_SMIF_zstroke->setText(QString::number(hexdata));
            }
            else if (tmpjob == 23)
            {
                ui->comboBox_SMIF_delay->setCurrentText(QString::number(hexdata));
            }
            else if (tmpjob == 24)
            {
                ui->line_align_displ->setText(data);
            }
            else if (tmpjob == 25)
            {
                qDebug() << "data 25" << data << "stop" << data.mid(0, 2).toInt(&ok, 16)
                         << "tilt" << data.mid(4, 2).toInt(&ok, 16) << "rot"
                         << data.mid(2, 2).toInt(&ok, 16);

                ui->line_dev_tilt->setText(QString::number(data.mid(6, 4).toInt(&ok, 16)));
                ui->line_dev_rot->setText(QString::number(data.mid(2, 4).toInt(&ok, 16)));
                // if (data.mid(0, 2).toInt(&ok, 16) == 1) ui->label_dev_stop->setStyleSheet(backLightGreen);
                // else ui->label_dev_stop->setStyleSheet(backRed);
            }
            else if (tmpjob == 28)
            {
                qDebug() << "data all" << data << "data" << data.right(1);
                ui->line_smif_logistic->setText(data.right(1));
            }
            else if (tmpjob == 29)
            {
                if (getparam2) // Button GET Parameter set gedrückt
                {
                    ui->line_maxdeviation_friction_2->setText(data.right(1));
                    getparam2 = 0;
                }
                else ui->line_maxdeviation_friction->setText(data.right(1));
            }
            else if (tmpjob == 32)
            {
                qDebug() << "(hexdata & 0b00000001)" << (hexdata & 0b00000001);
                qDebug() << "(hexdata & 0b00000010)" << (hexdata & 0b00000010);
                qDebug() << "(hexdata & 0b00000100)" << (hexdata & 0b00000100);
                qDebug() << "(hexdata & 0b00010000)" << (hexdata & 0b00010000);
                qDebug() << "(hexdata & 0b00100000)" << (hexdata & 0b00100000);
                qDebug() << "(hexdata & 0b01000000)" << (hexdata & 0b01000000);

                if ((hexdata & 0b00000001) == 1) ui->checkBox_Yjoy_phi->setChecked(1);
                else if ((hexdata & 0b00000001) == 0) ui->checkBox_Yjoy_phi->setChecked(0);
                if ((hexdata & 0b00000010) == 2) ui->checkBox_Yjoy_rotation->setChecked(1);
                else if ((hexdata & 0b00000010) == 0) ui->checkBox_Yjoy_rotation->setChecked(0);
                if ((hexdata & 0b00000100) == 4) ui->checkBox_Yjoy_tilt->setChecked(1);
                else if ((hexdata & 0b00000100) == 0) ui->checkBox_Yjoy_tilt->setChecked(0);

                if ((hexdata & 0b00010000) == 16) ui->checkBox_Xjoy_phi->setChecked(1);
                else if ((hexdata & 0b00010000) == 0) ui->checkBox_Xjoy_phi->setChecked(0);
                if ((hexdata & 0b00100000) == 32) ui->checkBox_Xjoy_rotation->setChecked(1);
                else if ((hexdata & 0b00100000) == 0) ui->checkBox_Xjoy_rotation->setChecked(0);
                if ((hexdata & 0b01000000) == 64) ui->checkBox_Xjoy_tilt->setChecked(1);
                else if ((hexdata & 0b01000000) == 0) ui->checkBox_Xjoy_tilt->setChecked(0);
            }
            else if (tmpjob == 40) // vac
            {
                if (macroclean == 1)
                {
                    if ((hexdata & 0b00000001) == 1) // LD vacon
                    {
                        ui->r_clean_vac_LD->setChecked(1);
                        ui->r_clean_vac_LD->setStyleSheet(backLightGreen);
                    }
                    else if ((hexdata & 0b00000001) == 0)
                    {
                        ui->r_clean_vac_LD->setChecked(0);
                        ui->r_clean_vac_LD->setStyleSheet(backLightGrey);
                    }
                    if ((hexdata & 0b00000010) == 2) // PA vac on
                    {
                        ui->r_clean_vac_PA->setChecked(1);
                        ui->r_clean_vac_PA->setStyleSheet(backLightGreen);
                    }
                    else if ((hexdata & 0b00000010) == 0)
                    {
                        ui->r_clean_vac_PA->setChecked(0);
                        ui->r_clean_vac_PA->setStyleSheet(backLightGrey);
                    }
                    if ((hexdata & 0b00001000) == 8)
                    {
                        ui->plainText_sendlog->appendPlainText("PA erkannt");
                        ui->r_clean_vac_WC1->setChecked(1);
                        ui->r_clean_vac_WC1->setStyleSheet(backLightGreen);
                    }
                    else if ((hexdata & 0b00001000) == 0)
                    {
                        ui->plainText_sendlog->appendPlainText("PA gelöscht");
                        ui->r_clean_vac_WC1->setChecked(0);
                        ui->r_clean_vac_WC1->setStyleSheet(backLightGrey);
                    }
                    if ((hexdata & 0b00010000) == 16)
                    {
                        ui->r_clean_vac_WC2->setChecked(1);
                        ui->r_clean_vac_WC2->setStyleSheet(backLightGreen);
                    }
                    else if ((hexdata & 0b00010000) == 0)
                    {
                        ui->r_clean_vac_WC2->setChecked(0);
                        ui->r_clean_vac_WC2->setStyleSheet(backLightGrey);
                    }
                    if ((hexdata & 0b00000100) == 4)
                    {
                        ui->r_clean_vac_CH4->setChecked(1);
                        ui->r_clean_vac_CH4->setStyleSheet(backLightGreen);
                    }
                    else if ((hexdata & 0b00000100) == 0)
                    {
                        ui->r_clean_vac_CH4->setChecked(0);
                        ui->r_clean_vac_CH4->setStyleSheet(backLightGrey);
                    }
                    if (hexdata == FN_BUSY)
                    {
                        if (setSendTimer->isActive() == 0) setSendTimer->start(waitvacswoff);
                    }
                    //    f_cleanmacro_vac();
                }
                else if (hexdata & 0b00000001) // VAC LD
                {
                    ui->rad_LDvac->setChecked(1);
                    ui->check_vac_loader_2->setChecked(1);
                    ui->check_vac_loader_4->setChecked(1);
                }
                else
                {
                    ui->rad_LDvac->setChecked(0);
                    ui->check_vac_loader_2->setChecked(0);
                    ui->check_vac_loader_4->setChecked(0);
                }
                if (hexdata & 0b00000010) // VAC PA
                {
                    ui->rad_PAvac->setChecked(1);
                    ui->check_vac_aligner_2->setChecked(1);
                    ui->check_vac_aligner_4->setChecked(1);
                } else {
                    ui->rad_PAvac->setChecked(0);
                    ui->check_vac_aligner_2->setChecked(0);
                    ui->check_vac_aligner_4->setChecked(0);
                }
                if (hexdata & 0b00000100) // VAC CH4
                {
                    ui->rad_CH4vac->setChecked(1);
                    ui->check_vac_chuck4_2->setChecked(1);
                    ui->check_vac_chuck4_4->setChecked(1);
                } else {
                    ui->rad_CH4vac->setChecked(0);
                    ui->check_vac_chuck4_2->setChecked(0);
                    ui->check_vac_chuck4_4->setChecked(0);
                }
                if (hexdata & 0b00001000) // VAC WC1
                {
                    ui->rad_WC1vac->setChecked(1);
                    ui->check_vac_wcleft_2->setChecked(1);
                    ui->check_vac_wcleft_4->setChecked(1);
                } else {
                    ui->rad_WC1vac->setChecked(0);
                    ui->check_vac_wcleft_2->setChecked(0);
                    ui->check_vac_wcleft_4->setChecked(0);
                }
                if (hexdata & 0b00010000) // VAC WC2
                {
                    ui->rad_WC2vac->setChecked(1);
                    ui->check_vac_wcright_2->setChecked(1);
                    ui->check_vac_wcright_4->setChecked(1);
                } else {
                    ui->rad_WC2vac->setChecked(0);
                    ui->check_vac_wcright_2->setChecked(0);
                    ui->check_vac_wcright_4->setChecked(0);
                }
                if (hexdata & 0b00100000) // VAC MAIN
                {
                    if (macroclean) {
                        ui->frame_clean_mainvac->setStyleSheet(backLightGreen);
                        //    f_cleanmacro_vac();
                    } else {
                        ui->rad_MainVac->setChecked(1);
                        ui->label_mainvac->setStyleSheet(backLightGreen);
                        ui->label_mainvac_2->setStyleSheet(backLightGreen);
                    }
                } else {
                    if (macroclean) {
                        ui->frame_clean_mainvac->setStyleSheet(backLightGrey);
                        //    f_cleanmacro_vac();
                    } else {
                        ui->rad_MainVac->setChecked(0);
                        ui->label_mainvac->setStyleSheet(backLightGrey);
                        ui->label_mainvac_2->setStyleSheet(backLightGrey);
                    }
                }
                if (hexdata & 0b01000000) // VAC CH6
                {
                    ui->rad_CH6vac->setChecked(1);
                    ui->check_vac_chuck6_2->setChecked(1);
                    ui->check_vac_chuck6_4->setChecked(1);
                } else {
                    ui->rad_CH6vac->setChecked(0);
                    ui->check_vac_chuck6_2->setChecked(0);
                    ui->check_vac_chuck6_4->setChecked(0);
                }
                if (hexdata & 0b10000000) // VAC CH8
                {
                    ui->rad_CH8vac->setChecked(1);
                    ui->check_vac_chuck8_2->setChecked(1);
                    ui->check_vac_chuck8_4->setChecked(1);
                } else {
                    ui->rad_CH8vac->setChecked(0);
                    ui->check_vac_chuck8_2->setChecked(0);
                    ui->check_vac_chuck8_4->setChecked(0);
                }

                if (xrepeat)
                    serialSendFeeder(svcgetvac);
                // if(getAVoper == 0 && userindex == 5)
                // on_checkBox_errorlog_2_clicked(1);     // oper-mode Vac
            }
            else if (tmpjob == 41) // Materialliste
            {
                qDebug() << "hexdata 41" << hexdata;
                set_Materialliste(hexdata);
            }
            else if (tmpjob == 42) // Foundwaferliste
            {
                qDebug() << "hexdata 42" << hexdata;
                set_Foundwaferliste(hexdata);
            }
            else if (tmpjob == 43) // Resetstate liste
            {
                qDebug() << "hexdata 43" << hexdata;
                set_Resetliste(hexdata);
            }
            else if (tmpjob == 44) //
            {
            }
            else if (tmpjob == 45) set_feederliste(data); // feederliste
            else if (tmpjob == 46)
            {
            }
            else if (tmpjob == 47) // EMO
            {
                if (hexdata == 0)
                {
                    ui->line_system_EMO->setText("ON");
                    ui->line_system_EMO->setStyleSheet(backLightGreen);
                }
                else if (hexdata == 1)
                {
                    ui->line_system_EMO->setText("OFF");
                    ui->line_system_EMO->setStyleSheet(backRed);
                }
                else ui->line_system_EMO->setText(data);
            }
            else if (tmpjob == 48) // ACR
            {
                //            if(tmpdata == 0)
                //            {
                //                ui->line_system_ACR->setText("ON");
                //                ui->line_system_ACR->setStyleSheet(backLightGreen);
                //            }
                //            else if(tmpdata == 1)
                //            {
                //                ui->line_system_ACR->setText("OFF");
                //                ui->line_system_ACR->setStyleSheet(backRed);
                //            }
                //            else ui->line_system_ACR->setText(data);
            }
            else if (tmpjob == 50) // PINC
            {
                ui->label_dev_pinc->setText(binList(hexdata));
            }
            else if (tmpjob == 51) // DDRC
            {
                ui->label_dev_ddrc->setText(binList(hexdata));
            }
            else if (tmpjob == 52) // PORTC
            {
                ui->label_dev_portc->setText(binList(hexdata));
            }
            //            else if(tmpjob == 3)
            //            ui->plainTextEdit_LOG_debug->appendPlainText(usbdata.trimmed());
        }
    }
    else if (str.left(6) == QString(rRead).left(6)) // hex-ascii bytes
    {
        QString s;

        if (str.mid(6, 3) == "RET") // $READ_RET=-1
        {
            read = str.mid(10, str.indexOf("=") - str.indexOf("\r") - 1).toInt(&ok, 10);
            qDebug() << "read ret" << read;
            retflag = 1;
            qDebug() << "lastcmd" << lastcmd; // $READ_57=1\r\n
            read = lastcmd.mid(6, str.indexOf("_") - str.indexOf("=") - 1).toInt(&ok, 10);
            qDebug() << "read last" << read;
        }
        else
        {
            read = str.mid(6, str.indexOf(":") - str.indexOf("_") - 1).toInt(&ok, 10);
            qDebug() << "read" << read;
            retflag = 0;
        }
        if (read == 1) // EE-Daten Lift1
        {
            float tmpResoH = getResolution("Lift2 height motor").toFloat();
            float tmpResoT = getResolution("Lift2 tilt motor").toFloat();
            float tmpfloat = 0.000000;

            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            for (int i = 0; i < parts.count(); i++) {
                switch (i) {
                case 0:
                    if (parts[i] == "1") {
                        ui->label_Lift1Present->setStyleSheet("background-color: green");
                        ui->check_lift1_deactivate->setChecked(1);
                        //    ui->check_lift1_deactivate->setText("deactivate");
                    } else {
                        //    ui->label_Lift1Present->setStyleSheet("background-color:
                        //    Red");
                        ui->check_lift1_deactivate->setChecked(0);
                        //    ui->check_lift1_deactivate->setText("activate");
                    }
                    break;
                case 1:
                    ui->line_lift1_wafersensor_height_2->setPalette(palSchrift);
                    ui->line_lift1_wafersensor_height_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_lift1_wafersensor_height_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift1_wafersensor_height_2->setText(parts[i]);
                    break;
                case 2: // Unload operator height
                    ui->line_lift1_unload_height_2->setPalette(palSchrift);
                    ui->line_lift1_unload_height_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_lift1_unload_height_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift1_unload_height_2->setText(parts[i]);
                    break;
                case 3: // XY-Loader height
                    ui->line_lift1_xyloader_height_2->setPalette(palSchrift);
                    ui->line_lift1_xyloader_height_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_lift1_xyloader_height_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift1_xyloader_height_2->setText(parts[i]);
                    break;
                case 4: // Measuring Unit Height
                    ui->line_lift1_measuring_height_2->setPalette(palSchrift);
                    ui->line_lift1_measuring_height_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_lift1_measuring_height_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift1_measuring_height_2->setText(parts[i]);
                    break;
                case 5: // Tilt present
                    if (parts[i] == "1") {
                        ui->label_Tilt1Present->setStyleSheet("background-color: green");
                        ui->check_tilt1_deactivate->setText("deactivate");
                        ui->check_tilt1_deactivate->setChecked(1);
                    } else {
                        ui->label_Tilt1Present->setStyleSheet("background-color: Red");
                        ui->check_tilt1_deactivate->setText("activate");
                        ui->check_tilt1_deactivate->setChecked(0);
                    }
                    break;
                case 6: // Tilt on position
                    ui->line_lift1_tiltactpos_2->setPalette(palSchrift);
                    ui->line_lift1_tiltactpos_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoT;
                    ui->line_lift1_tiltactpos_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift1_tiltactpos_2->setText(parts[i]);
                    break;
                case 7: // Tilt off position
                    ui->line_lift1_tiltinactpos_2->setPalette(palSchrift);
                    ui->line_lift1_tiltinactpos_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoT;
                    ui->line_lift1_tiltinactpos_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift1_tiltinactpos_2->setText(parts[i]);
                    break;
                case 8: // Wafertype thin
                    // if (parts[i] == "1")
                    //     ui->radio_lift1_thinwafer->setChecked(1);
                    // else
                    //     ui->radio_lift1_thinwafer->setChecked(0);
                    break;
                    //                   case 9:         // Smif=none
                    //                       if(line.mid(line.indexOf("=")+1,4)=="none")
                    //                       ui->p_lift1_SMIF->setEnabled(0);
                    //                       ui->combo_lift1_SMIF_select->setCurrentText(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    //                   break;
                    //                   case 10:         // Smif Port=COM9
                    //                       ui->combo_lift1_SMIF_com->setCurrentText(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    //                   break;
                case 9: // 4" Cassette Nr
                    ui->combo_4inchsel->setCurrentText(parts[i]);
                    break;
                case 10: // 5" Cassette Nr
                    ui->combo_5inchsel->setCurrentText(parts[i]);
                    break;
                case 11: // 6" Cassette Nr
                    ui->combo_6inchsel->setCurrentText(parts[i]);
                    break;
                case 12: // 8" Cassette Nr
                    ui->combo_8inchsel->setCurrentText(parts[i].trimmed());
                    break;
                }
            }
        }
        if (read == 2) // EE-Daten Lift2
        {
            float tmpResoH = getResolution("Lift2 height motor").toFloat();
            float tmpResoT = getResolution("Lift2 tilt motor").toFloat();
            float tmpfloat = 0.000000;

            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            for (int i = 0; i < parts.count(); i++) {
                switch (i) {
                case 0:
                    if (parts[i] == "1") {
                        ui->label_Lift2Present->setStyleSheet("background-color: green");
                        ui->check_lift2_deactivate->setText("set deactive");
                        ui->check_lift2_deactivate->setChecked(1);
                    } else {
                        ui->label_Lift2Present->setStyleSheet("background-color: Red");
                        ui->check_lift2_deactivate->setText("activate");
                        ui->check_lift2_deactivate->setChecked(0);
                    }
                    break;
                case 1:
                    ui->line_lift2_wafersensor_height_2->setPalette(palSchrift);
                    ui->line_lift2_wafersensor_height_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_lift2_wafersensor_height_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift2_wafersensor_height_2->setText(parts[i]);
                    break;
                case 2: // Unload operator height
                    ui->line_lift2_unload_height_2->setPalette(palSchrift);
                    ui->line_lift2_unload_height_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_lift2_unload_height_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift2_unload_height_2->setText(parts[i]);
                    break;
                case 3: // XY-Loader height
                    ui->line_lift2_xyloader_height_2->setPalette(palSchrift);
                    ui->line_lift2_xyloader_height_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_lift2_xyloader_height_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift2_xyloader_height_2->setText(parts[i]);
                    break;
                case 4: // Measuring Unit Height
                    ui->line_lift2_measuring_height_2->setPalette(palSchrift);
                    ui->line_lift2_measuring_height_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_lift2_measuring_height_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift2_measuring_height_2->setText(parts[i]);
                    break;
                case 5: // Tilt present
                    if (parts[i] == "1") {
                        ui->label_Tilt2Present->setStyleSheet("background-color: green");
                        ui->check_tilt2_deactivate->setText("deactivate");
                        ui->check_tilt2_deactivate->setChecked(1);
                    } else {
                        ui->label_Tilt2Present->setStyleSheet("background-color: Red");
                        ui->check_tilt2_deactivate->setText("activate");
                        ui->check_tilt2_deactivate->setChecked(0);
                    }
                    break;
                case 6: // Tilt on position
                    ui->line_lift2_tiltactpos_2->setPalette(palSchrift);
                    ui->line_lift2_tiltactpos_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoT;
                    ui->line_lift2_tiltactpos_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift2_tiltactpos_2->setText(parts[i]);
                    break;
                case 7: // Tilt off position
                    ui->line_lift2_tiltinactpos_2->setPalette(palSchrift);
                    ui->line_lift2_tiltinactpos_mm_2->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoT;
                    ui->line_lift2_tiltinactpos_mm_2->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_lift2_tiltinactpos_2->setText(parts[i]);
                    break;
                case 8: // Wafertype thin
                    // if (parts[i] == "1")
                    //     ui->radio_lift1_thinwafer->setChecked(1);
                    // else
                    //     ui->radio_lift2_thinwafer->setChecked(0);
                    break;
                    //                   case 9:         // Smif=none
                    //                       if(line.mid(line.indexOf("=")+1,4)=="none")
                    //                       ui->p_lift2_SMIF->setEnabled(0);
                    //                       ui->combo_lift2_SMIF_select->setCurrentText(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    //                   break;
                    //                   case 10:         // Smif Port=COM9
                    //                       ui->combo_lift2_SMIF_com->setCurrentText(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    //                   break;
                case 9: // 4" Cassette Nr
                    ui->combo_lift2_4inchsel->setPalette(palSchrift);
                    ui->combo_lift2_4inchsel->setCurrentText(parts[i]);
                    break;
                case 10: // 5" Cassette Nr
                    ui->combo_lift2_5inchsel->setPalette(palSchrift);
                    ui->combo_lift2_5inchsel->setCurrentText(parts[i]);
                    break;
                case 11: // 6" Cassette Nr
                    ui->combo_lift2_6inchsel->setPalette(palSchrift);
                    ui->combo_lift2_6inchsel->setCurrentText(parts[i]);
                    break;
                case 12: // 8" Cassette Nr
                    ui->combo_lift2_8inchsel->setPalette(palSchrift);
                    ui->combo_lift2_8inchsel->setCurrentText(parts[i].trimmed());
                    break;
                }
            }
        }
        if (read == 3) // EE-Daten Loader
        {
            float tmpResoX = getResolution("Loader x - motor").toFloat();
            float tmpResoY = getResolution("Loader y - motor").toFloat();
            float tmpfloat = 0.000000;

            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            for (int i = 0; i < parts.count(); i++) {
                switch (i) {
                case 0: // x-L1 position
                    ui->line_loader_xlift1pos_2->setPalette(palSchrift);
                    ui->line_loader_xlift1pos_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoX;
                    ui->line_loader_xlift1pos_4->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_loader_xlift1pos_2->setText(parts[i]);
                    break;
                case 1: // x-L2 position
                    ui->line_loader_xlift2pos_2->setPalette(palSchrift);
                    ui->line_loader_xlift2pos_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoX;
                    ui->line_loader_xlift2pos_4->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_loader_xlift2pos_2->setText(parts[i]);
                    break;
                case 2: // x-PA free position
                    ui->line_loader_xpreafreepos_2->setPalette(palSchrift);
                    ui->line_loader_xpreafreepos_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoX;
                    ui->line_loader_xpreafreepos_4->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_loader_xpreafreepos_2->setText(parts[i]);
                    break;
                case 3: // x-PA position
                    ui->line_loader_xpreapos_2->setPalette(palSchrift);
                    ui->line_loader_xpreapos_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoX;
                    ui->line_loader_xpreapos_4->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_loader_xpreapos_2->setText(parts[i]);
                    break;
                case 4: // y-L1 position
                    ui->line_loader_ylift1inpos_2->setPalette(palSchrift);
                    ui->line_loader_ylift1inpos_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoY;
                    ui->line_loader_ylift1inpos_4->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_loader_ylift1inpos_2->setText(parts[i]);
                    break;
                case 5: // y-L2 position
                    ui->line_loader_ylift2inpos_2->setPalette(palSchrift);
                    ui->line_loader_ylift2inpos_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoY;
                    ui->line_loader_ylift2inpos_4->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_loader_ylift2inpos_2->setText(parts[i]);
                    break;
                case 6: // y-PA position
                    ui->line_loader_ypreapos_2->setPalette(palSchrift);
                    ui->line_loader_ypreapos_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoY;
                    ui->line_loader_ypreapos_4->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_loader_ypreapos_2->setText(parts[i]);
                    break;
                case 7: // y-Out lift position
                    ui->line_loader_youtlift_2->setPalette(palSchrift);
                    ui->line_loader_youtlift_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoY;
                    ui->line_loader_youtlift_4->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_loader_youtlift_2->setText(parts[i]);
                    break;
                case 8: // y-In lift displacement
                    ui->line_loader_yliftdispl_3->setPalette(palSchrift);
                    ui->line_loader_yliftdispl_3->setText(parts[i]);
                    break;
                case 9: // 6" Cassette displacement
                    //  ui->line_loader_->setCurrentText(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    break;
                }
            }
        }
        if (read == 4) // EE-Daten Prealigner
        {

            float tmpResoH = getResolution("Prealigner height motor").toFloat();
            float tmpResoP = getResolution("Prealigner phi motor").toFloat();
            float tmpResoWOP = getResolution("Wobbler phi motor").toFloat();
            float tmpResoWOR = getResolution("Wobbler rotation motor").toFloat();
            float tmpfloat = 0.000000;

            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            for (int i = 0; i < parts.count(); i++) {
                switch (i) {
                case 0: // Wobbler present
                    if (parts[i] == "1") {
                        ui->label_preawobbpresent->setStyleSheet("background-color: green");
                        ui->p_RES_PREA_TILT_2->setDisabled(0);
                        ui->p_RES_PREA_ROTPOS_2->setDisabled(0);
                    } else {
                        ui->label_preawobbpresent->setStyleSheet("background-color: Red");
                        ui->p_RES_PREA_ROTPOS_2->setDisabled(0);
                        ui->p_RES_PREA_TILT_2->setDisabled(1);
                        ui->p_RES_PREA_ROTPOS_2->setDisabled(1);
                        ui->label_resPAR->setStyleSheet(
                                    "QLabel { background-color: grey }");
                        ui->label_resPAT->setStyleSheet(
                                    "QLabel { background-color: grey }");
                    }
                    break;
                case 1: // Below LO height
                    ui->line_belowloader_2->setPalette(palSchrift);
                    ui->line_belowloader_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_belowloader_4->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_belowloader_2->setText(parts[i]);
                    break;
                case 2: // Below LO height thin
                    // ui->line_belowloaderthin_2->setPalette(palSchrift);
                    // ui->line_belowloaderthin_2->setText(parts[i]);
                    break;
                case 3: // LO height
                    ui->line_loaderheight_2->setPalette(palSchrift);
                    ui->line_loaderheight_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_loaderheight_4->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_loaderheight_2->setText(parts[i]);
                    break;
                case 4: // Above LO height thin
                    // ui->line_aboveloaderthin_2->setPalette(palSchrift);
                    // ui->line_aboveloaderthin_2->setText(parts[i]);
                    break;
                case 5: // Above LO height
                    ui->line_aboveloader_2->setPalette(palSchrift);
                    ui->line_aboveloader_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_aboveloader_4->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_aboveloader_2->setText(parts[i]);
                    break;
                case 6: // PA height
                    ui->line_preaheight_2->setPalette(palSchrift);
                    ui->line_preaheight_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_preaheight_4->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_preaheight_2->setText(parts[i]);
                    break;
                case 7: // CH height
                    ui->line_chuckheight_2->setPalette(palSchrift);
                    ui->line_chuckheight_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_chuckheight_4->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_chuckheight_2->setText(parts[i]);
                    break;
                case 8: // WO angle
                    ui->line_wobbtiltangle_2->setPalette(palSchrift);
                    ui->line_wobbtiltangle_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoWOP;
                    ui->line_wobbtiltangle_4->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_wobbtiltangle_2->setText(parts[i]);
                    break;
                case 9: // WO rotational position
                    ui->line_wobrotpos_2->setPalette(palSchrift);
                    ui->line_wobrotpos_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoWOR;
                    ui->line_wobrotpos_4->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_wobrotpos_2->setText(parts[i]);
                    break;
                case 10: // Measurement present
                    if (parts[i] == "1")
                        ui->check_measureused->setChecked(1);
                    else
                        ui->check_measureused->setChecked(0);
                    break;
                case 11: // PA angle
                    ui->line_preasensangle_2->setPalette(palSchrift);
                    ui->line_preasensangle_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoP;
                    ui->line_preasensangle_4->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_preasensangle_2->setText(parts[i]);
                    break;
                case 12: // PA precount
                    ui->line_preaprecount_2->setPalette(palSchrift);
                    ui->line_preaprecount_2->setText(parts[i]);
                    break;
                case 13: // PA count
                    ui->line_preacount_2->setPalette(palSchrift);
                    ui->line_preacount_2->setText(parts[i]);
                    break;
                case 14: // PA postcount
                    ui->line_preapostcount_2->setPalette(palSchrift);
                    ui->line_preapostcount_2->setText(parts[i]);
                    break;
                case 15: // WOB phispeed
                    ui->line_wobphispeed_2->setPalette(palSchrift);
                    ui->line_wobphispeed_2->setText(parts[i]);
                    break;
                case 16: // Reader displacement
                    ui->line_readdispl->setPalette(palSchrift);
                    ui->line_readdispl->setText(parts[i]);
                    break;
                case 17: // Wobbler displacement
                    ui->line_wobbdispl->setPalette(palSchrift);
                    ui->line_wobbdispl->setText(parts[i]);
                    break;
                case 18: // Normal displacement
                    ui->line_normaldispl->setPalette(palSchrift);
                    ui->line_normaldispl->setText(parts[i]);
                    break;
                case 19: // Profilecalibration
                    ui->line_preaheight_2->setPalette(palSchrift);
                    if (parts[i] == "Y")
                        ui->check_profilecalib->setChecked(1);
                    else
                        ui->check_profilecalib->setChecked(0);
                    break;
                case 20: // Slitlength
                    ui->line_slitlenght->setPalette(palSchrift);
                    ui->line_slitlenght->setText(parts[i]);
                    break;
                }
            }
        }
        if (read == 5) // EE-Daten Waferchanger
        {
            float tmpResoH = getResolution("Waferchanger height motor").toFloat();
            float tmpResoP = getResolution("Waferchanger phi motor").toFloat();
            float tmpfloat = 0.000000;

            auto parts = str.mid(str.indexOf(":") + 1, str.indexOf("\r") - str.indexOf(":") - 1).split(',');

            for (int i = 0; i < parts.count(); i++)
            {
                switch (i) {
                case 0:
                    if (parts[i] == "1")
                    {
                        ui->label_wcpresent->setStyleSheet("background-color: green");
                    }
                    else
                    {
                        ui->label_wcpresent->setStyleSheet("background-color: Red");
                    }
                    break;
                case 1: // WC_aboveCH_height_thin
                    // ui->line_wc_thin_2->setPalette(palSchrift);
                    // ui->line_wc_thin_4->setPalette(palSchrift);
                    // tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    // ui->line_wc_thin_4->setText(QString::number(tmpfloat, 'f', 3));
                    // ui->line_wc_thin_2->setText(parts[i]);
                    break;
                case 2: // WC_aboveCH_height
                    ui->line_wc_abovechuckheight_2->setPalette(palSchrift);
                    ui->line_wc_abovechuckheight_5->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_wc_abovechuckheight_5->setText(
                                QString::number(tmpfloat, 'f', 3));
                    ui->line_wc_abovechuckheight_2->setText(parts[i]);
                    break;
                case 3: // WC_Ch_height
                    ui->line_wc_chuckheight_2->setPalette(palSchrift);
                    ui->line_wc_chuckheight_5->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_wc_chuckheight_5->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_wc_chuckheight_2->setText(parts[i]);
                    break;
                case 4: // WC_belowCH_height
                    ui->line_wc_belowchuckheight_2->setPalette(palSchrift);
                    ui->line_wc_belowchuckheight_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoH;
                    ui->line_wc_belowchuckheight_4->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_wc_belowchuckheight_2->setText(parts[i]);
                    break;
                case 5: // WC_CH_free_height
                    // ui->line_wc_chuckfreeheight_2->setPalette(palSchrift);
                    // if(ui->radio_wc_stepsmm->isChecked())
                    // {
                    //     tmpfloat = parts[i].toFloat(&ok)/tmpResoH;
                    //     ui->line_wc_chuckfreeheight_2->setText(QString::number(tmpfloat));
                    // }
                    // else
                    // {
                    //     ui->line_wc_chuckfreeheight_2->setText(parts[i]);
                    // }
                    break;
                case 6: // WC_Left_pos
                    ui->line_wc_leftpos_2->setPalette(palSchrift);
                    ui->line_wc_leftpos_5->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoP;
                    ui->line_wc_leftpos_5->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_wc_leftpos_2->setText(parts[i]);
                    break;
                case 7: // WC_mid_pos
                    ui->line_wc_middlepos_2->setPalette(palSchrift);
                    ui->line_wc_middlepos_5->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoP;
                    ui->line_wc_middlepos_5->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_wc_middlepos_2->setText(parts[i]);
                    break;
                case 8: // WC_right_pos
                    ui->line_wc_rightpos_2->setPalette(palSchrift);
                    ui->line_wc_rightpos_4->setPalette(palSchrift);
                    tmpfloat = parts[i].toFloat(&ok) / tmpResoP;
                    ui->line_wc_rightpos_4->setText(QString::number(tmpfloat, 'f', 3));
                    ui->line_wc_rightpos_2->setText(parts[i]);
                    break;
                case 9: // WC_LO_height
                    // ui->line_wc_loheight_2->setPalette(palSchrift);
                    // if(ui->radio_wc_stepsmm->isChecked())
                    // {
                    //     tmpfloat = parts[i].toFloat(&ok)/tmpResoH;
                    //     ui->line_wc_loheight_2->setText(QString::number(tmpfloat));
                    // }
                    // else
                    // {
                    //     ui->line_wc_loheight_2->setText(parts[i]);
                    // }
                    break;
                }
            }
        }
        if (read == 6) // EE-Daten Vac
        {
            auto parts = str.mid(str.indexOf(":") + 1, str.indexOf("\r") - str.indexOf(":") - 1).split(',');

            qDebug() << "count" << parts.count() << "part0" << parts[0] << "part1"<< parts[1];

            for (int i = 0; i < parts.count(); i++)
            {
                switch (i) {
                case 0: // CheckVac
                    if (parts[i] == "1") ui->check_vac_checkvac->setChecked(1);
                    else ui->check_vac_checkvac->setChecked(0);
                    break;
                case 1: // CheckMainVac
                    if (parts[i] == "1") ui->check_vac_checkmainvac->setChecked(1);
                    else ui->check_vac_checkmainvac->setChecked(0);
                    break;
                case 2: // check_vac_sequence
                    if (parts[i] == "1") ui->check_vac_sequence->setChecked(1);
                    else ui->check_vac_sequence->setChecked(0);
                    break;
                case 3: // V_use_chuck_6_vac
                    if (parts[i] == "1") ui->check_vac_use6inch->setChecked(1);
                    else ui->check_vac_use6inch->setChecked(0);
                    break;
                case 4: // V_use_chuck_8_vac
                    if (parts[i] == "1") ui->check_vac_use8inch->setChecked(1);
                    else ui->check_vac_use8inch->setChecked(0);
                    break;
                case 5: // V_lowLD
                    ui->line_vac_LD_ThrsON_2->setText(parts[i]);
                    break;
                case 6: // V_lowPA
                    ui->line_vac_PA_ThrsON_2->setText(parts[i]);
                    break;
                case 7: // V_lowCH
                    ui->line_vac_CH4_ThrsON_2->setText(parts[i]);
                    break;
                case 8: // V_lowWC1
                    ui->line_vac_WC1_ThrsON_2->setText(parts[i]);
                    break;
                case 9: // V_lowWC2
                    ui->line_vac_WC2_ThrsON_2->setText(parts[i]);
                    break;
                case 10: // check low active
                    if (parts[i] == "1") ui->check_vac_lowactive->setChecked(1);
                    else ui->check_vac_lowactive->setChecked(0);
                    break;
                case 11: // Retry
                    if (parts[i] == "1") ui->check_vac_rety->setChecked(1);
                    else ui->check_vac_rety->setChecked(0);
                    break;
                }
            }
            if (getpara) {
                waitACTpos = getVacParamLD; // Responsedaten neu einlesen
                waitlog = 1;
                serialSendFeeder("$X_2,0,0,7,1,0,0,0,7,88,\r\n"); // GET_Param VACUUMGROUP Board 7
            }
        }
        if (read == 7) // EE-Daten CASS 1
        {
            auto parts = str.mid(str.indexOf(":") + 1, str.indexOf("\r") - str.indexOf(":") - 1).split(','); // Carrierlist commaseparated

            setCassData(parts);
        }
        if (read == 8) // EE-Daten CASS 2
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //            SETUP_FILE_partCASS(2);
            //  on_p_setboardParam_clicked();
        }
        if (read == 9) // EE-Daten CASS 3
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts); // Daten in EE-Datenfelder einordnen
            //            SETUP_FILE_partCASS(3);
            //  on_p_setboardParam_clicked();
        }
        if (read == 10) // EE-Daten CASS 4
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //            SETUP_FILE_partCASS(4);
            //  on_p_setboardParam_clicked();
        }
        if (read == 11) // EE-Daten CASS 5
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //            SETUP_FILE_partCASS(5);
            //  on_p_setboardParam_clicked();
        }
        if (read == 12) // EE-Daten CASS 6
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //            SETUP_FILE_partCASS(6);
            //  on_p_setboardParam_clicked();
        }
        if (read == 13) // EE-Daten CASS 7
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //            SETUP_FILE_partCASS(7);
            //  on_p_setboardParam_clicked();
        }
        if (read == 14) // EE-Daten CASS 8
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //  SETUP_FILE_partCASS(8);
            //  on_p_setboardParam_clicked();
        }
        if (read == 15) // EE-Daten CASS 9
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //  SETUP_FILE_partCASS(9);
            //  on_p_setboardParam_clicked();
        }
        if (read == 16) // EE-Daten CASS 10
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //  SETUP_FILE_partCASS(10);
            //  on_p_setboardParam_clicked();
        }
        if (read == 17) // EE-Daten CASS 11
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //  SETUP_FILE_partCASS(11);
            //  on_p_setboardParam_clicked();
        }
        if (read == 18) // EE-Daten CASS 12
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            //            ui->label_cassnr->setText("12");
            setCassData(parts);
            //  SETUP_FILE_partCASS(12);
            //  on_p_setboardParam_clicked();
        }
        if (read == 19) // EE-Daten CASS 13
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //  SETUP_FILE_partCASS(13);
            //  on_p_setboardParam_clicked();
        }
        if (read == 20) // EE-Daten CASS 14
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //  SETUP_FILE_partCASS(14);
            //  on_p_setboardParam_clicked();
        }
        if (read == 21) // EE-Daten CASS 15
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //  SETUP_FILE_partCASS(15);
            //  on_p_setboardParam_clicked();
        }
        if (read == 22) // EE-Daten CASS 16
        {
            auto parts = str.mid(str.indexOf(":") + 1,
                                 str.indexOf("\r") - str.indexOf(":") - 1)
                    .split(',');
            setCassData(parts);
            //  SETUP_FILE_partCASS(16);
            //  on_p_setboardParam_clicked();
        }
        if (read == 23) // nn
        {
        }
        if (read == 24) // nn
        {
        }
        if (read == 25) // EE-Daten Tower
        {
        }
        if (read == 26) // EE-Daten Macro Joystick
        {
            auto parts = str.mid(str.indexOf(":") + 1, str.indexOf("\r") - str.indexOf(":") - 1).split(',');
            for (int i = 0; i < parts.count(); i++)
            {
                switch (i)
                {
                case 0:
                    ui->line_joy_tiltmin->setText(parts[i]);
                    break;
                case 1:
                    ui->line_joy_tiltmax->setText(parts[i]);
                    break;
                case 2:
                    ui->line_joy_rotmin->setText(parts[i]);
                    break;
                case 3:
                    ui->line_joy_rotmax->setText(parts[i]);
                    break;
                case 4:
                    ui->line_joy_threshold->setText(parts[i]);
                    break;
                case 5:
                    ui->line_joy_tiltspeedup->setText(parts[i]);
                    break;
                case 6:
                    ui->line_joy_tiltspeeddown->setText(parts[i]);
                    break;
                case 7:
                    ui->line_joy_rotCW->setText(parts[i]);
                    break;
                case 8:
                    ui->line_joy_rotCCW->setText(parts[i]);
                    break;
                case 9:
                    if (parts[i].toInt(&ok,10) & 0b00010000) ui->checkBox_Xjoy_phi->setChecked(1);
                    else ui->checkBox_Xjoy_phi->setChecked(0);
                    if (parts[i].toInt(&ok,10) & 0b00100000) ui->checkBox_Xjoy_rotation->setChecked(1);
                    else ui->checkBox_Xjoy_rotation->setChecked(0);
                    if (parts[i].toInt(&ok,10) & 0b01000000) ui->checkBox_Xjoy_tilt->setChecked(1);
                    else ui->checkBox_Xjoy_tilt->setChecked(0);
                    if (parts[i].toInt(&ok,10) & 0b00000001) ui->checkBox_Yjoy_phi->setChecked(1);
                    else ui->checkBox_Yjoy_phi->setChecked(0);
                    if (parts[i].toInt(&ok,10) & 0b00000010) ui->checkBox_Yjoy_rotation->setChecked(1);
                    else ui->checkBox_Yjoy_rotation->setChecked(0);
                    if (parts[i].toInt(&ok,10) & 0b00000100) ui->checkBox_Yjoy_tilt->setChecked(1);
                    else ui->checkBox_Yjoy_tilt->setChecked(0);
                    break;
                }
            }
        }
        if (read == 30) // Firmware RAC auslesen
        {
            QString FW = QString::fromLocal8Bit(QByteArray::fromHex(data.toLatin1()));
            qDebug() << "FW" << FW;
            ui->line_masterbox_RAC->setText(FW.mid(FW.indexOf("=") + 1, 8)); // RAC FW
            QString FWPC = "API.";
            FWPC.append(FW.mid(FW.indexOf("=") + 9, 4));
            //  FWPC.append(".");
            //  FWPC.append(FW.mid(FW.indexOf("=")+12,4));
            ui->line_masterbox->setText(FWPC); // API FW
        }
        if (read == 31) // getparam Loader Y
        {
        }
        if (read == 32) // getparam Loader X
        {
        }
        if (read == 33) // getpos Lift 1
        {
        }
        if (read == 34) // getpos Lift 2
        {
        }
        if (read == 50) // DC8
        {
            uint volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            float f = volt;
            qDebug() << "volt" << volt;
            QString s = QString::number(f * 0.0392, 10, 2);
            ui->lineEdit_Volt_8DC->setText(s);
        }
        if (read == 51) // DC12
        {
            uint volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            qDebug() << "volt" << volt;
            float f = volt;
            s = QString::number(f * 0.0784, 10, 2);
            ui->lineEdit_Volt_12DC->setText(s);
        }
        if (read == 52) // DCM12
        {
            uint volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            qDebug() << "volt" << volt;
            float f = volt;
            s = QString::number(f * -0.0784, 10, 2);
            ui->lineEdit_Volt_M12DC->setText(s);
        }
        if (read == 53) // DC24
        {
            uint volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            qDebug() << "volt" << volt;
            float f = volt;
            s = QString::number(f * 0.196, 10, 2);
            ui->lineEdit_Volt_24DC->setText(s);
        }
        if (read == 54) // Sensor Lift1
        {
            int sensor = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            QString s;

            if (sensor == 8)
                s = "8";
            else if (sensor == 4)
                s = "6";
            else if (sensor == 2)
                s = "5";
            else if (sensor == 1)
                s = "4";
            else if (sensor == 0)
                s = "--";
            ui->lineEdit_sens_L1sens->setText(s);
            ui->line_lift1_cassswitch->setText(s);

            setRadioCass(sensor); // setzen Radio in Widget CASS
        }
        if (read == 55) // Sensor Lift2
        {
            int sensor = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            QString s;
            qDebug() << sensor;
            if (sensor == 8)
                s = "8";
            else if (sensor == 4)
                s = "6";
            else if (sensor == 2)
                s = "5";
            else if (sensor == 1)
                s = "4";
            else if (sensor == 0)
                s = "--";
            ui->lineEdit_sens_L2sens->setText(s);
            ui->line_lift2_cassswitch->setText(s);

            setRadioCass(sensor); // setzen Radio in Widget CASS
        }
        if (read == 56) // Sensor Wafer
        {
            int sensor = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            QString s;

            if (sensor == 8)
                s = "8";
            else if (sensor == 4)
                s = "6";
            else if (sensor == 2)
                s = "5";
            else if (sensor == 1)
                s = "4";
            else if (sensor == 0)
                s = "--";
            ui->lineEdit_Sens_Wafersensor->setText(s);
            ui->line_align_ws->setText(s);
        }
        if (read == 57) // TP2
        {
            if (retflag) {
                ui->lineEdit_Temp_Board2->setText("n.c.");
            } else {
                float temper = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
                s = QString::number(temper * 0.392, 10, 2);
                ui->lineEdit_Temp_Board2->setText(s);
            }
        }
        if (read == 58) // TP3
        {
            float temper = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(temper * 0.392, 10, 2);
            ui->lineEdit_Temp_Board3->setText(s);
        }
        if (read == 59) // TP4
        {
            float temper = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(temper * 0.392, 10, 2);
            ui->lineEdit_Temp_Board4->setText(s);
        }
        if (read == 60) // TP5
        {
            float temper = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(temper * 0.392, 10, 2);
            ui->lineEdit_Temp_Board5->setText(s);
        }
        if (read == 61) // TP6
        {
            float temper = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(temper * 0.392, 10, 2);
            ui->lineEdit_Temp_Board6->setText(s);
        }
        if (read == 62) // VacMain
        {
            if (ui->checkBox_vac_mbar->isChecked()) {
                float vac = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
                s = QString::number(-vac / 255.00, 10, 3); // 3 Nachkommastellen;
            } else
                s = QString::number(str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16));
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '")
                   << "-> Vac Main=" << s << "\n";
            ui->lineEdit_mainvac->setText(s);          // register sys
            ui->line_vac_MainVac_actVal->setText(s);   // register vac
            ui->line_vac_MainVac_actVal_2->setText(s); // register oper
            if (ui->line_vac_MainVac_ThrsON->text().toInt(&ok, 10) < hexdata)
                ui->label_mainvac_2->setStyleSheet(backLightGreen);
            else
                ui->label_mainvac_2->setStyleSheet(backLightGrey);
        }
        if (read == 63) // Vac LD
        {
            if (ui->checkBox_vac_mbar->isChecked()) {
                float vac = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
                s = QString::number(-vac / 255.00, 10, 3); // 3 Nachkommastellen;
            } else
                s = QString::number(str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16));
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '")
                   << "-> Vac LD=" << s << "\n";
            ui->lineEdit_loadervac->setText(s);   // register sys
            ui->line_vac_LD_actVal->setText(s);   // register vac
            ui->line_vac_LD_actVal_2->setText(s); // register oper
            if (ui->check_vac_lowactive->isChecked()) {
                if (ui->line_vac_LD_ThrsON_2->text().toInt(&ok, 10) < hexdata)
                    ui->check_vac_loader_4->setStyleSheet(backLightGreen);
                else
                    ui->check_vac_loader_4->setStyleSheet(backLightGrey);
            } else {
                if (ui->line_vac_LD_ThrsON->text().toInt(&ok, 10) < hexdata)
                    ui->check_vac_loader_4->setStyleSheet(backLightGreen);
                else
                    ui->check_vac_loader_4->setStyleSheet(backLightGrey);
            }
        }
        if (read == 64) // Vac PA
        {
            if (ui->checkBox_vac_mbar->isChecked()) {
                float vac = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
                s = QString::number(-vac / 255.00, 10, 3); // 3 Nachkommastellen;
            } else
                s = QString::number(str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16));
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '")
                   << "-> Vac PA=" << s << "\n";
            ui->lineEdit_alignervac->setText(s);
            ui->line_vac_PA_actVal->setText(s);
            ui->line_vac_PA_actVal_2->setText(s);
            if (ui->line_vac_PA_ThrsON->text().toInt(&ok, 10) < hexdata)
                ui->check_vac_aligner_4->setStyleSheet(backLightGreen);
            else
                ui->check_vac_aligner_4->setStyleSheet(backLightGrey);
        }
        if (read == 65) // Vac WC1
        {
            if (ui->checkBox_vac_mbar->isChecked())
            {
                float vac = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
                s = QString::number(-vac / 255.00, 10, 3); // 3 Nachkommastellen;
            }
            else s = QString::number(str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16));
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "-> Vac WC1=" << s << "\n";
            ui->lineEdit_wcleftvac->setText(s);
            ui->line_vac_WC1_actVal->setText(s);
            ui->line_vac_WC1_actVal_2->setText(s);
            if (ui->line_vac_WC1_ThrsON->text().toInt(&ok, 10) < hexdata) ui->check_vac_wcleft_4->setStyleSheet(backLightGreen);
            else ui->check_vac_wcleft_4->setStyleSheet(backLightGrey);
        }
        if (read == 66) // Vac WC2
        {
            if (ui->checkBox_vac_mbar->isChecked()) {
                float vac = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
                s = QString::number(-vac / 255.00, 10, 3); // 3 Nachkommastellen;
            } else
                s = QString::number(str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16));
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '")
                   << "-> Vac WC2=" << s << "\n";
            ui->lineEdit_wcrightvac->setText(s);
            ui->line_vac_WC2_actVal->setText(s);
            ui->line_vac_WC2_actVal_2->setText(s);
            if (ui->line_vac_WC2_ThrsON->text().toInt(&ok, 10) < hexdata)
                ui->check_vac_wcright_4->setStyleSheet(backLightGreen);
            else
                ui->check_vac_wcright_4->setStyleSheet(backLightGrey);
        }
        if (read == 67) // Vac CH4
        {
            if (ui->checkBox_vac_mbar->isChecked()) {
                float vac = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
                s = QString::number(-vac / 255.00, 10, 3); // 3 Nachkommastellen;
            } else
                s = QString::number(str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16));
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '")
                   << "-> Vac CH4=" << s << "\n";
            ui->lineEdit_chuck4vac->setText(s);
            ui->line_vac_CH4_actVal->setText(s);
            ui->line_vac_CH4_actVal_2->setText(s);
            if (ui->line_vac_CH4_ThrsON->text().toInt(&ok, 10) < hexdata)
                ui->check_vac_chuck4_4->setStyleSheet(backLightGreen);
            else
                ui->check_vac_chuck4_4->setStyleSheet(backLightGrey);
        }
        if (read == 68) // READ EEflag
        {
            //            if(hexdata == 1)
            //            {
            //                ui->radio_LOG_eeflag->setStyleSheet("background-color:
            //                green");
            //            }
            //            else if(hexdata == 0)
            //            {
            //                ui->radio_LOG_eeflag->setStyleSheet("background-color:
            //                grey");
            //            }
        }
        if (read == 69) // errorstoplevel
        {
            //   int hexstat = parts[0].toInt(&ok,16);

            //            int errstop1 = hexstat & 0b00000001;
            //            int errstop2 = (hexstat & 0b00000010)>>1;

            if (hexdata == 0)
                ui->radio_log_errorstop1->setStyleSheet(radioGreen);
            else if (hexdata == 1)
                ui->radio_log_errorstop1->setStyleSheet(radioRed);
            //            if(errstop1)
            //            ui->radio_log_errorstop1->setStyleSheet(radioGreen); else
            //            ui->radio_log_errorstop1->setStyleSheet(radioRed);
            //            if(errstop2)
            //            ui->radio_log_errorstop2->setStyleSheet(radioGreen); else
            //            ui->radio_log_errorstop2->setStyleSheet(radioRed);
        }
        if (read == 70) // Feeder state
        {
            int k = 2;
            int m = 0;
            int fsstate[15] = {0};
            for (int i = 0; i < data.length() + 1; i += 2) {
                qDebug() << "data[" << i << "]" << data.mid(i, k).toInt(&ok, 16);
                fsstate[m] = data.mid(i, k).toInt(&ok, 16);
                qDebug() << "fsstate[" << m << "]" << fsstate[m];
                m++;
            }
            ui->line_fs_getl1->setText(QString::number(fsstate[0]));
            if (fsstate[0] == 10)
                ui->line_fs_getl1->setStyleSheet(backLightGreen);
            else if (fsstate[0] > 0)
                ui->line_fs_getl1->setStyleSheet(backRed);
            else if (fsstate[0] == 0)
                ui->line_fs_getl1->setStyleSheet(backLightGrey);

            ui->line_fs_getl2->setText(QString::number(fsstate[1]));
            if (fsstate[1] == 10)
                ui->line_fs_getl2->setStyleSheet(backLightGreen);
            else if (fsstate[1] > 0)
                ui->line_fs_getl2->setStyleSheet(backRed);
            else if (fsstate[1] == 0)
                ui->line_fs_getl2->setStyleSheet(backLightGrey);

            ui->line_fs_getpa->setText(QString::number(fsstate[2]));
            if (fsstate[2] == 10)
                ui->line_fs_getpa->setStyleSheet(backLightGreen);
            else if (fsstate[2] > 0)
                ui->line_fs_getpa->setStyleSheet(backRed);
            else if (fsstate[2] == 0)
                ui->line_fs_getpa->setStyleSheet(backLightGrey);

            ui->line_fs_putl1->setText(QString::number(fsstate[3]));
            if (fsstate[3] == 7)
                ui->line_fs_putl1->setStyleSheet(backLightGreen);
            else if (fsstate[3] > 0)
                ui->line_fs_putl1->setStyleSheet(backRed);
            else if (fsstate[3] == 0)
                ui->line_fs_putl1->setStyleSheet(backLightGrey);

            ui->line_fs_putl2->setText(QString::number(fsstate[4]));
            if (fsstate[4] == 7)
                ui->line_fs_putl2->setStyleSheet(backLightGreen);
            else if (fsstate[4] > 0)
                ui->line_fs_putl2->setStyleSheet(backRed);
            else if (fsstate[4] == 0)
                ui->line_fs_putl2->setStyleSheet(backLightGrey);

            ui->line_fs_putpa->setText(QString::number(fsstate[5]));
            if (fsstate[5] == 12)
                ui->line_fs_putpa->setStyleSheet(backLightGreen);
            else if (fsstate[5] > 0)
                ui->line_fs_putpa->setStyleSheet(backRed);
            else if (fsstate[5] == 0)
                ui->line_fs_putpa->setStyleSheet(backLightGrey);

            ui->line_fs_pa->setText(QString::number(fsstate[6]));
            if (fsstate[6] == 22 || fsstate[6] == 17)
                ui->line_fs_pa->setStyleSheet(backLightGreen);
            else if (fsstate[6] > 0)
                ui->line_fs_pa->setStyleSheet(backRed);
            else if (fsstate[6] == 0)
                ui->line_fs_pa->setStyleSheet(backLightGrey);

            ui->line_fs_prewc1->setText(QString::number(fsstate[7]));
            if (fsstate[7] == 10)
                ui->line_fs_prewc1->setStyleSheet(backLightGreen);
            else if (fsstate[7] > 0)
                ui->line_fs_prewc1->setStyleSheet(backRed);
            else if (fsstate[7] == 0)
                ui->line_fs_prewc1->setStyleSheet(backLightGrey);

            ui->line_fs_prewc0->setText(QString::number(fsstate[8]));
            if (fsstate[8] == 10)
                ui->line_fs_prewc0->setStyleSheet(backLightGreen);
            else if (fsstate[8] > 0)
                ui->line_fs_prewc0->setStyleSheet(backRed);
            else if (fsstate[8] == 0)
                ui->line_fs_prewc0->setStyleSheet(backLightGrey);

            ui->line_fs_wc->setText(QString::number(fsstate[9]));
            if (fsstate[9] == 1)
                ui->line_fs_wc->setStyleSheet(backLightGreen);
            else if (fsstate[9] > 0)
                ui->line_fs_wc->setStyleSheet(backRed);
            else if (fsstate[9] == 0)
                ui->line_fs_wc->setStyleSheet(backLightGrey);

            ui->line_fs_load1->setText(QString::number(fsstate[10]));
            if (fsstate[10] == 4)
                ui->line_fs_load1->setStyleSheet(backLightGreen);
            else if (fsstate[10] > 0)
                ui->line_fs_load1->setStyleSheet(backRed);
            else if (fsstate[10] == 0)
                ui->line_fs_load1->setStyleSheet(backLightGrey);

            ui->line_fs_load2->setText(QString::number(fsstate[11]));
            if (fsstate[11] == 4)
                ui->line_fs_load2->setStyleSheet(backLightGreen);
            else if (fsstate[11] > 0)
                ui->line_fs_load2->setStyleSheet(backRed);
            else if (fsstate[11] == 0)
                ui->line_fs_load2->setStyleSheet(backLightGrey);

            ui->line_fs_unload->setText(QString::number(fsstate[12]));
            if (fsstate[12] == 4)
                ui->line_fs_unload->setStyleSheet(backLightGreen);
            else if (fsstate[12] > 0)
                ui->line_fs_unload->setStyleSheet(backRed);
            else if (fsstate[12] == 0)
                ui->line_fs_unload->setStyleSheet(backLightGrey);

            ui->line_fs_macro->setText(QString::number(fsstate[13]));
            if (fsstate[13] == 5)
                ui->line_fs_macro->setStyleSheet(backLightGreen);
            else if (fsstate[13] > 0)
                ui->line_fs_macro->setStyleSheet(backRed);
            else if (fsstate[13] == 0)
                ui->line_fs_macro->setStyleSheet(backLightGrey);

            // ui->line_fs_macro->setText(QString::number(fsstate[14]));
            // if(fsstate[14] == 5) ui->line_fs_macro->setStyleSheet(backLightGreen);
            // else if(fsstate[14] > 0) ui->line_fs_macro->setStyleSheet(backRed);
            // else if(fsstate[14] == 0)
            // ui->line_fs_macro->setStyleSheet(backLightGrey);

            /*
      uint8_t subGetL1;
      uint8_t subGetL2;
      uint8_t subGetPA;
      uint8_t subPutL1;
      uint8_t subPutL2;
      uint8_t subPutPA;
      uint8_t subPA;
      uint8_t subPrewc1;
      uint8_t subPrewc0;
      uint8_t subWC;
      uint8_t subLoad1;
      uint8_t subLoad2;
      uint8_t subUnload;
      uint8_t subMacro;
       * */
        }
        if (read == 71) // DiagLeds
        {
            // ui->rad_diag_over->setChecked(0);
            // ui->rad_diag_slave->setChecked(0);
            // ui->rad_diag_master->setChecked(0);
            // ui->rad_diag_data->setChecked(0);
            // ui->rad_diag_clk->setChecked(0);

            // if (hexdata & 1) ui->rad_diag_over->setChecked(1);
            // if (hexdata & 2) ui->rad_diag_slave->setChecked(1);
            // if (hexdata & 4) ui->rad_diag_master->setChecked(1);
            // if (hexdata & 8) ui->rad_diag_data->setChecked(1);
            // if (hexdata & 16) ui->rad_diag_clk->setChecked(1);
        }
        if (read == 72) //
        {
        }
        if (read == 73) //
        {
        }
        if (read == 74) //
        {
        }
        if (read == 75) //
        {
        }
        if (read == 76) // Volt1 Board 2 Lift2-Height
        {
            if (retflag) {
                ui->lineEdit_voltmotLift2Height->setText("n.c.");
            } else {
                float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
                s = QString::number(volt * 0.196, 10, 2);
                ui->lineEdit_voltmotLift2Height->setText(s);
            }
        }
        if (read == 77) // Volt1 Board 3 Lift1-Height
        {
            float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(volt * 0.196, 10, 2);
            ui->lineEdit_voltmotLift1Height->setText(s);
        }
        if (read == 78) // Volt1 Board 4 PARotPos
        {
            float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(volt * 0.196, 10, 2);
            ui->lineEdit_voltmotPreaRotpos->setText(s);
        }
        if (read == 79) // Volt1 Board 5 Loader-X
        {
            float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(volt * 0.196, 10, 2);
            ui->lineEdit_voltmotLoaderX->setText(s);
        }
        if (read == 81) // Volt2 Board 2 Lift2-Tilt
        {
            float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(volt * 0.196, 10, 2);
            ui->lineEdit_voltmotLift2Tilt->setText(s);
        }
        if (read == 82) // Volt2 Board 3 Lift1-Tilt
        {
            float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(volt * 0.196, 10, 2);
            ui->lineEdit_voltmotLift1Tilt->setText(s);
        }
        if (read == 83) // Volt2 Board 4 PA-Phi
        {
            float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(volt * 0.196, 10, 2);
            ui->lineEdit_voltmotPreaPhi->setText(s);
        }
        if (read == 84) // Volt2 Board 5 Loader-Y
        {
            float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(volt * 0.196, 10, 2);
            ui->lineEdit_voltmotLoaderY->setText(s);
        }
        if (read == 87) // Volt3 Board 3 PA-Height
        {
            float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(volt * 0.196, 10, 2);
            ui->lineEdit_voltmotPreaHeight->setText(s);
        }
        if (read == 88) // Volt3 Board 4 PA-Tilt
        {
            float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(volt * 0.196, 10, 2);
            ui->lineEdit_voltmotPreaTilt->setText(s);
        }
        if (read == 89) // Volt3 Board 5 WC-Height
        {
            float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(volt * 0.196, 10, 2);
            ui->lineEdit_voltmotWcHeight->setText(s);
        }
        if (read == 90) // Volt3 Board 6 WC-Tilt
        {
            float volt = str.mid(str.indexOf(':') + 1, 2).toUInt(&ok, 16);
            s = QString::number(volt * 0.196, 10, 2);
            ui->lineEdit_voltmotWcPhi->setText(s);
        }
        if (read == 97) //
        {
        }
        if (read == 99) // Systemstatus
        {
            // if(cleansequenz == 1)
            // ui->plainText_clean_1->setStyleSheet(backLightGreen);
            auto parts = str.mid(str.indexOf(":") + 1,str.indexOf("\r") - str.indexOf(":") - 1).split(',');
            if (parts.size() > 0)
            {
                int hexstat = parts[0].toInt(&ok, 16);
                int SETEEDATAOK = hexstat & 0b0000000000000001;         // 1
                int EEMOTDATOK = (hexstat & 0b0000000000000110) >> 1;   // 2
                int BOARDVERSION = (hexstat & 0b0000000000001000) >> 3; // 3
                int RACALIVEOK = (hexstat & 0b0000000000010000) >> 4;   // 4
                int MAINVACOK = (hexstat & 0b0000000000100000) >> 5;    // 5
                int POWER = (hexstat & 0b0000000001000000) >> 6;        // 6
                int TEMPEROK = (hexstat & 0b0000000010000000) >> 7;     // 7
                int INITOK = (hexstat & 0b0000000100000000) >> 8;       // 8
                int RESOK = (hexstat & 0b0000001000000000) >> 9;        // 9
                int CLEANOK = (hexstat & 0b0000010000000000) >> 10;     // 10
                int TWISLAVES = (hexstat & 0b0000100000000000) >> 11;   // 11
                int TWICOMM = (hexstat & 0b0001000000000000) >> 12;     // 12
                int POWERFAIL = (hexstat & 0b0010000000000000) >> 13;   // 13
                int EMO = (hexstat & 0b0100000000000000) >> 14;         // 14

                if (SETEEDATAOK) ui->system_r_datasetup->setStyleSheet(radioGreen);
                else ui->system_r_datasetup->setStyleSheet(radioRed);
                if (EEMOTDATOK) ui->system_r_motordata->setStyleSheet(radioGreen);
                else ui->system_r_motordata->setStyleSheet(radioRed);
                if (BOARDVERSION) ui->system_r_databoards->setStyleSheet(radioGreen);
                else ui->system_r_databoards->setStyleSheet(radioRed);
                if (RACALIVEOK) ui->system_r_bitbus->setStyleSheet(radioGreen);
                else ui->system_r_bitbus->setStyleSheet(radioRed);
                if (MAINVACOK) ui->system_r_mainvac->setStyleSheet(radioGreen);
                else ui->system_r_mainvac->setStyleSheet(radioRed);
                if (POWER) ui->system_r_power->setStyleSheet(radioGreen);
                else ui->system_r_power->setStyleSheet(radioRed);
                if (TEMPEROK) ui->system_r_temperature->setStyleSheet(radioGreen);
                else ui->system_r_temperature->setStyleSheet(radioRed);
                if (INITOK)
                {
                    ui->radio_clean_INITok->setStyleSheet(radioGreen);
                    ui->radio_clean_INITok_2->setStyleSheet(radioGreen);
                    ui->system_r_init->setStyleSheet(radioGreen);
                    if (cleanman)
                    {
                        f_setsequence(20);
                        err_msgbox("feeder reset ok. Please start MCS application software again ");
                        cleanman = 0; // defaultwert, wenn nicht aktiv
                        cleansequenz = 255;
                    }
                }
                else
                {
                    ui->radio_clean_INITok->setStyleSheet(radioRed);
                    ui->system_r_init->setStyleSheet(radioRed);
                }
                if (RESOK) ui->system_r_reset->setStyleSheet(radioGreen);
                else ui->system_r_reset->setStyleSheet(radioRed);
                if (CLEANOK) ui->system_r_clean->setStyleSheet(radioGreen);
                else ui->system_r_clean->setStyleSheet(radioRed);
                if (TWISLAVES) ui->system_r_twislaves->setStyleSheet(radioGreen);
                else ui->system_r_twislaves->setStyleSheet(radioRed);
                if (TWICOMM) ui->system_r_twicomm->setStyleSheet(radioGreen);
                else ui->system_r_twicomm->setStyleSheet(radioRed);
                if (POWERFAIL) ui->system_r_powerfail->setStyleSheet(radioGreen);
                else  ui->system_r_powerfail->setStyleSheet(radioRed);
                if (EMO) ui->system_r_emo->setStyleSheet(radioGreen);
                else ui->system_r_emo->setStyleSheet(radioRed);
            }
        }
    }
    else if (str.left(5) == QString(rSET).left(5)) // "$SET_"
    {
        if (strjob == "err")
        {
            f_errtext(hexdata);
        }
        else if (strjob.trimmed() == "RET=0")
        {
            if (waitrepeat)
            {
                waitrepeat = 0;
                on_b_connect_feeder_clicked();
            }
            if (assistant_wc) assistant_loop(assistant_wc); // neue WC LEFT Daten sind gespeichert
            if (setfricbit)
            {
                tmpstat = 1;
                STORE_FILE_partLIFT(1);
                setfricbit = 0;
            }
        }
        else
        {
            if (tmpjob == 5) // Simulation
            {
            }
            else if (tmpjob == 6) // Servicemode
            {
                if (hexdata == 1) ui->p_log_servicemode->setStyleSheet(backLightGreen);
                else if (hexdata == 0) ui->p_log_servicemode->setStyleSheet(backLightGrey);
            }
            else if (tmpjob == 7) // LOGlevel debug
            {
                if (hexdata == 0)
                {
                    ui->checkBox_debuglog->setStyleSheet("background-color: grey");
                }
                else if (hexdata == 1)
                {
                    ui->checkBox_debuglog->setStyleSheet("background-color: green");
                }
            }
            else if (tmpjob == 8) // LOGlevel warn
            {
                if (hexdata == 0)
                {
                    ui->checkBox_warnlog->setStyleSheet("background-color: grey");
                }
                else if (hexdata == 1)
                {
                    ui->checkBox_warnlog->setStyleSheet("background-color: green");
                }
            }
            else if (tmpjob == 9) // LOGlevel error
            {
                if (hexdata == 0)
                {
                    ui->checkBox_errorlog->setStyleSheet("background-color: grey");
                    ui->checkBox_errorlog_2->setStyleSheet("background-color: grey");
                    //  if(userindex == 5) on_p_sys_VacRefresh_clicked();
                }
                else if (hexdata == 1)
                {
                    ui->checkBox_errorlog->setStyleSheet("background-color: green");
                    ui->checkBox_errorlog_2->setStyleSheet("background-color: green");
                }
            }
            else if (tmpjob == 14) // Wafer change
            {
                if (multiwc) // Waferchanger macro als Zentrierhilfe 180°
                {
                    static int count = 0;
                    if (count < 5)
                    {
                        tmpstat = 1;
                        on_p_align_waferchange_clicked();
                        count++;
                    }
                    else
                    {
                        multiwc = 0;
                        ui->check_wc_multi->setChecked(0);
                        count = 0;
                    }
                }
            }
            else if (tmpjob == 17) // Vactest starten
            {
                f_vactest();           // Vactest starten
            }
            else if (tmpjob == 16) // mainvacflag
            {
                if (hexdata == 0)
                {
                    ui->checkBox_mainvacoff->setStyleSheet("background-color: grey");
                }
                else if (hexdata == 1)
                {
                    ui->checkBox_mainvacoff->setStyleSheet("background-color: green");
                }
            }
            else if (tmpjob == 24) // Reader Displacement
            {
                qDebug() << "return=" << str.mid(str.indexOf(":") + 1, str.indexOf("\r") - str.indexOf(":") - 1);
                if (macro_profil == 1) macroProfil(true);
                else if (str.mid(str.indexOf(":") + 1, str.indexOf("\r") - str.indexOf(":") - 1) == ui->line_align_displ->text())
                {
                    qDebug() << "set color" << backLightGreen;
                    ui->p_align_setdispl->setStyleSheet(backLightGreen);
                }
                else ui->p_align_setdispl->setStyleSheet(backRed);
            }
            else if (tmpjob == 26) ui->checkBox_ASYST_statuspoll->setChecked(!hexdata);
            else if (tmpjob == 29) // friction max. deviation
            {
                ui->line_maxdeviation_friction->setText(data.right(1));
            } else if (tmpjob == 30) // release LD X
            {
                if (str.mid(str.indexOf(":") + 1,
                            str.indexOf("\r") - str.indexOf(":") - 1) == "0") {
                    ui->check_loader_releasemotoX->setChecked(0);
                    ui->check_loader_releasemotoX->setStyleSheet(
                                "background-color: green");
                } else if (str.mid(str.indexOf(":") + 1,
                                   str.indexOf("\r") - str.indexOf(":") - 1) == "1") {
                    ui->check_loader_releasemotoX->setChecked(0);
                    ui->check_loader_releasemotoX->setStyleSheet(
                                "background-color: grey");
                }
            } else if (tmpjob == 31) // release LD Y
            {
                if (str.mid(str.indexOf(":") + 1,
                            str.indexOf("\r") - str.indexOf(":") - 1) == "0") {
                    ui->check_loader_releasemotoY->setChecked(0);
                    ui->check_loader_releasemotoY->setStyleSheet(
                                "background-color: green");
                } else if (str.mid(str.indexOf(":") + 1,
                                   str.indexOf("\r") - str.indexOf(":") - 1) == "1") {
                    ui->check_loader_releasemotoY->setChecked(0);
                    ui->check_loader_releasemotoY->setStyleSheet(
                                "background-color: grey");
                }
            } else if (tmpjob == 35) // cal Sensor Lift
            {
                float val;
                if (calSensHeight) {
                    ui->radio_lift1_addtohgt->setChecked(0);
                    float tmpReso = getResolution("Lift1 height motor").toFloat();
                    float height = (float)hexdata * 1.0;
                    val = height / tmpReso;
                    ui->line_lift1_xyloader_height_mm->setText(
                                QString::number(val, 'f', 3));
                    val = hexdata;
                    ui->line_lift1_xyloader_height->setText(QString::number(val));
                    ui->push_lift1_cal_sensheight->setStyleSheet(backLightGreen);
                    calSensHeight = 0;
                } else if (calSensHeight2) {
                    ui->radio_lift2_addtohgt->setChecked(0);
                    float tmpReso = getResolution("Lift2 height motor").toFloat();
                    float height = (float)hexdata * 1.0;
                    val = height / tmpReso;
                    ui->line_lift2_xyloader_height_mm->setText(QString::number(hexdata));
                    val = hexdata;
                    ui->line_lift2_xyloader_height->setText(QString::number(hexdata));
                    ui->push_lift2_cal_senshgt->setStyleSheet(backLightGreen);
                    calSensHeight2 = 0;
                }
            } else if (tmpjob == 38) // getmap Auswertung
            {
                if (svc8 == 2) // CASS Map
                {
                    map.clear();
                    for (int i = 1; i < 26; i++) {
                        if (str.mid(str.indexOf(":") - 1 + 2 * i, 2) == "30")
                            map.append("0 ");
                        else if (str.mid(str.indexOf(":") - 1 + 2 * i, 2) == "31")
                            map.append("1 ");
                        else if (str.mid(str.indexOf(":") - 1 + 2 * i, 2) == "32")
                            map.append("2 ");
                        else if (str.mid(str.indexOf(":") - 1 + 2 * i, 2) == "33")
                            map.append("3 ");
                        if (i % 5 == 0 && i < 25)
                            map.append(". ");
                    }
                    ui->lineL1_maplist->setText(map);
                    svc8 = 0;
                }

            } else if (tmpjob == 39) // map -> getmap
            {
                tmpstat = 1;
                if (svc8 == 1)
                    getMap();
            } else if (tmpjob == 41) // load cass
            {
                ui->checkCass_Lock->setChecked(1);
                ui->checkCass_Lock->setStyleSheet("background-color: green");
            } else if (tmpjob == 40) // unload cass
            {
                ui->checkCass_Lock->setChecked(0);
                ui->checkCass_Lock->setStyleSheet("background-color: red");
            } else if (tmpjob == 54) // LDX
            {
                cleanman = 0;
                // if (cleansequenz == 2 || cleansequenz == 3) {
                //     static int step = 0;
                //     if (step == 0) {
                //         tmpstat = 1;
                //         on_p_PA_LDhgt_clicked(); // pos PA LD height
                //         step = 1;
                //     } else if (step == 1) // response auf pos LDX PAfree
                //     {
                //         if (cleansequenz == 2) {
                //             tmpstat = 1;
                //             on_p_clean_completereset_clicked(); // cleansequenz wird auf 0
                //             // gesetzt
                //         }
                //         step = 0;
                //     }
                // }
            }
            else if (tmpjob == 55) // LDY
            {
                // if (cleansequenz == 2 || cleansequenz == 3)
                //     on_p_LD_XPA_clicked(); // Loader X pos PA
                if (f_lift1xyhgt == 1)
                {
                    tmpstat = 1;
                    on_p_LDheight_xy_clicked(); // Lift1 height motor fahren
                    f_lift1xyhgt = 0;
                }
                else if (f_lift2xyhgt == 1)
                {
                    tmpstat = 1;
                    on_p_LDheight_xy_2_clicked(); // Lift2 height motor fahren
                    f_lift2xyhgt = 0;
                }
                else if (f_lift1operhgt == 1)
                {
                    tmpstat = 1;
                    on_p_oper_height_clicked(); // Lift1 height motor fahren
                    f_lift1operhgt = 0;
                }
                else if (f_lift2operhgt == 1)
                {
                    tmpstat = 1;
                    on_p_oper_height_2_clicked(); // Lift2 height motor fahren
                    f_lift2operhgt = 0;
                }
                else if (f_lift1senshgt == 1)
                {
                    tmpstat = 1;
                    on_p_wafersensor_height_clicked(); // Lift1 height motor fahren
                    f_lift1senshgt = 0;
                }
                else if (f_lift2senshgt == 1)
                {
                    tmpstat = 1;
                    on_p_wafersensor_height_2_clicked(); // Lift2 height motor fahren
                    f_lift2senshgt = 0;
                }
            }
            else if (tmpjob == 56) // PA tilt
            {
                if (res2pos) {
                    if (hexdata == 0) {
                        ui->label_resPAT->setStyleSheet(
                                    "QLabel { background-color: green }");
                    } else
                        ui->label_resPAT->setStyleSheet("background-color: red");
                    res2pos = 0;
                }
                if (cleanman)
                    f_clean_reset(5);    // res PA ROT
            }
            else if (tmpjob == 57) // PA ROT
            {
                if (res2pos) {
                    if (hexdata == 0) {
                        ui->label_resPAR->setStyleSheet(
                                    "QLabel { background-color: green }");
                    } else
                        ui->label_resPAR->setStyleSheet("background-color: red");
                    res2pos = 0;
                }
                if (cleanman)
                    f_clean_reset(1);    // res LD Y
            }
            else if (tmpjob == 58) // PA Height
            {
                cleanman = 0;
                if (cleansequenz == 2 || cleansequenz == 3) {
                    static int step = 0;

                    if (step == 0) {
                        tmpstat = 1;
                        on_p_LD_Ypapos_clicked(); // Loader Y pos PA
                        step = 1;
                    } else if (step == 1) {
                        tmpstat = 1;
                        serialSendFeeder(vaconLD); // Loader Vac ON
                        step = 2;
                    } else if (step == 2) {
                        tmpstat = 1;
                        on_p_LD_PAfree_clicked(); // Loader X pos PAfree
                        step = 0;
                    }
                }
            }
            else if (tmpjob == 59) // PA Phi
            {
                if (macro_profil)
                    macroProfil(true);
            }
            else if (tmpjob == 61) // WC Height
            {
                cleanman = 0;
            }
            else if (tmpjob == 62) // WC PHI
            {
                if (res2pos) {
                    if (hexdata == 0) {
                        //                        ui->p_clean_resetwc->setStyleSheet(backLightGreen);
                        //                        ui->p_clean_resetwc->setText("wafer
                        //                        changer\nok");
                        // if (cleansequenz == 1) {
                        //     f_setsequence(0);
                        //     err_msgbox("Click 'Ok' to reset all feeder axes");
                        //     on_p_clean_completereset_clicked();
                        // }
                        ui->p_clean_sequence1->setStyleSheet(backLightGreen);
                    } else
                        ui->p_clean_sequence1->setStyleSheet(backLightRed);
                    res2pos = 0;
                }
                cleanman = 0;
            } else if (tmpjob == 69) // errstop.level1 resetten
            {
                if (hexdata == 1) {
                    ui->radio_log_errorstop1->setStyleSheet("background-color: grey");
                } else if (hexdata == 0) {
                    ui->radio_log_errorstop1->setStyleSheet("background-color: green");
                }
            } else if (tmpjob == 70) // Materialliste
            {
                set_Materialliste(hexdata);
            } else if (tmpjob == 73) // Foundwaferliste
            {
                qDebug() << "set 73" << hexdata;
                set_Foundwaferliste(hexdata);
            }
        }
        if (waitLDout)
        {
            QString p2 = str.right(8).trimmed(); // RET=0 parsen
            qDebug() << "waitLDout p2" << p2;
            if (hexdata == 0) // 0=ok
            {
                if (waitLDout == 1) // LDYout vor Slotposition Finger/Wafer
                {
                    tmpstat = 1;
                    tmpstr = 0;
                    tmpstr.append(setpos); // SET Slotposition with finger or wafer offset
                    if (casslift == 1) {
                        if (ui->radioCass_Finger->isChecked())
                            tmpstr.append("10=");
                        else if (ui->radioCass_Wafer->isChecked())
                            tmpstr.append("12=");
                    } else if (casslift == 2) {
                        if (ui->radioCass_Finger->isChecked())
                            tmpstr.append("11=");
                        else if (ui->radioCass_Wafer->isChecked())
                            tmpstr.append("13=");
                    }
                    tmpstr.append(QString::number(ui->spinCass_SlotPos->value()).toLatin1());
                    tmpstr.append("\r\n");
                    feedertimeout = 5000;
                    serialSendFeeder(tmpstr);
                }
                else if (waitLDout == 2) // LDYout vor ScanMap
                {
                    int liftindex = 0;
                    QString index = QString::number(ui->comboCass_Type->currentIndex());
                    if (ui->comboCass_Type->currentIndex() <= 0) err_msgbox("please select carrier");
                    else
                    {
                        if (ui->checkCass_lift1->isChecked()) liftindex = 1;
                        else if (ui->checkCass_lift2->isChecked()) liftindex = 2;
                        else err_msgbox("please select lift");
                        if (liftindex)
                        {
                            tmpstat = 1;
                            tmpstr = 0;
                            tmpstr.append(setpos);
                            tmpstr.append("39=" + QString::number(liftindex).toLatin1() + ",");
                            tmpstr.append(index.toLatin1());
                            tmpstr.append("\r\n"); // ScanMap
                            if (cmdtimeout->isActive() == FALSE) cmdtimeout->start(30000);
                            serialSendFeeder(tmpstr);
                            svc8 = 1;
                        }
                    }
                }
                else if (waitLDout == 3) // LDYout vor Lift Unload
                {
                    if (casslift != 0)
                    {
                        tmpstat = 1;
                        tmpstr = 0;
                        tmpstr.append(setpos);
                        tmpstr.append("40="); // Lift unload
                        tmpstr.append(QString::number(casslift).toLatin1());
                        tmpstr.append("\r\n");
                        feedertimeout = 10000;
                        serialSendFeeder(tmpstr);
                    }
                }
                else if (waitLDout == 20) // LDYout vor Smif ScanMap
                {
                    int liftindex = 0;
                    if (ui->groupBox_SMIF_Lift1->isChecked() || ui->groupBox_ASYST_Lift1->isChecked()) liftindex = 1;
                    else err_msgbox("please select lift");
                    if (liftindex)
                    {
                        if(ui->combo_lift1_SMIF_select->currentText().contains("ISE") == TRUE)
                        {
                            tmpstat = 1;
                            tmpstr = 0;
                            tmpstr.append(ISE_INV); // auf SMIF cmd folgt als Response ein !C_String
                            tmpstr.append(QString::number(liftindex).toLatin1());
                            tmpstr.append("\r\n");
                            if (cmdtimeout->isActive() == FALSE) cmdtimeout->start(30000);
                        }
                        else if(ui->combo_lift1_SMIF_select->currentText().contains("ASYST") == TRUE)
                        {
                            tmpstat = 1;
                            tmpstr = 0;
                            tmpstr.append(ASYST_CMD);   // "$ASYST_2="
                            tmpstr.append(cmdMAP);     // "12"
                            tmpstr.append("\r\n");
                            if (cmdtimeout->isActive() == FALSE) cmdtimeout->start(30000);
                        }
                        serialSendFeeder(tmpstr);
                        //  svc8 = 10;                           // Flag für anschließendes
                        //  GETMAP
                    }
                }
                else if (waitLDout == 30)
                {
                    on_p_lock_unlock_clicked();
                }
                waitLDout = 0;
            }
            else err_msgbox("Loader not outside");
        }
        else if (loadcar) // Response Tilt deaktive
        {
            tmpstat = 1;
            loadcar = 0;
            waitLDout = 1;
            on_p_LD_Yout_clicked();
        }
    }
    else if (str.left(5) == QString(rSETVAC).left(5)) // $SETVAC_
    {
        qDebug() << "strjob" << strjob;

        if (strjob == "err")
        {
            f_errtext(hexdata);
        }
        else
        {
            static int vaccntLD = 0;
            static int vaccntPA = 0;
            static int vaccntWC1 = 0;
            static int vaccntWC2 = 0;
            static int vaccntCH4 = 0;
            static int vaccntCH6 = 0;
            static int vaccntCH8 = 0;

            if (vactestflag)
            {
                if (ui->line_vac_SwCnt_LD->text().toInt(&ok, 10) < vaccntLD) vaccntLD = 0;
                if (ui->line_vac_SwCnt_PA->text().toInt(&ok, 10) < vaccntPA) vaccntPA = 0;
                if (ui->line_vac_SwCnt_WC1->text().toInt(&ok, 10) < vaccntWC1) vaccntWC1 = 0;
                if (ui->line_vac_SwCnt_WC2->text().toInt(&ok, 10) < vaccntWC2) vaccntWC2 = 0;
                if (ui->line_vac_SwCnt_CH4->text().toInt(&ok, 10) < vaccntCH4) vaccntCH4 = 0;
                if (ui->line_vac_SwCnt_CH6->text().toInt(&ok, 10) < vaccntCH6) vaccntCH6 = 0;
                if (ui->line_vac_SwCnt_CH8->text().toInt(&ok, 10) < vaccntCH8) vaccntCH8 = 0;

                vactest->start(ui->line_vac_testdelay->text().toInt(&ok, 10));
            }
            else
            {
                vaccntLD = 0;
                vaccntPA = 0;
                vaccntWC1 = 0;
                vaccntWC2 = 0;
                vaccntCH4 = 0;
                vaccntCH6 = 0;
                vaccntCH8 = 0;
            }

            if (tmpjob == 1) // LD
            {
                if (macroclean)
                {
                    if (hexdata == 1) // LD vacon
                    {
                        ui->r_clean_vac_LD->setChecked(1);
                        ui->r_clean_vac_LD->setStyleSheet(backLightGreen);
                        f_setVAClabels(11);
                    }
                    else if (hexdata == FN_TIMEOUT) // hex 43,dez 67
                    {
                        ui->r_clean_vac_LD->setChecked(0);
                        ui->r_clean_vac_LD->setStyleSheet(backLightGrey);
                        f_setVAClabels(12);
                    }
                    else if (hexdata == 0)
                    {
                        ui->r_clean_vac_LD->setChecked(0);
                        ui->r_clean_vac_LD->setStyleSheet(backLightGrey);
                        f_setVAClabels(10);
                    } else --mstep; // bei Fehler cmd repeat
                    setSendTimer->start(waitvacswoff);
                }
                else
                {
                    if (hexdata == 1) // LD vacon
                    {
                        f_setVAClabels(11);
                    }
                    else if (hexdata == FN_TIMEOUT) // hex 43,dez 67
                    {
                        if (vactestflag && ui->checkBox_vacUnitTest->isChecked())
                        {
                            vaccntLD++;
                            ui->line_vac_ERRCnt_LD->setText(QString::number(vaccntLD));
                        }
                        f_setVAClabels(12);
                    }
                    else if (hexdata == 0) {
                        f_setVAClabels(10);
                    }
                }
                if (cleansequenz == 2 || cleansequenz == 3)
                    serialSendFeeder(vacoffPA); // PA Vac OFF
            }
            else if (tmpjob == 2)         // PA
            {
                if (macroclean)
                {
                    if (hexdata == 1) // PA vacon
                    {
                        ui->r_clean_vac_PA->setChecked(1);
                        ui->r_clean_vac_PA->setStyleSheet(backLightGreen);
                        f_setVAClabels(21);
                    }
                    else if (hexdata == FN_TIMEOUT)
                    {
                        ui->r_clean_vac_PA->setChecked(0);
                        ui->r_clean_vac_PA->setStyleSheet(backLightGrey);
                        f_setVAClabels(22);
                    }
                    else if (hexdata == 0)
                    {
                        ui->r_clean_vac_PA->setChecked(0);
                        ui->r_clean_vac_PA->setStyleSheet(backLightGrey);
                        f_setVAClabels(20);
                    }
                    else --mstep; // bei Fehler cmd repeat
                    setSendTimer->start(waitvacswoff);
                }
                else
                {
                    if (hexdata == 1) // PA vacon
                    {
                        f_setVAClabels(21);
                    }
                    else if (hexdata == FN_TIMEOUT) // hex 43,dez 67
                    {
                        if (vactestflag && ui->checkBox_vacUnitTest->isChecked())
                        {
                            vaccntPA++;
                            ui->line_vac_ERRCnt_PA->setText(QString::number(vaccntPA));
                        }
                        f_setVAClabels(22);
                    }
                    else if (hexdata == 0)
                    {
                        f_setVAClabels(20);
                    }
                    else if (tmpdata == 0) ui->label_pavac->setStyleSheet("QLabel { background-color: red }");
                }
                if (macro_profil == 1) macroProfil(true);
                if (cleansequenz == 2 || cleansequenz == 3) on_p_PA_belowLDhgt_clicked(); // PAH pos below LD
            }
            else if (tmpjob == 3)           // WC1
            {
                if (macroclean)
                {
                    if (hexdata == 1) // WC1 vacon
                    {
                        ui->r_clean_vac_WC1->setChecked(1);
                        ui->r_clean_vac_WC1->setStyleSheet(backLightGreen);
                        f_setVAClabels(31);
                    }
                    else if (hexdata == FN_TIMEOUT) // WC1 Timeout
                    {
                        ui->r_clean_vac_WC1->setChecked(0);
                        ui->r_clean_vac_WC1->setStyleSheet(backLightGrey);
                        f_setVAClabels(32);
                    }
                    else if (hexdata == 0) // WC1 vacoff
                    {
                        ui->r_clean_vac_WC1->setChecked(0);
                        ui->r_clean_vac_WC1->setStyleSheet(backLightGrey);
                        f_setVAClabels(30);
                    }
                    else --mstep; // bei Fehler cmd repeat
                    setSendTimer->start(waitvacswoff);
                }
                else
                {
                    if (hexdata == 1) // WC left vacon
                    {
                        f_setVAClabels(31);
                    }
                    else if (hexdata == FN_TIMEOUT) // hex 43,dez 67
                    {
                        if (vactestflag && ui->checkBox_vacUnitTest->isChecked())
                        {
                            vaccntWC1++;
                            ui->line_vac_ERRCnt_WC1->setText(QString::number(vaccntWC1));
                        }
                        f_setVAClabels(32);
                    }
                    else if (hexdata == 0)
                    {
                        f_setVAClabels(30);
                    }
                }
                if (cleanman) {
                    if (hexdata == 0) // WC1 vacoff
                    {
                        tmpstat = 1;
                        serialSendFeeder(vacoffWC2); // auch WC2 vac abschalten
                    }
                }
            }
            else if (tmpjob == 4) // WC2
            {
                if (macroclean)
                {
                    if (hexdata == 1) // WC2 vacon
                    {
                        ui->r_clean_vac_WC2->setChecked(1);
                        ui->r_clean_vac_WC2->setStyleSheet(backLightGreen);
                        f_setVAClabels(41);
                    }
                    else if (hexdata == FN_TIMEOUT) // WC2 Timeout
                    {
                        ui->r_clean_vac_WC2->setChecked(0);
                        ui->r_clean_vac_WC2->setStyleSheet(backLightGrey);
                        f_setVAClabels(42);
                    }
                    else if (hexdata == 0) // WC2 vacoff
                    {
                        ui->r_clean_vac_WC2->setChecked(0);
                        ui->r_clean_vac_WC2->setStyleSheet(backLightGrey);
                        f_setVAClabels(40);
                    }
                    else --mstep; // bei Fehler cmd repeat
                    setSendTimer->start(waitvacswoff);
                }
                else
                {
                    if (hexdata == 1) // WC right vacon
                    {
                        f_setVAClabels(41);
                    }
                    else if (hexdata == FN_TIMEOUT) // hex 43,dez 67
                    {
                        vaccntWC2++;
                        ui->line_vac_ERRCnt_WC2->setText(QString::number(vaccntWC2));
                        f_setVAClabels(42);
                    }
                    else if (hexdata == 0) // hex 43,dez 67
                    {
                        f_setVAClabels(40);
                    }
                }
                if (cleanman)
                {
                    if (hexdata == 0) // WC2 vacoff
                    {
                        tmpstat = 1;
                        on_p_PA_getheight_clicked(); // WCH abfragen
                    }
                }
            }
            else if (tmpjob == 5) // CH4
            {
                if (macroclean)
                {
                    if (hexdata == 1) // CH4 vacon
                    {
                        ui->r_clean_vac_CH4->setChecked(1);
                        ui->r_clean_vac_CH4->setStyleSheet(backLightGreen);
                        f_setVAClabels(51);
                    }
                    else if (hexdata == FN_TIMEOUT) // CH4 Timeout
                    {
                        ui->r_clean_vac_CH4->setChecked(0);
                        ui->r_clean_vac_CH4->setStyleSheet(backLightGrey);
                        f_setVAClabels(52);
                    }
                    else if (hexdata == 0) // CH4 vacoff
                    {
                        ui->r_clean_vac_CH4->setChecked(0);
                        ui->r_clean_vac_CH4->setStyleSheet(backLightGrey);
                        f_setVAClabels(50);
                    }
                    else --mstep; // bei Fehler cmd repeat
                    setSendTimer->start(waitvacswoff);
                }
                else
                {
                    if (hexdata == 1) // Chuck vacon
                    {
                        f_setVAClabels(51);
                    }
                    else if (hexdata == FN_TIMEOUT) // hex 43,dez 67
                    {
                        vaccntCH4++;
                        ui->line_vac_ERRCnt_CH4->setText(QString::number(vaccntCH4));
                        f_setVAClabels(52);
                    }
                    else if (hexdata == 0)
                    {
                        f_setVAClabels(50);
                    }
                }
            }
            else if (tmpjob == 6) // CH6
            {
                if (hexdata == 1) f_setVAClabels(61); // Chuck6 vacon
                else if (hexdata == 0) f_setVAClabels(60);
            }
            else if (tmpjob == 7) // CH8
            {
                if (hexdata == 1) f_setVAClabels(71); // Chuck8 vacon
                else if (hexdata == 0) f_setVAClabels(70); // Chuck8 vacoff
            }
            else if (tmpjob == 9) // all switches off
            {
                if (macroclean) setSendTimer->start(waitvacswoff); // all vac switches are off - wait
                // a little time to switch units on
            }
        }
    }
    else if (str.left(6) == QString(PSET_1).left(6)) // "$PSET_1=0\r\n" als Trigger für nächsten Datensatz
    {
        if (cmdaktiv == 3) // 3 = Motordaten aus p_INIT_saveMOT_2
        {
            tmpstat = 1;
            serialSendFeeder(
                        EEPROM.mid(cntall, EEPROM.indexOf("\r", cntall) - cntall + 2));
            cmdaktiv = 4;
        }
        if (cmdaktiv == 2) // 2 = Motordaten aus p_INIT_save_allmot_EPROM
        {
            if (partmot < 12) // Zähler für gesendete Motorparametersätze
            {
                tmpstat = 1;
                serialSendFeeder(
                            EEPROM.mid(cntall, EEPROM.indexOf("&", cntall) - cntall + 1));
                cntall =
                        EEPROM.indexOf("&", cntall) + 1; // Anzahl+1 bis zum ersten & (138)
                partmot++;
            } else if (partmot == 12) // auf Abschluss $PSET_RET=0 warten
            {
                tmpstat = 1;
                serialSendFeeder(
                            EEPROM.mid(cntall, EEPROM.indexOf("\r", cntall) - cntall + 2));
                cmdaktiv = 4;
                partmot++;
            }
        } else if (cmdaktiv == 1) // 1 = Setupdaten
        {
            tmpstat = 1;
            cmdaktiv = 0;
            serialSendFeeder(EEPROM);
        } else if (retdata == 0) {
            if (cmdaktiv == 4) {
                if (motall) {
                    ui->label_INIT_mot_dataok->show();
                    ui->label_INIT_mot_dataok->setStyleSheet(backLightGreen);
                    ui->label_INIT_mot_dataok->setText("INSMOTOR data ok");
                } else {
                    ui->label_mot_dataok->setStyleSheet(backLightGreen);
                    ui->label_mot_dataok->setText("INSMOTOR.ini ok");
                }
                cmdaktiv = 0;
            } else {
                ui->label_INIT_store_ok->setStyleSheet(backLightGreen);
                ui->label_INIT_store_ok->setText("INSSETUP data ok");
            }
        } else {
            if (cmdaktiv == 4) {
                if (motall) {
                    ui->label_INIT_mot_dataok->show();
                    ui->label_INIT_mot_dataok->setStyleSheet(backRed);
                    ui->label_INIT_mot_dataok->setText("INSMOTOR data error");
                } else {
                    ui->label_mot_dataok->setStyleSheet(backRed);
                    ui->label_mot_dataok->setText("INSMOTOR.ini error");
                }
                cmdaktiv = 0;
            } else {
                ui->label_INIT_store_ok->setStyleSheet(backRed);
                ui->label_INIT_store_ok->setText("INSSETUP data error");
            }
        }
    }
    else if (str.left(5) == QString(r_err).left(5)) // $ERR_ (errorlog warnlog)
    {

        if (f_errtext(
                    str.mid(str.indexOf("_") + 1, str.indexOf("\r")).toInt(&ok, 16)))
            ui->plainTextEdit_LOGwarn->appendPlainText(str.trimmed());

    }
    else if (str.at(0) == QString(rXRAC).at(0)) // Erkennungszeichen &
    {
        qDebug() << "rXRAC" << str;

        QString Rtext;
        QString Ftext;
        QString cmdstr;
        QString datastr;

        datastr.clear();

        QString data;
        QString Byte1;
        QString Byte2;
        QString Byte3;
        QString Byte4;
        QString Byte5;
        QString Byte6;
        QString Byte7;
        QString Byte8;
        QString Byte9;
        QString Byte10;
        QString Byte11;
        QString Byte12;
        QString Byte13;
        QString Byte14;
        QString Byte15;
        QString Byte16;
        QString Byte17;
        QString Byte18;
        QString Byte19;
        QString Byte20;
        QString Byte21;
        QString Byte22;
        QString Byte23;
        QString Byte24;
        QString Byte25;
        QString Byte26;
        QString Byte27;
        QString Byte28;
        QString Byte29;
        QString Byte30;
        QString Byte31;
        QString Byte32;

        if (XRACcmd) // erwarteter Byte-String aus XRAC X_1 Anforderung
        {
            QString NODEtext = str.mid(5, 2);
            qDebug() << "rXRAC NODEtext" << NODEtext;
            QString CMDtext = str.mid(15, 2);
            QString FUItext = str.mid(17, 2);
            QString cmd = str.left(18); //

            if (str.size() > 18) {
                int i = 19;
                do {
                    if (i < 21)
                        Byte1 = str.mid(i, 2);
                    else if (i < 23)
                        Byte2 = str.mid(i, 2);
                    else if (i < 25)
                        Byte3 = str.mid(i, 2);
                    else if (i < 8)
                        Byte4 = str.mid(i, 2);
                    else if (i < 10)
                        Byte5 = str.mid(i, 2);
                    else if (i < 12)
                        Byte6 = str.mid(i, 2);
                    else if (i < 14)
                        Byte7 = str.mid(i, 2);
                    else if (i < 16)
                        Byte8 = str.mid(i, 2);
                    else if (i < 18)
                        Byte9 = str.mid(i, 2);
                    else if (i < 20)
                        Byte10 = str.mid(i, 2);
                    else if (i < 22)
                        Byte11 = str.mid(i, 2);
                    else if (i < 24)
                        Byte12 = str.mid(i, 2);
                    else if (i < 26)
                        Byte13 = str.mid(i, 2);
                    else if (i < 28)
                        Byte14 = str.mid(i, 2);
                    else if (i < 30)
                        Byte15 = str.mid(i, 2);
                    else if (i < 32)
                        Byte16 = str.mid(i, 2);
                    else if (i < 36)
                        Byte17 = str.mid(i, 2);
                    else if (i < 38)
                        Byte18 = str.mid(i, 2);
                    else if (i < 40)
                        Byte19 = str.mid(i, 2);
                    else if (i < 42)
                        Byte20 = str.mid(i, 2);
                    else if (i < 44)
                        Byte21 = str.mid(i, 2);
                    else if (i < 46)
                        Byte22 = str.mid(i, 2);
                    else if (i < 50)
                        Byte23 = str.mid(i, 2);
                    else if (i < 52)
                        Byte24 = str.mid(i, 2);
                    else if (i < 54)
                        Byte25 = str.mid(i, 2);
                    else if (i < 56)
                        Byte26 = str.mid(i, 2);
                    else if (i < 58)
                        Byte27 = str.mid(i, 2);
                    else if (i < 60)
                        Byte28 = str.mid(i, 2);
                    else if (i < 62)
                        Byte29 = str.mid(i, 2);
                    else if (i < 64)
                        Byte30 = str.mid(i, 2);
                    else if (i < 66)
                        Byte31 = str.mid(i, 2);
                    else if (i < 68)
                        Byte32 = str.mid(i, 2);
                    i += 2;
                } while (str.size() > i);
                qDebug() << "rXRAC Byte1 a" << Byte1;
            }

            if (str.size() > 18) {
                data = str.mid(19, str.indexOf('\r')); // Datenstring
                qDebug() << "data " << data;
                Byte1 = str.mid(19, 2);
                if (str.size() > 20)
                    Byte2 = str.mid(21, 2);
                else
                    Byte2.clear();
                if (str.size() > 22)
                    Byte3 = str.mid(23, 2);
                else
                    Byte3.clear();
                if (str.size() > 24)
                    Byte4 = str.mid(25, 2);
                else
                    Byte4.clear();
                if (str.size() > 26)
                    Byte5 = str.mid(27, 2);
                else
                    Byte5.clear();
                if (str.size() > 28)
                    Byte6 = str.mid(29, 2);
                else
                    Byte6.clear();
                if (str.size() > 30)
                    Byte7 = str.mid(31, 2);
                else
                    Byte7.clear();
                if (str.size() > 32)
                    Byte8 = str.mid(33, 2);
                else
                    Byte8.clear();
                if (str.size() > 34)
                    Byte9 = str.mid(35, 2);
                else
                    Byte9.clear();
                if (str.size() > 36)
                    Byte10 = str.mid(37, 2);
                else
                    Byte10.clear();
                if (str.size() > 38)
                    Byte11 = str.mid(39, 2);
                else
                    Byte11.clear();
                if (str.size() > 40)
                    Byte12 = str.mid(41, 2);
                else
                    Byte12.clear();
                if (str.size() > 42)
                    Byte13 = str.mid(43, 2);
                else
                    Byte13.clear();
                if (str.size() > 44)
                    Byte14 = str.mid(45, 2);
                else
                    Byte14.clear();
                if (str.size() > 46)
                    Byte15 = str.mid(47, 2);
                else
                    Byte15.clear();
                if (str.size() > 48)
                    Byte16 = str.mid(49, 2);
                else
                    Byte16.clear();
                if (str.size() > 50)
                    Byte17 = str.mid(51, 2);
                else
                    Byte17.clear();
                if (str.size() > 52)
                    Byte18 = str.mid(53, 2);
                else
                    Byte18.clear();
                if (str.size() > 54)
                    Byte19 = str.mid(55, 2);
                else
                    Byte19.clear();
                if (str.size() > 56)
                    Byte20 = str.mid(57, 2);
                else
                    Byte20.clear();
                if (str.size() > 58)
                    Byte21 = str.mid(59, 2);
                else
                    Byte21.clear();
                if (str.size() > 60)
                    Byte22 = str.mid(61, 2);
                else
                    Byte22.clear();
                if (str.size() > 62)
                    Byte23 = str.mid(63, 2);
                else
                    Byte23.clear();
                if (str.size() > 64)
                    Byte24 = str.mid(65, 2);
                else
                    Byte24.clear();
                if (str.size() > 66)
                    Byte25 = str.mid(67, 2);
                else
                    Byte25.clear();
                if (str.size() > 68)
                    Byte26 = str.mid(69, 2);
                else
                    Byte26.clear();
                if (str.size() > 70)
                    Byte27 = str.mid(71, 2);
                else
                    Byte27.clear();
                if (str.size() > 72)
                    Byte28 = str.mid(73, 2);
                else
                    Byte28.clear();
                if (str.size() > 74)
                    Byte29 = str.mid(75, 2);
                else
                    Byte29.clear();
                if (str.size() > 76)
                    Byte30 = str.mid(77, 2);
                else
                    Byte30.clear();
                if (str.size() > 78)
                    Byte31 = str.mid(79, 2);
                else
                    Byte31.clear();
                if (str.size() > 80)
                    Byte32 = str.mid(81, 2);
                else
                    Byte32.clear();
                qDebug() << "rXRAC Byte1 b" << Byte1;

                for (int i = 0; i < (cmd.mid(1, 2).toInt(&ok, 16)) * 2;
                     i += 2) // Länge der Antwort im ersten Byte hexcodiert
                {
                    if (i == 0)
                        ui->line_data1_2->setText(Byte1);
                    else if (i == 0)
                        ui->line_data2_2->setText(Byte2);
                    else if (i == 0)
                        ui->line_data3_2->setText(Byte3);
                    else if (i == 0)
                        ui->line_data4_2->setText(Byte4);
                    else if (i == 0)
                        ui->line_data5_2->setText(Byte5);
                    else if (i == 0)
                        ui->line_data6_2->setText(Byte6);
                    else if (i == 0)
                        ui->line_data7_2->setText(Byte7);
                    else if (i == 0)
                        ui->line_data8_2->setText(Byte8);
                }

                datastr.append("data " + Byte1 + " " + Byte2 + " " + Byte3 + " " +
                               Byte4 + " " + Byte5 + " " + Byte6 + " " + Byte7 + " " +
                               Byte8 + " " + Byte9 + " " + Byte10 + " " + Byte11 + " " +
                               Byte12 + " " + Byte13 + " " + Byte14 + " " + Byte15 +
                               " " + Byte16 + " " + Byte17 + " " + Byte18 + " " +
                               Byte19 + " " + Byte20 + " " + Byte21 + " " + Byte22 +
                               " " + Byte23 + " " + Byte24 + " " + Byte25 + " " +
                               Byte26 + " " + Byte27 + " " + Byte28 + " " + Byte29 +
                               " " + Byte30 + " " + Byte31 + " " + Byte32);
            }
            else datastr.append("--");

            /* BitBus-CMD Bytes in das Widget XCMD einordnen */
            ui->line_rctl->setText("--");
            ui->line_len->setText(cmd.mid(1, 2));
            ui->line_flag->setText(cmd.mid(3, 2));
            ui->line_node->setText(cmd.mid(5, 2));
            ui->line_task->setText(cmd.mid(7, 2));
            ui->line_x1->setText(cmd.mid(9, 2));
            ui->line_x2->setText(cmd.mid(11, 2));
            ui->line_x3->setText(cmd.mid(13, 2));

            Rtext = decodeRespHex(CMDtext);

            ui->line_R->setText(Rtext);
            Ftext = decodeFUIhex(FUItext);

            ui->line_FUI->setText(Ftext);

            cmdstr.append(/*"len "+cmd.mid(1,2)+*/ "#" + cmd.mid(13, 2) + ": N" + NODEtext + " " + Rtext + " " + Ftext);

            ui->plainTextEdit_data_XRAC->appendPlainText(cmdstr);
            ui->plainTextEdit_data_XRAC->appendPlainText(datastr);

            logout << cmdstr.append(" ");
            logout << datastr.append('\n');

            /* Datenbytes aus Parameterset 1 in Widget Motor einordnen */
            qDebug() << "rXRAC str.mid(15,2).toInt(&ok,16)"<< str.mid(15, 2).toInt(&ok, 16);

            if (NODEtext == "4" && CMDtext == "34" &&
                    FUItext == "2") // Response Position PA PHI Motor ( 4Bytes )
            {
                int val = Byte1.toInt(&ok, 16) * 256 * 256 * 256 +
                        Byte2.toInt(&ok, 16) * 256 * 256 +
                        Byte3.toInt(&ok, 10) * 256 + Byte4.toInt(&ok, 10);
                float enc = ui->line_preacount->text().toFloat();
                float angle = 360 / enc * val;
                qDebug() << val << " - " << enc;
                ui->line_align_getpos_degree->setText(QString::number(angle));
                ui->line_align_getpos->setText(QString::number(val));
            } else if (XRACmot == 1 && data.left(2).toUInt(&ok, 16) == 1 &&
                       str.mid(15, 2).toInt(&ok, 16) ==
                       38) // Response MotorParameter Teil 1
            {
                // Motor1: Lift2Height(Node
                // 2);Lift1Height(3);PARotPos(4);Loader-X(5);Stage-X(6) Motor2:
                // Lift2Tilt(2);Lift1Tilt(3);PA-Phi(4);Loader-Y(5);Stage-Y(6) Motor3:
                // PA-Height(3);PA-Tilt(4);WC-Height(5);WC-PHI(6)

                qDebug() << "dataset 1" << data.left(2).toUInt(&ok, 16);

                uint val1 = data.mid(4, 2).toUInt(&ok, 16) * 256 * 256 * 256 +
                        data.mid(6, 2).toUInt(&ok, 16) * 256 * 256 +
                        data.mid(8, 2).toUInt(&ok, 16) * 256 +
                        data.mid(10, 2).toUInt(&ok, 16); // Vel full
                uint val2 = data.mid(12, 2).toUInt(&ok, 16) * 256 +
                        data.mid(14, 2).toUInt(&ok, 16); // Acc full
                uint val3 = data.mid(16, 2).toUInt(&ok, 16);    // current full
                uint val4 = data.mid(18, 2).toUInt(&ok, 16) * 256 * 256 * 256 +
                        data.mid(20, 2).toUInt(&ok, 16) * 256 * 256 +
                        data.mid(22, 2).toUInt(&ok, 16) * 256 +
                        data.mid(24, 2).toUInt(&ok, 16); // Vel empty
                uint val5 = data.mid(26, 2).toUInt(&ok, 16) * 256 +
                        data.mid(28, 2).toUInt(&ok, 16); // Acc empty
                uint val6 = data.mid(30, 2).toUInt(&ok, 16);
                uint val7 = data.mid(32, 2).toUInt(&ok, 16) * 256 * 256 * 256 +
                        data.mid(34, 2).toUInt(&ok, 16) * 256 * 256 +
                        data.mid(36, 2).toUInt(&ok, 16) * 256 +
                        data.mid(38, 2).toUInt(&ok, 16); // Vel move
                uint val8 = data.mid(40, 2).toUInt(&ok, 16) * 256 +
                        data.mid(42, 2).toUInt(&ok, 16); // Acc move
                uint val9 = data.mid(44, 2).toUInt(&ok, 16);
                uint val10 = data.mid(46, 2).toUInt(&ok, 16) * 256 * 256 * 256 +
                        data.mid(48, 2).toUInt(&ok, 16) * 256 * 256 +
                        data.mid(50, 2).toUInt(&ok, 16) * 256 +
                        data.mid(52, 2).toUInt(&ok, 16); // Vel init
                uint val11 = data.mid(54, 2).toUInt(&ok, 16) * 256 +
                        data.mid(56, 2).toInt(&ok, 16); // Acc init
                uint val12 = data.mid(58, 2).toUInt(&ok, 16);
                uint val13 = data.mid(60, 2).toUInt(&ok, 16) * 256 +
                        data.mid(62, 2).toUInt(&ok, 16); // fast decelleration
                ui->line_velofull_2->setText(QString::number(val1 / 1000));
                ui->line_accelfull_2->setText(QString::number(val2));
                ui->line_currfull_2->setText(QString::number(val3));
                ui->line_veloempty_2->setText(QString::number(val4 / 1000));
                ui->line_accelempty_2->setText(QString::number(val5));
                ui->line_currempty_2->setText(QString::number(val6));
                ui->line_velomove_2->setText(QString::number(val7 / 1000));
                ui->line_accelmove_2->setText(QString::number(val8));
                ui->line_currmove_2->setText(QString::number(val9));
                ui->line_veloinit_2->setText(QString::number(val10 / 1000));
                ui->line_accelinit_2->setText(QString::number(val11));
                ui->line_currinit_2->setText(QString::number(val12));
                ui->line_fastdecel_2->setText(QString::number(val13));

                on_push_mot_readrac_2_clicked(); // Parameterset 2 holen
            } else if (XRACmot == 1 && data.left(2).toUInt(&ok, 16) == 2 &&
                       str.mid(15, 2).toInt(&ok, 16) ==
                       38) // Response MotorParameter Teil 2
            {
                qDebug() << "dataset 2" << data.left(2).toUInt(&ok, 16);

                uint val1 = data.mid(2, 2).toUInt(&ok, 16); // low current
                uint val2 = data.mid(4, 2).toUInt(&ok, 16); // curr delay
                uint val3 = data.mid(6, 2).toUInt(&ok, 16) * 256 +
                        data.mid(8, 2).toUInt(&ok, 16); // motor resolution
                //     qDebug()<<data.mid(10,2).toUInt(&ok,16)*256<<","<<data.mid(12,2).toUInt(&ok,16)<<","<<val3;
                uint val4 = data.mid(10, 2).toUInt(&ok, 16) * 256 +
                        data.mid(12, 2).toUInt(&ok, 16); // encoder resolution
                uint val5 = data.mid(14, 2).toUInt(&ok, 16); // Gear 1
                uint val6 = data.mid(16, 2).toUInt(&ok, 16); // Gear 2
                int val7 = data.mid(18, 2).toInt(&ok, 16) * 256 * 256 * 256 +
                        data.mid(20, 2).toInt(&ok, 16) * 256 * 256 +
                        data.mid(22, 2).toInt(&ok, 16) * 256 +
                        data.mid(24, 2).toInt(&ok, 16); // lower limit
                int val8 = data.mid(26, 2).toInt(&ok, 16) * 256 * 256 * 256 +
                        data.mid(28, 2).toInt(&ok, 16) * 256 * 256 +
                        data.mid(30, 2).toInt(&ok, 16) * 256 +
                        data.mid(32, 2).toUInt(&ok, 16);  // upper limit
                uint val9 = data.mid(34, 2).toUInt(&ok, 16); // Active sensors byte 2-5
                int val91 = (val9 & 4) >> 2;
                int val92 = (val9 & 8) >> 3;
                int val93 = (val9 & 16) >> 4;
                //                 int val94 = (val9 & 32) >> 5;
                //    qDebug()<<"val9"<<val91<<","<<val92<<","<<val93<<","<<val94;
                int val10 =
                        data.mid(36, 2).toUInt(&ok, 16) & 56; // Sensor polarity byte 3-5
                float val11 = data.mid(38, 2).toInt(&ok, 16) * 256 * 256 * 256 +
                        data.mid(40, 2).toInt(&ok, 16) * 256 * 256 +
                        data.mid(42, 2).toInt(&ok, 16) * 256 +
                        data.mid(44, 2).toInt(&ok, 16); // Initdistance
                qDebug() << "data.mid(38,2)"
                         << data.mid(38, 2).toInt(&ok, 16) * 256 * 256 * 256;
                qDebug() << "data.mid(40,2)"
                         << data.mid(40, 2).toInt(&ok, 16) * 256 * 256;
                qDebug() << "data.mid(42,2)" << data.mid(42, 2).toInt(&ok, 16) * 256;
                qDebug() << "data.mid(44,2)" << data.mid(44, 2).toInt(&ok, 16);
                qDebug() << "val11-steps" << val11;
                val11 = val11 / (ui->line_resolution->text().toFloat());
                qDebug() << "val11-mm" << val11;
                int val12 = data.mid(46, 2).toInt(&ok, 16); // Motionconfig
                int val121 = val12 & 1;                     // Encoder used
                int val122 = (val12 & 2) >> 1;              // Interpolator used
                int val123 = (val12 & 4) >> 2;              // Encoder on motor end
                int val124 = (val12 & 8) >> 3;   // Check encoder against motorsteps
                int val125 = (val12 & 16) >> 4;  // Use closed loop
                int val126 = (val12 & 32) >> 5;  // Init by moving
                int val127 = (val12 & 64) >> 6;  // Check Positionvalues
                int val128 = (val12 & 128) >> 7; // Check Motor Voltage
                qDebug() << "val12" << val121 << "," << val122 << "," << val123 << ","
                         << val124 << "," << val125 << "," << val126 << "," << val127
                         << "," << val128;
                int val13 =
                        data.mid(48, 2).toInt(&ok, 16); // Position error - max deviation
                int val14 = data.mid(50, 2).toInt(&ok, 16); // Position retrycount
                int val15 = data.mid(52, 2).toInt(&ok, 16); // Position delay
                int val17 = data.mid(56, 2).toInt(&ok, 16); // Liner correction 0.01 %
                int val18 = data.mid(58, 2).toInt(&ok, 16); // Ramptype

                ui->line_stdbycurr_2->setText(QString::number(val1));
                ui->line_currrisetime_2->setText(QString::number(val2));
                ui->line_motresolution_2->setText(QString::number(val3)); // motor resolution
                ui->line_encresolution_2->setText(QString::number(val4));  // encoder resolution
                ui->line_gear1_2->setText(QString::number(val5)); // Gear 1
                ui->line_gear2_2->setText(QString::number(val6)); // Gear 2
                ui->line_lowsoftlimit_2->setText(QString::number(val7)); // lower limit
                ui->line_upsoftlimit_2->setText(QString::number(val8));  // upper limit
                ui->check_usesoftlimit_2->setChecked(val91); // Use software limits
                ui->check_uselowsensor_2->setChecked(val92); // Use lower limit sensor
                ui->check_useupsensor_2->setChecked(val93);  // Use upper limit sensor
                ui->line_senspolar_2->setText(QString::number(val10)); // senor polarities
                ui->line_initdistance_2->setText(QString::number(val11));                  // Initdistance
                ui->check_posencoder_2->setChecked(val121);   // Encoder used
                ui->check_interpolator_2->setChecked(val122); // Interpolator used
                ui->check_enconmotor_2->setChecked(val123);   // Encoder on motor end
                ui->check_stopatmaxdev_2->setChecked(val124); // Check encoder against motorsteps - stop at max deviation
                ui->check_closedloop_2->setChecked(val125);   // Use closed loop
                ui->check_initbymove_2->setChecked(val126);   // Init by moving
                ui->check_checkpos_2->setChecked(val127);     // Check Positionvalues
                ui->check_checkmotvolt_2->setChecked(val128); // Check Motor Voltage
                ui->line_maxdeviation_2->setText(QString::number(val13)); // max Deviation
                ui->line_posretrycount_2->setText(QString::number(val14));                          // retry count
                ui->line_posdelay_2->setText(QString::number(val15)); // position delay
                ui->line_lincorr_2->setText(QString::number(val17));  // linear corr
                ui->line_ramptype_2->setText(QString::number(val18)); // Ramptype
                if (ui->frame_motor_friction_maxdev_2->isHidden() == FALSE) serialSendFeeder("$GET_29=0\r\n");
                XRACcmd = 0;
                XRACmot = 0;
            }
        }
    }
    else if (str.left(6) == QString(rSMIF).left(6)) // INSBox Response &SMIF_ bei Timeout oder Fehler (Daten werden über Log !R_ übermittelt)
    {
        qDebug() << "SMIF_Resp" << hexjob;
    }

    if (errlogwait && getAVoper == 0 && waitlog == 0)
    {
        qDebug() << "f_receiveSVC errlogwait" << errlogwait;
        errlogwait = 0;
        r_logon = 1;
        serialSendFeeder(senddata);
    }
    else if (r_logon && tmpstat == 0 && waitlog == 0)
    {
        qDebug() << "f_receiveSVC r_logon" << r_logon << "cmdfeeder" << cmdfeeder;
        r_logon = 0;
        logswitch(1);
    }
}
void MainWindow::f_setVAClabels(int channel) {
    switch (channel) {
    case 10: // LD OFF
        ui->check_loader_vacuum->setChecked(0);
        ui->check_loader_vacuum->setStyleSheet(backLightGrey);
        ui->check_vac_loader_2->setChecked(0);
        ui->check_vac_loader_2->setStyleSheet(backLightGrey);
        ui->check_vac_loader_4->setChecked(0);
        ui->check_vac_loader_4->setStyleSheet(backLightGrey);
        break;
    case 11: // LD ON
        ui->check_loader_vacuum->setChecked(1);
        ui->check_loader_vacuum->setStyleSheet(backLightGreen);
        ui->check_vac_loader_2->setChecked(1);
        ui->check_vac_loader_2->setStyleSheet(backLightGreen);
        ui->check_vac_loader_4->setChecked(1);
        ui->check_vac_loader_4->setStyleSheet(backLightGreen);
        break;
    case 12: // LD Timeout
        ui->check_loader_vacuum->setChecked(1);
        ui->check_loader_vacuum->setStyleSheet(backLightGrey);
        ui->check_vac_loader_2->setChecked(1);
        ui->check_vac_loader_2->setStyleSheet(backLightGrey);
        ui->check_vac_loader_4->setChecked(1);
        ui->check_vac_loader_4->setStyleSheet(backLightGrey);
        break;
    case 20: // PA OFF
        ui->label_pavac->setStyleSheet(backLightGrey);
        ui->check_vac_aligner_2->setChecked(0);
        ui->check_vac_aligner_2->setStyleSheet(backLightGrey);
        ui->check_vac_aligner_4->setChecked(0);
        ui->check_vac_aligner_4->setStyleSheet(backLightGrey);
        ui->check_preavac_2->setChecked(0);
        ui->check_preavac_2->setStyleSheet(backLightGrey);
        ui->check_preavac->setChecked(0);
        ui->check_preavac->setStyleSheet(backLightGrey);
        break;
    case 21: // PA ON
        ui->label_pavac->setStyleSheet(backLightGreen);
        ui->check_vac_aligner_2->setChecked(1);
        ui->check_vac_aligner_2->setStyleSheet(backLightGreen);
        ui->check_vac_aligner_4->setChecked(1);
        ui->check_vac_aligner_4->setStyleSheet(backLightGreen);
        ui->check_preavac_2->setChecked(1);
        ui->check_preavac_2->setStyleSheet(backLightGreen);
        ui->check_preavac->setChecked(1);
        ui->check_preavac->setStyleSheet(backLightGreen);
        break;
    case 22: // PA Timeout
        ui->label_pavac->setStyleSheet(backLightYello);
        ui->check_vac_aligner_2->setChecked(1);
        ui->check_vac_aligner_2->setStyleSheet(backLightGrey);
        ui->check_vac_aligner_4->setChecked(1);
        ui->check_vac_aligner_4->setStyleSheet(backLightGrey);
        ui->check_preavac_2->setChecked(1);
        ui->check_preavac_2->setStyleSheet(backLightGrey);
        ui->check_preavac->setChecked(1);
        ui->check_preavac->setStyleSheet(backLightGrey);
        break;
    case 30: // WC left OFF
        ui->check_vac_wcleft_2->setChecked(0);
        ui->check_vac_wcleft_2->setStyleSheet(backLightGrey);
        ui->check_vac_wcleft_4->setChecked(0);
        ui->check_vac_wcleft_4->setStyleSheet(backLightGrey);
        ui->check_wc_vacuumleft->setChecked(0);
        ui->check_wc_vacuumleft->setStyleSheet(backLightGrey);
        break;
    case 31: // WC left ON
        ui->check_vac_wcleft_2->setChecked(1);
        ui->check_vac_wcleft_2->setStyleSheet(backLightGreen);
        ui->check_vac_wcleft_4->setChecked(1);
        ui->check_vac_wcleft_4->setStyleSheet(backLightGreen);
        ui->check_wc_vacuumleft->setChecked(1);
        ui->check_wc_vacuumleft->setStyleSheet(backLightGreen);
        break;
    case 32: // WC left Timeout
        ui->check_vac_wcleft_2->setChecked(1);
        ui->check_vac_wcleft_2->setStyleSheet(backLightGrey);
        ui->check_vac_wcleft_4->setChecked(1);
        ui->check_vac_wcleft_4->setStyleSheet(backLightGrey);
        ui->check_wc_vacuumleft->setChecked(1);
        ui->check_wc_vacuumleft->setStyleSheet(backLightGrey);
        break;
    case 40: // WC right OFF
        ui->check_vac_wcright_2->setChecked(0);
        ui->check_vac_wcright_2->setStyleSheet(backLightGrey);
        ui->check_vac_wcright_4->setChecked(0);
        ui->check_vac_wcright_4->setStyleSheet(backLightGrey);
        ui->check_wc_vacuumright->setChecked(0);
        ui->check_wc_vacuumright->setStyleSheet(backLightGrey);
        break;
    case 41: // WC right ON
        ui->check_vac_wcright_2->setChecked(1);
        ui->check_vac_wcright_2->setStyleSheet(backLightGreen);
        ui->check_vac_wcright_4->setChecked(1);
        ui->check_vac_wcright_4->setStyleSheet(backLightGreen);
        ui->check_wc_vacuumright->setChecked(1);
        ui->check_wc_vacuumright->setStyleSheet(backLightGreen);
        break;
    case 42: // WC right Timeout
        ui->check_vac_wcright_2->setChecked(1);
        ui->check_vac_wcright_2->setStyleSheet(backLightGrey);
        ui->check_vac_wcright_4->setChecked(1);
        ui->check_vac_wcright_4->setStyleSheet(backLightGrey);
        ui->check_wc_vacuumright->setChecked(1);
        ui->check_wc_vacuumright->setStyleSheet(backLightGrey);
        break;
    case 50: // Chuck4 OFF
        ui->check_vac_chuck4_2->setChecked(0);
        ui->check_vac_chuck4_2->setStyleSheet(backLightGrey);
        ui->check_vac_chuck4_4->setChecked(0);
        ui->check_vac_chuck4_4->setStyleSheet(backLightGrey);
        ui->check_wc_vacuumchuck->setChecked(0);
        ui->check_wc_vacuumchuck->setStyleSheet(backLightGrey);
        break;
    case 51: // Chuck4 ON
        ui->check_vac_chuck4_2->setChecked(1);
        ui->check_vac_chuck4_2->setStyleSheet(backLightGreen);
        ui->check_vac_chuck4_4->setChecked(1);
        ui->check_vac_chuck4_4->setStyleSheet(backLightGreen);
        ui->check_wc_vacuumchuck->setChecked(1);
        ui->check_wc_vacuumchuck->setStyleSheet(backLightGreen);
        break;
    case 52: // Chuck4 Timeout
        ui->check_vac_chuck4_2->setChecked(1);
        ui->check_vac_chuck4_2->setStyleSheet(backLightGrey);
        ui->check_wc_vacuumchuck->setChecked(1);
        ui->check_wc_vacuumchuck->setStyleSheet(backLightGrey);
        break;
    case 60: // Chuck6 OFF
        if (CheckCH6vac) {
            ui->check_vac_chuck6_2->setChecked(1);
            ui->check_vac_chuck6_4->setChecked(1);
        } else {
            ui->check_vac_chuck6_2->setChecked(0);
            ui->check_vac_chuck6_4->setChecked(0);
        }
        ui->check_vac_chuck6_2->setStyleSheet(backLightGrey);
        ui->check_vac_chuck6_4->setStyleSheet(backLightGrey);
        break;
    case 61: // Chuck6 ON
        ui->check_vac_chuck6_2->setChecked(1);
        ui->check_vac_chuck6_2->setStyleSheet(backLightGreen);
        ui->check_vac_chuck6_4->setChecked(1);
        ui->check_vac_chuck6_4->setStyleSheet(backLightGreen);
        break;
    case 70: // Chuck8 OFF
        if (CheckCH8vac) {
            ui->check_vac_chuck8_2->setChecked(1);
            ui->check_vac_chuck8_4->setChecked(1);
        } else {
            ui->check_vac_chuck8_2->setChecked(0);
            ui->check_vac_chuck8_4->setChecked(0);
        }
        ui->check_vac_chuck8_2->setStyleSheet(backLightGrey);
        ui->check_vac_chuck8_4->setStyleSheet(backLightGrey);
        break;
    case 71: // Chuck8 ON
        ui->check_vac_chuck8_2->setChecked(1);
        ui->check_vac_chuck8_2->setStyleSheet(backLightGreen);
        ui->check_vac_chuck8_4->setChecked(1);
        ui->check_vac_chuck8_4->setStyleSheet(backLightGreen);
        break;
    default:
        break;
    }
}
void MainWindow::f_setRESlabels(int axis) {
    switch (axis) {
    case 0:
        ui->label_res_LDY->setStyleSheet(backLightGreen);
        ui->p_loader_initydrive->setStyleSheet(backLightGreen);
        ui->label_res_LDX->setStyleSheet(backLightGreen);
        ui->p_loader_initxdrive->setStyleSheet(backLightGreen);
        if (ui->check_lift1_deactivate->isChecked()) {
            ui->label_res_L1H->setStyleSheet(backLightGreen);
            ui->push_lift1_init_height->setStyleSheet(backLightGreen);
        }
        if (ui->check_lift2_deactivate->isChecked()) {
            ui->label_res_L2H->setStyleSheet(backLightGreen);
            ui->p_lift2_init_height->setStyleSheet(backLightGreen);
        }
        ui->label_resWCH->setStyleSheet(backLightGreen);
        ui->p_wc_initheight->setStyleSheet(backLightGreen);
        ui->label_WCP->setStyleSheet(backLightGreen);
        ui->p_wc_initangle->setStyleSheet(backLightGreen);
        if (ui->check_wob_deactiv->isChecked()) {
            ui->label_resPAT->setStyleSheet(backLightGreen);
            ui->p_INIT_PA_Tilt->setStyleSheet(backLightGreen);
            ui->label_resPAR->setStyleSheet(backLightGreen);
            ui->p_INIT_PA_RotPos->setStyleSheet(backLightGreen);
        }
        ui->label_res_PAH->setStyleSheet(backLightGreen);
        ui->p_INIT_PA_Height->setStyleSheet(backLightGreen);
        ui->label_resPAP->setStyleSheet(backLightGreen);
        ui->p_INIT_PA_Phi->setStyleSheet(backLightGreen);
        if (ui->check_tilt1_deactivate->isChecked()) {
            ui->label_res_L1T->setStyleSheet(backLightGreen);
            ui->push_lift1_init_tilt->setStyleSheet(backLightGreen);
        }
        if (ui->check_tilt2_deactivate->isChecked()) {
            ui->label_res_L2T->setStyleSheet(backLightGreen);
            ui->p_lift2_init_tilt->setStyleSheet(backLightGreen);
        }
        break;
    default:
        break;
    }
}
void MainWindow::f_receiveLOG(QByteArray str) {
    QString data;
    QString counter;
    int tmpdata;

    data = str.mid(str.indexOf("/") + 1, str.indexOf("\r") - str.indexOf("/") - 1);
    counter = str.mid(str.indexOf("/") + 1, str.indexOf("\r") - str.indexOf(",") - 1);
    tmpdata = str.mid(str.indexOf(":") + 1, str.indexOf("\r") - str.indexOf(":") - 1).toInt(&ok, 10); // daten als dezimalzahl

    if (str.left(3) == QString(rlogwarn)) // !W_
    {
        ui->plainTextEdit_LOGwarn->appendPlainText(str.trimmed());
        int fblock;  // Funktionsblock
        int cmd;     // CMD
        int cmdid;   // ID
        int nr;      // fehlernummer
        int counter; // Fehlercounter

        auto parts =
                str.mid(str.indexOf("_") + 1, str.indexOf("\r") - str.indexOf("_") - 1)
                .split(','); // Fehlercodierung durch Komma getrennt
        qDebug() << "parts" << parts;
        if (parts.count() >= 4) {
            logout
                    << parts[0] << " " << parts[1] << " " << parts[2] << " " << parts[3]
                       << " "
                       << parts[4].append(
                              '\n'); // Funktionsblock, CMD, ID, Fehlernummer, Fehlercounter
            fblock = parts[0].toInt(&ok, 16);
            cmd = parts[1].toInt(&ok, 16);
            cmdid = parts[2].toInt(&ok, 16);
            nr = parts[3].trimmed().toInt(&ok, 16);
            counter = parts[4].trimmed().toInt(&ok, 16);
            QString counterstr = QString::number(counter);
            f_decodeWarnlog(fblock, cmd, cmdid, nr, counterstr);
        }
    } else if (str.left(2) == QString("//")) // "//"
    {
        QString temp = str.mid(2, str.indexOf("\r")).trimmed();
        auto parts = temp.split(','); // Fehlercodierung durch Komma getrennt
        qDebug() << "parts"
                 << parts; // MSPF.mcount,MSPF.pcount,RESPF.mcount,RESPF.pcount

        if (parts.count() >= 4) {
            ui->line_mspf_mcnt->setText(parts[0]);
            ui->line_mspf_pcnt->setText(parts[1]);
            ui->line_respf_mcnt->setText(parts[2]);
            ui->line_respf_pcnt->setText(parts[3]);
        }
    } else if (str.left(1) == QString("/")) // "/"
    {
        auto parts =
                str.mid(str.indexOf("/") + 1, str.indexOf("\r") - str.indexOf("/") - 1)
                .split(','); // Fehlercodierung durch Komma getrennt
        //    qDebug()<<"parts"<<parts;
        // qDebug()<<"RACErrCode[tmpdata]"<<RACErrCode[tmpdata];
        if (parts.count() >= 7) {
            int fnr_send = parts[0].toInt(&ok, 16);
            int fnr_mess = parts[1].toInt(&ok, 16);
            int fnr_poll = parts[2].toInt(&ok, 16);
            int fnr_cycle = parts[3].toInt(&ok, 16);
            int fnr_feeder = parts[4].toInt(&ok, 16);
            int fnr_main = parts[5].toInt(&ok, 16);
            int fnr_udval = parts[6].toInt(&ok, 16);
            int fnr_node = parts[7].toInt(&ok, 16);

            ui->plainTextEdit_LOG_debug->appendPlainText(
                        QTime::currentTime().toString("hh:mm:ss.zzz' '"));
            ui->plainTextEdit_LOG_debug->insertPlainText(EC_sendfrm[fnr_send]);
            ui->plainTextEdit_LOG_debug->insertPlainText("-");
            ui->plainTextEdit_LOG_debug->insertPlainText(EC_racmess[fnr_mess]);
            ui->plainTextEdit_LOG_debug->insertPlainText("-");
            ui->plainTextEdit_LOG_debug->insertPlainText(EC_racpoll[fnr_poll]);
            ui->plainTextEdit_LOG_debug->insertPlainText("-");
            ui->plainTextEdit_LOG_debug->insertPlainText(EC_feedercycle[fnr_cycle]);
            ui->plainTextEdit_LOG_debug->insertPlainText("-");
            ui->plainTextEdit_LOG_debug->insertPlainText(EC_feeder[fnr_feeder]);
            ui->plainTextEdit_LOG_debug->insertPlainText("-");
            ui->plainTextEdit_LOG_debug->insertPlainText(EC_main[fnr_main]);
            ui->plainTextEdit_LOG_debug->insertPlainText("-");
            ui->plainTextEdit_LOG_debug->insertPlainText(EC_main[fnr_udval]);
            ui->plainTextEdit_LOG_debug->insertPlainText("-");
            ui->plainTextEdit_LOG_debug->insertPlainText(EC_main[fnr_node]);
        }
    }

    if (errlogwait) {
        qDebug() << "f_receiveLOG errlogwait" << errlogwait;
        errlogwait = 0;
        r_logon = 1;
        serialSendFeeder(senddata);
    } else if (r_logon) {
        qDebug() << "f_receiveLOG r_logon" << r_logon;
        r_logon = 0;
        logswitch(1);
    }
}
void MainWindow::f_decodeWarnlog(int block, int cmd, int id, int fehlernr, QString count)
{
    QString strblock; // Funktionsblock
    QString strcmd;   // CMD
    QString strcmdid; // ID
    QString strnr;    // fehlernummer

    qDebug() << "block" << block << "cmd" << cmd << "id" << id << "fehlernr"<< fehlernr;

    switch (block) {
    case 1: // RAC
        strblock = "RAC";
        break;
        //        case 2:     // Sequenz
        //            strblock = "Seq.";
        //        break;
    case 2: // TWI
        strblock = "TWI";
        break;
    case 9: // main()
        strblock = "main()";
        break;
    }
    switch (cmd) {
    case 0:
        strcmd = "muXCMD";
        break;
    case 1:
        strcmd = "muL1";
        break;
    case 2:
        strcmd = "muL2";
        break;
    case 3:
        strcmd = "TWI_fails";
        break;
    case 5:
        strcmd = "muLD";
        break;
    case 6:
        strcmd = "muPA";
        break;
    case 7:
        strcmd = "muWC";
        break;
    case 8:
        strcmd = "muCH";
        break;
    case 9:
        strcmd = "muSYST";
        break;
    }
    switch (id)
    {
    case 1:
        if (cmd == 0) strcmdid = "0";
        else if (cmd == 1) strcmdid = "L1CASS";
        else if (cmd == 2) strcmdid = "L2CASS";
        else if (cmd == 5) strcmdid = "LDX";
        else if (cmd == 6) strcmdid = "PAH";
        else if (cmd == 7) strcmdid = "WCH";
        else if (cmd == 8) strcmdid = "CH4VAC";
        else if (cmd == 9) strcmdid = "MAINVAC";
        else if (cmd == 3) strcmdid = "TWI";
        break;
    case 2:
        if (cmd == 0) strcmdid = "0";
        else if (cmd == 1) strcmdid = "L1LOCK";
        else if (cmd == 2) strcmdid = "L2LOCK";
        else if (cmd == 5) strcmdid = "LDY";
        else if (cmd == 6) strcmdid = "PAP";
        else if (cmd == 7) strcmdid = "WCP";
        else if (cmd == 8) strcmdid = "CH4AVAC";
        else if (cmd == 9) strcmdid = "TLAMP1";
        else if (cmd == 3) strcmdid = "TWI";
        break;
    case 3:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1TILT";
        else if (cmd == 2)
            strcmdid = "L2TILT";
        else if (cmd == 5)
            strcmdid = "LDVAC";
        else if (cmd == 6)
            strcmdid = "PAT";
        else if (cmd == 7)
            strcmdid = "WC1VAC";
        else if (cmd == 8)
            strcmdid = "CH5VAC";
        else if (cmd == 9)
            strcmdid = "TLAMP2";
        else if (cmd == 3)
            strcmdid = "TWI";
        break;
    case 4:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1MAP";
        else if (cmd == 2)
            strcmdid = "L2MAP";
        else if (cmd == 5)
            strcmdid = "LDAVAC";
        else if (cmd == 6)
            strcmdid = "PAR";
        else if (cmd == 7)
            strcmdid = "WC2VAC";
        else if (cmd == 8)
            strcmdid = "CH6VAC";
        else if (cmd == 9)
            strcmdid = "TLAMP3";
        else if (cmd == 3)
            strcmdid = "TWI";
        break;
    case 5:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1POS";
        else if (cmd == 2)
            strcmdid = "L2POS";
        else if (cmd == 5)
            strcmdid = "ResLDX";
        else if (cmd == 6)
            strcmdid = "WAFSENS";
        else if (cmd == 7)
            strcmdid = "WC1AVAC";
        else if (cmd == 8)
            strcmdid = "CH8VAC";
        else if (cmd == 9)
            strcmdid = "THORN";
        else if (cmd == 3)
            strcmdid = "TWI";
        break;
    case 6:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1H";
        else if (cmd == 2)
            strcmdid = "L2H";
        else if (cmd == 5)
            strcmdid = "ResLDY";
        else if (cmd == 6)
            strcmdid = "PAVAC";
        else if (cmd == 7)
            strcmdid = "WC2AVAC";
        else if (cmd == 8)
            strcmdid = "?";
        else if (cmd == 9)
            strcmdid = "TMP2";
        else if (cmd == 3)
            strcmdid = "TWI";
        break;
    case 7:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1Sens";
        else if (cmd == 2)
            strcmdid = "L2Sens";
        else if (cmd == 5)
            strcmdid = "LDGETPARA";
        else if (cmd == 6)
            strcmdid = "PAAVAC";
        else if (cmd == 7)
            strcmdid = "ResWCH";
        else if (cmd == 8)
            strcmdid = "?";
        else if (cmd == 9)
            strcmdid = "TMP3";
        else if (cmd == 3)
            strcmdid = "TWI";
        break;
    case 8:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "ResL1H";
        else if (cmd == 2)
            strcmdid = "ResL2H";
        else if (cmd == 5)
            strcmdid = "LDSETPARA";
        else if (cmd == 6)
            strcmdid = "ResPAH";
        else if (cmd == 7)
            strcmdid = "ResWCP";
        else if (cmd == 8)
            strcmdid = "?";
        else if (cmd == 9)
            strcmdid = "TMP4";
        else if (cmd == 3)
            strcmdid = "TWI";
        break;
    case 9:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "ResL1T";
        else if (cmd == 2)
            strcmdid = "ResL2T";
        else if (cmd == 5)
            strcmdid = "LDX_GETPOS";
        else if (cmd == 6)
            strcmdid = "ResPAP";
        else if (cmd == 7)
            strcmdid = "WCGETPARA";
        else if (cmd == 9)
            strcmdid = "TMP5";
        else
            strcmdid = "?";
        break;
    case 10:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1GETPOS";
        else if (cmd == 2)
            strcmdid = "L2GETPOS";
        else if (cmd == 5)
            strcmdid = "LDY_GETPOS";
        else if (cmd == 6)
            strcmdid = "ResPAT";
        else if (cmd == 7)
            strcmdid = "WCH_GETPOS";
        else if (cmd == 9)
            strcmdid = "TMP6";
        else
            strcmdid = "?";
        break;
    case 11:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1GETPARA";
        else if (cmd == 2)
            strcmdid = "L2GETPARA";
        else if (cmd == 5)
            strcmdid = "LDX_GETMOPAR";
        else if (cmd == 6)
            strcmdid = "ResPAR";
        else if (cmd == 7)
            strcmdid = "WCP_GETPOS";
        else if (cmd == 9)
            strcmdid = "V1_2";
        else
            strcmdid = "?";
        break;
    case 12:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1SETPARA";
        else if (cmd == 2)
            strcmdid = "L2SETPARA";
        else if (cmd == 5)
            strcmdid = "LDX_SETMOPAR";
        else if (cmd == 6)
            strcmdid = "PACal";
        else if (cmd == 7)
            strcmdid = "WCH_GETMOPAR";
        else if (cmd == 9)
            strcmdid = "V1_3";
        else
            strcmdid = "?";
        break;
    case 13:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1H_GETMOPAR";
        else if (cmd == 2)
            strcmdid = "L2H_GETMOPAR";
        else if (cmd == 5)
            strcmdid = "LDY_GETMOPAR";
        else if (cmd == 6)
            strcmdid = "PAanalVAL";
        else if (cmd == 7)
            strcmdid = "WCH_SETMOPAR";
        else if (cmd == 9)
            strcmdid = "V1_4";
        else
            strcmdid = "?";
        break;
    case 14:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1H_SETMOPAR";
        else if (cmd == 2)
            strcmdid = "L2H_SETMOPAR";
        else if (cmd == 5)
            strcmdid = "LDY_SETMOPAR";
        else if (cmd == 6)
            strcmdid = "PAGETPARA";
        else if (cmd == 7)
            strcmdid = "WCP_GETMOPAR";
        else if (cmd == 9)
            strcmdid = "V1_5";
        else
            strcmdid = "?";
        break;
    case 15:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1T_GETMOPAR";
        else if (cmd == 2)
            strcmdid = "L2T_GETMOPAR";
        else if (cmd == 6)
            strcmdid = "PAMEAS";
        else if (cmd == 7)
            strcmdid = "WCP_SETMOPAR";
        else if (cmd == 9)
            strcmdid = "V1_6";
        else
            strcmdid = "?";
        break;
    case 16:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 1)
            strcmdid = "L1T_SETMOPAR";
        else if (cmd == 2)
            strcmdid = "L2T_SETMOPAR";
        else if (cmd == 6)
            strcmdid = "PAH_GETPOS";
        else if (cmd == 9)
            strcmdid = "V2_2";
        else
            strcmdid = "?";
        break;
    case 17:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 6)
            strcmdid = "PAP_GETPOS";
        else if (cmd == 9)
            strcmdid = "V2_3";
        else
            strcmdid = "?";
        break;
    case 18:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 6)
            strcmdid = "PAR_GETPOS";
        else if (cmd == 9)
            strcmdid = "V2_4";
        else
            strcmdid = "?";
        break;
    case 19:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 6)
            strcmdid = "PAT_GETPOS";
        else if (cmd == 9)
            strcmdid = "V2_5";
        else
            strcmdid = "?";
        break;
    case 20:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 6)
            strcmdid = "PAH_GETMOPAR";
        else if (cmd == 9)
            strcmdid = "V2_6";
        else
            strcmdid = "?";
        break;
    case 21:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 6)
            strcmdid = "PAH_SETMOPAR";
        else if (cmd == 9)
            strcmdid = "V3_2";
        else
            strcmdid = "?";
        break;
    case 22:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 6)
            strcmdid = "PAT_GETMOPAR";
        else if (cmd == 9)
            strcmdid = "V3_3";
        else
            strcmdid = "?";
        break;
    case 23:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 6)
            strcmdid = "PAT_SETMOPAR";
        else if (cmd == 9)
            strcmdid = "V3_4";
        else
            strcmdid = "?";
        break;
    case 24:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 6)
            strcmdid = "PAP_GETMOPAR";
        else if (cmd == 9)
            strcmdid = "V3_5";
        else
            strcmdid = "?";
        break;
    case 25:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 6)
            strcmdid = "PAP_SETMOPAR";
        else if (cmd == 9)
            strcmdid = "V3_6";
        else
            strcmdid = "?";
        break;
    case 26:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 6)
            strcmdid = "PAR_GETMOPAR";
        else if (cmd == 9)
            strcmdid = "PF2";
        else
            strcmdid = "?";
        break;
    case 27:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 6)
            strcmdid = "PAR_SETMOPAR";
        else if (cmd == 9)
            strcmdid = "PF3";
        else
            strcmdid = "?";
        break;
    case 28:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "PF4";
        else
            strcmdid = "?";
        break;
    case 29:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "PF5";
        else
            strcmdid = "?";
        break;
    case 30:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "PF6";
        else
            strcmdid = "?";
        break;
    case 31:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "PF4";
        else
            strcmdid = "?";
        break;
    case 32:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "PF7";
        else
            strcmdid = "?";
        break;
    case 33:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "PF8";
        else
            strcmdid = "?";
        break;
    case 34:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "PF9";
        else
            strcmdid = "?";
        break;
    case 35:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "PF15";
        else
            strcmdid = "?";
        break;
    case 36:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "MPF";
        else
            strcmdid = "?";
        break;
    case 37:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "VDC8";
        else
            strcmdid = "?";
        break;
    case 38:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "VDC12";
        else
            strcmdid = "?";
        break;
    case 39:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "VDCM12";
        else
            strcmdid = "?";
        break;
    case 40:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "VDC24";
        else
            strcmdid = "?";
        break;
    case 41:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "EMO";
        else
            strcmdid = "?";
        break;
    case 42:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "ACR";
        else
            strcmdid = "?";
        break;
    case 43:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "B2";
        else
            strcmdid = "?";
        break;
    case 44:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "B3";
        else
            strcmdid = "?";
        break;
    case 45:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "B4";
        else
            strcmdid = "?";
        break;
    case 46:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "B5";
        else
            strcmdid = "?";
        break;
    case 47:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "B6";
        else
            strcmdid = "?";
        break;
    case 48:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "B7";
        else
            strcmdid = "?";
        break;
    case 49:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "B8";
        else
            strcmdid = "?";
        break;
    case 50:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "B15";
        else
            strcmdid = "?";
        break;
    case 51:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "WOL1SW";
        else
            strcmdid = "?";
        break;
    case 52:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "WOLPPWM";
        else
            strcmdid = "?";
        break;
    case 53:
        if (cmd == 0)
            strcmdid = "0";
        else if (cmd == 9)
            strcmdid = "FLASH";
        else
            strcmdid = "?";
        break;
    }
    f_errtext(fehlernr);
    ui->plainTextEdit_LOGwarn->appendPlainText(strblock + ", " + strcmd + ", " + strcmdid + ", " + count);
    ui->line_log_fehlercount->setText(count);
}
int MainWindow::f_errtext(int nr) {
    int ret = 0;
    switch (nr) {
    case NODE_NOT_CONNECTED:
        ui->plainTextEdit_LOGwarn->appendPlainText("NODE_NOT_CONNECTED");
        break;
    case MSPF_NO_MEMORY:
        ui->plainTextEdit_LOGwarn->appendPlainText("MSPF_NO_MEMORY");
        break;
    case RSPF_NO_MEMORY:
        ui->plainTextEdit_LOGwarn->appendPlainText("RSPF_NO_MEMORY");
        break;
    case PIF_NO_MEMORY:
        ui->plainTextEdit_LOGwarn->appendPlainText("PIF_NO_MEMORY");
        break;
    case POF_NO_MEMORY:
        ui->plainTextEdit_LOGwarn->appendPlainText("POF_NO_MEMORY");
        break;
    case ERRORLIST_FULL:
        ui->plainTextEdit_LOGwarn->appendPlainText("ERRORLIST_FULL");
        break;
    case UNIT_NOT_PRESENT:
        ui->plainTextEdit_LOGwarn->appendPlainText("UNIT_NOT_PRESENT");
        break;
    case CLEAN_TIMEOUT:
        ui->plainTextEdit_LOGwarn->appendPlainText("CLEAN_TIMEOUT");
        break;
    case FN_BUSY:
        ui->plainTextEdit_LOGwarn->appendPlainText("FN_BUSY");
        break;
    case FN_BLOCKED:
        ui->plainTextEdit_LOGwarn->appendPlainText("FN_BLOCKED");
        break;
    case FN_CANCEL:
        ui->plainTextEdit_LOGwarn->appendPlainText("FN_CANCEL");
        break;
    case ERR_NODE:
        ui->plainTextEdit_LOGwarn->appendPlainText("ERR_NODE");
        break;
    case FN_TIMEOUT:
        ui->plainTextEdit_LOGwarn->appendPlainText("FN_TIMEOUT");
        break;
    case VACUUM_LOW:
        ui->plainTextEdit_LOGwarn->appendPlainText("VACUUM_LOW");
        break;
    default:
        ui->plainTextEdit_LOGwarn->appendPlainText("Unkown");
        ret = 1;
    }
    return ret;
}
void MainWindow::serialReceived_stage() {
    if (stagetimeout->isActive())
        stagetimeout->stop();
    stagecmdtimeout = 5000;
    while (serial_stage->canReadLine()) {
        mtdata = serial_stage->readLine();
        logout << QTime::currentTime().toString("hh:mm:ss.zzz' '")
               << mtdata.append('\n');

        ui->plainTextEdit_stage_loger->appendPlainText("->" + mtdata.trimmed());
        qDebug() << "receive: " << mtdata;

        if (STAGEid == cPOS) {
            ui->line_stage_actualposx->setText(mtdata.left(12).trimmed());
            ui->line_stage_actualposy->setText(mtdata.trimmed().right(9).trimmed());
            STAGEid = nc;
        } else if (STAGEid == cSTATUS) {
            int state = mtdata.trimmed().toInt(&ok, 10);
            int D0 = state & 0b00000001; // Status Positionierbefehl
            int D1 = state & 0b00000010; // Status Joystick
            int D5 = state & 0b00100000; // Status CL Sollposition = Istposition
            if (D0 || D5)
                stageSTA->start(100);
            else {
                if (stageSTA->isActive())
                    stageSTA->stop();
                if (stageCAL->isActive())
                    stageCAL->stop();
            }
            if (D1)
                ui->check_stage_joystick->setChecked(1);
            else
                ui->check_stage_joystick->setChecked(0);
            if (STAGECAL) {
                stageCAL->start(50000);
                STAGECAL = 0;
                stagecmd = 0;
                serialSendStage(mtrm);
            }
            STAGEid = nc;
            if (state == 0) {
                stagecmd = 0;
                on_p_stage_getpos_clicked();
            }
        } else if (STAGEid == cSETPOS) {
            STAGEid = nc;
        }
        stagecmd = 0;
    }
}
void MainWindow::serialReceived_DUE() // LOG und Measdaten
{
    int val = 0;
    int max = 0;

    while (serial_due->canReadLine())
    {
        usbdata = serial_due->readLine();
        qDebug() << "svcresults" << svcresults << "data" << usbdata;
        if (testdata == 0) ui->plainText_sendlog->appendPlainText("->" + usbdata.trimmed());
        if (svcresults)
        {
            if (usbdata.trimmed() == "1") ui->check_testdata_ON->setStyleSheet(backLightGreen);
            else ui->check_testdata_ON->setStyleSheet(backYello);
            svcresults = 0;
        }
        else if (svcid == 1)
        {
            if (usbdata.trimmed() == "1") ui->check_align_rawdata->setStyleSheet(backLightGreen);
            else ui->check_align_rawdata->setStyleSheet(backWhite);
            svcid = 0;
        }
        else if (svc1) // flatlen
        {
            ui->line_align_flatlen->setText(QString::number(usbdata.trimmed().toInt(&ok, 10) / 10));
            svc1 = FALSE;
        }
        else if (svc2) // wafersize
        {
            ui->line_align_wafsize->setText(usbdata.trimmed());
            svc2 = FALSE;
        }
        else if (svc3) // graph reset flat
        {
            if (usbdata.trimmed() == "1") ui->check_testdata_resetFlag->setStyleSheet(backLightYello);
            else ui->check_testdata_resetFlag->setStyleSheet(backLightGreen);
            svc3 = FALSE;
        }
        else if (svc4) // slitlen
        {
            int tmpint = usbdata.trimmed().toInt(&ok, 10);
            ui->line_align_slitlen->setText(QString::number(tmpint));
            svc4 = FALSE;
        }
        else if (svc5) // setupdispl
        {
            int tmpint = usbdata.trimmed().toInt(&ok, 10);
            ui->line_align_setupdispl->setText(QString::number(tmpint));
            svc5 = FALSE;
        }
        else if (svc6)
        {
            int tmpint = usbdata.trimmed().toInt(&ok, 10);
            if (tmpint == 3) ui->check_testdata_sinfit->setStyleSheet(backLightGreen);
            else ui->check_testdata_sinfit->setStyleSheet(backLightYello);
            svc6 = FALSE;
        }
        else if (svc7)
        {
            int tmpint = usbdata.trimmed().toInt(&ok, 10);
            if (tmpint == 5) ui->check_testdata_sqrlog->setStyleSheet(backLightGreen);
            else ui->check_testdata_sqrlog->setStyleSheet(backLightYello);
            svc7 = FALSE;
        }
        else if (svc9) // graphdata on/off
        {
            int tmpint = usbdata.trimmed().toInt(&ok, 10);
            if (tmpint == 1) ui->check_align_dataon->setStyleSheet(backLightGreen);
            else ui->check_align_dataon->setStyleSheet(backLightYello);
            svc9 = FALSE;
            if (macro_profil == 1) macroProfil(true);
        }
        else if (svc11) // wafangle
        {
            int tmpint = usbdata.trimmed().toInt(&ok, 10);
            ui->line_align_setwafangle->setText(QString::number(tmpint));
            svc11 = FALSE;
        }
        else if (svc12) // filter
        {
            int tmpint = usbdata.trimmed().toInt(&ok, 10);
            ui->line_align_matchfilter->setText(QString::number(tmpint));
            svc12 = FALSE;
        }
        else if (svc13) // FNidcorr
        {
            int tmpint = usbdata.trimmed().toInt(&ok, 10);
            ui->line_align_fnidcorr->setText(QString::number(tmpint));
            svc13 = FALSE;
        }
        else if (svc14) // paangle
        {
            int tmpint = usbdata.trimmed().toInt(&ok, 10);
            ui->line_align_paangle->setText(QString::number(tmpint));
            svc14 = FALSE;
        }
        else if (testdata)
        {
            if (usbdata.trimmed() == "+")
            {
                int set = ui->spin_testdata_set->value() - 1;
                QByteArray tmpdat = testdaten[set].mid(testdaten[set].indexOf("*") + 2, testdaten[set].indexOf("\r") - 1);
                serialSendDUE(tmpdat);
            }
            else if (usbdata.trimmed() == "1")
            {
                testdata = 0;
                ui->check_testdata_ok->setStyleSheet(backLightGreen);
            }
            else if (usbdata.trimmed() == "0")
            {
                testdata = 0;
                ui->check_testdata_ok->setStyleSheet(backRed);
            }
        }
        else
        {
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "->"<< usbdata.trimmed() << "\n";
            auto parts = usbdata.trimmed().split(',');
            clearData(); // alte Diagrammdaten löschen
            int i = 0;
            int k = 0;
            int profildat[1542];

            if (parts.count() > 0)
            {
                if (parts[0] == "!")
                {
                    int val = parts[1].toInt(&ok, 10);
                    ui->line_over_1->setText(QString::number(val)); // dsp.lowlinecnt
                    val = parts[2].toInt(&ok, 10);
                    ui->line_over_2->setText(QString::number(val)); // dsp.lowedgeID0[0]
                    val = parts[3].toInt(&ok, 10);
                    ui->line_over_3->setText(QString::number(val)); // dsp.lowedgeID1[0]
                    val = parts[4].toInt(&ok, 10);
                    ui->line_over_4->setText(QString::number(val)); // dsp.lowedgeID0[1]
                    val = parts[5].toInt(&ok, 10);
                    ui->line_over_5->setText(QString::number(val)); // dsp.lowedgeID1[1] 5
                    val = parts[6].toInt(&ok, 10);
                    ui->line_over_6->setText(QString::number(val)); // dsp.lowedgeID0[2]
                    val = parts[7].toInt(&ok, 10);
                    ui->line_over_7->setText(QString::number(val)); // dsp.lowedgeID1[2]
                    val = parts[8].toInt(&ok, 10);
                    ui->line_over_8->setText(QString::number(val)); // dsp.longline
                    val = parts[9].toInt(&ok, 10);
                    ui->line_over_9->setText(QString::number(val)); // dsp.longID0
                    val = parts[10].toInt(&ok, 10);
                    ui->line_over_10->setText(QString::number(val)); // pa.kksVEC 10
                    val = parts[11].toInt(&ok, 10);
                    ui->line_over_11->setText(QString::number(val)); // dsp Flag
                    if (val == 1) ui->line_over_11->setStyleSheet(backLightYello);
                    else ui->line_over_11->setStyleSheet(backWhite);
                    val = parts[12].toInt(&ok, 10);
                    ui->line_flat_1->setText(QString::number(val)); // f.peakid[0]
                    val = parts[13].toInt(&ok, 10);
                    ui->line_flat_2->setText(QString::number(val)); // f.peakid[1]
                    val = parts[14].toInt(&ok, 10);
                    ui->line_flat_3->setText(QString::number(val)); // f.flatcut
                    if (val == 1) ui->line_flat_3->setStyleSheet(backLightYello);
                    else ui->line_flat_3->setStyleSheet(backWhite);
                    val = parts[15].toInt(&ok, 10);
                    ui->line_flat_4->setText(QString::number(val)); // pa.notchpoint 15
                    val = parts[16].toInt(&ok, 10);
                    ui->line_flat_5->setText(QString::number(val)); // pa.notchid
                    //                   int FNid = val;
                    val = parts[17].toFloat(&ok) / 10.0;
                    ui->line_over_12->setText(QString::number(val)); // veclen in µm
                    float vecint = parts[18].toFloat(&ok) / 10.0;
                    ui->line_over_20->setText( QString::number(vecint)); // pa.veclenint in mm
                    val = parts[19].toInt(&ok, 10);
                    if (val > 6164) val -= 6164;
                    ui->line_over_13->setText(QString::number(val)); // displPos an RAC
                    val = parts[20].toInt(&ok, 10);
                    ui->line_prea_psmax->setText(QString::number(val)); // p.smax 20
                    smax = val;
                    val = parts[21].toInt(&ok, 10);
                    ui->line_flat_12->setText(QString::number(val)); // p.smaxid
                    smaxid = val;
                    val = parts[22].toInt(&ok, 10);
                    ui->line_prea_3->setText(QString::number(val)); // f.minid
                    val = parts[23].toInt(&ok, 10);
                    ui->line_prea_4->setText(QString::number(val)); // shift (bestfitid)
                    bestfitid = val;
                    val = parts[24].toInt(&ok, 10);
                    ui->line_over_14->setText(QString::number(val)); // pa.displPosVal
                    // val = parts[25].toInt(&ok,10);
                    // ui->line_over_16->setText(QString::number(val));   // p.zeroid 25
                    val = parts[26].toFloat(&ok) / 10;
                    ui->line_over_17->setText(QString::number(val)); // sinvectics
                    val = parts[27].toInt(&ok, 10);
                    ui->line_flat_6->setText(QString::number(val)); // pa.wafanglesteps
                    val = parts[28].toInt(&ok, 10);
                    ui->line_flat_7->setText(QString::number(val)); // pa.phiposFN
                    val = parts[29].toInt(&ok, 10);
                    max = val;
                    ui->line_over_19->setText(QString::number(val)); // sinmax
                    val = parts[30].toInt(&ok, 10);
                    ui->line_flat_8->setText( QString::number(val)); // zuletzt aktiver Threshold    30
                    val = parts[31].toInt(&ok, 10);
                    ui->line_flat_9->setText(QString::number(val)); // Flag Flatsplit
                    if (val == 1) ui->line_flat_9->setStyleSheet(backLightYello);
                    else ui->line_flat_9->setStyleSheet(backWhite);
                    val = parts[32].toInt(&ok, 10);
                    ui->line_prea_6->setText(QString::number(val)); // x offset
                    ui->line_prea_6->setStyleSheet(backLightYello);
                    ui->line_stage_xoff->setText(QString::number(val));
                    val = parts[33].toInt(&ok, 10);
                    ui->line_prea_5->setText(QString::number(val)); // y offset
                    ui->line_prea_5->setStyleSheet(backLightYello);
                    ui->line_stage_yoff->setText(QString::number(val));
                    val = parts[34].toInt(&ok, 10);
                    ui->line_flat_10->setText(QString::number(val)); // norminid
                    if (parts.count() > 34) val = parts[35].toInt(&ok, 10);
                    ui->line_flat_11->setText(QString::number(val)); // normincorr 35
                    normincorr = val;
                    ui->label_flat11->setText("smincorr");
                    if (parts.count() > 35) val = parts[36].toInt(&ok, 10);
                    ui->line_fit_maxid->setText(QString::number(val)); // fitmaxid
                    val += 3082;
                    if (val > 6164) val -= 6164;
                    ui->line_fit_minid->setText(QString::number(val)); // Fitminid (gerechnet)
                    if (parts.count() > 36)    // p.normin
                    {
                        val = parts[37].toInt(&ok, 10);
                        ui->line_flat_13->setText(QString::number(val));
                        ui->line_flat_diffmin->setText(QString::number(val - normincorr));
                    }
                    if (parts.count() > 37) // fit.zoffset
                    {
                        zoffset = parts[38].toInt(&ok, 10);
                        ui->line_zoffset->setText(QString::number(zoffset));
                    }
                    if (parts.count() > 38) // pa.vecdiff
                    {
                        val = parts[39].toInt(&ok, 10);
                        ui->line_vecdiff->setText(QString::number(val));
                    }
                    if (parts.count() > 39) // fit.bes
                    {
                        val = parts[40].toInt(&ok, 10);
                        ui->line_prea_bestfit->setText(QString::number(val));
                    }
                    if (parts.count() > 40) // pa.PHIcorr
                    {
                        float tmpcorr = parts[41].toFloat(&ok) / 10.0;
                        val = parts[41].toInt(&ok, 10) / 10;
                        if ((abs(tmpcorr) - abs(val)) * 10 > 5)
                            val += 1;
                        ui->line_phicorr->setText(QString::number(val));
                    }
                    if (parts.count() > 41) // inKTnotchid
                    {
                        val = parts[42].toInt(&ok, 10);
                        ui->line_inKTnotch->setText(QString::number(val));
                        ui->line_inKTnotch->setStyleSheet(backLightYello);
                    }
                    if (parts.count() > 42) // inKTmaxid
                    {
                        val = parts[43].toInt(&ok, 10);
                        ui->line_inKTmax->setText(QString::number(val));
                        ui->line_inKTmax->setStyleSheet(backLightYello);
                    }
                    if (parts.count() > 43) // turnKTvector
                    {
                        val = parts[44].toInt(&ok, 10);
                        ui->line_turnKTvec->setText(QString::number(val));
                        ui->line_turnKTvec->setStyleSheet(backLightYello);
                    }
                    if (parts.count() > 44) // outKTmaxid
                    {
                        val = parts[45].toInt(&ok, 10);
                        ui->line_outKTvec->setText(QString::number(val));
                        ui->line_outKTvec->setStyleSheet(backLightYello);
                    }
                    if (parts.count() > 45) // filterwert
                    {
                        val = parts[46].toInt(&ok, 10);
                        ui->line_filter->setText(QString::number(val));
                        ui->line_filter->setStyleSheet(backLightYello);
                    }
                    if (parts.count() > 46) // fnok flag
                    {
                        val = parts[47].toInt(&ok, 10);
                        if (val) {
                            ui->checkBox_debug_fnok->setChecked(1);
                            ui->checkBox_debug_fnok->setStyleSheet(backLightGreen);
                        } else {
                            ui->checkBox_debug_fnok->setChecked(0);
                            ui->checkBox_debug_fnok->setStyleSheet(backRed);
                        }
                    }
                    //  Berechnung sinmin value
                    //  uint16_t tmpamp = (p.smax + fit.zoffset - p.normincorr)/2;
                    //  uint16_t tmpslp = (p.smax + fit.zoffset + p.normincorr)/2;
                    //  fit.sinmin = sin(0.5 * PI + 3082) * tmpamp + tmpslp;
                    int tmpamp = (ui->line_prea_psmax->text().toInt(&ok, 10) +
                                  ui->line_zoffset->text().toInt(&ok, 10) -
                                  ui->line_flat_11->text().toInt(&ok, 10)) / 2;
                    int tmpslp = (ui->line_prea_psmax->text().toInt(&ok, 10) +
                                  ui->line_zoffset->text().toInt(&ok, 10) +
                                  ui->line_flat_11->text().toInt(&ok, 10)) / 2;
                    int minval = sin(0.5 * M_PI + 3082) * tmpamp + tmpslp;
                    ui->line_fit_minid_val->setText(QString::number(minval));
                    ui->textBrowser_maxid->append(QString::number(cyclecount) + " KTmax " +
                                ui->line_outKTvec->text() + ", corr " + ui->line_phicorr->text() +
                                ", vdiff " + ui->line_vecdiff->text() + ", shift " +
                                ui->line_prea_4->text() + ", fit " +
                                ui->line_prea_bestfit->text() + ", f " + ui->line_filter->text() +
                                ", x " + ui->line_prea_6->text() + ", y " +
                                ui->line_prea_5->text());
                }
                else if (parts[0] == "*") // Graph
                {
                    i++;
                    do
                    {
                        if (parts[i] != "\r\n")
                        {
                            val = parts[i].toInt(&ok, 10);
                            if (ui->check_testdata_sinfit->isChecked())
                            {
                                // Sinusfit = (sinus((1541-maxid+phasenoffset+id)/3082*pi) *
                                // (max+zoffset-min)/2 + (max+zoffset+min)/2)
                                double sin = qSin((1541.0 - smaxid + bestfitid + i) / 3082.0 * M_PI);
                                double t_amp = (smax + zoffset - normincorr) / 2.0;
                                double t_slp = (smax + zoffset + normincorr) / 2.0;
                                double sinfit = sin * t_amp + t_slp;
                                addPoint2(sinfit);
                                addPoint((double)k, (double)val);
                                ui->plainText_sendlog->appendPlainText(QString::number(val));
                                if (macro_profil && i > 1540 && i < 3083)
                                {
                                    qDebug() << "qSin(90.0/1541.0*i)"<< qSin(90.0 / 1541.0 * i * M_PI_2);
                                    profildat[i - 1541] = val * (2 - val / (16384.0 * qSin(90.0 / 1541.0 * i * M_PI_2))); // val*(2-val/soll)
                                }
                            }
                            else if (ui->check_testdata_xychart->isChecked())
                            {
                                xyplot = TRUE;
                                //                               double size = 0;
                                //                               double diff =  max - val;
                                //                               if(ui->line_align_wafsize->text()
                                //                               == "8") size = 200.0 +
                                //                               diff/16384.0 * 200.0; else
                                //                               if(ui->line_align_wafsize->text()
                                //                               == "6") size = 150.0 +
                                //                               diff/16384.0 * 150.0;
                                double x = qCos((1541.0 - smaxid + i) / 3082.0 * M_PI) * val;
                                double y = qSin((1541.0 - smaxid + i) / 3082.0 * M_PI) * val;
                                addXYPoint(x, y);
                                ui->plainText_sendlog->appendPlainText(QString::number(x) + "," + QString::number(y));
                            }
                            else
                            {
                                addPoint((double)k, (double)val);
                                ui->plainText_sendlog->appendPlainText(QString::number(val));
                            }
                        }
                        i++;
                        if (parts.count() < 6164)
                        {
                            k += 8; // bei LD Displacement wird nur ein Bruchteil der Daten gesendet
                            graphcol = 1; // Linienfarbe Rot
                        }
                        else
                        {
                            k++;
                            graphcol = 0; // Linienfarbe Schwarz
                        }
                    }
                    while (i < parts.count() && parts[i] != "#");
                    chart = 1;
                }
                if (macro_profil)
                {
                    if (graphcol) err_msgbox("Not enough values");
                }
                if (chart) showspline();
            }
        }
    }
}
void MainWindow::serialReceived_Mic() {
    static int statmic = 0;
    while (serial_mic->canReadLine()) {
        usbdata = serial_mic->readLine();
        logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "mic -> "
               << usbdata.append('\n');
        ui->plainTextEdit_mic_loger->appendPlainText("->" + usbdata.trimmed());
        qDebug() << "receive: " << usbdata;
        miccmd = 0;
        if (MICid == mGETPOS) {
            if (statmic == 0) {
                if (usbdata.trimmed().toInt(&ok, 10) == EOT) // MIC bereit
                {
                    statmic = 1;
                    serialSendMic(
                                "0D 00 00 80 00 80 01 44 45 56 31 09 1E 00 02 38\r\n"); // Reset
                    // Z-Trieb
                } else if (usbdata.trimmed().toInt(&ok, 10) ==
                           ENQ) // MIC will Daten senden
                {
                    statmic = 1;
                }
            } else if (statmic == 1) {
                if (usbdata.trimmed().toInt(&ok, 10) == ACK) // ACK empfangen
                {
                    statmic = 0;
                    MICid = ncmic;
                } else // Daten empfangen und ACK senden
                {
                    statmic = 0;
                    MICid = ncmic;
                }
            }
        } else if (MICid == mSETPOSZ) {
            MICid = ncmic;
        }
    }
}
void MainWindow::serialReceived_SMIF2()
{
    while (serial_smif2->canReadLine())
    {
        static QString iscmd = ""; // cmd-Speicher für Zuordnung der Response
        sersmif2data = serial_smif2->readLine();
        smiflogout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "->" << sersmif2data.trimmed() << "\n";
        qDebug()<<"sersmif2data.mid(3,4)"<<sersmif2data.mid(3,4);
        if(sersmif2data.mid(3,4) == "IND>") // ISE
        {
            if (iscmd != "CDATA") ui->plainTextEdit_logsmif_cmd->appendPlainText(QTime::currentTime().toString("hh:mm:ss.zzz' '") + "->" + sersmif2data.trimmed());
            else ui->plainTextEdit_logsmif_cmd->appendPlainText(sersmif2data.trimmed());    // CDATA = service slot data
        }
        else
        {
            ui->plainTextEdit_logsmif_asystcmd->appendPlainText(QTime::currentTime().toString("hh:mm:ss.zzz' '") + "->" + sersmif2data.trimmed());
        }
       qDebug() <<"receive: "<< sersmif2data;

        if (sersmif2data.left(3) == QString("!C_")) // "!C_"
        {
            auto parts = sersmif2data.mid(sersmif2data.indexOf("_") + 1, sersmif2data.indexOf("\r") - sersmif2data.indexOf("_") - 1).split(' '); // Codierung durch Space getrennt

            qDebug() <<"partscount "<< parts.count()<<"part[0] "<< parts[0];

            if (parts.count() != 0)
            {
                iscmd = parts[0];
                if (iscmd == "STATUS") ui->p_SMIF_status->setStyleSheet(backLightGrey);
                else if(iscmd == "FSR") ui->p_ASYST_status->setStyleSheet(backLightGrey);
            }
        }
        else if (sersmif2data.left(3) == QString("!R_")) // "!R_"
        {
            if(sersmif2data.mid(3,4) == "IND>")          // ISE
            {
                auto parts = sersmif2data.mid(sersmif2data.indexOf(">") + 2, sersmif2data.indexOf("\r") - sersmif2data.indexOf(">") - 2).split(' '); // Fehlercodierung durch Space getrennt
                qDebug() <<"iscmd"<< iscmd << "parts.count" << parts.count();
                if (parts.count() != 0)
                {
                    if (parts[0].toInt(&ok, 10) > 1) // ISE Fehlercode
                    {
                        ui->label_smif1_errcode->setStyleSheet(backYello);
                        QString ec = parts[0];
                        ec.append(" ");
                        ui->label_smif1_errcode->setText((ec + IseErrCode[parts[0].toInt(&ok, 10) - 1]));
                        if (parts[0].toInt(&ok, 10) < 100) ui->label_smiferrortype->setText("stepper driver");
                        else if (parts[0].toInt(&ok, 10) < 120) ui->label_smiferrortype->setText("cmd interface");
                        else if (parts[0].toInt(&ok, 10) < 170) ui->label_smiferrortype->setText("general lift error");
                        else if (parts[0].toInt(&ok, 10) < 200) ui->label_smiferrortype->setText("lift option error");
                        else ui->label_smiferrortype->setText("unkown error");
                    }
                    else if (iscmd == "STATUS")
                    {
                        ui->p_SMIF_status->setStyleSheet(backLightGreen);
                        ui->line_smif_status1->setText(parts[0]);
                        ui->line_smif_status2->setText(parts[1]);
                        ui->line_smif_status3->setText(parts[2]);
                        ui->line_smif_status4->setText(parts[3]);
                        ui->line_smif_status5->setText(parts[4]);
                    }
                    else if (iscmd == "PCONF2")
                    {
                        ui->line_smif_getpconf2->setText(QString::number(parts[1].toInt(&ok, 10)));
                    }
                    else if (iscmd == "PCONF3")
                    {
                        ui->line_smif_pconf3_p1->setText(QString::number(parts[1].toInt(&ok, 10)));
                        ui->line_smif_pconf3_p2->setText(QString::number(parts[2].toInt(&ok, 10)));
                        ui->line_smif_pconf3_p3->setText(QString::number(parts[3].toInt(&ok, 10)));
                    }
                    else if (iscmd == "PCONF4")
                    {
                        ui->line_smif_getpconf4->setText(parts[1]);
                    }
                    else if (iscmd == "PCONF5")
                    {
                        ui->line_smif_getpconf5_thick->setText(QString::number(parts[1].toInt(&ok, 10)));
                        ui->line_smif_getpconf5_fullempty->setText(QString::number(parts[2].toInt(&ok, 10)));
                        ui->line_smif_getpconf5_emptyfull->setText(QString::number(parts[3].toInt(&ok, 10)));
                        ui->line_smif_getpconf5_mode->setText(QString::number(parts[4].toInt(&ok, 10)));
                    }
                    else if (iscmd == "PCONF6")
                    {
                        ui->line_smif_getpconf6->setText(QString::number(parts[1].toInt(&ok, 10)));
                    }
                    else if (iscmd == "GCONF2")
                    {

                    }
                    else if (iscmd == "INV")
                    {
                        QString slotnr = "";

                        for (int i = 1; i < 26; i++)
                        {
                            slotnr = parts[i]; // 2 Stellen pro Slot -> Werte in 1,3,5,7,...
                            qDebug() << "slot" << i << slotnr;
                            switch (i - 1)
                            {
                            case 0:
                                if (slotnr == "0")
                                {
                                    ui->lineEdit_L1S1_2->setStyleSheet("background-color: grey");
                                    ui->check_slot1_3->show();
                                }
                                else if (slotnr == "1")
                                {
                                    ui->lineEdit_L1S1_2->setStyleSheet("background-color: white");
                                    ui->check_slot1_3->show();
                                }
                                else if (slotnr == "2")
                                {
                                    ui->lineEdit_L1S1_2->setStyleSheet("background-color: red ");
                                    ui->check_slot1_3->show();
                                }
                                else if (slotnr == "3")
                                {
                                    ui->lineEdit_L1S1_2->setStyleSheet("background-color: green");
                                    ui->check_slot1_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10); // VECslot1 speichert alle gültigen (=1) Slots
                                break;
                            case 1:
                                if (slotnr == "0")
                                {
                                    ui->lineEdit_L1S2_2->setStyleSheet("background-color: grey");
                                    ui->check_slot2_3->show();
                                }
                                else if (slotnr == "1")
                                {
                                    ui->lineEdit_L1S2_2->setStyleSheet("background-color: white");
                                    ui->check_slot2_3->show();
                                }
                                else if (slotnr == "2")
                                {
                                    ui->lineEdit_L1S2_2->setStyleSheet("background-color: red ");
                                    ui->check_slot2_3->show();
                                }
                                else if (slotnr == "3")
                                {
                                    ui->lineEdit_L1S2_2->setStyleSheet("background-color: green");
                                    ui->check_slot2_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 2:
                                if (slotnr == "0")
                                {
                                    ui->lineEdit_L1S3_2->setStyleSheet("background-color: grey");
                                    ui->check_slot3_3->show();
                                }
                                else if (slotnr == "1")
                                {
                                    ui->lineEdit_L1S3_2->setStyleSheet("background-color: white");
                                    ui->check_slot3_3->show();
                                }
                                else if (slotnr == "2")
                                {
                                    ui->lineEdit_L1S3_2->setStyleSheet("background-color: red ");
                                    ui->check_slot3_3->show();
                                }
                                else if (slotnr == "3")
                                {
                                    ui->lineEdit_L1S3_2->setStyleSheet("background-color: green");
                                    ui->check_slot3_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 3:
                                if (slotnr == "0")
                                {
                                    ui->lineEdit_L1S4_2->setStyleSheet("background-color: grey");
                                    ui->check_slot4_3->show();
                                }
                                else if (slotnr == "1")
                                {
                                    ui->lineEdit_L1S4_2->setStyleSheet("background-color: white");
                                    ui->check_slot4_3->show();
                                }
                                else if (slotnr == "2")
                                {
                                    ui->lineEdit_L1S4_2->setStyleSheet("background-color: red ");
                                    ui->check_slot4_3->show();
                                }
                                else if (slotnr == "3")
                                {
                                    ui->lineEdit_L1S4_2->setStyleSheet("background-color: green");
                                    ui->check_slot4_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 4:
                                if (slotnr == "0")
                                {
                                    ui->lineEdit_L1S5_2->setStyleSheet("background-color: grey");
                                    ui->check_slot5_3->show();
                                }
                                else if (slotnr == "1")
                                {
                                    ui->lineEdit_L1S5_2->setStyleSheet("background-color: white");
                                    ui->check_slot5_3->show();
                                }
                                else if (slotnr == "2")
                                {
                                    ui->lineEdit_L1S5_2->setStyleSheet("background-color: red ");
                                    ui->check_slot5_3->show();
                                }
                                else if (slotnr == "3")
                                {
                                    ui->lineEdit_L1S5_2->setStyleSheet("background-color: green");
                                    ui->check_slot5_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 5:
                                if (slotnr == "0")
                                {
                                    ui->lineEdit_L1S6_2->setStyleSheet("background-color: grey");
                                    ui->check_slot6_3->show();
                                }
                                else if (slotnr == "1")
                                {
                                    ui->lineEdit_L1S6_2->setStyleSheet("background-color: white");
                                    ui->check_slot6_3->show();
                                }
                                else if (slotnr == "2")
                                {
                                    ui->lineEdit_L1S6_2->setStyleSheet("background-color: red ");
                                    ui->check_slot6_3->show();
                                }
                                else if (slotnr == "3")
                                {
                                    ui->lineEdit_L1S6_2->setStyleSheet("background-color: green");
                                    ui->check_slot6_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 6:
                                if (slotnr == "0")
                                {
                                    ui->lineEdit_L1S7_2->setStyleSheet("background-color: grey");
                                    ui->check_slot7_3->show();
                                }
                                else if (slotnr == "1")
                                {
                                    ui->lineEdit_L1S7_2->setStyleSheet("background-color: white");
                                    ui->check_slot7_3->show();
                                }
                                else if (slotnr == "2")
                                {
                                    ui->lineEdit_L1S7_2->setStyleSheet("background-color: red ");
                                    ui->check_slot7_3->show();
                                }
                                else if (slotnr == "3")
                                {
                                    ui->lineEdit_L1S7_2->setStyleSheet("background-color: green");
                                    ui->check_slot7_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 7:
                                if (slotnr == "0")
                                {
                                    ui->lineEdit_L1S8_2->setStyleSheet("background-color: grey");
                                    ui->check_slot8_3->show();
                                }
                                else if (slotnr == "1")
                                {
                                    ui->lineEdit_L1S8_2->setStyleSheet("background-color: white");
                                    ui->check_slot8_3->show();
                                }
                                else if (slotnr == "2")
                                {
                                    ui->lineEdit_L1S8_2->setStyleSheet("background-color: red ");
                                    ui->check_slot8_3->show();
                                }
                                else if (slotnr == "3")
                                {
                                    ui->lineEdit_L1S8_2->setStyleSheet("background-color: green");
                                    ui->check_slot8_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 8:
                                if (slotnr == "0")
                                {
                                    ui->lineEdit_L1S9_2->setStyleSheet("background-color: grey");
                                    ui->check_slot9_3->show();
                                }
                                else if (slotnr == "1")
                                {
                                    ui->lineEdit_L1S9_2->setStyleSheet("background-color: white");
                                    ui->check_slot9_3->show();
                                }
                                else if (slotnr == "2")
                                {
                                    ui->lineEdit_L1S9_2->setStyleSheet("background-color: red ");
                                    ui->check_slot9_3->show();
                                }
                                else if (slotnr == "3")
                                {
                                    ui->lineEdit_L1S9_2->setStyleSheet("background-color: green");
                                    ui->check_slot9_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 9:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S10_2->setStyleSheet("background-color: grey");
                                    ui->check_slot10_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S10_2->setStyleSheet("background-color: white");
                                    ui->check_slot10_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S10_2->setStyleSheet("background-color: red ");
                                    ui->check_slot10_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S10_2->setStyleSheet("background-color: green");
                                    ui->check_slot10_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 10:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S11_2->setStyleSheet("background-color: grey");
                                    ui->check_slot11_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S11_2->setStyleSheet("background-color: white");
                                    ui->check_slot11_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S11_2->setStyleSheet("background-color: red ");
                                    ui->check_slot11_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S11_2->setStyleSheet("background-color: green");
                                    ui->check_slot11_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 11:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S12_2->setStyleSheet("background-color: grey");
                                    ui->check_slot12_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S12_2->setStyleSheet("background-color: white");
                                    ui->check_slot12_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S12_2->setStyleSheet("background-color: red ");
                                    ui->check_slot12_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S12_2->setStyleSheet("background-color: green");
                                    ui->check_slot12_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 12:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S13_2->setStyleSheet("background-color: grey");
                                    ui->check_slot13_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S13_2->setStyleSheet("background-color: white");
                                    ui->check_slot13_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S13_2->setStyleSheet("background-color: red ");
                                    ui->check_slot13_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S13_2->setStyleSheet("background-color: green");
                                    ui->check_slot13_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 13:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S14_2->setStyleSheet("background-color: grey");
                                    ui->check_slot14_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S14_2->setStyleSheet("background-color: white");
                                    ui->check_slot14_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S14_2->setStyleSheet("background-color: red ");
                                    ui->check_slot14_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S14_2->setStyleSheet("background-color: green");
                                    ui->check_slot14_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 14:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S15_2->setStyleSheet("background-color: grey");
                                    ui->check_slot15_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S15_2->setStyleSheet("background-color: white");
                                    ui->check_slot15_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S15_2->setStyleSheet("background-color: red ");
                                    ui->check_slot15_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S15_2->setStyleSheet("background-color: green");
                                    ui->check_slot15_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 15:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S16_2->setStyleSheet("background-color: grey");
                                    ui->check_slot16_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S16_2->setStyleSheet("background-color: white");
                                    ui->check_slot16_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S16_2->setStyleSheet("background-color: red ");
                                    ui->check_slot16_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S16_2->setStyleSheet("background-color: green");
                                    ui->check_slot16_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 16:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S17_2->setStyleSheet("background-color: grey");
                                    ui->check_slot17_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S17_2->setStyleSheet("background-color: white");
                                    ui->check_slot17_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S17_2->setStyleSheet("background-color: red ");
                                    ui->check_slot17_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S17_2->setStyleSheet("background-color: green");
                                    ui->check_slot17_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 17:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S18_2->setStyleSheet("background-color: grey");
                                    ui->check_slot18_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S18_2->setStyleSheet("background-color: white");
                                    ui->check_slot18_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S18_2->setStyleSheet("background-color: red ");
                                    ui->check_slot18_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S18_2->setStyleSheet("background-color: green");
                                    ui->check_slot18_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 18:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S19_2->setStyleSheet("background-color: grey");
                                    ui->check_slot19_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S19_2->setStyleSheet("background-color: white");
                                    ui->check_slot19_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S19_2->setStyleSheet("background-color: red ");
                                    ui->check_slot19_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S19_2->setStyleSheet("background-color: green");
                                    ui->check_slot19_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 19:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S20_2->setStyleSheet("background-color: grey");
                                    ui->check_slot20_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S20_2->setStyleSheet("background-color: white");
                                    ui->check_slot20_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S20_2->setStyleSheet("background-color: red ");
                                    ui->check_slot20_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S20_2->setStyleSheet("background-color: green");
                                    ui->check_slot20_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 20:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S21_2->setStyleSheet("background-color: grey");
                                    ui->check_slot21_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S21_2->setStyleSheet("background-color: white");
                                    ui->check_slot21_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S21_2->setStyleSheet("background-color: red ");
                                    ui->check_slot21_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S21_2->setStyleSheet("background-color: green");
                                    ui->check_slot21_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 21:
                                if (slotnr == "0") {
                                    ui->lineEdit_L1S22_2->setStyleSheet("background-color: grey");
                                    ui->check_slot22_3->show();
                                } else if (slotnr == "1") {
                                    ui->lineEdit_L1S22_2->setStyleSheet("background-color: white");
                                    ui->check_slot22_3->show();
                                } else if (slotnr == "2") {
                                    ui->lineEdit_L1S22_2->setStyleSheet("background-color: red ");
                                    ui->check_slot22_3->show();
                                } else if (slotnr == "3") {
                                    ui->lineEdit_L1S22_2->setStyleSheet("background-color: green");
                                    ui->check_slot22_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 22:
                                if (slotnr == "0")
                                {
                                    ui->lineEdit_L1S23_2->setStyleSheet("background-color: grey");
                                    ui->check_slot23_3->show();
                                }
                                else if (slotnr == "1")
                                {
                                    ui->lineEdit_L1S23_2->setStyleSheet("background-color: white");
                                    ui->check_slot23_3->show();
                                }
                                else if (slotnr == "2")
                                {
                                    ui->lineEdit_L1S23_2->setStyleSheet("background-color: red ");
                                    ui->check_slot23_3->show();
                                }
                                else if (slotnr == "3")
                                {
                                    ui->lineEdit_L1S23_2->setStyleSheet("background-color: green");
                                    ui->check_slot23_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 23:
                                if (slotnr == "0")
                                {
                                    ui->lineEdit_L1S24_2->setStyleSheet("background-color: grey");
                                    ui->check_slot24_3->show();
                                }
                                else if (slotnr == "1")
                                {
                                    ui->lineEdit_L1S24_2->setStyleSheet("background-color: white");
                                    ui->check_slot24_3->show();
                                }
                                else if (slotnr == "2")
                                {
                                    ui->lineEdit_L1S24_2->setStyleSheet("background-color: red ");
                                    ui->check_slot24_3->show();
                                }
                                else if (slotnr == "3")
                                {
                                    ui->lineEdit_L1S24_2->setStyleSheet("background-color: green");
                                    ui->check_slot24_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            case 24:
                                if (slotnr.left(1) == "0")
                                {
                                    ui->lineEdit_L1S25_2->setStyleSheet("background-color: grey");
                                    ui->check_slot25_3->show();
                                }
                                else if (slotnr.left(1) == "1")
                                {
                                    ui->lineEdit_L1S25_2->setStyleSheet("background-color: white");
                                    ui->check_slot25_3->show();
                                }
                                else if (slotnr.left(1) == "2")
                                {
                                    ui->lineEdit_L1S25_2->setStyleSheet("background-color: red ");
                                    ui->check_slot25_3->show();
                                }
                                else if (slotnr.left(1) == "3")
                                {
                                    ui->lineEdit_L1S25_2->setStyleSheet("background-color: green");
                                    ui->check_slot25_3->show();
                                }
                                VECslot1[i] = slotnr.toShort(&ok, 10);
                                break;
                            }
                        }
                    }
                    else if (iscmd == "ERROR")
                    {

                    }
                    else if (iscmd == "_ANA") // SMIF Laser output
                    {
                        ui->line_SMIF_laseroutput->setText(QString::number(parts[1].toInt(&ok, 10)));
                    }
                    else if (iscmd == "_S_RCNT")
                    {
                        ui->line_SMIF_counter->setText(QString::number(parts[1].toInt(&ok, 10)));
                    }
                }
            }
            else                                         // ASYST
            {
                 auto parts = sersmif2data.mid(sersmif2data.indexOf("_") + 1, sersmif2data.indexOf("\r") - sersmif2data.indexOf("_") - 1).split(' '); // Fehlercodierung durch Space getrennt

                 for (int var = 0; var < parts.count(); ++var)
                 {
                     qDebug() <<"partscount "<< parts.count()<<"part["<<var<<"]"<<parts[var];
                 }

                if(iscmd == "FSR")
                {
                    int i = 0;
                    int t = 0;

                    if(parts[0] == "FSD0") t = 0;
                    else if(parts[0] == "FSD2") t = 2;

                    if(t == 0)
                    {
                        if(parts[3] == "PIP")
                        {
                            if(parts[4] == "FALSE")
                            {
                                ui->radio_ASYST_pod_false->setChecked(1);
                                ui->radio_ASYST_pod_true->setChecked(0);
                            }
                            else
                            {
                                ui->radio_ASYST_pod_false->setChecked(0);
                                ui->radio_ASYST_pod_true->setChecked(1);
                            }
                        }
                        if(parts[5] == "READY")
                        {
                            if(parts[6] == "FALSE")
                            {
                                ui->radio_ASYST_ready_false->setChecked(1);
                                ui->radio_ASYST_ready_true->setChecked(0);
                            }
                            else
                            {
                                ui->radio_ASYST_ready_false->setChecked(0);
                                ui->radio_ASYST_ready_true->setChecked(1);
                            }
                        }
                        if(parts[7] == "HOME")
                        {
                            if(parts[8] == "FALSE")
                            {
                                ui->radio_ASYST_home_false->setChecked(1);
                                ui->radio_ASYST_home_true->setChecked(0);
                            }
                            else
                            {
                                ui->radio_ASYST_home_false->setChecked(0);
                                ui->radio_ASYST_home_true->setChecked(1);
                            }
                        }
                        if(parts[9] == "PRTST")
                        {
                            if(parts[10] == "UNLK")
                            {
                                ui->radio_ASYST_lock_false->setChecked(1);
                                ui->radio_ASYST_lock_true->setChecked(0);
                            }
                            else
                            {
                                ui->radio_ASYST_lock_false->setChecked(0);
                                ui->radio_ASYST_lock_true->setChecked(1);
                            }
                        }
                        if(parts[11] == "ELDN")
                        {
                            if(parts[12] == "FALSE")
                            {
                                ui->radio_ASYST_dwnlimit_false->setChecked(1);
                                ui->radio_ASYST_dwnlimit_true->setChecked(0);
                            }
                            else
                            {
                                ui->radio_ASYST_dwnlimit_false->setChecked(0);
                                ui->radio_ASYST_dwnlimit_true->setChecked(1);
                            }
                        }
                        if(parts[13] == "ELUP")
                        {
                            if(parts[14] == "FALSE")
                            {
                                ui->radio_ASYST_uplimit_false->setChecked(1);
                                ui->radio_ASYST_uplimit_true->setChecked(0);
                            }
                            else
                            {
                                ui->radio_ASYST_uplimit_false->setChecked(0);
                                ui->radio_ASYST_uplimit_true->setChecked(1);
                            }
                        }
                        if(parts[15] == "ELSTAGE")
                        {
                            if(parts[16] == "FALSE")
                            {
                                ui->radio_ASYST_stage_false->setChecked(1);
                                ui->radio_ASYST_stage_true->setChecked(0);
                            }
                            else
                            {
                                ui->radio_ASYST_stage_false->setChecked(0);
                                ui->radio_ASYST_stage_true->setChecked(1);
                            }
                        }
                        if(parts[17] == "SEATER")
                        {
                            if(parts[18] == "OUT")
                            {
                                ui->radio_ASYST_seater_out->setChecked(1);
                                ui->radio_ASYST_seater_home->setChecked(0);
                            }
                            else if(parts[18] == "HOME")
                            {
                                ui->radio_ASYST_seater_out->setChecked(0);
                                ui->radio_ASYST_seater_home->setChecked(1);
                            }
                            else if(parts[18] == "OTHER")
                            {
                                ui->radio_ASYST_seater_out->setChecked(1);
                                ui->radio_ASYST_seater_home->setChecked(1);
                            }
                        }
                        if(parts[19] == "MODE")
                        {
                            if(parts[20] == "AUTO")
                            {
                                ui->radio_ASYST_mode_auto->setChecked(1);
                                ui->radio_ASYST_mode_manual->setChecked(0);
                            }
                            else
                            {
                                ui->radio_ASYST_mode_auto->setChecked(0);
                                ui->radio_ASYST_mode_manual->setChecked(1);
                            }
                        }
                        if(parts[21] == "SLOTPOS")
                        {
                            ui->line_ASYST_currentslot->setText(parts[22]);
                        }
                        if(parts[23] == "ELPOS")
                        {
                            ui->line_ASYST_elevatorpos->setText(parts[24]);
                        }
                    }
                    else if(t == 2)
                    {
                        if(parts[1] == "S1") f_ASYST_slot(ui->lineEdit_L1S1_5, parts[2]);
                        if(parts[3] == "S2") f_ASYST_slot(ui->lineEdit_L1S2_5, parts[4]);
                        if(parts[5] == "S3") f_ASYST_slot(ui->lineEdit_L1S3_5, parts[6]);
                        if(parts[7] == "S4") f_ASYST_slot(ui->lineEdit_L1S4_5, parts[8]);
                        if(parts[9] == "S5") f_ASYST_slot(ui->lineEdit_L1S5_5, parts[10]);
                        if(parts[11] == "S6") f_ASYST_slot(ui->lineEdit_L1S6_5, parts[12]);
                        if(parts[13] == "S7") f_ASYST_slot(ui->lineEdit_L1S7_5, parts[14]);
                        if(parts[15] == "S8") f_ASYST_slot(ui->lineEdit_L1S8_5, parts[16]);
                        if(parts[17] == "S9") f_ASYST_slot(ui->lineEdit_L1S9_5, parts[18]);
                        if(parts[19] == "S10") f_ASYST_slot(ui->lineEdit_L1S10_5, parts[20]);
                        if(parts[21] == "S11") f_ASYST_slot(ui->lineEdit_L1S11_5, parts[22]);
                        if(parts[23] == "S12") f_ASYST_slot(ui->lineEdit_L1S12_5, parts[24]);
                        if(parts[25] == "S13") f_ASYST_slot(ui->lineEdit_L1S13_5, parts[26]);
                        if(parts[27] == "S14") f_ASYST_slot(ui->lineEdit_L1S14_5, parts[28]);
                        if(parts[29] == "S15") f_ASYST_slot(ui->lineEdit_L1S15_5, parts[30]);
                        if(parts[31] == "S16") f_ASYST_slot(ui->lineEdit_L1S16_5, parts[32]);
                        if(parts[33] == "S17") f_ASYST_slot(ui->lineEdit_L1S17_5, parts[34]);
                        if(parts[35] == "S18") f_ASYST_slot(ui->lineEdit_L1S18_5, parts[36]);
                        if(parts[37] == "S19") f_ASYST_slot(ui->lineEdit_L1S19_5, parts[38]);
                        if(parts[39] == "S20") f_ASYST_slot(ui->lineEdit_L1S20_5, parts[40]);
                        if(parts[41] == "S21") f_ASYST_slot(ui->lineEdit_L1S21_5, parts[42]);
                        if(parts[43] == "S22") f_ASYST_slot(ui->lineEdit_L1S22_5, parts[44]);
                        if(parts[45] == "S23") f_ASYST_slot(ui->lineEdit_L1S23_5, parts[46]);
                        if(parts[47] == "S24") f_ASYST_slot(ui->lineEdit_L1S24_5, parts[48]);
                        if(parts[49] == "S25") f_ASYST_slot(ui->lineEdit_L1S25_5, parts[50]);
                    }
                }
                else if(iscmd == "ECS")
                {
                    if(parts.count() > 1)
                    {
                        if(parts[1] != "OK") err_msgbox("error: " + parts[1]);
                    }
                    else err_msgbox("error response: " + parts[0]);
                }
                else if(iscmd == "ECR")
                {
                    QLabel *label = new QLabel;
                    label->setText(parts[2]);
                    qDebug() <<"receive: ECR ";
                    if(parts[1] == "P4") ui->tableWidget_ASYST_readconfig->setCellWidget(0,1,label);
                    else if(parts[1] == "P6") ui->tableWidget_ASYST_readconfig->setCellWidget(1,1,label);
                    else if(parts[1] == "P13") ui->tableWidget_ASYST_readconfig->setCellWidget(2,1,label);
                    else if(parts[1] == "P16") ui->tableWidget_ASYST_readconfig->setCellWidget(3,1,label);
                    else if(parts[1] == "P30") ui->tableWidget_ASYST_readconfig->setCellWidget(4,1,label);
                    else if(parts[1] == "P31") ui->tableWidget_ASYST_readconfig->setCellWidget(5,1,label);
                    else if(parts[1] == "P33") ui->tableWidget_ASYST_readconfig->setCellWidget(6,1,label);
                    else if(parts[1] == "P34") ui->tableWidget_ASYST_readconfig->setCellWidget(7,1,label);
                    else if(parts[1] == "P35") ui->tableWidget_ASYST_readconfig->setCellWidget(8,1,label);
                    else if(parts[1] == "P36") ui->tableWidget_ASYST_readconfig->setCellWidget(0,4,label);
                    else if(parts[1] == "P37") ui->tableWidget_ASYST_readconfig->setCellWidget(1,4,label);
                    else if(parts[1] == "P38") ui->tableWidget_ASYST_readconfig->setCellWidget(2,4,label);
                    else if(parts[1] == "P39") ui->tableWidget_ASYST_readconfig->setCellWidget(3,4,label);
                    else if(parts[1] == "P40") ui->tableWidget_ASYST_readconfig->setCellWidget(4,4,label);
                    else if(parts[1] == "P41") ui->tableWidget_ASYST_readconfig->setCellWidget(5,4,label);
                    else if(parts[1] == "P63") ui->tableWidget_ASYST_readconfig->setCellWidget(6,4,label);
                    else if(parts[1] == "P67") ui->tableWidget_ASYST_readconfig->setCellWidget(7,4,label);

                }
                else if(iscmd == "HCS")
                {

                }
                else if(iscmd == "EDER")
                {

                }
            }
        }
        sersmif2data = 0;
    }
    smiflogout.flush();
}
void MainWindow::f_ASYST_slot(QLineEdit *line, QString t)
{
    qDebug()<<"line"<<line<<"String"<<t;
    if(t == "E") line->setStyleSheet("background-color: white");
    else if(t == "F") line->setStyleSheet("background-color: green");
    else if(t == "C") line->setStyleSheet("background-color: red");
    else if(t == "U") line->setStyleSheet("background-color: grey");
}
void MainWindow::f_rec_ASYS_SMIF(QByteArray str) {}
void MainWindow::f_rec_ISE_SMIF(QByteArray str) {}
void MainWindow::setCassData(QByteArrayList(parts)) // schreibt die empfangenen Cass.Daten in die RAC-Daten-Felder
{
    for (int i = 0; i < parts.count(); i++) // Carrierdaten in der Reihenfolge in die Tabelle eintragen
    {
        switch (i)
        {
        case 0: // Slots
            ui->lineCass_numbSlots_2->setPalette(palSchrift);
            ui->lineCass_numbSlots_2->setText(parts[i]);
            break;
        case 1: // First slot
            ui->lineCass_firstSlot_2->setPalette(palSchrift);
            ui->lineCass_firstSlot_2->setText(parts[i]);
            break;
        case 2: // Slot distance (Pitch)
            ui->lineCass_SlotDist_2->setPalette(palSchrift);
            ui->lineCass_SlotDist_2->setText(parts[i]);
            break;
        case 3: // Slotsizewindow
            ui->lineCass_SlotWdw_2->setPalette(palSchrift);
            ui->lineCass_SlotWdw_2->setText(parts[i]);
            break;
        case 4: // Wafersizewindow
            ui->lineCass_WafSizeWdw_2->setPalette(palSchrift);
            ui->lineCass_WafSizeWdw_2->setText(parts[i]);
            break;
        case 5: // Wafer Height Offset
            ui->lineCass_WafheightOff_2->setPalette(palSchrift);
            ui->lineCass_WafheightOff_2->setText(parts[i]);
            break;
        case 6: // Finger Height Offset
            ui->lineCass_fingerHeightOff_2->setPalette(palSchrift);
            ui->lineCass_fingerHeightOff_2->setText(parts[i]);
            break;
        case 7: // Flat
            if (parts[i] == "1")
            {
                ui->checkCass_notch_2->setChecked(0);
                ui->checkCass_flat_2->setChecked(1);
            }
            else
            {
                ui->checkCass_notch_2->setChecked(1);
                ui->checkCass_flat_2->setChecked(0);
            }
            break;
        }
    }
    int index = ui->line_cassid->text().toInt(&ok, 10);
    switch (index)
    {
    case 1:
        if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x01)) ui->checkCass_friction_2->setChecked(1); // friction wafer bitcodiert in Lift1
        else ui->checkCass_friction_2->setChecked(0);
        break;
    case 2:
        if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x02)) ui->checkCass_friction_2->setChecked(1);
        else ui->checkCass_friction_2->setChecked(0);
        break;
    case 3:
        if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x04)) ui->checkCass_friction_2->setChecked(1);
        else ui->checkCass_friction_2->setChecked(0);
        break;
    case 4:
        if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x08)) ui->checkCass_friction_2->setChecked(1);
        else ui->checkCass_friction_2->setChecked(0);
        break;
    case 5:
        if ((ui->combo_6inchsel->currentText().toInt(&ok, 10) & 0x01))
            ui->checkCass_friction_2->setChecked(1);
        else ui->checkCass_friction_2->setChecked(0);
        break;
    case 6:
        if ((ui->combo_6inchsel->currentText().toInt(&ok, 10) & 0x02))
            ui->checkCass_friction_2->setChecked(1);
        else ui->checkCass_friction_2->setChecked(0);
        break;
    case 7:
        if ((ui->combo_6inchsel->currentText().toInt(&ok, 10) & 0x04))
            ui->checkCass_friction_2->setChecked(1);
        else ui->checkCass_friction_2->setChecked(0);
        break;
    case 8:
        if ((ui->combo_6inchsel->currentText().toInt(&ok, 10) & 0x08))
            ui->checkCass_friction_2->setChecked(1);
        else ui->checkCass_friction_2->setChecked(0);
        break;
    case 9:
        if ((ui->combo_5inchsel->currentText().toInt(&ok, 10) & 0x01)) ui->checkCass_friction_2->setChecked(1);
        else ui->checkCass_friction_2->setChecked(0);
        break;
    case 10:
        if ((ui->combo_5inchsel->currentText().toInt(&ok, 10) & 0x02))
            ui->checkCass_friction_2->setChecked(1);
        else
            ui->checkCass_friction_2->setChecked(0);
        break;
    case 11:
        if ((ui->combo_5inchsel->currentText().toInt(&ok, 10) & 0x04))
            ui->checkCass_friction_2->setChecked(1);
        else
            ui->checkCass_friction_2->setChecked(0);
        break;
    case 12:
        if ((ui->combo_5inchsel->currentText().toInt(&ok, 10) & 0x08))
            ui->checkCass_friction_2->setChecked(1);
        else
            ui->checkCass_friction_2->setChecked(0);
        break;
    case 13:
        if ((ui->combo_4inchsel->currentText().toInt(&ok, 10) & 0x01))
            ui->checkCass_friction_2->setChecked(1);
        else
            ui->checkCass_friction_2->setChecked(0);
        break;
    case 14:
        if ((ui->combo_4inchsel->currentText().toInt(&ok, 10) & 0x02))
            ui->checkCass_friction_2->setChecked(1);
        else
            ui->checkCass_friction_2->setChecked(0);
        break;
    case 15:
        if ((ui->combo_4inchsel->currentText().toInt(&ok, 10) & 0x04))
            ui->checkCass_friction_2->setChecked(1);
        else
            ui->checkCass_friction_2->setChecked(0);
        break;
    case 16:
        if ((ui->combo_4inchsel->currentText().toInt(&ok, 10) & 0x08))
            ui->checkCass_friction_2->setChecked(1);
        else
            ui->checkCass_friction_2->setChecked(0);
        break;
    }
}
void MainWindow::set_Resetliste(int list) // liest RAC re.all aus
{
    if (list & 0b0000000000000001) // reset complete
    {

    } else {
    }
    if (list & 0b0000000000000010) // reset lift1 height
    {
        ui->label_res_L1H->setStyleSheet(backLightGreen);
        ui->push_lift1_init_height->setStyleSheet(backLightGreen);
    } else {
        ui->label_res_L1H->setStyleSheet(backLightRed);
        ui->push_lift1_init_height->setStyleSheet(backDefault);
    }
    if (list & 0b0000000000000100) // reset lift2 height
    {
        ui->label_res_L2H->setStyleSheet(backLightGreen);
        ui->p_lift2_init_height->setStyleSheet(backLightGreen);
    } else {
        ui->label_res_L2H->setStyleSheet(backLightRed);
        ui->p_lift2_init_height->setStyleSheet(backDefault);
    }
    if (list & 0b0000000000001000) // reset lift1 tilt
    {
        ui->label_res_L1T->setStyleSheet(backLightGreen);
        ui->push_lift1_init_tilt->setStyleSheet(backLightGreen);
    } else {
        ui->label_res_L1T->setStyleSheet(backLightRed);
        ui->push_lift1_init_tilt->setStyleSheet(backDefault);
    }
    if (list & 0b0000000000010000) // reset lift2 tilt
    {
        ui->label_res_L2T->setStyleSheet(backLightGreen);
        ui->p_lift2_init_tilt->setStyleSheet(backLightGreen);
    } else {
        ui->label_res_L2T->setStyleSheet(backLightRed);
        ui->p_lift2_init_tilt->setStyleSheet(backDefault);
    }
    if (list & 0b0000000000100000) // reset loader x
    {
        ui->label_res_LDX->setStyleSheet(backLightGreen);
        ui->p_loader_initxdrive->setStyleSheet(backLightGreen);
    } else {
        ui->label_res_LDX->setStyleSheet(backLightRed);
        ui->p_loader_initxdrive->setStyleSheet(backDefault);
    }
    if (list & 0b0000000001000000) // reset loader y
    {
        ui->label_res_LDY->setStyleSheet(backLightGreen);
        ui->p_loader_initydrive->setStyleSheet(backLightGreen);
    } else {
        ui->label_res_LDY->setStyleSheet(backLightRed);
        ui->p_loader_initydrive->setStyleSheet(backDefault);
    }
    if (list & 0b0000000010000000) // reset pa phi
    {
        ui->label_resPAP->setStyleSheet(backLightGreen);
        ui->p_INIT_PA_Phi->setStyleSheet(backLightGreen);
    }
    else
    {
        ui->label_resPAP->setStyleSheet(backLightRed);
        ui->p_INIT_PA_Phi->setStyleSheet(backDefault);
    }
    if (list & 0b0000000100000000) // reset pa height
    {
        ui->label_res_PAH->setStyleSheet(backLightGreen);
        ui->p_INIT_PA_Height->setStyleSheet(backLightGreen);
    }
    else
    {
        ui->label_res_PAH->setStyleSheet(backLightRed);
        ui->p_INIT_PA_Height->setStyleSheet(backDefault);
    }

    if (list & 0b0000001000000000) // reset pa tilt
    {
        ui->label_resPAT->setStyleSheet(backLightGreen);
        ui->p_INIT_PA_Tilt->setStyleSheet(backLightGreen);
    }
    else
    {
        ui->label_resPAT->setStyleSheet(backLightRed);
        ui->p_INIT_PA_Tilt->setStyleSheet(backDefault);
    }

    if (list & 0b0000010000000000) // reset pa rotpos
    {
        ui->label_resPAR->setStyleSheet(backLightGreen);
        ui->p_INIT_PA_RotPos->setStyleSheet(backLightGreen);
    }
    else
    {
        ui->label_resPAR->setStyleSheet(backLightRed);
        ui->p_INIT_PA_RotPos->setStyleSheet(backDefault);
    }

    if (list & 0b0000100000000000) // reset wc height
    {
        ui->label_resWCH->setStyleSheet(backLightGreen);
        ui->p_wc_initheight->setStyleSheet(backLightGreen);
    }
    else
    {
        ui->label_resWCH->setStyleSheet(backLightRed);
        ui->p_wc_initheight->setStyleSheet(backDefault);
    }

    if (list & 0b0001000000000000) // reset wc phi
    {
        ui->label_WCP->setStyleSheet(backLightGreen);
        ui->p_wc_initangle->setStyleSheet(backLightGreen);
    }
    else
    {
        ui->label_WCP->setStyleSheet(backLightRed);
        ui->p_wc_initangle->setStyleSheet(backDefault);
    }
}
void MainWindow::set_Materialliste(int list) {
    // LOADER    (01, Bit 0)
    // ALIGNER   (02, Bit 1)
    // STAGE     (04, Bit 2)
    // wWC1      (08, Bit 3)
    // wWC2      (10, Bit 4)
    // wSLOT     (20, Bit 5)
    if (list & 0b00100000) // SLOT vorhanden
    {

    } else {
    }
    if (list & 0b00000001) // Wafer auf Loader
    {
        ui->r_system_mm_loader->setChecked(1);
        ui->r_system_mm_loader->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_loader->setChecked(0);
        ui->r_system_mm_loader->setStyleSheet(backLightGrey);
    }
    if (list & 0b00000010) // Wafer auf PA
    {
        ui->r_system_mm_pa->setChecked(1);
        ui->r_system_mm_pa->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_pa->setChecked(0);
        ui->r_system_mm_pa->setStyleSheet(backLightGrey);
    }
    if (list & 0b00001000) // Wafer auf WC1
    {
        ui->r_system_mm_wc1->setChecked(1);
        ui->r_system_mm_wc1->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_wc1->setChecked(0);
        ui->r_system_mm_wc1->setStyleSheet(backLightGrey);
    }
    if (list & 0b00010000) // Wafer auf WC2
    {
        ui->r_system_mm_wc2->setChecked(1);
        ui->r_system_mm_wc2->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_wc2->setChecked(0);
        ui->r_system_mm_wc2->setStyleSheet(backLightGrey);
    }
    if (list & 0b00000100) // Wafer auf Chuck
    {
        ui->r_system_mm_chuck->setChecked(1);
        ui->r_system_mm_chuck->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_chuck->setChecked(0);
        ui->r_system_mm_chuck->setStyleSheet(backLightGrey);
    }
    if (list & 0b01000000) // Wafer aus Lift1
    {
        ui->r_system_mm_lift1->setChecked(1);
        ui->r_system_mm_lift1->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_lift1->setChecked(0);
        ui->r_system_mm_lift1->setStyleSheet(backLightGrey);
    }
    if (list & 0b10000000) // Wafer aus Lift2
    {
        ui->r_system_mm_lift2->setChecked(1);
        ui->r_system_mm_lift2->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_lift2->setChecked(0);
        ui->r_system_mm_lift2->setStyleSheet(backLightGrey);
    }
}
QString MainWindow::get_Materialliste()
{
    int list = 0;

    if (ui->r_system_mm_loader->isChecked() == 1) list |= 0b00000001; // Wafer auf Loader
    else list &= 0b11111101;

    if (ui->r_system_mm_pa->isChecked() == 1) list |= 0b00000010; // Wafer auf PA
    else list &= 0b11111011;

    if (ui->r_system_mm_wc1->isChecked() == 1) list |= 0b00001000; // Wafer auf WC1
    else list &= 0b11110111;

    if (ui->r_system_mm_wc2->isChecked() == 1) list |= 0b00010000; // Wafer auf WC2
    else list &= 0b11101111;

    if (ui->r_system_mm_chuck->isChecked() == 1) list |= 0b00000100; // Wafer auf Chuck
    else list &= 0b11011111;

    if (ui->r_system_mm_lift1->isChecked() == 1) list |= 0b01000000; // Wafer aus Lift1
    else list &= 0b10111111;

    if (ui->r_system_mm_lift2->isChecked() == 1)
        list |= 0b10000000; // Wafer aus Lift2
    else
        list &= 0b01111111;

    return QString::number(list);
}
QString MainWindow::get_Foundwafliste() {
    int list = 0;

    if (ui->r_system_mm_loader_2->isChecked() == 1)
        list |= 0b00000001; // Wafer auf Loader
    else
        list &= 0b11111101;

    if (ui->r_system_mm_pa_2->isChecked() == 1)
        list |= 0b00000010; // Wafer auf PA
    else
        list &= 0b11111011;

    if (ui->r_system_mm_wc1_2->isChecked() == 1)
        list |= 0b00001000; // Wafer auf WC1
    else
        list &= 0b11110111;

    if (ui->r_system_mm_wc2_2->isChecked() == 1)
        list |= 0b00010000; // Wafer auf WC2
    else
        list &= 0b11101111;

    if (ui->r_system_mm_chuck_2->isChecked() == 1)
        list |= 0b00000100; // Wafer auf Chuck
    else
        list &= 0b11011111;

    if (ui->r_system_mm_lift1_2->isChecked() == 1)
        list |= 0b01000000; // Wafer aus Lift1
    else
        list &= 0b10111111;

    if (ui->r_system_mm_lift2_2->isChecked() == 1)
        list |= 0b10000000; // Wafer aus Lift2
    else
        list &= 0b01111111;

    return QString::number(list);
}
void MainWindow::set_Foundwaferliste(int list) {
    if (list & 0b00000001) // found Wafer auf Loader
    {
        ui->r_system_mm_loader_2->setChecked(1);
        ui->r_system_mm_loader_2->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_loader_2->setChecked(0);
        ui->r_system_mm_loader_2->setStyleSheet(backLightGrey);
    }
    if (list & 0b00000010) // found Wafer auf PA
    {
        ui->r_system_mm_pa_2->setChecked(1);
        ui->r_system_mm_pa_2->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_pa_2->setChecked(0);
        ui->r_system_mm_pa_2->setStyleSheet(backLightGrey);
    }
    if (list & 0b00001000) // found Wafer auf WC1
    {
        ui->r_system_mm_wc1_2->setChecked(1);
        ui->r_system_mm_wc1_2->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_wc1_2->setChecked(0);
        ui->r_system_mm_wc1_2->setStyleSheet(backLightGrey);
    }
    if (list & 0b00010000) // found Wafer auf WC2
    {
        ui->r_system_mm_wc2_2->setChecked(1);
        ui->r_system_mm_wc2_2->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_wc2_2->setChecked(0);
        ui->r_system_mm_wc2_2->setStyleSheet(backLightGrey);
    }
    if (list & 0b00000100) // found Wafer auf Chuck
    {
        ui->r_system_mm_chuck_2->setChecked(1);
        ui->r_system_mm_chuck_2->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_chuck_2->setChecked(0);
        ui->r_system_mm_chuck_2->setStyleSheet(backLightGrey);
    }
    if (list & 0b01000000) // found Wafer aus Lift1
    {
        ui->r_system_mm_lift1_2->setChecked(1);
        ui->r_system_mm_lift1_2->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_lift1_2->setChecked(0);
        ui->r_system_mm_lift1_2->setStyleSheet(backLightGrey);
    }
    if (list & 0b10000000) // found Wafer aus Lift2
    {
        ui->r_system_mm_lift2_2->setChecked(1);
        ui->r_system_mm_lift2_2->setStyleSheet(backLightGreen);
    } else {
        ui->r_system_mm_lift2_2->setChecked(0);
        ui->r_system_mm_lift2_2->setStyleSheet(backLightGrey);
    }
}
void MainWindow::set_feederliste(QString data)
{
    int cd;
    char d[16];
    int i;
    int k;
    QString C[51];
    QString F[51];
    QString N[51];
    QString mu[51];
    QString su[51];
    QString node[17];

    uint16_t list = data.toUInt(&ok, 16);
    static int packcount = 0;

    if (data == "clear")
    {
        packcount = 0;

        ui->plainText_log_time->clear();
    }
    else
    {
        switch (packcount)
        {
        case 0: // fd1 (Lift1) ui->line_log_L1_1->setText(QString::number(list & 0b0000000000000011));
            //    if((list & 0b0000000000000011) == 0)
            //    ui->line_log_L1_1->setStyleSheet(backLightRed);
            if ((list & 0b0000000000000011) == 1) ui->line_log_L1_1->setStyleSheet(backLightGreen);
            else if ((list & 0b0000000000000011) == 2) ui->line_log_L1_1->setStyleSheet(backLightBlue);
            else if ((list & 0b0000000000000011) == 3) ui->line_log_L1_1->setStyleSheet(backLightYello);
            else ui->line_log_L1_1->setStyleSheet(backLightGrey);
            ui->line_log_L1_2->setText(QString::number((list & 0b0000000000001100) >> 2));
            //    if(((list & 0b0000000000001100)>>2) == 0)
            //    ui->line_log_L1_2->setStyleSheet(backLightRed);
            if (((list & 0b0000000000001100) >> 2) == 1) ui->line_log_L1_2->setStyleSheet(backLightGreen);
            else if (((list & 0b0000000000001100) >> 2) == 2) ui->line_log_L1_2->setStyleSheet(backLightBlue);
            else if (((list & 0b0000000000001100) >> 2) == 3) ui->line_log_L1_2->setStyleSheet(backLightYello);
            else ui->line_log_L1_2->setStyleSheet(backLightGrey);
            ui->line_log_L1_3->setText(QString::number((list & 0b0000000000110000) >> 4));
            //    if(((list & 0b0000000000110000)>>4) == 0)
            //    ui->line_log_L1_3->setStyleSheet(backLightRed);
            if (((list & 0b0000000000110000) >> 4) == 1) ui->line_log_L1_3->setStyleSheet(backLightGreen);
            else if (((list & 0b0000000000110000) >> 4) == 2) ui->line_log_L1_3->setStyleSheet(backLightBlue);
            else if (((list & 0b0000000000110000) >> 4) == 3) ui->line_log_L1_3->setStyleSheet(backLightYello);
            else ui->line_log_L1_3->setStyleSheet(backLightGrey);
            ui->line_log_L1_4->setText(QString::number((list & 0b0000000011000000) >> 6));
            if (((list & 0b0000000011000000) >> 6) == 1) ui->line_log_L1_4->setStyleSheet(backLightGreen);
            else if (((list & 0b0000000011000000) >> 6) == 2) ui->line_log_L1_4->setStyleSheet(backLightBlue);
            else if (((list & 0b0000000011000000) >> 6) == 3) ui->line_log_L1_4->setStyleSheet(backLightYello);
            else ui->line_log_L1_4->setStyleSheet(backLightGrey);
            ui->line_log_L1_5->setText(QString::number((list & 0b0000001100000000) >> 8));
            if (((list & 0b0000001100000000) >> 8) == 1) ui->line_log_L1_5->setStyleSheet(backLightGreen);
            else if (((list & 0b0000001100000000) >> 8) == 2) ui->line_log_L1_5->setStyleSheet(backLightBlue);
            else if (((list & 0b0000001100000000) >> 8) == 3) ui->line_log_L1_5->setStyleSheet(backLightYello);
            else ui->line_log_L1_5->setStyleSheet(backLightGrey);
            ui->line_log_L1_6->setText(QString::number((list & 0b0000110000000000) >> 10));
            if (((list & 0b0000110000000000) >> 10) == 1) ui->line_log_L1_6->setStyleSheet(backLightGreen);
            else if (((list & 0b0000110000000000) >> 10) == 2)ui->line_log_L1_6->setStyleSheet(backLightBlue);
            else if (((list & 0b0000110000000000) >> 10) == 3) ui->line_log_L1_6->setStyleSheet(backLightYello);
            else ui->line_log_L1_6->setStyleSheet(backLightGrey);
            ui->line_log_L1_7->setText(QString::number((list & 0b0011000000000000) >> 12));
            if (((list & 0b0011000000000000) >> 12) == 1) ui->line_log_L1_7->setStyleSheet(backLightGreen);
            else if (((list & 0b0011000000000000) >> 12) == 2) ui->line_log_L1_7->setStyleSheet(backLightBlue);
            else if (((list & 0b0011000000000000) >> 12) == 3) ui->line_log_L1_7->setStyleSheet(backLightYello);
            else ui->line_log_L1_7->setStyleSheet(backLightGrey);
            ui->line_log_L1_8->setText(QString::number((list & 0b1100000000000000) >> 14));
            if (((list & 0b1100000000000000) >> 14) == 1) ui->line_log_L1_8->setStyleSheet(backLightGreen);
            else if (((list & 0b1100000000000000) >> 14) == 2) ui->line_log_L1_8->setStyleSheet(backLightBlue);
            else if (((list & 0b1100000000000000) >> 14) == 3) ui->line_log_L1_8->setStyleSheet(backLightYello);
            else ui->line_log_L1_8->setStyleSheet(backLightGrey);
            packcount++;
            break;
        case 1: // fd2 (Lift2)
            ui->line_log_L2_1->setText(QString::number(list & 0b0000000000000011));
            if ((list & 0b0000000000000011) == 1) ui->line_log_L2_1->setStyleSheet(backLightGreen);
            else if ((list & 0b0000000000000011) == 2) ui->line_log_L2_1->setStyleSheet(backLightBlue);
            else if ((list & 0b0000000000000011) == 3) ui->line_log_L2_1->setStyleSheet(backLightYello);
            else ui->line_log_L2_1->setStyleSheet(backLightGrey);
            ui->line_log_L2_2->setText(QString::number((list & 0b0000000000001100) >> 2));
            if (((list & 0b0000000000001100) >> 2) == 1) ui->line_log_L2_2->setStyleSheet(backLightGreen);
            else if (((list & 0b0000000000001100) >> 2) == 2) ui->line_log_L2_2->setStyleSheet(backLightBlue);
            else if (((list & 0b0000000000001100) >> 2) == 3) ui->line_log_L2_2->setStyleSheet(backLightYello);
            else ui->line_log_L2_2->setStyleSheet(backLightGrey);
            ui->line_log_L2_3->setText(QString::number((list & 0b0000000000110000) >> 4));
            if (((list & 0b0000000000110000) >> 4) == 1) ui->line_log_L2_3->setStyleSheet(backLightGreen);
            else if (((list & 0b0000000000110000) >> 4) == 2) ui->line_log_L2_3->setStyleSheet(backLightBlue);
            else if (((list & 0b0000000000110000) >> 4) == 3) ui->line_log_L2_3->setStyleSheet(backLightYello);
            else ui->line_log_L2_3->setStyleSheet(backLightGrey);
            ui->line_log_L2_4->setText(QString::number((list & 0b0000000011000000) >> 6));
            if (((list & 0b0000000011000000) >> 6) == 1) ui->line_log_L2_4->setStyleSheet(backLightGreen);
            else if (((list & 0b0000000011000000) >> 6) == 2) ui->line_log_L2_4->setStyleSheet(backLightBlue);
            else if (((list & 0b0000000011000000) >> 6) == 3) ui->line_log_L2_4->setStyleSheet(backLightYello);
            else ui->line_log_L2_4->setStyleSheet(backLightGrey);
            ui->line_log_L2_5->setText(QString::number((list & 0b0000001100000000) >> 8));
            if (((list & 0b0000001100000000) >> 8) == 1) ui->line_log_L2_5->setStyleSheet(backLightGreen);
            else if (((list & 0b0000001100000000) >> 8) == 2) ui->line_log_L2_5->setStyleSheet(backLightBlue);
            else if (((list & 0b0000001100000000) >> 8) == 3) ui->line_log_L2_5->setStyleSheet(backLightYello);
            else ui->line_log_L2_5->setStyleSheet(backLightGrey);
            ui->line_log_L2_6->setText(QString::number((list & 0b0000110000000000) >> 10));
            if (((list & 0b0000110000000000) >> 10) == 1) ui->line_log_L2_6->setStyleSheet(backLightGreen);
            else if (((list & 0b0000110000000000) >> 10) == 2) ui->line_log_L2_6->setStyleSheet(backLightBlue);
            else if (((list & 0b0000110000000000) >> 10) == 3) ui->line_log_L2_6->setStyleSheet(backLightYello);
            else ui->line_log_L2_6->setStyleSheet(backLightGrey);
            ui->line_log_L2_7->setText(QString::number((list & 0b0011000000000000) >> 12));
            if (((list & 0b0011000000000000) >> 12) == 1) ui->line_log_L2_7->setStyleSheet(backLightGreen);
            else if (((list & 0b0011000000000000) >> 12) == 2) ui->line_log_L2_7->setStyleSheet(backLightBlue);
            else if (((list & 0b0011000000000000) >> 12) == 3) ui->line_log_L2_7->setStyleSheet(backLightYello);
            else ui->line_log_L2_7->setStyleSheet(backLightGrey);
            ui->line_log_L2_8->setText(QString::number((list & 0b1100000000000000) >> 14));
            if (((list & 0b1100000000000000) >> 14) == 1) ui->line_log_L2_8->setStyleSheet(backLightGreen);
            else if (((list & 0b1100000000000000) >> 14) == 2) ui->line_log_L2_8->setStyleSheet(backLightBlue);
            else if (((list & 0b1100000000000000) >> 14) == 3) ui->line_log_L2_8->setStyleSheet(backLightYello);
            else ui->line_log_L2_8->setStyleSheet(backLightGrey);
            packcount++;
            break;
        case 2: // fLD
            cd = data.length();
            k = cd;
            qDebug() << "cd LD" << cd;
            for (i = 1; i < cd + 1; i++)
            {
                qDebug() << "data.mid(cd-i,1)" << i << data.mid(cd - i, 1);
                d[cd - k] = data.mid(cd - i, 1).toUInt(&ok, 16); // LSB in d[0]
                --k;
            }
            ui->line_log_LD2->setText(QString::number(d[7] & 0x03)); // MSB LDX Lift2
            if ((d[7] & 0x03) == 1) ui->line_log_LD2->setStyleSheet(backLightGreen);
            else if ((d[7] & 0x03) == 2) ui->line_log_LD2->setStyleSheet(backLightBlue);
            else if ((d[7] & 0x03) == 3) ui->line_log_LD2->setStyleSheet(backLightYello);
            else ui->line_log_LD2->setStyleSheet(backLightGrey);
            ui->line_log_LD1->setText(QString::number((d[7] & 0x0C) >> 2)); // LDX Lift1
            if ((d[7] & 0x0C) >> 2 == 1) ui->line_log_LD1->setStyleSheet(backLightGreen);
            else if ((d[7] & 0x0C) >> 2 == 2) ui->line_log_LD1->setStyleSheet(backLightBlue);
            else if ((d[7] & 0x0C) >> 2 == 3) ui->line_log_LD1->setStyleSheet(backLightYello);
            else ui->line_log_LD1->setStyleSheet(backLightGrey);
            ui->line_log_LD4->setText(QString::number(d[6] & 0x03));
            if ((d[6] & 0x03) == 1) ui->line_log_LD4->setStyleSheet(backLightGreen);
            else if ((d[6] & 0x03) == 2) ui->line_log_LD4->setStyleSheet(backLightBlue);
            else if ((d[6] & 0x03) == 3) ui->line_log_LD4->setStyleSheet(backLightYello);
            else ui->line_log_LD4->setStyleSheet(backLightGrey);
            ui->line_log_LD3->setText(QString::number((d[6] & 0x0C) >> 2));
            if ((d[6] & 0x0C) >> 2 == 1) ui->line_log_LD3->setStyleSheet(backLightGreen);
            else if ((d[6] & 0x0C) >> 2 == 2) ui->line_log_LD3->setStyleSheet(backLightBlue);
            else if ((d[6] & 0x0C) >> 2 == 3) ui->line_log_LD3->setStyleSheet(backLightYello);
            else ui->line_log_LD3->setStyleSheet(backLightGrey);
            ui->line_log_LD6->setText(QString::number(d[5] & 0x03));
            if ((d[5] & 0x03) == 1) ui->line_log_LD6->setStyleSheet(backLightGreen);
            else if ((d[5] & 0x03) == 2) ui->line_log_LD6->setStyleSheet(backLightBlue);
            else if ((d[5] & 0x03) == 3) ui->line_log_LD6->setStyleSheet(backLightYello);
            else ui->line_log_LD6->setStyleSheet(backLightGrey);
            ui->line_log_LD5->setText(QString::number((d[5] & 0x0C) >> 2));
            if ((d[5] & 0x0C) >> 2 == 1) ui->line_log_LD5->setStyleSheet(backLightGreen);
            else if ((d[5] & 0x0C) >> 2 == 2) ui->line_log_LD5->setStyleSheet(backLightBlue);
            else if ((d[5] & 0x0C) >> 2 == 3) ui->line_log_LD5->setStyleSheet(backLightYello);
            else ui->line_log_LD5->setStyleSheet(backLightGrey);
            ui->line_log_LD8->setText(QString::number(d[4] & 0x03));
            if ((d[4] & 0x03) == 1) ui->line_log_LD8->setStyleSheet(backLightGreen);
            else if ((d[4] & 0x03) == 2) ui->line_log_LD8->setStyleSheet(backLightBlue);
            else if ((d[4] & 0x03) == 3) ui->line_log_LD8->setStyleSheet(backLightYello);
            else ui->line_log_LD8->setStyleSheet(backLightGrey);
            ui->line_log_LD7->setText(QString::number((d[4] & 0x0C) >> 2));
            if ((d[4] & 0x0C) >> 2 == 1) ui->line_log_LD7->setStyleSheet(backLightGreen);
            else if ((d[4] & 0x0C) >> 2 == 2) ui->line_log_LD7->setStyleSheet(backLightBlue);
            else if ((d[4] & 0x0C) >> 2 == 3) ui->line_log_LD7->setStyleSheet(backLightYello);
            else ui->line_log_LD7->setStyleSheet(backLightGrey);
            ui->line_log_LD10->setText(QString::number(d[3] & 0x03));
            if ((d[3] & 0x03) == 1) ui->line_log_LD10->setStyleSheet(backLightGreen);
            else if ((d[3] & 0x03) == 2) ui->line_log_LD10->setStyleSheet(backLightBlue);
            else if ((d[3] & 0x03) == 3) ui->line_log_LD10->setStyleSheet(backLightYello);
            else ui->line_log_LD10->setStyleSheet(backLightGrey);
            ui->line_log_LD9->setText(QString::number((d[3] & 0x0C) >> 2));
            if ((d[3] & 0x0C) >> 2 == 1) ui->line_log_LD9->setStyleSheet(backLightGreen);
            else if ((d[3] & 0x0C) >> 2 == 2) ui->line_log_LD9->setStyleSheet(backLightBlue);
            else if ((d[3] & 0x0C) >> 2 == 3) ui->line_log_LD9->setStyleSheet(backLightYello);
            else ui->line_log_LD9->setStyleSheet(backLightGrey);
            ui->line_log_LD11->setText(QString::number((d[2] & 0x0C) >> 2));
            if ((d[2] & 0x0C) >> 2 == 1) ui->line_log_LD11->setStyleSheet(backLightGreen);
            else if ((d[2] & 0x0C) >> 2 == 2) ui->line_log_LD11->setStyleSheet(backLightBlue);
            else if ((d[2] & 0x0C) >> 2 == 3) ui->line_log_LD11->setStyleSheet(backLightYello);
            else ui->line_log_LD11->setStyleSheet(backLightGrey);
            packcount++;
            break;
        case 3: // fPA
            cd = data.length();
            qDebug() << "cd PA" << cd;
            k = cd;
            for (i = 1; i < cd + 1; i++) {
                d[cd - k] = data.mid(cd - i, 1).toUInt(&ok, 16);
                --k;
            }
            ui->line_log_PA15->setText(QString::number((d[0] & 0x0c) >> 2));
            if ((d[0] & 0x0c) >> 2 == 1)
                ui->line_log_PA15->setStyleSheet(backLightGreen);
            else if ((d[0] & 0x0c) >> 2 == 2)
                ui->line_log_PA15->setStyleSheet(backLightBlue);
            else if ((d[0] & 0x0c) >> 2 == 3)
                ui->line_log_PA15->setStyleSheet(backLightYello);
            else
                ui->line_log_PA15->setStyleSheet(backLightGrey);
            ui->line_log_PA2->setText(QString::number(d[7] & 0x03));
            if ((d[7] & 0x03) == 1)
                ui->line_log_PA2->setStyleSheet(backLightGreen);
            else if ((d[7] & 0x03) == 2)
                ui->line_log_PA2->setStyleSheet(backLightBlue);
            else if ((d[7] & 0x03) == 3)
                ui->line_log_PA2->setStyleSheet(backLightYello);
            else
                ui->line_log_PA2->setStyleSheet(backLightGrey);
            ui->line_log_PA1->setText(QString::number((d[7] & 0x0C) >> 2));
            if ((d[7] & 0x0C) >> 2 == 1)
                ui->line_log_PA1->setStyleSheet(backLightGreen);
            else if ((d[7] & 0x0C) >> 2 == 2)
                ui->line_log_PA1->setStyleSheet(backLightBlue);
            else if ((d[7] & 0x0C) >> 2 == 3)
                ui->line_log_PA1->setStyleSheet(backLightYello);
            else
                ui->line_log_PA1->setStyleSheet(backLightGrey);
            ui->line_log_PA4->setText(QString::number(d[6] & 0x03));
            if ((d[6] & 0x03) == 1)
                ui->line_log_PA4->setStyleSheet(backLightGreen);
            else if ((d[6] & 0x03) == 2)
                ui->line_log_PA4->setStyleSheet(backLightBlue);
            else if ((d[6] & 0x03) == 3)
                ui->line_log_PA4->setStyleSheet(backLightYello);
            else
                ui->line_log_PA4->setStyleSheet(backLightGrey);
            ui->line_log_PA3->setText(QString::number((d[6] & 0x0C) >> 2));
            if ((d[6] & 0x0C) >> 2 == 1)
                ui->line_log_PA3->setStyleSheet(backLightGreen);
            else if ((d[6] & 0x0C) >> 2 == 2)
                ui->line_log_PA3->setStyleSheet(backLightBlue);
            else if ((d[6] & 0x0C) >> 2 == 3)
                ui->line_log_PA3->setStyleSheet(backLightYello);
            else
                ui->line_log_PA3->setStyleSheet(backLightGrey);
            ui->line_log_PA6->setText(QString::number(d[5] & 0x03));
            if ((d[5] & 0x03) == 1)
                ui->line_log_PA6->setStyleSheet(backLightGreen);
            else if ((d[5] & 0x03) == 2)
                ui->line_log_PA6->setStyleSheet(backLightBlue);
            else if ((d[5] & 0x03) == 3)
                ui->line_log_PA6->setStyleSheet(backLightYello);
            else
                ui->line_log_PA6->setStyleSheet(backLightGrey);
            ui->line_log_PA5->setText(QString::number((d[5] & 0x0C) >> 2));
            if ((d[5] & 0x0C) >> 2 == 1)
                ui->line_log_PA5->setStyleSheet(backLightGreen);
            else if ((d[5] & 0x0C) >> 2 == 2)
                ui->line_log_PA5->setStyleSheet(backLightBlue);
            else if ((d[5] & 0x0C) >> 2 == 3)
                ui->line_log_PA5->setStyleSheet(backLightYello);
            else
                ui->line_log_PA5->setStyleSheet(backLightGrey);
            ui->line_log_PA8->setText(QString::number(d[4] & 0x03));
            if ((d[4] & 0x03) == 1)
                ui->line_log_PA8->setStyleSheet(backLightGreen);
            else if ((d[4] & 0x03) == 2)
                ui->line_log_PA8->setStyleSheet(backLightBlue);
            else if ((d[4] & 0x03) == 3)
                ui->line_log_PA8->setStyleSheet(backLightYello);
            else
                ui->line_log_PA8->setStyleSheet(backLightGrey);
            ui->line_log_PA7->setText(QString::number((d[4] & 0x0C) >> 2));
            if ((d[4] & 0x0C) >> 2 == 1)
                ui->line_log_PA7->setStyleSheet(backLightGreen);
            else if ((d[4] & 0x0C) >> 2 == 2)
                ui->line_log_PA7->setStyleSheet(backLightBlue);
            else if ((d[4] & 0x0C) >> 2 == 3)
                ui->line_log_PA7->setStyleSheet(backLightYello);
            else
                ui->line_log_PA7->setStyleSheet(backLightGrey);
            ui->line_log_PA10->setText(QString::number(d[3] & 0x03));
            if ((d[3] & 0x03) == 1)
                ui->line_log_PA10->setStyleSheet(backLightGreen);
            else if ((d[3] & 0x03) == 2)
                ui->line_log_PA10->setStyleSheet(backLightBlue);
            else if ((d[3] & 0x03) == 3)
                ui->line_log_PA10->setStyleSheet(backLightYello);
            else
                ui->line_log_PA10->setStyleSheet(backLightGrey);
            ui->line_log_PA9->setText(QString::number((d[3] & 0x0C) >> 2));
            if ((d[3] & 0x0C) >> 2 == 1)
                ui->line_log_PA9->setStyleSheet(backLightGreen);
            else if ((d[3] & 0x0C) >> 2 == 2)
                ui->line_log_PA9->setStyleSheet(backLightBlue);
            else if ((d[3] & 0x0C) >> 2 == 3)
                ui->line_log_PA9->setStyleSheet(backLightYello);
            else
                ui->line_log_PA9->setStyleSheet(backLightGrey);
            ui->line_log_PA12->setText(QString::number(d[2] & 0x03));
            if ((d[2] & 0x03) == 1)
                ui->line_log_PA12->setStyleSheet(backLightGreen);
            else if ((d[2] & 0x03) == 2)
                ui->line_log_PA12->setStyleSheet(backLightBlue);
            else if ((d[2] & 0x03) == 3)
                ui->line_log_PA12->setStyleSheet(backLightYello);
            else
                ui->line_log_PA12->setStyleSheet(backLightGrey);
            ui->line_log_PA11->setText(QString::number((d[2] & 0x0C) >> 2));
            if ((d[2] & 0x0C) >> 2 == 1)
                ui->line_log_PA11->setStyleSheet(backLightGreen);
            else if ((d[2] & 0x0C) >> 2 == 2)
                ui->line_log_PA11->setStyleSheet(backLightBlue);
            else if ((d[2] & 0x0C) >> 2 == 3)
                ui->line_log_PA11->setStyleSheet(backLightYello);
            else
                ui->line_log_PA11->setStyleSheet(backLightGrey);
            ui->line_log_PA14->setText(QString::number(d[1] & 0x03));
            if ((d[1] & 0x03) == 1)
                ui->line_log_PA14->setStyleSheet(backLightGreen);
            else if ((d[1] & 0x03) == 2)
                ui->line_log_PA14->setStyleSheet(backLightBlue);
            else if ((d[1] & 0x03) == 3)
                ui->line_log_PA14->setStyleSheet(backLightYello);
            else
                ui->line_log_PA14->setStyleSheet(backLightGrey);
            ui->line_log_PA13->setText(QString::number((d[1] & 0x0C) >> 2));
            if ((d[1] & 0x0C) >> 2 == 1)
                ui->line_log_PA13->setStyleSheet(backLightGreen);
            else if ((d[1] & 0x0C) >> 2 == 2)
                ui->line_log_PA13->setStyleSheet(backLightBlue);
            else if ((d[1] & 0x0C) >> 2 == 3)
                ui->line_log_PA13->setStyleSheet(backLightYello);
            else
                ui->line_log_PA13->setStyleSheet(backLightGrey);
            packcount++;
            break;
        case 4: // fWC
            cd = data.length();
            k = cd;
            for (i = 1; i < cd + 1; i++) {
                d[cd - k] = data.mid(cd - i, 1).toUInt(&ok, 16);
                //           qDebug()<<"WC d["<<cd-k<<"]"<<QString::number(d[cd-k]);
                --k;
            }
            ui->line_log_WC2->setText(QString::number(d[7] & 0x03));
            if ((d[7] & 0x03) == 1)
                ui->line_log_WC2->setStyleSheet(backLightGreen);
            else if ((d[7] & 0x03) == 2)
                ui->line_log_WC2->setStyleSheet(backLightBlue);
            else if ((d[7] & 0x03) == 3)
                ui->line_log_WC2->setStyleSheet(backLightYello);
            else
                ui->line_log_WC2->setStyleSheet(backLightGrey);
            ui->line_log_WC1->setText(QString::number((d[7] & 0x0C) >> 2));
            if ((d[7] & 0x0C) >> 2 == 1)
                ui->line_log_WC1->setStyleSheet(backLightGreen);
            else if ((d[7] & 0x0C) >> 2 == 2)
                ui->line_log_WC1->setStyleSheet(backLightBlue);
            else if ((d[7] & 0x0C) >> 2 == 3)
                ui->line_log_WC1->setStyleSheet(backLightYello);
            else
                ui->line_log_WC1->setStyleSheet(backLightGrey);
            ui->line_log_WC4->setText(QString::number(d[6] & 0x03));
            if ((d[6] & 0x03) == 1)
                ui->line_log_WC4->setStyleSheet(backLightGreen);
            else if ((d[6] & 0x03) == 2)
                ui->line_log_WC4->setStyleSheet(backLightBlue);
            else if ((d[6] & 0x03) == 3)
                ui->line_log_WC4->setStyleSheet(backLightYello);
            else
                ui->line_log_WC4->setStyleSheet(backLightGrey);
            ui->line_log_WC3->setText(QString::number((d[6] & 0x0C) >> 2));
            if ((d[6] & 0x0C) >> 2 == 1)
                ui->line_log_WC3->setStyleSheet(backLightGreen);
            else if ((d[6] & 0x0C) >> 2 == 2)
                ui->line_log_WC3->setStyleSheet(backLightBlue);
            else if ((d[6] & 0x0C) >> 2 == 3)
                ui->line_log_WC3->setStyleSheet(backLightYello);
            else
                ui->line_log_WC3->setStyleSheet(backLightGrey);
            ui->line_log_WC6->setText(QString::number(d[5] & 0x03));
            if ((d[5] & 0x03) == 1)
                ui->line_log_WC6->setStyleSheet(backLightGreen);
            else if ((d[5] & 0x03) == 2)
                ui->line_log_WC6->setStyleSheet(backLightBlue);
            else if ((d[5] & 0x03) == 3)
                ui->line_log_WC6->setStyleSheet(backLightYello);
            else
                ui->line_log_WC6->setStyleSheet(backLightGrey);
            ui->line_log_WC5->setText(QString::number((d[5] & 0x0C) >> 2));
            if ((d[5] & 0x0C) >> 2 == 1)
                ui->line_log_WC5->setStyleSheet(backLightGreen);
            else if ((d[5] & 0x0C) >> 2 == 2)
                ui->line_log_WC5->setStyleSheet(backLightBlue);
            else if ((d[5] & 0x0C) >> 2 == 3)
                ui->line_log_WC5->setStyleSheet(backLightYello);
            else
                ui->line_log_WC5->setStyleSheet(backLightGrey);
            ui->line_log_WC8->setText(QString::number(d[4] & 0x03));
            if ((d[4] & 0x03) == 1)
                ui->line_log_WC8->setStyleSheet(backLightGreen);
            else if ((d[4] & 0x03) == 2)
                ui->line_log_WC8->setStyleSheet(backLightBlue);
            else if ((d[4] & 0x03) == 3)
                ui->line_log_WC8->setStyleSheet(backLightYello);
            else
                ui->line_log_WC8->setStyleSheet(backLightGrey);
            ui->line_log_WC7->setText(QString::number((d[4] & 0x0C) >> 2));
            if ((d[4] & 0x0C) >> 2 == 1)
                ui->line_log_WC7->setStyleSheet(backLightGreen);
            else if ((d[4] & 0x0C) >> 2 == 2)
                ui->line_log_WC7->setStyleSheet(backLightBlue);
            else if ((d[4] & 0x0C) >> 2 == 3)
                ui->line_log_WC7->setStyleSheet(backLightYello);
            else
                ui->line_log_WC7->setStyleSheet(backLightGrey);
            ui->line_log_WC10->setText(QString::number(d[3] & 0x03));
            if ((d[3] & 0x03) == 1)
                ui->line_log_WC10->setStyleSheet(backLightGreen);
            else if ((d[3] & 0x03) == 2)
                ui->line_log_WC10->setStyleSheet(backLightBlue);
            else if ((d[3] & 0x03) == 3)
                ui->line_log_WC10->setStyleSheet(backLightYello);
            else
                ui->line_log_WC10->setStyleSheet(backLightGrey);
            ui->line_log_WC9->setText(QString::number((d[3] & 0x0C) >> 2));
            if ((d[3] & 0x0C) >> 2 == 1)
                ui->line_log_WC9->setStyleSheet(backLightGreen);
            else if ((d[3] & 0x0C) >> 2 == 2)
                ui->line_log_WC9->setStyleSheet(backLightBlue);
            else if ((d[3] & 0x0C) >> 2 == 3)
                ui->line_log_WC9->setStyleSheet(backLightYello);
            else
                ui->line_log_WC9->setStyleSheet(backLightGrey);
            ui->line_log_WC11->setText(QString::number((d[2] & 0x0C) >> 2));
            if ((d[2] & 0x0C) >> 2 == 1)
                ui->line_log_WC11->setStyleSheet(backLightGreen);
            else if ((d[2] & 0x0C) >> 2 == 2)
                ui->line_log_WC11->setStyleSheet(backLightBlue);
            else if ((d[2] & 0x0C) >> 2 == 3)
                ui->line_log_WC11->setStyleSheet(backLightYello);
            else
                ui->line_log_WC11->setStyleSheet(backLightGrey);
            packcount++;
            break;
        case 5:
            cd = data.length();
            qDebug() << "cd vac" << cd;
            k = cd;
            for (i = 1; i < cd + 1;
                 i++) { // Byte enthält zwei Nibble (H-Nibble und L-Nibble), das
                // unterste L-Nibble wird zuerst ausgelesen und in d[0]
                // gespeichert
                d[cd - k] = data.mid(cd - i, 1).toUInt(
                            &ok,
                            16); // d[0] enthält L-Nibble, Maskierung 0x03 ergibt ersten Wert
                qDebug() << "d[" << cd - k << "]" << QString::number(d[cd - k]);
                --k;
            }
            qDebug() << "d0,0"
                     << QString::number(d[0] & 0x03); // Byte0, Nibble0 LD_vac
            qDebug() << "d0,1"
                     << QString::number((d[0] & 0x0C) >>
                                        2); // Byte0, Nibble1 LD_pollvac
            qDebug() << "d1,0"
                     << QString::number(d[1] & 0x03); // Byte0, Nibble2 PA_vac
            qDebug() << "d1,1"
                     << QString::number((d[1] & 0x0C) >>
                                        2); // Byte0, Nibble3 PA_pollvac
            qDebug() << "d2,0"
                     << QString::number(d[2] & 0x03); // Byte1, Nibble0 WC1_vac
            qDebug() << "d2,1"
                     << QString::number((d[2] & 0x0C) >>
                                        2); // Byte1, Nibble1 WC1_pollvac
            qDebug() << "d3,0"
                     << QString::number(d[3] & 0x03); // Byte1, Nibble2 WC2_vac
            qDebug() << "d3,1"
                     << QString::number((d[3] & 0x0C) >>
                                        2); // Byte1, Nibble3 WC2_pollvac
            qDebug() << "d4,0"
                     << QString::number(d[4] & 0x03); // Byte2, Nibble0 CH4_vac
            qDebug() << "d4,1"
                     << QString::number((d[4] & 0x0C) >>
                                        2); // Byte2, Nibble1 CH4_pollvac
            qDebug() << "d5,0"
                     << QString::number(d[5] & 0x03); // Byte2, Nibble2 CH6_vac
            qDebug() << "d5,1"
                     << QString::number((d[5] & 0x0C) >> 2); // Byte2, Nibble3 CH8_vac

            if ((d[0] & 0x03) == 0) {
                ui->rd_log_LD_vacoff_3->setChecked(0);
                ui->rd_log_LD_vacoff_3->setStyleSheet(radioGrey);
            } else if ((d[0] & 0x03) == 1) {
                ui->rd_log_LD_vacoff_3->setChecked(1);
                ui->rd_log_LD_vacoff_3->setStyleSheet(radioGreen);
            } else if ((d[0] & 0x03) == 2) {
                ui->rd_log_LD_vacoff_3->setChecked(0);
                ui->rd_log_LD_vacoff_3->setStyleSheet(radioYello);
            } else if ((d[0] & 0x03) == 3) {
                ui->rd_log_LD_vacoff_3->setChecked(0);
                ui->rd_log_LD_vacoff_3->setStyleSheet(radioRed);
            }
            if ((d[0] & 0x0C) >> 2 == 0) // LD_vacpoll
            {
                ui->rd_log_LD_avac_3->setChecked(0);
                ui->rd_log_LD_avac_3->setStyleSheet(radioGrey);
            } else if ((d[0] & 0x0C) >> 2 == 1) {
                ui->rd_log_LD_avac_3->setChecked(1);
                ui->rd_log_LD_avac_3->setStyleSheet(radioGreen);
            } else if ((d[0] & 0x0C) >> 2 == 2) {
                ui->rd_log_LD_avac_3->setChecked(0);
                ui->rd_log_LD_avac_3->setStyleSheet(radioYello);
            } else if ((d[0] & 0x0C) >> 2 == 3) {
                ui->rd_log_LD_avac_3->setChecked(0);
                ui->rd_log_LD_avac_3->setStyleSheet(radioRed);
            }
            if ((d[1] & 0x03) == 0) {
                ui->rd_log_PA_vacoff_3->setChecked(0);
                ui->rd_log_PA_vacoff_3->setStyleSheet(radioGrey);
            } else if ((d[1] & 0x03) == 1) {
                ui->rd_log_PA_vacoff_3->setChecked(1);
                ui->rd_log_PA_vacoff_3->setStyleSheet(radioGreen);
            } else if ((d[1] & 0x03) == 2) {
                ui->rd_log_PA_vacoff_3->setChecked(0);
                ui->rd_log_PA_vacoff_3->setStyleSheet(radioYello);
            } else if ((d[1] & 0x03) == 3) {
                ui->rd_log_PA_vacoff_3->setChecked(0);
                ui->rd_log_PA_vacoff_3->setStyleSheet(radioRed);
            }
            if ((d[1] & 0x0C) >> 2 == 0) {
                ui->rd_log_PA_avac_3->setChecked(0);
                ui->rd_log_PA_avac_3->setStyleSheet(radioGrey);
            } else if ((d[1] & 0x0C) >> 2 == 1) {
                ui->rd_log_PA_avac_3->setChecked(1);
                ui->rd_log_PA_avac_3->setStyleSheet(radioGreen);
            } else if ((d[1] & 0x0C) >> 2 == 2) {
                ui->rd_log_PA_avac_3->setChecked(0);
                ui->rd_log_PA_avac_3->setStyleSheet(radioYello);
            } else if ((d[1] & 0x0C) >> 2 == 3) {
                ui->rd_log_PA_avac_3->setChecked(0);
                ui->rd_log_PA_avac_3->setStyleSheet(radioRed);
            }
            if ((d[2] & 0x03) == 0) {
                ui->rd_log_WC1_vacoff_3->setChecked(0);
                ui->rd_log_WC1_vacoff_3->setStyleSheet(radioGrey);
            } else if ((d[2] & 0x03) == 1) {
                ui->rd_log_WC1_vacoff_3->setChecked(1);
                ui->rd_log_WC1_vacoff_3->setStyleSheet(radioGreen);
            } else if ((d[2] & 0x03) == 2) {
                ui->rd_log_WC1_vacoff_3->setChecked(0);
                ui->rd_log_WC1_vacoff_3->setStyleSheet(radioYello);
            } else if ((d[2] & 0x03) == 3) {
                ui->rd_log_WC1_vacoff_3->setChecked(0);
                ui->rd_log_WC1_vacoff_3->setStyleSheet(radioRed);
            }
            if ((d[2] & 0x0C) >> 2 == 0) {
                ui->rd_log_WC1_avac_3->setChecked(0);
                ui->rd_log_WC1_avac_3->setStyleSheet(radioGrey);
            } else if ((d[2] & 0x0C) >> 2 == 1) {
                ui->rd_log_WC1_avac_3->setChecked(1);
                ui->rd_log_WC1_avac_3->setStyleSheet(radioGreen);
            } else if ((d[2] & 0x0C) >> 2 == 2) {
                ui->rd_log_WC1_avac_3->setChecked(0);
                ui->rd_log_WC1_avac_3->setStyleSheet(radioYello);
            } else if ((d[2] & 0x0C) >> 2 == 3) {
                ui->rd_log_WC1_avac_3->setChecked(0);
                ui->rd_log_WC1_avac_3->setStyleSheet(radioRed);
            }
            if ((d[3] & 0x03) == 0) {
                ui->rd_log_WC2_vacoff_3->setChecked(0);
                ui->rd_log_WC2_vacoff_3->setStyleSheet(radioGrey);
            } else if ((d[3] & 0x03) == 1) {
                ui->rd_log_WC2_vacoff_3->setChecked(1);
                ui->rd_log_WC2_vacoff_3->setStyleSheet(radioGreen);
            } else if ((d[3] & 0x03) == 2) {
                ui->rd_log_WC2_vacoff_3->setChecked(0);
                ui->rd_log_WC2_vacoff_3->setStyleSheet(radioYello);
            } else if ((d[3] & 0x03) == 3) {
                ui->rd_log_WC2_vacoff_3->setChecked(0);
                ui->rd_log_WC2_vacoff_3->setStyleSheet(radioRed);
            }
            if ((d[3] & 0x0C) >> 2 == 0) {
                ui->rd_log_WC2_avac_3->setChecked(0);
                ui->rd_log_WC2_avac_3->setStyleSheet(radioGrey);
            } else if ((d[3] & 0x0C) >> 2 == 1) {
                ui->rd_log_WC2_avac_3->setChecked(1);
                ui->rd_log_WC2_avac_3->setStyleSheet(radioGreen);
            } else if ((d[3] & 0x0C) >> 2 == 2) {
                ui->rd_log_WC2_avac_3->setChecked(0);
                ui->rd_log_WC2_avac_3->setStyleSheet(radioYello);
            } else if ((d[3] & 0x0C) >> 2 == 3) {
                ui->rd_log_WC2_avac_3->setChecked(0);
                ui->rd_log_WC2_avac_3->setStyleSheet(radioRed);
            }
            if ((d[4] & 0x03) == 0) {
                ui->rd_log_CH_vacoff_3->setChecked(0);
                ui->rd_log_CH_vacoff_3->setStyleSheet(radioGrey);
            } else if ((d[4] & 0x03) == 1) {
                ui->rd_log_CH_vacoff_3->setChecked(1);
                ui->rd_log_CH_vacoff_3->setStyleSheet(radioGreen);
            } else if ((d[4] & 0x03) == 2) {
                ui->rd_log_CH_vacoff_3->setChecked(0);
                ui->rd_log_CH_vacoff_3->setStyleSheet(radioYello);
            } else if ((d[4] & 0x03) == 3) {
                ui->rd_log_CH_vacoff_3->setChecked(0);
                ui->rd_log_CH_vacoff_3->setStyleSheet(radioRed);
            }
            if ((d[4] & 0x0C) >> 2 == 0) {
                ui->rd_log_CH_avac_3->setChecked(0);
                ui->rd_log_CH_avac_3->setStyleSheet(radioGrey);
            } else if ((d[4] & 0x0C) >> 2 == 1) {
                ui->rd_log_CH_avac_3->setChecked(1);
                ui->rd_log_CH_avac_3->setStyleSheet(radioGreen);
            } else if ((d[4] & 0x0C) >> 2 == 2) {
                ui->rd_log_CH_avac_3->setChecked(0);
                ui->rd_log_CH_avac_3->setStyleSheet(radioYello);
            } else if ((d[4] & 0x0C) >> 2 == 3) {
                ui->rd_log_CH_avac_3->setChecked(0);
                ui->rd_log_CH_avac_3->setStyleSheet(radioRed);
            }

            packcount++;
            break;
        case 6: // Nodelist
            ui->line_log_node2->setText("-");
            ui->line_log_node3->setText("-");
            ui->line_log_node4->setText("-");
            ui->line_log_node5->setText("-");
            ui->line_log_node6->setText("-");
            ui->line_log_node7->setText("-");
            ui->line_log_node8->setText("-");
            ui->line_log_node15->setText("-");

            cd = data.length();
            qDebug() << "cd node" << cd;
            node[16] = data.mid(cd - 2, 2);
            node[15] = data.mid(cd - 4, 2);
            node[14] = data.mid(cd - 6, 2);
            node[13] = data.mid(cd - 8, 2);
            node[12] = data.mid(cd - 10, 2);
            node[11] = data.mid(cd - 12, 2);
            node[10] = data.mid(cd - 14, 2);
            node[9] = data.mid(cd - 16, 2);
            node[8] = data.mid(cd - 18, 2);
            node[7] = data.mid(cd - 20, 2);
            node[6] = data.mid(cd - 22, 2);
            node[5] = data.mid(cd - 24, 2);
            node[4] = data.mid(cd - 26, 2);
            node[3] = data.mid(cd - 28, 2);
            node[2] = data.mid(cd - 30, 2);
            node[1] = data.mid(cd - 32, 2);
            node[0] = data.mid(cd - 34, 2);

            ui->line_log_node2->setText(node[2]);
            ui->line_log_node3->setText(node[3]);
            ui->line_log_node4->setText(node[4]);
            ui->line_log_node5->setText(node[5]);
            ui->line_log_node6->setText(node[6]);
            ui->line_log_node7->setText(node[7]);
            ui->line_log_node8->setText(node[8]);
            ui->line_log_node15->setText(node[15]);

            ui->line_log_node2->setStyleSheet(backDefault);
            ui->line_log_node3->setStyleSheet(backDefault);
            ui->line_log_node4->setStyleSheet(backDefault);
            ui->line_log_node5->setStyleSheet(backDefault);
            ui->line_log_node6->setStyleSheet(backDefault);
            ui->line_log_node7->setStyleSheet(backDefault);
            ui->line_log_node8->setStyleSheet(backDefault);
            ui->line_log_node15->setStyleSheet(backDefault);

            if (node[2] == "FF")
                ui->line_log_node2->setStyleSheet(backRed);
            if (node[3] == "FF")
                ui->line_log_node3->setStyleSheet(backRed);
            if (node[4] == "FF")
                ui->line_log_node4->setStyleSheet(backRed);
            if (node[5] == "FF")
                ui->line_log_node5->setStyleSheet(backRed);
            if (node[6] == "FF")
                ui->line_log_node6->setStyleSheet(backRed);
            if (node[7] == "FF")
                ui->line_log_node7->setStyleSheet(backRed);
            if (node[8] == "FF")
                ui->line_log_node8->setStyleSheet(backRed);
            if (node[15] == "FF")
                ui->line_log_node15->setStyleSheet(backRed);

            packcount++;
            break;
        case 7:
            //   qDebug()<<"list"<<list;
            if (list & 0b0000000000000001)
                ui->line_log_clean->setText("1");
            else
                ui->line_log_clean->setText("0");
            if ((list & 0b0000000100000000) >> 2)
                ui->line_log_friction->setText("1");
            else
                ui->line_log_friction->setText("0");

            packcount = 0;
            break;
            //        case 9:         // Node Response
            //            ui->plainText_log_N->clear();
            //            cd = data.length();
            //            qDebug()<<"cd N"<<cd;
            //            for(int i = 1; i < (cd/2+1);i++)
            //            {
            //                qDebug()<<"data.mid(cd-2*i,2)"<<data.mid(cd-2*i,2);
            //                N[i-1] = data.mid(cd-2*i,2);

            //            }

            //            ui->plainText_log_N->appendPlainText( N[9] + "\r"
            //                                                 + N[8] + "\r"
            //                                                 + N[7] + "\r"
            //                                                 + N[6] + "\r"
            //                                                 + N[5] + "\r"
            //                                                 + N[4] + "\r"
            //                                                 + N[3] + "\r"
            //                                                 + N[2] + "\r"
            //                                                 + N[1] + "\r"
            //                                                 + N[0] );
            //            packcount = 0;
            //            break;
            //        case 10:         // mu Response
            //            ui->plainText_log_N->clear();
            //            cd = data.length();
            //            qDebug()<<"cd mu"<<cd;
            //            for(int i = 1; i < (cd/2+1);i++)
            //            {
            //                qDebug()<<"data.mid(cd-2*i,2)"<<data.mid(cd-2*i,2);
            //                mu[i-1] = data.mid(cd-2*i,2);

            //            }

            //            ui->plainText_log_N->appendPlainText( mu[9] + "\r"
            //                                                 + mu[8] + "\r"
            //                                                 + mu[7] + "\r"
            //                                                 + mu[6] + "\r"
            //                                                 + mu[5] + "\r"
            //                                                 + mu[4] + "\r"
            //                                                 + mu[3] + "\r"
            //                                                 + mu[2] + "\r"
            //                                                 + mu[1] + "\r"
            //                                                 + mu[0] );
            //            packcount++;
            //            break;
            //        case 11:         // su Response
            //            ui->plainText_log_N->clear();
            //            cd = data.length();
            //            qDebug()<<"cd su"<<cd;
            //            for(int i = 1; i < (cd/2+1);i++)
            //            {
            //                qDebug()<<"data.mid(cd-2*i,2)"<<data.mid(cd-2*i,2);
            //                su[i-1] = data.mid(cd-2*i,2);

            //            }

            //            ui->plainText_log_N->appendPlainText( su[17] + "\r"
            //                                                 + su[16] + "\r"
            //                                                 + su[15] + "\r"
            //                                                 + su[14] + "\r"
            //                                                 + su[13] + "\r"
            //                                                 + su[12] + "\r"
            //                                                 + su[11] + "\r"
            //                                                 + su[10] + "\r"
            //                                                 + su[9] + "\r"
            //                                                 + su[8] + "\r"
            //                                                 + su[7] + "\r"
            //                                                 + su[6] + "\r"
            //                                                 + su[5] + "\r"
            //                                                 + su[4] + "\r"
            //                                                 + su[3] + "\r"
            //                                                 + su[2] + "\r"
            //                                                 + su[1] + "\r"
            //                                                 + su[0] );
            //            packcount = 0;
            //            break;
        }
    }
}
QString MainWindow::decodeFUIhex(QString FUItext)
{
    QString Ftext;

    switch (FUItext.toInt(&ok, 16))
    {
    case 0:
        Ftext = "BOARD";
        break;
    case 1:
        Ftext = "MOTOR1";
        break;
    case 2:
        Ftext = "MOTOR2";
        break;
    case 3:
        Ftext = "MOTOR3";
        break;
    case 4:
        Ftext = "TEMPERATURE";
        break;
    case 5:
        Ftext = "VOLTAGE1";
        break;
    case 6:
        Ftext = "VOLTAGE2";
        break;
    case 7:
        Ftext = "VOLTAGE3";
        break;
    case 8:
        Ftext = "VOLTAGE4";
        break;
    case 9:
        Ftext = "INPORT1";
        break;
    case 10:
        Ftext = "INPORT2";
        break;
    case 11:
        Ftext = "OUTPORT";
        break;
    case 12:
        Ftext = "INBIT1";
        break;
    case 13:
        Ftext = "INBIT2";
        break;
    case 14:
        Ftext = "INBIT3";
        break;
    case 15:
        Ftext = "INBIT4";
        break;
    case 16:
        Ftext = "INBIT5";
        break;
    case 17:
        Ftext = "INBIT6";
        break;
    case 18:
        Ftext = "INBIT7";
        break;
    case 19:
        Ftext = "INBIT8";
        break;
    case 20:
        Ftext = "INBIT9";
        break;
    case 21:
        Ftext = "INBIT10";
        break;
    case 22:
        Ftext = "INBIT11";
        break;
    case 23:
        Ftext = "INBIT12";
        break;
    case 24:
        Ftext = "INBIT13";
        break;
    case 25:
        Ftext = "INBIT14";
        break;
    case 26:
        Ftext = "OUTBIT1";
        break;
    case 27:
        Ftext = "OUTBIT2";
        break;
    case 28:
        Ftext = "OUTBIT3";
        break;
    case 29:
        Ftext = "OUTBIT4";
        break;
    case 30:
        Ftext = "OUTBIT5";
        break;
    case 31:
        Ftext = "OUTBIT6";
        break;
    case 320:
        Ftext = "OUTBIT7";
        break;
    case 33:
        Ftext = "OUTBIT8";
        break;
    case 34:
        Ftext = "SWITCH1";
        break;
    case 35:
        Ftext = "SWITCH2";
        break;
    case 36:
        Ftext = "SWITCH3";
        break;
    case 37:
        Ftext = "SWITCH4";
        break;
    case 38:
        Ftext = "SWITCH5";
        break;
    case 39:
        Ftext = "SWITCH6";
        break;
    case 40:
        Ftext = "SWITCH7";
        break;
    case 41:
        Ftext = "SWITCH8";
        break;
    case 42:
        Ftext = "TOWERLP1";
        break;
    case 43:
        Ftext = "TOWERLP2";
        break;
    case 44:
        Ftext = "TOWERLP3";
        break;
    case 45:
        Ftext = "TOWERHN1";
        break;
    case 46:
        Ftext = "SWITCH13";
        break;
    case 47:
        Ftext = "SWITCH14";
        break;
    case 48:
        Ftext = "SWITCH15";
        break;
    case 49:
        Ftext = "SWITCH16";
        break;
    case 50:
        Ftext = "PWM_OUTPUT1";
        break;
    case 51:
        Ftext = "PWM_OUTPUT2";
        break;
    case 52:
        Ftext = "PWM_OUTPUT3";
        break;
    case 53:
        Ftext = "ANALOG_INPUT1";
        break;
    case 54:
        Ftext = "ANALOG_INPUT2";
        break;
    case 55:
        Ftext = "ANALOG_INPUT3";
        break;
    case 56:
        Ftext = "ANALOG_INPUT4";
        break;
    case 57:
        Ftext = "MAINVACUUM";
        break;
    case 58:
        Ftext = "ANALOG_INPUT6";
        break;
    case 59:
        Ftext = "ANALOG_INPUT7";
        break;
    case 60:
        Ftext = "VACUUMSWITCH1";
        break;
    case 61:
        Ftext = "VACUUMSWITCH2";
        break;
    case 62:
        Ftext = "VACUUMSWITCH3";
        break;
    case 63:
        Ftext = "VACUUMSWITCH4";
        break;
    case 64:
        Ftext = "VACUUMSWITCH5";
        break;
    case 65:
        Ftext = "VACUUMSWITCH6";
        break;
    case 66:
        Ftext = "VACUUMSWITCH7";
        break;
    case 67:
        Ftext = "VACUUMUNIT1";
        break;
    case 68:
        Ftext = "VACUUMUNIT2";
        break;
    case 69:
        Ftext = "VACUUMUNIT3";
        break;
    case 70:
        Ftext = "VACUUMUNIT4";
        break;
    case 71:
        Ftext = "VACUUMUNIT5";
        break;
    case 72:
        Ftext = "VACUUMUNIT6";
        break;
    case 73:
        Ftext = "VACUUMUNIT7";
        break;
    case 74:
        Ftext = "LIFT_LOCK1";
        break;
    case 75:
        Ftext = "LIFT_LOCK2";
        break;
    case 76:
        Ftext = "SENSOR_VALUE1";
        break;
    case 77:
        Ftext = "SENSOR_VALUE2";
        break;
    case 78:
        Ftext = "SENSOR_VALUE3";
        break;
    case 79:
        Ftext = "SENSOR_VALUE4";
        break;
    case 80:
        Ftext = "AMPL_SENSOR1";
        break;
    case 81:
        Ftext = "AMPL_SENSOR2";
        break;
    case 82:
        Ftext = "AMPL_SENSOR3";
        break;
    case 83:
        Ftext = "AMPL_SENSOR4";
        break;
    case 84:
        Ftext = "EXISTENCESENSOR1";
        break;
    case 85:
        Ftext = "EXISTENCESENSOR2";
        break;
    case 86:
        Ftext = "EXISTENCESENSOR3";
        break;
    case 87:
        Ftext = "EXISTENCESENSOR4";
        break;
    case 88:
        Ftext = "VACUUMGROUP";
        break;
    case 89:
        Ftext = "EMERGENCYSTOP";
        break;
    case 90:
        Ftext = "BOARD_REVISION";
        break;
    case 92:
        Ftext = "MEASUNIT";
        break;
    case 93:
        Ftext = "MEASTRANSMITTER";
        break;
    case 199:
        Ftext = "CHANGE_STATUS";
        break;
    case 200:
        Ftext = "POWER_FAIL";
        break;
    case 201:
        Ftext = "MOT_POWER_FAIL";
        break;
    case 202:
        Ftext = "DCDC_POWER_OK";
        break;
    case 210:
        Ftext = "LIFT";
        break;
    case 250:
        Ftext = "TASK_0";
        break;
    case 251:
        Ftext = "TASK_1";
        break;
    case 252:
        Ftext = "TASK_2";
        break;
    default:
        Ftext = "--";
        break;
    }
    return Ftext;
}
QString MainWindow::decodeRespHex(QString CMDtext)
{
    QString Rtext;

    if(CMDtext.toInt(&ok, 16) < 31)
    {
        int c = CMDtext.toInt(&ok, 16);
        switch (c) // Zahl kommt als hex rein
        {
        case 1:
            Rtext = "POSA_ABS";
            break;
        case 2:
            Rtext = "POS_CONST";
            break;
        case 3:
            Rtext = "READ_POS";
            break;
        case 4:
            Rtext = "SET_VALUE";
            break;
        case 5:
            Rtext = "GET_VALUE";
            break;
        case 6:
            Rtext = "SET_PARAM";
            break;
        case 7:
            Rtext = "GET_PARAM";
            break;
        case 8:
            Rtext = "READ_INFO";
            break;
        case 9:
            Rtext = "RESET_UNIT";
            break;
        case 10:
            Rtext = "FN_BREAK";
            break;
        case 11:
            Rtext = "WAIT_CHANGE";
            break;
        case 12:
            Rtext = "LOAD_MODE";
            break;
        case 13:
            Rtext = "DOWN_LOAD";
            break;
        case 14:
            Rtext = "UP_LOAD";
            break;
        case 15:
            Rtext = "READ_MEM";
            break;
        case 16:
            Rtext = "CLEAR_MSGS";
            break;
        case 17:
            Rtext = "CALIBRATE";
            break;
        case 18:
            Rtext = "LIFT_INVENTORY";
            break;
        case 19:
            Rtext = "LIFT_POS";
            break;
        default:
            Rtext = "--";
        }
    }
    else
    {
        switch (CMDtext.toInt(&ok, 16)) // Zahl kommt als hex rein
        {
        case 32:
            Rtext = "POSA_OK";
            break;
        case 33:
            Rtext = "POSC_OK";
            break;
        case 34:
            Rtext = "POS_STAT";
            break;
        case 35:
            Rtext = "SET_VALUE_OK";
            break;
        case 36:
            Rtext = "GET_VALUE_OK";
            break;
        case 37:
            Rtext = "SET_PARAM_OK";
            break;
        case 38:
            Rtext = "GET_PARAM_OK";
            break;
        case 39:
            Rtext = "RESET_OK";
            break;
        case 40:
            Rtext = "INFO_STAT";
            break;
        case 41:
            Rtext = "BREAK_OK";
            break;
        case 45:
            Rtext = "MEM_STAT";
            break;
        case 48:
            Rtext = "CALIBRATE_OK";
            break;
        case 49:
            Rtext = "LIFT_INV_OK";
            break;
        case 50:
            Rtext = "LIFT_POS_OK";
            break;
        case 64:
            Rtext = "FN_BUSY";
            break;
        case 65:
            Rtext = "FN_CANCEL";
            break;
        case 66:
            Rtext = "FN_BLOCKED";
            break;
        case 67:
            Rtext = "FN_TIMEOUT";
            break;
        case 68:
            Rtext = "FN_NOT_PRESENT";
            break;
        case 69:
            Rtext = "ERR_MSG";
            break;
        case 70:
            Rtext = "ERR_ID";
            break;
        case 71:
            Rtext = "ERR_POS";
            break;
        case 72:
            Rtext = "ERR_VAL";
            break;
        case 73:
            Rtext = "ERR_SENS";
            break;
        case 74:
            Rtext = "ERR_END";
            break;
        case 75:
            Rtext = "ERR_COMM";
            break;
        case 76:
            Rtext = "ERR_NODE";
            break;
        case 77:
            Rtext = "ERR_EMERGENCY";
            break;
        case 78:
            Rtext = "ERR_CALIB";
            break;
        case 79:
            Rtext = "ERR_POS_DIFF";
            break;
        case 80:
            Rtext = "ERR_MOTVOLTAGE";
            break;
        case 150:
            Rtext = "UNKNOWN_CMD";
            break;
        default:
            Rtext = "--";
            break;
        }
    }
    return Rtext;
}
QString MainWindow::decodeMU(int mu)
{
    QString Rtext;

    if (mu == 0) Rtext = "XCMD";
    else if (mu == 1) Rtext = "Lift 1";
    else if (mu == 2) Rtext = "Lift 2";
    else if (mu == 5) Rtext = "Loader";
    else if (mu == 6) Rtext = "Aligner";
    else if (mu == 7) Rtext = "Changer";
    else if (mu == 8) Rtext = "Chuck";
    else if (mu == 9) Rtext = "System";
    else Rtext = "?";

    return Rtext;
}
QString MainWindow::decodeSU(int su, int mu)
{
    QString Rtext;

    if (mu == 1)
    {
        if (su == 1) Rtext = "L1 CASS";
        else if (su == 2) Rtext = "L1 LOCK";
        else if (su == 3) Rtext = "L1 TILT";
        else if (su == 4) Rtext = "L1 MAP";
        else if (su == 5) Rtext = "L1 POS";
        else if (su == 6) Rtext = "L1 Height";
        else if (su == 7) Rtext = "L1 Sens";
        else if (su == 8) Rtext = "L1 ResHeight";
        else if (su == 9) Rtext = "L1 ResTilt";
        else if (su == 10) Rtext = "L1 GETPOS";
        else if (su == 11) Rtext = "L1 GETPARA";
        else if (su == 12) Rtext = "L1 SETPARA";
        else if (su == 13) Rtext = "L1 GETMOPAR H";
        else if (su == 14) Rtext = "L1 SETMOPAR H";
        else if (su == 15) Rtext = "L1 GETMOPAR T";
        else if (su == 16) Rtext = "L1 SETMOPAR T";
        else Rtext = "?";
    }
    else if (mu == 2)
    {
        if (su == 1) Rtext = "L2 CASS";
        else if (su == 2) Rtext = "L2 LOCK";
        else if (su == 3) Rtext = "L2 TILT";
        else if (su == 4) Rtext = "L2 MAP";
        else if (su == 5) Rtext = "L2 POS";
        else if (su == 6) Rtext = "L2 Height";
        else if (su == 7) Rtext = "L2 Sens";
        else if (su == 8) Rtext = "L2 ResHeight";
        else if (su == 9) Rtext = "L2 ResTilt";
        else if (su == 10) Rtext = "L2 GETPOS";
        else if (su == 11) Rtext = "L2 GETPARA";
        else if (su == 12) Rtext = "L2 SETPARA";
        else if (su == 13) Rtext = "L2 GETMOPAR H";
        else if (su == 14) Rtext = "L2 SETMOPAR H";
        else if (su == 15) Rtext = "L2 GETMOPAR T";
        else if (su == 16) Rtext = "L2 SETMOPAR T";
        else Rtext = "?";
    }
    else if (mu == 5)
    {
        if (su == 1)
            Rtext = "LD X";
        else if (su == 2)
            Rtext = "LD Y";
        else if (su == 3)
            Rtext = "LD VAC";
        else if (su == 4)
            Rtext = "LD AVAC";
        else if (su == 5)
            Rtext = "LD Res X";
        else if (su == 6)
            Rtext = "LD Res Y";
        else if (su == 7)
            Rtext = "LD GETPARA";
        else if (su == 8)
            Rtext = "LD SETPARA";
        else if (su == 9)
            Rtext = "LD GETPOS X";
        else if (su == 10)
            Rtext = "LD GETPOS Y";
        else if (su == 11)
            Rtext = "LD GETMOPARA X";
        else if (su == 12)
            Rtext = "LD SETMOPARA X";
        else if (su == 13)
            Rtext = "LD2 GETMOPAR Y";
        else if (su == 14)
            Rtext = "LD SETMOPAR Y";
        else
            Rtext = "?";
    }
    else if (mu == 6)
    {
        if (su == 1)
            Rtext = "PA Height";
        else if (su == 2)
            Rtext = "PA Phi";
        else if (su == 3)
            Rtext = "PA Tilt";
        else if (su == 4)
            Rtext = "PA Rot";
        else if (su == 5)
            Rtext = "PA WafSens";
        else if (su == 6)
            Rtext = "PA VAC";
        else if (su == 7)
            Rtext = "PA AVAC";
        else if (su == 8)
            Rtext = "PA ResHeight";
        else if (su == 9)
            Rtext = "PA ResPhi";
        else if (su == 10)
            Rtext = "PA ResTilt";
        else if (su == 11)
            Rtext = "PA ResRot";
        else if (su == 12)
            Rtext = "PA Calib";
        else if (su == 13)
            Rtext = "PA AVAC Value";
        else if (su == 14)
            Rtext = "PA GETPARA";
        else if (su == 15)
            Rtext = "PA Measure";
        else if (su == 16)
            Rtext = "PA GETPOS Height";
        else if (su == 17)
            Rtext = "PA GETPOS Phi";
        else if (su == 18)
            Rtext = "PA GETPOS Tilt";
        else if (su == 19)
            Rtext = "PA GETPOS Rot";
        else if (su == 20)
            Rtext = "PA GETMOPARA H";
        else if (su == 21)
            Rtext = "PA SETMOPARA H";
        else if (su == 22)
            Rtext = "PA GETMOPARA P";
        else if (su == 23)
            Rtext = "PA SETMOPARA P";
        else if (su == 24)
            Rtext = "PA GETMOPARA T";
        else if (su == 25)
            Rtext = "PA SETMOPARA T";
        else if (su == 26)
            Rtext = "PA GETMOPARA R";
        else if (su == 27)
            Rtext = "PA SETMOPARA R";
        else
            Rtext = "?";
    }
    else if (mu == 7)
    {
        if (su == 1)
            Rtext = "WC X";
        else if (su == 2)
            Rtext = "WC Height";
        else if (su == 3)
            Rtext = "WC Phi";
        else if (su == 4)
            Rtext = "WC1 VAC";
        else if (su == 5)
            Rtext = "WC2 VAC";
        else if (su == 6)
            Rtext = "WC1 AVAC";
        else if (su == 7)
            Rtext = "WC2 AVAC";
        else if (su == 8)
            Rtext = "WC ResHeight";
        else if (su == 9)
            Rtext = "WC ResPhi";
        else if (su == 10)
            Rtext = "WC GETPARA";
        else if (su == 11)
            Rtext = "WC GETPOS Height";
        else if (su == 12)
            Rtext = "WC GETPOS Phi";
        else if (su == 13)
            Rtext = "WC GETMOPAR H";
        else if (su == 14)
            Rtext = "WC SETMOPAR H";
        else if (su == 15)
            Rtext = "WC GETMOPAR Phi";
        else if (su == 16)
            Rtext = "WC SETMOPAR Phi";
        else
            Rtext = "?";
    }
    else if (mu == 8)
    {
        if (su == 1)
            Rtext = "CH4 VAC";
        else if (su == 2)
            Rtext = "CH4 AVAC";
        else if (su == 3)
            Rtext = "CH5 VAC";
        else if (su == 4)
            Rtext = "CH6 VAC";
        else if (su == 5)
            Rtext = "CH8 VAC";
        else
            Rtext = "?";
    }
    else if (mu == 9)
    {
        if (su == 1)
            Rtext = "Sys MainVAC";
        else if (su == 2)
            Rtext = "Sys Lamp1";
        else if (su == 3)
            Rtext = "Sys Lamp2";
        else if (su == 4)
            Rtext = "Sys Lamp3";
        else if (su == 5)
            Rtext = "Sys Horn";
        else if (su == 6)
            Rtext = "Sys Temp2";
        else if (su == 7)
            Rtext = "Sys Temp3";
        else if (su == 8)
            Rtext = "Sys Temp4";
        else if (su == 9)
            Rtext = "Sys Temp5";
        else if (su == 10)
            Rtext = "Sys Temp6";
        else if (su == 11)
            Rtext = "Sys V1-B2";
        else if (su == 12)
            Rtext = "Sys V1-B3";
        else if (su == 13)
            Rtext = "Sys V1-B4";
        else if (su == 14)
            Rtext = "Sys V1-B5";
        else if (su == 15)
            Rtext = "Sys V1-B6";
        else if (su == 16)
            Rtext = "Sys V2-B2";
        else if (su == 17)
            Rtext = "Sys V2-B3";
        else if (su == 18)
            Rtext = "Sys V2-B4";
        else if (su == 19)
            Rtext = "Sys V2-B5";
        else if (su == 20)
            Rtext = "Sys V2-B6";
        else if (su == 21)
            Rtext = "Sys V3-B2";
        else if (su == 22)
            Rtext = "Sys V3-B3";
        else if (su == 23)
            Rtext = "Sys V3-B4";
        else if (su == 24)
            Rtext = "Sys V3-B5";
        else if (su == 25)
            Rtext = "Sys V3-B6";
        else if (su == 26)
            Rtext = "Sys PF-B2";
        else if (su == 27)
            Rtext = "Sys PF-B3";
        else if (su == 28)
            Rtext = "Sys PF-B4";
        else if (su == 29)
            Rtext = "Sys PF-B5";
        else if (su == 30)
            Rtext = "Sys PF-B6";
        else if (su == 31)
            Rtext = "Sys PF-B7";
        else if (su == 32)
            Rtext = "Sys PF-B8";
        else if (su == 33)
            Rtext = "Sys PF-B9";
        else if (su == 34)
            Rtext = "Sys PF-B15";
        else if (su == 35)
            Rtext = "Sys MPF";
        else if (su == 36)
            Rtext = "Sys VDC 8";
        else if (su == 37)
            Rtext = "Sys VDC 12";
        else if (su == 38)
            Rtext = "Sys VDC -12";
        else if (su == 39)
            Rtext = "Sys VDC 24";
        else if (su == 40)
            Rtext = "Sys EMO";
        else if (su == 41)
            Rtext = "Sys ACR";
        else if (su == 42)
            Rtext = "Sys Board2";
        else if (su == 43)
            Rtext = "Sys Board3";
        else if (su == 44)
            Rtext = "Sys Board4";
        else if (su == 45)
            Rtext = "Sys Board5";
        else if (su == 46)
            Rtext = "Sys Board6";
        else if (su == 47)
            Rtext = "Sys Board7";
        else if (su == 48)
            Rtext = "Sys Board8";
        else if (su == 49)
            Rtext = "Sys Board9";
        else if (su == 50)
            Rtext = "Sys Board15";
        else if (su == 51)
            Rtext = "Sys WOB Lamp1 SW";
        else if (su == 52)
            Rtext = "Sys WOB Lamp1 PWM";
        else
            Rtext = "?";
    }

    return Rtext;
}
QString MainWindow::decodeAPI(int api)
{
    QString Rtext;

    if (api == 0) Rtext = "@VER";
    else if (api == 1) Rtext = "@STAT";
    else if (api == 2) Rtext = "@INIT";
    else if (api == 3) Rtext = "@IN";
    else if (api == 4) Rtext = "@SETCAR";
    else if (api == 5) Rtext = "@ALIGN";
    else if (api == 6) Rtext = "@MAP";
    else if (api == 7) Rtext = "@GETMAP";
    else if (api == 8) Rtext = "@L1 GET";
    else if (api == 9) Rtext = "@L2 GET";
    else if (api == 10) Rtext = "@ALGET";
    else if (api == 11) Rtext = "@L1PUT";
    else if (api == 12) Rtext = "@L2PUT";
    else if (api == 13) Rtext = "@ALPUT";
    else if (api == 14) Rtext = "@SETALROT";
    else if (api == 15) Rtext = "@GETALROT";
    else if (api == 16) Rtext = "@WC";
    else if (api == 17) Rtext = "@PREWC";
    else if (api == 18) Rtext = "@SETOUT";
    else if (api == 19) Rtext = "@SETLAMP";
    else if (api == 20) Rtext = "@GETOUT";
    else if (api == 21) Rtext = "@L1MAP";
    else if (api == 22) Rtext = "@L2MAP";
    else if (api == 23) Rtext = "@GETERR";
    else if (api == 24) Rtext = "@LOAD";
    else if (api == 25) Rtext = "@UNLOAD";
    else if (api == 26) Rtext = "@MACROSTART";
    else if (api == 27) Rtext = "@MACROUPDATE";
    else if (api == 28) Rtext = "@MACROSTOP";
    else Rtext = "?";
    return Rtext;
}
void MainWindow::f_APIid(QString apidata, bool err) //
{
    QString data = apidata.mid(apidata.indexOf("=") + 1, -1);
    QString lift = apidata.mid(apidata.indexOf("=") + 1, 1);
    QString getout = apidata.mid(apidata.indexOf("=") + 1, 4);
    QString slotmap = apidata.mid(apidata.indexOf(",") + 1, 25);
    QString errcode = apidata;
    QString tpart;

    auto parts = apidata
            .mid(apidata.indexOf("=") + 1,
                 apidata.indexOf("\r") - apidata.indexOf("=") - 1)
            .split(',');
    QString slotnr = "";
    int hexstat = 0;
    int LDVAC = 0;
    int PAVAC = 0;
    int CHVAC = 0;
    int WC1VAC = 0;
    int WC2VAC = 0;
    int Cass1 = 0;
    int Cass2 = 0;
    int WS = 0;
    int sz1b1 = 0;
    int sz1b2 = 0;
    int sz1b3 = 0;
    int sz2b1 = 0;
    int sz2b2 = 0;
    int sz2b3 = 0;
    int szWb1 = 0;
    int szWb2 = 0;
    int szWb3 = 0;
    int CH4VAC = 0;
    int VacMain = 0;
    int LOCK1 = 0;
    int TILT1 = 0;
    int LOCK2 = 0;
    int TILT2 = 0;
    int WCOK = 0;
    int EMO = 0;
    int DC8V = 0;
    int DC12V = 0;
    int DCM12V = 0;
    int DC24V = 0;
    int MOTWC = 0;
    int PF = 0;
    int RESOK = 0;
    int faterr = 0;

    int sizeL1 = 0;
    int sizeL2 = 0;
    int sizeWS = 0;

    int tmpvar;

    qDebug() << "APIid" << APIid << "data" << data;

    switch (APIid)
    {
    case cVER:
        qDebug() << parts << parts.count();
        qDebug() << "RAC" << parts[0];
        qDebug() << "RAC" << parts[1].mid(3, -1);
        qDebug() << "PA" << parts[2].mid(3, -1);
        ui->plainText_sendlog->appendPlainText(QTime::currentTime().toString("hh:mm:ss.zzz' '") + "->" + apidata.trimmed());
        ui->line_masterbox->setText(parts[0]);
        ui->line_masterbox_RAC->setText(parts[1].mid(3, -1));
        ui->line_masterbox_PA->setText(parts[2].mid(3, -1));
        if (parts.count() > 3) ui->line_motorboard2->setText(parts[3].mid(3, -1));
        if (parts.count() > 4) ui->line_motorboard3->setText(parts[4].mid(3, -1));
        if (parts.count() > 5) ui->line_motorboard4->setText(parts[5].mid(3, -1));
        if (parts.count() > 6) ui->line_motorboard5->setText(parts[6].mid(3, -1));
        if (parts.count() > 7) ui->line_motorboard6->setText(parts[7].mid(3, -1));
        if (parts.count() > 8) ui->line_sensorboard7->setText(parts[8].mid(3, -1));
        if (parts.count() > 9) ui->line_sensorboard8->setText(parts[9].mid(3, -1));
        // if (parts.count() > 10) ui->line_sensorboard9->setText(parts[10].mid(3, -1));
        if (parts.count() > 11) ui->line_alignerboard->setText(parts[11].mid(4, -1));
        APIid = none;
        break;
    case cSTAT:
        APIid = none;
        break;
    case cIN:
        hexstat = data.toUInt(&ok, 16);
        qDebug() << "hexstat" << hexstat;
        Cass1 = hexstat & 0b00000000000000000000000000000001;
        Cass2 = (hexstat & 0b00000000000000000000000000000010) >> 1;
        WS = (hexstat & 0b00000000000000000000000000000100) >> 2;
        sz1b1 = (hexstat & 0b00000000000000000000000000001000) >> 3;
        sz1b2 = (hexstat & 0b00000000000000000000000000010000) >> 4;
        sz1b3 = (hexstat & 0b00000000000000000000000000100000) >> 5;
        sz2b1 = (hexstat & 0b00000000000000000000000001000000) >> 6;
        sz2b2 = (hexstat & 0b00000000000000000000000010000000) >> 7;
        sz2b3 = (hexstat & 0b00000000000000000000000100000000) >> 8;
        szWb1 = (hexstat & 0b00000000000000000000001000000000) >> 9;
        szWb2 = (hexstat & 0b00000000000000000000010000000000) >> 10;
        szWb3 = (hexstat & 0b00000000000000000000100000000000) >> 11;
        LDVAC = (hexstat & 0b00000000000000000001000000000000) >> 12;
        PAVAC = (hexstat & 0b00000000000000000010000000000000) >> 13;
        CH4VAC = (hexstat & 0b00000000000000000100000000000000) >> 14;
        WC1VAC = (hexstat & 0b00000000000000001000000000000000) >> 15;
        WC2VAC = (hexstat & 0b00000000000000010000000000000000) >> 16;
        VacMain = (hexstat & 0b00000000000000100000000000000000) >> 17;
        LOCK1 = (hexstat & 0b00000000000001000000000000000000) >> 18;
        TILT1 = (hexstat & 0b00000000000010000000000000000000) >> 19;
        LOCK2 = (hexstat & 0b00000000000100000000000000000000) >> 20;
        TILT2 = (hexstat & 0b00000000001000000000000000000000) >> 21;
        WCOK = (hexstat & 0b00000000010000000000000000000000) >> 22;
        faterr = (hexstat & 0b00000000100000000000000000000000) >> 23; // Node disconnected
        EMO = (hexstat & 0b00000001000000000000000000000000) >> 24; // EMERGENCY_STOP
        DC8V = (hexstat & 0b00000010000000000000000000000000) >> 25;   // DC
        DC12V = (hexstat & 0b00000100000000000000000000000000) >> 26;  // Mot
        DCM12V = (hexstat & 0b00001000000000000000000000000000) >> 27; // Mot
        DC24V = (hexstat & 0b00010000000000000000000000000000) >> 28;  // Mot
        MOTWC = (hexstat & 0b00100000000000000000000000000000) >> 29;  // Mot WC
        PF = (hexstat & 0b01000000000000000000000000000000) >> 30; // EMERGENCY_STOP
        RESOK = (hexstat & 0b10000000000000000000000000000000) >> 31; // Reset OK

        qDebug() << "RESOK" << RESOK;

        sizeL1 = (sz1b1 << 2) + (sz1b2 << 1) + sz1b3;
        sizeL2 = (sz2b1 << 2) + (sz2b2 << 1) + sz2b3;
        sizeWS = (szWb1 << 2) + (szWb2 << 1) + szWb3;

        if (xsens == 1) // set SensorRadio CASS
        {
            if (ui->checkCass_lift1->isChecked())
            {
                if (sizeL1 == 7) // 8 Inch
                {
                    ui->radioCass_8inch->setChecked(1);
                    ui->radioCass_6inch->setChecked(0);
                    ui->radioCass_5inch->setChecked(0);
                    ui->radioCass_4inch->setChecked(0);
                }
                else if (sizeL1 == 5) // 6 Inch
                {
                    ui->radioCass_8inch->setChecked(0);
                    ui->radioCass_6inch->setChecked(1);
                    ui->radioCass_5inch->setChecked(0);
                    ui->radioCass_4inch->setChecked(0);
                }
                else if (sizeL1 == 1) // 4 Inch
                {
                    ui->radioCass_8inch->setChecked(0);
                    ui->radioCass_6inch->setChecked(0);
                    ui->radioCass_5inch->setChecked(0);
                    ui->radioCass_4inch->setChecked(1);
                }
                else if (sizeL1 == 0) // keine Cass
                {
                    ui->radioCass_8inch->setChecked(0);
                    ui->radioCass_6inch->setChecked(0);
                    ui->radioCass_5inch->setChecked(0);
                    ui->radioCass_4inch->setChecked(0);
                }
            } else if (ui->checkCass_lift2->isChecked())
            {
                if (sizeL2 == 7) // 8 Inch
                {
                    ui->radioCass_8inch->setChecked(1);
                    ui->radioCass_6inch->setChecked(0);
                    ui->radioCass_5inch->setChecked(0);
                    ui->radioCass_4inch->setChecked(0);
                }
                else if (sizeL2 == 5) // 6 Inch
                {
                    ui->radioCass_8inch->setChecked(0);
                    ui->radioCass_6inch->setChecked(1);
                    ui->radioCass_5inch->setChecked(0);
                    ui->radioCass_4inch->setChecked(0);
                }
                else if (sizeL2 == 1) // 4 Inch
                {
                    ui->radioCass_8inch->setChecked(0);
                    ui->radioCass_6inch->setChecked(0);
                    ui->radioCass_5inch->setChecked(0);
                    ui->radioCass_4inch->setChecked(1);
                }
                else if (sizeL2 == 0) // keine Cass
                {
                    ui->radioCass_8inch->setChecked(0);
                    ui->radioCass_6inch->setChecked(0);
                    ui->radioCass_5inch->setChecked(0);
                    ui->radioCass_4inch->setChecked(0);
                }
            }
            xsens = 0;
        }
        else // set Sensorfelder API
        {
            ui->combo_8inchsel_api->hide();
            ui->combo_6inchsel_api->hide();
            ui->combo_5inchsel_api->hide();
            ui->combo_4inchsel_api->hide();
            ui->label_API_no8->show();
            ui->label_API_no6->show();
            ui->label_API_no5->show();
            ui->label_API_no4->show();

            if (Cass1 == 0) {
                ui->line_sensorlift1->setText("--");
                ui->combo_8inchsel_api->hide();
                ui->combo_6inchsel_api->hide();
                ui->combo_5inchsel_api->hide();
                ui->combo_4inchsel_api->hide();
                ui->label_API_no8->show();
                ui->label_API_no6->show();
                ui->label_API_no5->show();
                ui->label_API_no4->show();
                VECselslots1.clear();
                deletslots(1);
            } else {
                if (sizeL1 == 7) {
                    ui->line_sensorlift1->setText("8");
                    ui->label_API_no8->hide();
                    ui->combo_8inchsel_api->show();
                } else if (sizeL1 == 5) {
                    ui->line_sensorlift1->setText("6");
                    ui->label_API_no6->hide();
                    ui->combo_6inchsel_api->show();
                } else if (sizeL1 == 1) {
                    ui->line_sensorlift1->setText("4");
                    ui->label_API_no4->hide();
                    ui->combo_4inchsel_api->show();
                }
            }
            if (Cass2 == 0) {
                ui->line_sensorlift2->setText("--");
                if (ui->groupBox_Lift2->isChecked() == true) {
                    ui->label_API_no8->show();
                    ui->combo_8inchsel_api->hide();
                }
                if (ui->groupBox_Lift2->isChecked() == true) {
                    ui->label_API_no6->show();
                    ui->combo_6inchsel_api->hide();
                }
                if (ui->groupBox_Lift2->isChecked() == true) {
                    ui->label_API_no5->show();
                    ui->combo_5inchsel_api->hide();
                }
                if (ui->groupBox_Lift2->isChecked() == true) {
                    ui->label_API_no4->show();
                    ui->combo_4inchsel_api->hide();
                }
                VECselslots2.clear();
                deletslots(2);
            } else {

                if (sizeL2 == 7) {
                    ui->line_sensorlift2->setText("8");
                    ui->label_API_no8->hide();
                    ui->combo_8inchsel_api->show();
                } else if (sizeL2 == 5) {
                    ui->line_sensorlift2->setText("6");
                    ui->label_API_no6->hide();
                    ui->combo_6inchsel_api->show();
                } else if (sizeL2 == 1) {
                    ui->line_sensorlift2->setText("4");
                    ui->label_API_no4->hide();
                    ui->combo_4inchsel_api->show();
                }
            }
            if (sizeWS == 7)
                ui->line_sensorwafer->setText("8");
            else if (sizeWS == 5)
                ui->line_sensorwafer->setText("6");
            else if (sizeWS == 1)
                ui->line_sensorwafer->setText("4");
            else
                ui->line_sensorwafer->setText(QString::number(sizeWS) + " ?");
        }

        if (VacMain) ui->radi_API_vacMAIN->setStyleSheet(radioGreen); // 1=MainVac vorhanden
        else ui->radi_API_vacMAIN->setStyleSheet(radioRed);
        if (LDVAC) ui->radi_API_vacLD->setStyleSheet(radioGreen); // 1=LDVac vorhanden
        else ui->radi_API_vacLD->setStyleSheet(radioRed);
        if (PAVAC) ui->radi_API_vacPA->setStyleSheet(radioGreen); // 1=PAVac vorhanden
        else ui->radi_API_vacPA->setStyleSheet(radioRed);
        if (WC1VAC) ui->radi_API_vacWC1->setStyleSheet(radioGreen); // 1=WC1Vac vorhanden
        else ui->radi_API_vacWC1->setStyleSheet(radioRed);
        if (WC2VAC) ui->radi_API_vacWC2->setStyleSheet(radioGreen); // 1=WC2Vac vorhanden
        else ui->radi_API_vacWC2->setStyleSheet(radioRed);
        if (CH4VAC) ui->radi_API_vacCH4->setStyleSheet(radioGreen); // 1=ChuckVac vorhanden
        else ui->radi_API_vacCH4->setStyleSheet(radioRed);

        if (MOTWC) ui->radi_API_EMO->setStyleSheet(radioGreen); // 1=EMO ausgelöst
        else ui->radi_API_EMO->setStyleSheet(radioRed);
        if (faterr) ui->radi_API_ACR->setStyleSheet(radioGreen); // 1=Node disconnected
        else ui->radi_API_ACR->setStyleSheet(radioRed);
        if (DC8V) ui->radi_API_DC8->setStyleSheet(radioGreen); // 1=DC vorhanden
        else ui->radi_API_DC8->setStyleSheet(radioRed);
        if (DC12V) ui->radi_API_DC12->setStyleSheet(radioGreen); // 1=DC vorhanden
        else ui->radi_API_DC12->setStyleSheet(radioRed);
        if (DCM12V) ui->radi_API_DCM12->setStyleSheet(radioGreen); // 1=DC vorhanden
        else ui->radi_API_DCM12->setStyleSheet(radioRed);
        if (DC24V) ui->radi_API_DC24->setStyleSheet(radioGreen); // 1=DC vorhanden
        else ui->radi_API_DC24->setStyleSheet(radioRed);

        if (PF) ui->radi_API_PF->setStyleSheet(radioGreen); // 1=PF vorhanden
        else ui->radi_API_PF->setStyleSheet(radioRed);
        if (LOCK1) ui->radi_API_lock1->setStyleSheet(radioGreen); // 1=Lock1 aktiv
        else ui->radi_API_lock1->setStyleSheet(radioRed);
        if (LOCK2) ui->radi_API_lock2->setStyleSheet(radioGreen); // 1=Lock2 aktiv
        else ui->radi_API_lock2->setStyleSheet(radioRed);
        if (TILT1) ui->radi_API_tilt1->setStyleSheet(radioGreen); // 1=Tilt1 inaktiv => ready for handling
        else ui->radi_API_tilt1->setStyleSheet(radioRed);
        if (TILT2) ui->radi_API_tilt2->setStyleSheet(radioGreen); // 1=Tilt2 inaktiv
        else ui->radi_API_tilt2->setStyleSheet(radioRed);
        if (WCOK) ui->radi_API_wcok->setStyleSheet(radioGreen); // 1=WC in Mittenstellung
        else ui->radi_API_wcok->setStyleSheet(radioRed);
        if (RESOK) ui->radi_API_resok->setStyleSheet(radioGreen); // 1=INSBox ist Initialisiert
        else ui->radi_API_resok->setStyleSheet(radioRed);
        apiid_copy = APIid;
        APIid = none;
        if (API_POLLTEST) apitestpolling->start(22);
        break;
    case cGETOUT:
        hexstat = getout.toInt(&ok, 16);
        qDebug() << "hexstat" << hexstat;
        LDVAC = (hexstat & 1);
        PAVAC = (hexstat & 2) >> 1;
        CHVAC = (hexstat & 4) >> 2;
        WC1VAC = (hexstat & 8) >> 3;
        WC2VAC = (hexstat & 16) >> 4;

        logout << "GETOUT: LD" << LDVAC << "PA" << PAVAC << "CH" << CHVAC << "WC1"
               << WC1VAC << "WC2" << WC2VAC << '\n';
        if (LDVAC)
            ui->radio_API_OUT_LD_2->setStyleSheet(radioGreen);
        else
            ui->radio_API_OUT_LD_2->setStyleSheet(radioRed);
        if (PAVAC)
            ui->radio_API_OUT_PA_2->setStyleSheet(radioGreen);
        else
            ui->radio_API_OUT_PA_2->setStyleSheet(radioRed);
        if (CHVAC)
            ui->radio_API_OUT_CH4_2->setStyleSheet(radioGreen);
        else
            ui->radio_API_OUT_CH4_2->setStyleSheet(radioRed);
        if (WC1VAC)
            ui->radio_API_OUT_WC1_2->setStyleSheet(radioGreen);
        else
            ui->radio_API_OUT_WC1_2->setStyleSheet(radioRed);
        if (WC2VAC)
            ui->radio_API_OUT_WC2_2->setStyleSheet(radioGreen);
        else
            ui->radio_API_OUT_WC2_2->setStyleSheet(radioRed);
        APIid = none;
        if (API_POLLTEST)
            apitestpolling->start(22);
        break;
    case cGETALROT:
        ui->line_getalrot->setText(data);
        APIid = none;
        break;
    case cGETWOBB:
        ui->line_getwobbler->setText(data);
        APIid = none;
        break;
    case cGETERR:
        if (errcode.left(2) == "02")
            tmpstr.append("@STAT ");
        else if (errcode.left(2) == "03")
            tmpstr.append("@INIT ");
        else if (errcode.left(2) == "04")
            tmpstr.append("@IN ");
        else if (errcode.left(2) == "05")
            tmpstr.append("@OUT ");
        else if (errcode.left(2) == "06")
            tmpstr.append("@SETCAR ");
        else if (errcode.left(2) == "07")
            tmpstr.append("@MAPL1 ");
        else if (errcode.left(2) == "08")
            tmpstr.append("@MAPL2 ");
        else if (errcode.left(2) == "09")
            tmpstr.append("@GET ");
        else if (errcode.left(2) == "0A")
            tmpstr.append("@PUT ");
        else if (errcode.left(2) == "0B")
            tmpstr.append("@ALIGN ");
        else if (errcode.left(2) == "0C")
            tmpstr.append("@ALROT ");
        else if (errcode.left(2) == "0D")
            tmpstr.append("@PREWC ");
        else if (errcode.left(2) == "0E")
            tmpstr.append("@WC ");
        else if (errcode.left(2) == "0F")
            tmpstr.append("@GETOUT ");

        if (errcode.right(2) == "40")
            tmpstr.append("FN_BUSY");
        else if (errcode.right(2) == "60")
            tmpstr.append("MAP_NOT_VALID");
        else if (errcode.right(2) == "69")
            tmpstr.append("CHUCK_VACUUM_ERR");
        else if (errcode.right(2) == "6E")
            tmpstr.append("TIMEOUT");
        else if (errcode.right(2) == "6F")
            tmpstr.append("IS_BUSY");
        else if (errcode.right(2) == "71")
            tmpstr.append("VACUUM_ERR");
        else if (errcode.right(2) == "79")
            tmpstr.append("CHECK_CHANGER_ARM");
        else if (errcode.left(5) == "RET=0")
            tmpstr.append("No ERROR");
        APIid = none;
        break;
    case cSETCAR:
        APIid = none;
        if (assistant_wc)
            assistant_loop(assistant_wc);
        else if (macro_profil)
            macroProfil(true);
        break;
    case cINIT:
        if (err)
            ui->label_initok->setStyleSheet("background-color: red");
        else
            ui->label_initok->setStyleSheet("background-color: green");
        APIid = none;
        break;
    case cSETOUT:
        APIid = none;
        break;
    case cMAP:
        APIid = none;
        on_p_Invent_GETMAP_clicked();
        break;
    case cGETL:
        APIid = none;
        on_p_API_putaligner_clicked(); // direkt auf den Aligner legen
        break;
    case cGETA:
        APIid = none;
        if (assistant_wc)
            assistant_loop(assistant_wc);
        else if (macro_profil)
            macroProfil(true);
        else
            on_p_API_Put_clicked(); // direkt zurück in den Lift/Slot
        if (API_LOOP)
            apiloopcpl = 1;
        break;
    case cPUT:
        APIid = none;
        if (API_LOOP) {
            static int count = 0;
            if (apiloopcpl) {
                count++;
                ui->label_API_loopcnt->setText(QString::number(count));
                apiloopcpl = 0;
            }
            int cycles = ui->line_API_setloopcnt->text().toInt(&ok, 10);
            if (count < cycles)
                api_loop();
            else
                on_p_API_START_clicked(0);
        } else
            PAwaf = idxwaf; // wafSlotnr auf Aligner
        if (assistant_wc)
            assistant_loop(assistant_wc);
        else if (macro_profil)
            macroProfil(true);
        break;
    case cALIGN:
        APIid = none;
        if (API_LOOP)
            api_loop();
        else if (assistant_wc)
            assistant_loop(assistant_wc);
        else if (macro_profil)
            macroProfil(true);
        break;
    case cSETALROT:
        APIid = none;
        break;
    case cSTARTMACRO:
        APIid = none;
        if (API_LOOP)
            api_loop();
        break;
    case cSTOPMACRO:
        APIid = none;
        if (API_LOOP)
            api_loop();
        break;
    case cPREWCup:
        APIid = none;
        doAPI_WC(); // direkt change nach PREWC
        break;
    case cPREWCdown:
        APIid = none;
        break;
    case cWC:
        tmpvar = CHwaf;
        CHwaf = PAwaf;
        PAwaf = tmpvar;
        APIid = none;
        if (assistant_wc)
            assistant_loop(assistant_wc);
        if (API_LOOP)
            api_loop();
        break;
    case cGETMAP:
        qDebug() << "lift" << lift << "slots" << slotmap;
        if (lift == "1") {
            for (int i = 0; i < 25; i++) {
                slotnr = slotmap.mid(slotmap.indexOf(",") + i + 1, 1);
                qDebug() << "slot" << i << slotnr;
                switch (i) {
                case 0:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S1->setStyleSheet("background-color: white");
                        ui->check_slot1->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S1->setStyleSheet("background-color: green");
                        ui->check_slot1->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S1->setStyleSheet("background-color: red ");
                        ui->check_slot1->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S1->setStyleSheet("background-color: grey");
                        ui->check_slot1->hide();
                    }
                    VECslot1[i] = slotnr.toShort(
                                &ok, 10); // VECslot1 speichert alle gültigen (=1) Slots
                    break;
                case 1:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S2->setStyleSheet("background-color: white");
                        ui->check_slot2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S2->setStyleSheet("background-color: green");
                        ui->check_slot2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S2->setStyleSheet("background-color: red ");
                        ui->check_slot2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S2->setStyleSheet("background-color: grey");
                        ui->check_slot2->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 2:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S3->setStyleSheet("background-color: white");
                        ui->check_slot3->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S3->setStyleSheet("background-color: green");
                        ui->check_slot3->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S3->setStyleSheet("background-color: red ");
                        ui->check_slot3->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S3->setStyleSheet("background-color: grey");
                        ui->check_slot3->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 3:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S4->setStyleSheet("background-color: white");
                        ui->check_slot4->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S4->setStyleSheet("background-color: green");
                        ui->check_slot4->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S4->setStyleSheet("background-color: red ");
                        ui->check_slot4->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S4->setStyleSheet("background-color: grey");
                        ui->check_slot4->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 4:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S5->setStyleSheet("background-color: white");
                        ui->check_slot5->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S5->setStyleSheet("background-color: green");
                        ui->check_slot5->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S5->setStyleSheet("background-color: red ");
                        ui->check_slot5->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S5->setStyleSheet("background-color: grey");
                        ui->check_slot5->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 5:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S6->setStyleSheet("background-color: white");
                        ui->check_slot6->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S6->setStyleSheet("background-color: green");
                        ui->check_slot6->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S6->setStyleSheet("background-color: red ");
                        ui->check_slot6->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S6->setStyleSheet("background-color: grey");
                        ui->check_slot6->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 6:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S7->setStyleSheet("background-color: white");
                        ui->check_slot7->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S7->setStyleSheet("background-color: green");
                        ui->check_slot7->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S7->setStyleSheet("background-color: red ");
                        ui->check_slot7->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S7->setStyleSheet("background-color: grey");
                        ui->check_slot7->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 7:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S8->setStyleSheet("background-color: white");
                        ui->check_slot8->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S8->setStyleSheet("background-color: green");
                        ui->check_slot8->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S8->setStyleSheet("background-color: red ");
                        ui->check_slot8->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S8->setStyleSheet("background-color: grey");
                        ui->check_slot8->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 8:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S9->setStyleSheet("background-color: white");
                        ui->check_slot9->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S9->setStyleSheet("background-color: green");
                        ui->check_slot9->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S9->setStyleSheet("background-color: red ");
                        ui->check_slot9->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S9->setStyleSheet("background-color: grey");
                        ui->check_slot9->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 9:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S10->setStyleSheet("background-color: white");
                        ui->check_slot10->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S10->setStyleSheet("background-color: green");
                        ui->check_slot10->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S10->setStyleSheet("background-color: red ");
                        ui->check_slot10->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S10->setStyleSheet("background-color: grey");
                        ui->check_slot10->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 10:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S11->setStyleSheet("background-color: white");
                        ui->check_slot11->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S11->setStyleSheet("background-color: green");
                        ui->check_slot11->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S11->setStyleSheet("background-color: red ");
                        ui->check_slot11->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S11->setStyleSheet("background-color: grey");
                        ui->check_slot11->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 11:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S12->setStyleSheet("background-color: white");
                        ui->check_slot12->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S12->setStyleSheet("background-color: green");
                        ui->check_slot12->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S12->setStyleSheet("background-color: red ");
                        ui->check_slot12->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S12->setStyleSheet("background-color: grey");
                        ui->check_slot12->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 12:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S13->setStyleSheet("background-color: white");
                        ui->check_slot13->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S13->setStyleSheet("background-color: green");
                        ui->check_slot13->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S13->setStyleSheet("background-color: red ");
                        ui->check_slot13->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S13->setStyleSheet("background-color: grey");
                        ui->check_slot13->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 13:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S14->setStyleSheet("background-color: white");
                        ui->check_slot14->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S14->setStyleSheet("background-color: green");
                        ui->check_slot14->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S14->setStyleSheet("background-color: red ");
                        ui->check_slot14->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S14->setStyleSheet("background-color: grey");
                        ui->check_slot14->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 14:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S15->setStyleSheet("background-color: white");
                        ui->check_slot15->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S15->setStyleSheet("background-color: green");
                        ui->check_slot15->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S15->setStyleSheet("background-color: red ");
                        ui->check_slot15->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S15->setStyleSheet("background-color: grey");
                        ui->check_slot15->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 15:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S16->setStyleSheet("background-color: white");
                        ui->check_slot16->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S16->setStyleSheet("background-color: green");
                        ui->check_slot16->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S16->setStyleSheet("background-color: red ");
                        ui->check_slot16->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S16->setStyleSheet("background-color: grey");
                        ui->check_slot16->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 16:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S17->setStyleSheet("background-color: white");
                        ui->check_slot17->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S17->setStyleSheet("background-color: green");
                        ui->check_slot17->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S17->setStyleSheet("background-color: red ");
                        ui->check_slot17->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S17->setStyleSheet("background-color: grey");
                        ui->check_slot17->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 17:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S18->setStyleSheet("background-color: white");
                        ui->check_slot18->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S18->setStyleSheet("background-color: green");
                        ui->check_slot18->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S18->setStyleSheet("background-color: red ");
                        ui->check_slot18->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S18->setStyleSheet("background-color: grey");
                        ui->check_slot18->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 18:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S19->setStyleSheet("background-color: white");
                        ui->check_slot19->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S19->setStyleSheet("background-color: green");
                        ui->check_slot19->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S19->setStyleSheet("background-color: red ");
                        ui->check_slot19->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S19->setStyleSheet("background-color: grey");
                        ui->check_slot19->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 19:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S20->setStyleSheet("background-color: white");
                        ui->check_slot20->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S20->setStyleSheet("background-color: green");
                        ui->check_slot20->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S20->setStyleSheet("background-color: red ");
                        ui->check_slot20->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S20->setStyleSheet("background-color: grey");
                        ui->check_slot20->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 20:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S21->setStyleSheet("background-color: white");
                        ui->check_slot21->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S21->setStyleSheet("background-color: green");
                        ui->check_slot21->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S21->setStyleSheet("background-color: red ");
                        ui->check_slot21->hide();
                    }
                    else if (slotnr == "3")
                    {
                        ui->lineEdit_L1S21->setStyleSheet("background-color: grey");
                        ui->check_slot21->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 21:
                    if (slotnr == "0")
                    {
                        ui->lineEdit_L1S22->setStyleSheet("background-color: white");
                        ui->check_slot22->hide();
                    }
                    else if (slotnr == "1")
                    {
                        ui->lineEdit_L1S22->setStyleSheet("background-color: green");
                        ui->check_slot22->show();
                    }
                    else if (slotnr == "2")
                    {
                        ui->lineEdit_L1S22->setStyleSheet("background-color: red ");
                        ui->check_slot22->hide();
                    }
                    else if (slotnr == "3")
                    {
                        ui->lineEdit_L1S22->setStyleSheet("background-color: grey");
                        ui->check_slot22->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 22:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S23->setStyleSheet("background-color: white");
                        ui->check_slot23->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S23->setStyleSheet("background-color: green");
                        ui->check_slot23->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S23->setStyleSheet("background-color: red ");
                        ui->check_slot23->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S23->setStyleSheet("background-color: grey");
                        ui->check_slot23->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 23:
                    if (slotnr == "0") {
                        ui->lineEdit_L1S24->setStyleSheet("background-color: white");
                        ui->check_slot24->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L1S24->setStyleSheet("background-color: green");
                        ui->check_slot24->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L1S24->setStyleSheet("background-color: red ");
                        ui->check_slot24->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L1S24->setStyleSheet("background-color: grey");
                        ui->check_slot24->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                case 24:
                    if (slotnr.left(1) == "0") {
                        ui->lineEdit_L1S25->setStyleSheet("background-color: white");
                        ui->check_slot25->hide();
                    } else if (slotnr.left(1) == "1") {
                        ui->lineEdit_L1S25->setStyleSheet("background-color: green");
                        ui->check_slot25->show();
                    } else if (slotnr.left(1) == "2") {
                        ui->lineEdit_L1S25->setStyleSheet("background-color: red ");
                        ui->check_slot25->hide();
                    } else if (slotnr.left(1) == "3") {
                        ui->lineEdit_L1S25->setStyleSheet("background-color: grey");
                        ui->check_slot25->hide();
                    }
                    VECslot1[i] = slotnr.toShort(&ok, 10);
                    break;
                }
            }
        }
        else if (lift == "2") {
            for (int i = 0; i < 25; i++) {
                slotnr = slotmap.mid(slotmap.indexOf(",") + i + 1, 1);
                qDebug() << "slot" << i << slotnr;
                switch (i) {
                case 0:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S1->setStyleSheet("background-color: white");
                        ui->check_slot1_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S1->setStyleSheet("background-color: green");
                        ui->check_slot1_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S1->setStyleSheet("background-color: red ");
                        ui->check_slot1_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S1->setStyleSheet("background-color: grey");
                        ui->check_slot1_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 1:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S2->setStyleSheet("background-color: white");
                        ui->check_slot2_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S2->setStyleSheet("background-color: green");
                        ui->check_slot2_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S2->setStyleSheet("background-color: red ");
                        ui->check_slot2_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S2->setStyleSheet("background-color: grey");
                        ui->check_slot2_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 2:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S3->setStyleSheet("background-color: white");
                        ui->check_slot3_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S3->setStyleSheet("background-color: green");
                        ui->check_slot3_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S3->setStyleSheet("background-color: red ");
                        ui->check_slot3_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S3->setStyleSheet("background-color: grey");
                        ui->check_slot3_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 3:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S4->setStyleSheet("background-color: white");
                        ui->check_slot4_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S4->setStyleSheet("background-color: green");
                        ui->check_slot4_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S4->setStyleSheet("background-color: red ");
                        ui->check_slot4_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S4->setStyleSheet("background-color: grey");
                        ui->check_slot4_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 4:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S5->setStyleSheet("background-color: white");
                        ui->check_slot5_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S5->setStyleSheet("background-color: green");
                        ui->check_slot5_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S5->setStyleSheet("background-color: red ");
                        ui->check_slot5_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S5->setStyleSheet("background-color: grey");
                        ui->check_slot5_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 5:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S6->setStyleSheet("background-color: white");
                        ui->check_slot6_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S6->setStyleSheet("background-color: green");
                        ui->check_slot6_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S6->setStyleSheet("background-color: red ");
                        ui->check_slot6_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S6->setStyleSheet("background-color: grey");
                        ui->check_slot6_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 6:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S7->setStyleSheet("background-color: white");
                        ui->check_slot7_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S7->setStyleSheet("background-color: green");
                        ui->check_slot7_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S7->setStyleSheet("background-color: red ");
                        ui->check_slot7_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S7->setStyleSheet("background-color: grey");
                        ui->check_slot7_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 7:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S8->setStyleSheet("background-color: white");
                        ui->check_slot8_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S8->setStyleSheet("background-color: green");
                        ui->check_slot8_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S8->setStyleSheet("background-color: red ");
                        ui->check_slot8_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S8->setStyleSheet("background-color: grey");
                        ui->check_slot8_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 8:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S9->setStyleSheet("background-color: white");
                        ui->check_slot9_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S9->setStyleSheet("background-color: green");
                        ui->check_slot9_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S9->setStyleSheet("background-color: red ");
                        ui->check_slot9_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S9->setStyleSheet("background-color: grey");
                        ui->check_slot9_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 9:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S10->setStyleSheet("background-color: white");
                        ui->check_slot10_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S10->setStyleSheet("background-color: green");
                        ui->check_slot10_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S10->setStyleSheet("background-color: red ");
                        ui->check_slot10_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S10->setStyleSheet("background-color: grey");
                        ui->check_slot10_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 10:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S11->setStyleSheet("background-color: white");
                        ui->check_slot11_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S11->setStyleSheet("background-color: green");
                        ui->check_slot11_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S11->setStyleSheet("background-color: red ");
                        ui->check_slot11_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S11->setStyleSheet("background-color: grey");
                        ui->check_slot11_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 11:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S12->setStyleSheet("background-color: white");
                        ui->check_slot12_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S12->setStyleSheet("background-color: green");
                        ui->check_slot12_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S12->setStyleSheet("background-color: red ");
                        ui->check_slot12_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S12->setStyleSheet("background-color: grey");
                        ui->check_slot12_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 12:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S13->setStyleSheet("background-color: white");
                        ui->check_slot13_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S13->setStyleSheet("background-color: green");
                        ui->check_slot13_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S13->setStyleSheet("background-color: red ");
                        ui->check_slot13_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S13->setStyleSheet("background-color: grey");
                        ui->check_slot13_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 13:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S14->setStyleSheet("background-color: white");
                        ui->check_slot14_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S14->setStyleSheet("background-color: green");
                        ui->check_slot14_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S14->setStyleSheet("background-color: red ");
                        ui->check_slot14_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S14->setStyleSheet("background-color: grey");
                        ui->check_slot14_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 14:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S15->setStyleSheet("background-color: white");
                        ui->check_slot15_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S15->setStyleSheet("background-color: green");
                        ui->check_slot15_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S15->setStyleSheet("background-color: red ");
                        ui->check_slot15_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S15->setStyleSheet("background-color: grey");
                        ui->check_slot15_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 15:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S16->setStyleSheet("background-color: white");
                        ui->check_slot16_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S16->setStyleSheet("background-color: green");
                        ui->check_slot16_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S16->setStyleSheet("background-color: red ");
                        ui->check_slot16_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S16->setStyleSheet("background-color: grey");
                        ui->check_slot16_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 16:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S17->setStyleSheet("background-color: white");
                        ui->check_slot17_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S17->setStyleSheet("background-color: green");
                        ui->check_slot17_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S17->setStyleSheet("background-color: red ");
                        ui->check_slot17_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S17->setStyleSheet("background-color: grey");
                        ui->check_slot17_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 17:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S18->setStyleSheet("background-color: white");
                        ui->check_slot18_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S18->setStyleSheet("background-color: green");
                        ui->check_slot18_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S18->setStyleSheet("background-color: red ");
                        ui->check_slot18_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S18->setStyleSheet("background-color: grey");
                        ui->check_slot18_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 18:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S19->setStyleSheet("background-color: white");
                        ui->check_slot19_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S19->setStyleSheet("background-color: green");
                        ui->check_slot19_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S19->setStyleSheet("background-color: red ");
                        ui->check_slot19_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S19->setStyleSheet("background-color: grey");
                        ui->check_slot19_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 19:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S20->setStyleSheet("background-color: white");
                        ui->check_slot20_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S20->setStyleSheet("background-color: green");
                        ui->check_slot20_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S20->setStyleSheet("background-color: red ");
                        ui->check_slot20_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S20->setStyleSheet("background-color: grey");
                        ui->check_slot20_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 20:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S21->setStyleSheet("background-color: white");
                        ui->check_slot21_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S21->setStyleSheet("background-color: green");
                        ui->check_slot21_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S21->setStyleSheet("background-color: red ");
                        ui->check_slot21_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S21->setStyleSheet("background-color: grey");
                        ui->check_slot21_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 21:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S22->setStyleSheet("background-color: white");
                        ui->check_slot22_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S22->setStyleSheet("background-color: green");
                        ui->check_slot22_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S22->setStyleSheet("background-color: red ");
                        ui->check_slot22_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S22->setStyleSheet("background-color: grey");
                        ui->check_slot22_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 22:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S23->setStyleSheet("background-color: white");
                        ui->check_slot23_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S23->setStyleSheet("background-color: green");
                        ui->check_slot23_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S23->setStyleSheet("background-color: red ");
                        ui->check_slot23_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S23->setStyleSheet("background-color: grey");
                        ui->check_slot23_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 23:
                    if (slotnr == "0") {
                        ui->lineEdit_L2S24->setStyleSheet("background-color: white");
                        ui->check_slot24_2->hide();
                    } else if (slotnr == "1") {
                        ui->lineEdit_L2S24->setStyleSheet("background-color: green");
                        ui->check_slot24_2->show();
                    } else if (slotnr == "2") {
                        ui->lineEdit_L2S24->setStyleSheet("background-color: red ");
                        ui->check_slot24_2->hide();
                    } else if (slotnr == "3") {
                        ui->lineEdit_L2S24->setStyleSheet("background-color: grey");
                        ui->check_slot24_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                case 24:
                    if (slotnr.left(1) == "0") {
                        ui->lineEdit_L2S25->setStyleSheet("background-color: white");
                        ui->check_slot25_2->hide();
                    } else if (slotnr.left(1) == "1") {
                        ui->lineEdit_L2S25->setStyleSheet("background-color: green");
                        ui->check_slot25_2->show();
                    } else if (slotnr.left(1) == "2") {
                        ui->lineEdit_L2S25->setStyleSheet("background-color: red ");
                        ui->check_slot25_2->hide();
                    } else if (slotnr.left(1) == "3") {
                        ui->lineEdit_L2S25->setStyleSheet("background-color: grey");
                        ui->check_slot25_2->hide();
                    }
                    VECslot2[i] = slotnr.toShort(&ok, 10);
                    break;
                }
            }
        }
        APIid = none;
        break;
    case cGETFNRES:
        qDebug() << "x offset" << parts[0] << "y offset" << parts[1];
        if (parts.count() == 2) {
            ui->line_api_getfnres_x->setText(parts[0]);
            ui->line_api_getfnres_y->setText(
                        parts[1].mid(parts[1].indexOf("=") + 1, -1));
        }
        APIid = none;
        if (assistant_wc)
            assistant_loop(assistant_wc);
        break;
    case cUNLOAD:
        APIid = none;
        if (assistant_wc)
            assistant_loop(assistant_wc);
        else if (macro_profil)
            macroProfil(true);
        else {
            deselslot();
            if (ui->check_lift2_deactivate->text() == "set deactive")
                ui->groupBox_Lift2->setEnabled(true);
            ui->groupBox_Lift1->setEnabled(true);
        }
        break;
    case cLOAD:
        APIid = none;
        if (assistant_wc)
            assistant_loop(assistant_wc);
        else if (macro_profil)
            macroProfil(true);
        break;
    case cSETLAMP:
        APIid = none;
        break;
    case cSERVICE:
        APIid = none;
        if (ui->check_API_servicemode->isChecked())
            ui->check_API_servicemode->setStyleSheet(backLightGreen);
        else
            ui->check_API_servicemode->setStyleSheet(backLightGrey);
        break;
    case cTWI:
        APIid = none;
        ui->p_API_twidelay->setStyleSheet(backLightGreen);
        break;
    case cGETSTATE:
        APIid = none;
        ui->p_API_getstate->setStyleSheet(backLightGreen);
        ui->line_getstate->setText(data);
        break;
    case none:
        APIid = none;
        break;
    }
}
void MainWindow::f_apitestpolling()
{
    if (apitestpolling->isActive())
        apitestpolling->stop();
    api_poll();
}
// Stylesheets
void MainWindow::setRESLabelRed()
{
    ui->label_res_L1H->setStyleSheet("QLabel { background-color: red }");
    ui->label_res_L1T->setStyleSheet("QLabel { background-color: red }");
    ui->label_res_L2H->setStyleSheet("QLabel { background-color: red }");
    ui->label_res_L2T->setStyleSheet("QLabel { background-color: red }");
    ui->label_res_LDX->setStyleSheet("QLabel { background-color: red }");
    ui->label_res_LDY->setStyleSheet("QLabel { background-color: red }");
    ui->label_resWCH->setStyleSheet("QLabel { background-color: red }");
    ui->label_WCP->setStyleSheet("QLabel { background-color: red }");
    ui->label_resMIC->setStyleSheet(backLightGrey);
    ui->label_resST->setStyleSheet(backLightGrey);
    ui->label_res_PAH->setStyleSheet("QLabel { background-color: red }");
    ui->label_resPAP->setStyleSheet("QLabel { background-color: red }");
    ui->label_resPAR->setStyleSheet("QLabel { background-color: red }");
    ui->label_resPAT->setStyleSheet("QLabel { background-color: red }");
}
void MainWindow::setStyleSheets()
{
    palBackground.setColor(QPalette::Base, QColor(45, 45, 255));
    palBackground2.setColor(QPalette::Base, QColor(45, 45, 10));
    palSchrift.setColor(
                QPalette::Text,
                QColor(0, 0, 255)); // blaue Schrift für zurück gelesene Parameter
    palSchrift0.setColor(QPalette::Text,
                         QColor(0, 0, 0)); // schwarze Schrift für ini-Daten
    ui->p_help_cass->setStyleSheet("color: blue");
    ui->tabWidget->setStyleSheet(col_Beige);
    ui->tabWidget_2->setStyleSheet(col_Grey);

    QPalette palette;
    palette.setColor(QPalette::Base, QColor(251, 251, 251));
    ui->line_cassname->setStyleSheet(col_greywhite);
    ui->lineCass_numbSlots->setStyleSheet(col_greywhite);
    ui->line_cassid->setStyleSheet(col_greywhite);
    ui->spinCass_SlotPos->setStyleSheet(col_greywhite);
    ui->spinCass_SlotDist->setStyleSheet(col_greywhite);
    ui->spinCass_SlotWdw->setStyleSheet(col_greywhite);
    ui->spinCass_WafSizeWdw->setStyleSheet(col_greywhite);
    ui->spinCass_WafheightOff->setStyleSheet(col_greywhite);
    ui->spinCass_fingerHeightOff->setStyleSheet(col_greywhite);
    ui->spinCass_firstSlot->setStyleSheet(col_greywhite);
    ui->lineCass_actHeightPos->setStyleSheet(col_greywhite);
    ui->lineCass_actpos_mm->setStyleSheet(col_greywhite);
    ui->lineL1_maplist->setStyleSheet(col_greywhite);
    ui->line_align_displ->setStyleSheet(col_greywhite);
}
void MainWindow::setStyleSheetFrames()
{
    ui->plainText_sendlog->setStyleSheet(col_greywhite);
    ui->frame_cass_select->setStyleSheet(col_Beigeframe);
    //    ui->frame_SMIF1->setStyleSheet(col_Beigeframe);
    ui->frame_SMIF1_status->setStyleSheet(col_Beigeframe);
    ui->frame_cass_copy->setStyleSheet(col_Beigeframe);
    ui->frame_cass_go->setStyleSheet(col_Beigeframe);
    ui->frame_cass_set->setStyleSheet(col_Beigeframe);
    ui->frame_cass_pos->setStyleSheet(col_Beigeframe);
    ui->frame_cass_release->setStyleSheet(col_Beigeframe);
    ui->frame_loader_posx->setStyleSheet(col_Beigeframe);
    ui->frame_loader_posy->setStyleSheet(col_Beigeframe);
    ui->frame_lift1_postilt->setStyleSheet(col_Beigeframe);
    ui->frame_lift1_posheight->setStyleSheet(col_Beigeframe);
    ui->frame_cass_map->setStyleSheet(col_Beigeframe);
    ui->frame_lift2_posheight->setStyleSheet(col_Beigeframe);
    ui->frame_lift2_postilt->setStyleSheet(col_Beigeframe);
    ui->frame_pa_height->setStyleSheet(col_Beigeframe);
    ui->frame_pa_phi->setStyleSheet(col_Beigeframe);
    ui->frame_pa_tilt->setStyleSheet(col_Beigeframe);
    ui->frame_pa_rot->setStyleSheet(col_Beigeframe);
    ui->frame_wc_height->setStyleSheet(col_Beigeframe);
    ui->frame_wc_phi->setStyleSheet(col_Beigeframe);
    ui->frame_log_servicedata->setStyleSheet(col_Beigeframe);
    ui->frame_vac_setup->setStyleSheet(col_Beigeframe);
    ui->frame_vac_set->setStyleSheet(col_Beigeframe);
    ui->spinBox_sourcecass->setStyleSheet(col_Beigeframe);
    ui->spinBox_destinationcass->setStyleSheet(col_Beigeframe);
    ui->toolBox_macro->setStyleSheet(col_Beigeframe);
    ui->pacmds->setStyleSheet(col_Beigeframe);
    ui->frame_aligner_set->setStyleSheet(col_Beigeframe);
}
void MainWindow::APIstatus()
{
    serialSendAPI("@STAT\r\n");
    cmdSTA->stop();
}
// ------------- System polling ------------------
void MainWindow::pollDC() {
    static int dccyc = 0;

    if (dccyc == 0)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("50"); // DC8 einlesen
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        dccyc = 1;
    }
    else if (dccyc == 1)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("51"); // DC12 einlesen
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        dccyc = 2;
    }
    else if (dccyc == 2)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("52"); // DCM12 einlesen
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        dccyc = 3;
    }
    else if (dccyc == 3)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("53"); // DC24 einlesen
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        dccyc = 0;
    }
}
void MainWindow::pollTP()
{
    static int tpcyc = 0;

    if (tpcyc == 0)
    {
        if (ui->check_lift2_deactivate->isChecked())
        {
            tmpstr = 0;
            tmpstr.append(READ);
            tmpstr.append("57"); // Temperatur Board 2
            // tmpstr.append("=");
            // tmpstr.append("1");
            tmpstr.append(CRLF);
            serialSendFeeder(tmpstr);
        }
        tpcyc = 1;
    }
    else if (tpcyc == 1)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("58"); // Temperatur Board 3
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        tpcyc = 2;
    }
    else if (tpcyc == 2)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("59"); // Temperatur Board 4
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        tpcyc = 3;
    }
    else if (tpcyc == 3)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("60"); // Temperatur Board 5
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        tpcyc = 4;
    }
    else if (tpcyc == 4)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("61"); // Temperatur Board 6
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        tpcyc = 0;
    }
}
void MainWindow::pollVAC() // analoge vac values werden in RAC laufend gepollt
{
    static int avcyc = 0;

    if (avcyc == 0)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("62"); // VAC Main
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        avcyc = 1;
    }
    else if (avcyc == 1)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("63"); // VAC Loader
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        avcyc = 2;
    }
    else if (avcyc == 2)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("64"); // VAC PA
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        avcyc = 3;
    }
    else if (avcyc == 3)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("65"); // VAC WC1
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        avcyc = 4;
    }
    else if (avcyc == 4)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("66"); // VAC WC2
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        avcyc = 5;
    }
    else if (avcyc == 5)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("67"); // VAC CH4
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);

        if (getAVoper) avcyc = 6;
        else avcyc = 0;
    }
    else if (avcyc == 6)
    {
        resetFlags();
        serialSendFeeder(svcgetvac); // $GET=40_ Status der Vakuumventile holen
        getAVoper = 0;
        avcyc = 0;
    }
}
void MainWindow::pollMV()
{
    static int mvcyc = 0;

    if (mvcyc == 0)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("76"); // Volt1 Board 2 Lift2-Height
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 1;
    }
    else if (mvcyc == 1)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("77"); // Volt1 Board 3 Lift1-Height
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 2;
    }
    else if (mvcyc == 2)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("78"); // Volt1 Board 4 PARotPos
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 3;
    }
    else if (mvcyc == 3)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("79"); // Volt1 Board 5 Loader-X
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 4;
    }
    else if (mvcyc == 4)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("81"); // Volt2 Board 2 Lift2-Tilt
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 5;
    }
    else if (mvcyc == 5)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("82"); // Volt2 Board 3 Lift1-Tilt
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 6;
    }
    else if (mvcyc == 6)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("83"); // Volt2 Board 4 PA-Phi
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 7;
    }
    else if (mvcyc == 7)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("84"); // Volt2 Board 5 Loader-Y
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 8;
    }
    else if (mvcyc == 8)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("87"); // Volt3 Board 3 PA-Height
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 9;
    }
    else if (mvcyc == 9)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("88"); // Volt3 Board 4 PA-Tilt
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 10;
    }
    else if (mvcyc == 10)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("89"); // Volt3 Board 5 WC-Height
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 11;
    }
    else if (mvcyc == 11)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("90"); // Volt3 Board 6 WC-PHI
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        mvcyc = 0;
    }
}
void MainWindow::pollSEN()
{
    static int pscyc = 0;

    if (pscyc == 0)
    {
        if (ui->radio_lift1_SMIF->isChecked() == 0)
        {
            tmpstr = 0;
            tmpstr.append(READ);
            tmpstr.append("54"); // Lift1 Sensor
            // tmpstr.append("=");
            // tmpstr.append("1");
            tmpstr.append(CRLF);
            serialSendFeeder(tmpstr);
        }
        else
        {
            ui->lineEdit_sens_L1sens->setText("--");
            ui->line_lift1_cassswitch->setText("--");
        }
        //        else err_msgbox("SMIF Lift is installed. Please use SMIF ->
        //        Status")
        pscyc = 1;
    }
    else if (pscyc == 1)
    {
        if (ui->radio_lift2_notinstalled->isChecked() == 0) {
            tmpstr = 0;
            tmpstr.append(READ);
            tmpstr.append("55"); // Lift2 Sensor
            // tmpstr.append("=");
            // tmpstr.append("1");
            tmpstr.append(CRLF);
            serialSendFeeder(tmpstr);
        }
        pscyc = 2;
    }
    else if (pscyc == 2)
    {
        tmpstr = 0;
        tmpstr.append(READ);
        tmpstr.append("56"); // Wafer Sensor
        // tmpstr.append("=");
        // tmpstr.append("1");
        tmpstr.append(CRLF);
        serialSendFeeder(tmpstr);
        pscyc = 0;
    }
}
void MainWindow::pollWS()
{
    static int wscyc = 0;

    if (wscyc == 0)
    {
        on_p_align_analogval_clicked(); // Analogwert Alignersensor
        wscyc = 1;
    }
    else if (wscyc == 1)
    {
        on_p_align_amplif_clicked(); // Verstärkung Alignersensor
        wscyc = 0;
    }
}
void MainWindow::pollVV() // vac switches
{
    serialSendFeeder(svcgetvac);
}
void MainWindow::pollcmd()
{
    if (cmdfeeder == 0)
    {
        if (pollflagDC) pollDC();
        else if (pollflagTP) pollTP();
        else if (pollflagAV) pollVAC();
        else if (pollflagWS) pollWS();
        else if (pollflagMV) pollMV();
        else if (pollflagVV) pollVV();
        else if (pollflagPS) pollSEN();
        else if (pollflagEMO) pollEMO();
    }
}
void MainWindow::pollEMO() { serialSendFeeder("$GET_47=0\r\n"); }
void MainWindow::stopTimer() { syspoll->stop(); }
// ---------------- TESTDATA ----------------------
void MainWindow::on_check_testdata_ON_clicked()
{
    if (serial_due->isOpen())
    {
        if (ui->check_testdata_ON->isChecked()) serialSendDUE("$ad=1\r");
        else serialSendDUE("$ad=0\r");
        svcresults = TRUE;
    }
    else
    {
        err_msgbox("COM5 not open");
        ui->check_testdata_ON->setChecked(0);
    }
}
void MainWindow::on_p_aligntestdata_clicked() {
    QString tmpline = "0";
    int count = 0;
    QString diracer = "C:/Users/micha/OneDrive - FernUniversität "
                      "Hagen/miratecs/Projekte/INS3000/Plots/Log";
    QString diramd = "C:/Users/miraTecs/OneDrive - FernUniversität "
                     "Hagen/miratecs/Projekte/INS3000/Plots/Log";
    QString dir;
    if (QFileInfo::exists(diracer)) dir = diracer;
    else dir = diramd;
    DATA2OPEN = QFileDialog::getOpenFileName(this, tr("Open *.*log"), dir, tr("inifile (*.log);;All Files (*)"));

    QFile f(DATA2OPEN); // Daten aus INSSETUP.INI einlesen
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
    ui->line_activeFile_testdata->setText(f.fileName());
    line.clear();
    int i = 0;
    ui->plainTextEdit_reader_copy->clear();
    QTextCursor cursor = ui->plainTextEdit_reader_copy->textCursor();
    for (int t = 0; t < amount; t++)
    {
        testdaten[t] = 0;
    }

    while (!f.atEnd())
    {
        line = f.readLine();
        i++;
        if (line.contains('*'))
        {
            qDebug() << line.length() << "count" << count << "line" << i;
            if (line.length() > 20000)
            {
                qDebug() << "gezählt" << count;
                if (count < amount) testdaten[count] = line;
                else
                {
                    err_msgbox("limit testdaten array hit");
                    break;
                }
                count++;
                ui->plainTextEdit_reader_copy->appendPlainText(line);
                ui->line_testdata_count->setText(QString::number(count));
            }
        }
    }
    if (count) on_spin_testdata_set_valueChanged("1");
    f.close();
    qDebug() << "pos" << cursor.position();
    cursor.movePosition(QTextCursor::Start);
    cursor.setPosition(QTextCursor::Start);
    qDebug() << "pos" << cursor.position();
    //    ui->plainTextEdit_reader_copy->scroll(0,-500);
    QScrollBar *scrollbar = ui->plainTextEdit_reader_copy->verticalScrollBar();
    qDebug() << "scrollbar" << scrollbar->value();
    scrollbar->setValue(0);
    ui->plainTextEdit_reader_copy->update();

    /*
  QTextCursor actCursor = ui->textEdit->textCursor();  // den aktuellen
  Textcursor aus dem QTextEdit speichern int iCurPos = actCursor.position();  //
  die aktuelle Cursorposition als Int speichern iCurPos += ui->spinBox->value();
  // hier habe ich Werte von -20 bis +20 zur Auswahl, um welche dann die
  Cursorposition geändert wird actCursor.setPosition(iCurPos);  // den
  QTextCursor neu Positionieren ui->textEdit->setTextCursor(actCursor);  // und
  den geänderten TextCursor wieder an das QTextEdit weitergeben
  ui->textEdit->setFocus();
   * */
}
void MainWindow::on_p_testdata_send_clicked() {
    testdata = 1;
    serialSendDUE("$dg=1\r");
}
void MainWindow::on_spin_testdata_set_valueChanged(const QString &arg1) {
    qDebug() << "spin" << arg1;
    QString ind = arg1;
    int tmparg = 0;
    if (arg1.toInt(&ok, 10) > ui->line_testdata_count->text().toInt(&ok, 10)) {
        tmparg = arg1.toInt(&ok, 10) - 1;
        ind = QString::number(tmparg);
    }
    ui->spin_testdata_set->setValue(ind.toInt(&ok, 10));

    if (ind.toInt(&ok, 10) < amount) {
        QString testdate = testdaten[ind.toUInt(&ok, 10) - 1].left(11);
        ui->line_testdata_date->setText(testdate);

        QString datstr = testdaten[ind.toUInt(&ok, 10) - 1];
        f_showdata(datstr);
    }
}
void MainWindow::f_showdata(QString datastr) {
    auto parts = datastr.mid(datastr.indexOf('*') + 1, datastr.indexOf('\r') - 1)
            .trimmed()
            .split(',');
    clearData(); // alte Diagrammdaten löschen
    int i = 0;
    int k = 0;
    int val = 0;
    if (parts.count() > 0) {
        do {
            if (parts[i] != "\r\n") {
                val = parts[i].toInt(&ok, 10);
                addPoint((double)k, (double)val);
            }
            i++;
            if (parts.count() < 6164) {
                k += 8; // bei LD Displacement wird nur ein Bruchteil der Daten gesendet
                graphcol = 1;
            } else {
                k++;
                graphcol = 0;
            }
        } while (i < parts.count());
        chart = 2;
        showspline();
    }
}
void MainWindow::on_p_data_show_clicked() {
    int spin = ui->spin_testdata_set->value();
    if (spin <= ui->line_testdata_count->text().toInt(&ok, 10)) {
        QString datstr = testdaten[spin - 1];
        f_showdata(datstr);
    } else
        ui->spin_testdata_set->setValue(
                    ui->line_testdata_count->text().toInt(&ok, 10));
}
void MainWindow::on_check_testdata_resetFlag_clicked() {
    if (serial_due->isOpen()) {
        if (ui->check_testdata_resetFlag->isChecked())
            serialSendDUE("$ad=3=0\r");
        else
            serialSendDUE("$ad=3=1\r");
        svc3 = TRUE;
    } else {
        err_msgbox("COM5 not open");
        ui->check_testdata_resetFlag->setChecked(0);
    }
}
void MainWindow::on_check_testdata_sqrlog_clicked() {
    if (serial_due->isOpen()) {
        if (ui->check_testdata_sqrlog->isChecked() &&
                ui->check_testdata_sinfit->isChecked()) {
            err_msgbox("uncheck normlog first");
            ui->check_testdata_sqrlog->setChecked(0);
        } else if (ui->check_testdata_sinfit->isChecked() == 0) {
            if (ui->check_testdata_sqrlog->isChecked()) {
                serialSendDUE("$d0=5\r"); // quadrierte sensordaten
                plotsqr = 1;
            } else {
                serialSendDUE("$d0=4\r"); // standard sensordaten
                plotsqr = 0;
            }
            svc7 = TRUE;
        }
    } else {
        err_msgbox("COM5 not open");
        ui->check_testdata_sqrlog->setChecked(0);
    }
}
// ---------------- INIT ----------------------
void MainWindow::on_p_loadinssetupini_clicked() // INI-File auswählen, abweichend vom Standardpfad
{
    SETUP_FILE("0");
}
void MainWindow::on_p_loadinsmotorini_clicked() // INSMOTOR.INI-File auswählen und Version auslesen
{
    MFILE2OPEN = QFileDialog::getOpenFileName(
                this, tr("Open Insmotor.INI"), "", tr("inifile (*.ini);;All Files (*)"));

    MotparaReadVersion(MFILE2OPEN);
}
void MainWindow::MotparaReadVersion(QString file) // liest nur die Version aus der Mot-INI aus
{
    QFile f1(file); // Daten aus INSMOTOR.INI einlesen
    if (!f1.open(QIODevice::ReadOnly | QIODevice::Text))
        return;
    ui->lineEdit_activemotorFile->setText(f1.fileName());
    line.clear();

    while (!f1.atEnd()) {
        line = f1.readLine();
        if (line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            // qDebug() << line;
            if (line.mid(1, line.size() - 3) == "Version") {
                line = f1.readLine();
                QString initext =
                        line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                line = f1.readLine();
                initext.append(" - ");
                initext.append(
                            line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                ui->line_motorini_version->setText(initext);
            }
        }
    }
    f1.close();
}
void MainWindow::SETUP_FILE(const QString &arg1) // SetupINI-File einlesen
{
    QString tmpline = "0";
    if (arg1 == "0")
    {
        FILE2OPEN = QFileDialog::getOpenFileName(this, tr("Open Inssetup.INI"), "", tr("inifile (*.ini);;All Files (*)"));
    }
    else if (arg1 == "1")
    {
        FILE2OPEN = DEFAULTINIFILE;
        MFILE2OPEN = DEFAULTMOTFILE;
    }
    QFile f(FILE2OPEN); // Daten aus INSSETUP.INI einlesen
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) err_msgbox("can't open INIfile");
    else
    {
        ui->lineEdit_activeIniFile->setText(f.fileName());
        line.clear();
        int i = 0;

        float tmpReso;
        float tmpResoPAH;
        float tmpResoPAP;
        float tmpResoWOR;
        float tmpResoWOT;
        float tmpResoLDX;
        float tmpResoLDY;
        float tmpResoWCH;
        float tmpResoWCP;
        float val;
        QString linestr;

        while (!f.atEnd())
        {
            if (tmpline.at(0) != '[') line = f.readLine(); // falls bereits eine Zeile mit [ gelesen wurde
            else tmpline = "0";
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                if (line.mid(1, line.size() - 3) == "Version")
                {
                    line = f.readLine();
                    QString initext = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                    line = f.readLine();
                    initext.append(" - ");
                    initext.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    ui->line_setupini_version->setText(initext);
                }
                else if (line.mid(1, line.size() - 3) == "Lift1")
                {
                    for (i = 0; i <= 15; ++i) // Block hat 15 Zeilen
                    {
                        line = f.readLine();
                        if (line.at(0) != '\n')
                        {
                            linestr = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                            switch (i)
                            {
                            case 0: // Lift present
                                if (line.mid(line.indexOf("=") + 1, 1) == "1")
                                {
                                    ui->check_lift1_deactivate->setChecked(1);
                                }
                                else
                                {
                                    ui->radio_lift1_notinstalled->setChecked(1);
                                    ui->check_lift1_deactivate->setChecked(0);
                                    ui->frame_lift1_selectSMIF->hide();
                                    ui->frame_lift1_leica->hide();
                                }
                                break;
                            case 1: // Wafersensor height
                                tmpReso = getResolution("Lift1 height motor").toFloat();
                                val = linestr.toFloat(&ok) / tmpReso;
                                ui->line_lift1_wafersensor_height_mm->setText(QString::number(val, 'f', 3));
                                ui->line_lift1_wafersensor_height->setText(linestr);
                                break;
                            case 2: // Unload operator height
                                tmpReso = getResolution("Lift1 height motor").toFloat();
                                val = linestr.toFloat(&ok) / tmpReso;
                                ui->line_lift1_unload_height_mm->setText(QString::number(val, 'f', 3));
                                ui->line_lift1_unload_height->setText(linestr);
                                break;
                            case 3: // XY-Loader height
                                tmpReso = getResolution("Lift1 height motor").toFloat();
                                val = linestr.toFloat(&ok) / tmpReso;
                                ui->line_lift1_xyloader_height_mm->setText(QString::number(val, 'f', 3));
                                ui->line_lift1_xyloader_height->setText(linestr);
                                break;
                            case 4: // Measuring Unit Height
                                val = linestr.toFloat(&ok) * tmpReso;
                                ui->line_lift1_measuring_height_mm->setText(linestr);
                                ui->line_lift1_measuring_height->setText(QString::number(val));
                                break;
                            case 5: // Tilt present
                                if (line.mid(line.indexOf("=") + 1, 1) == "1")
                                {
                                    ui->label_Tilt1Present->setStyleSheet("background-color: green");
                                    ui->label_Tilt1_present->setText("Tilt1 active");
                                    ui->check_tilt1_deactivate->setText("deactivate");
                                    ui->check_tilt1_deactivate->setChecked(1);
                                }
                                else
                                {
                                    ui->label_Tilt1Present->setStyleSheet("background-color: Red");
                                    ui->label_Tilt1_present->setText("Tilt1 deactive");
                                    ui->check_tilt1_deactivate->setText("activate");
                                    ui->check_tilt1_deactivate->setChecked(0);
                                }
                                break;
                            case 6: // Tilt on position
                                tmpReso = getResolution("Lift1 tilt motor").toFloat();
                                val = linestr.toFloat(&ok) / tmpReso;
                                ui->line_lift1_tiltactpos_mm->setText(QString::number(val, 'f', 3));
                                ui->line_lift1_tiltactpos->setText(linestr);
                                break;
                            case 7: // Tilt off position
                                tmpReso = getResolution("Lift1 tilt motor").toFloat();
                                val = linestr.toFloat(&ok) / tmpReso;
                                ui->line_lift1_tiltinactpos_mm->setText(QString::number(val, 'f', 3));
                                ui->line_lift1_tiltinactpos->setText(linestr);
                                break;
                            case 8: // Wafertype thin
                                // if (line.mid(line.indexOf("=") + 1, 1) == "thin" || line.mid(line.indexOf("=") + 1, 1) == "1") ui->radio_lift1_thinwafer->setChecked(1);
                                // else if (line.mid(line.indexOf("=") + 1, 1) == "normal" || line.mid(line.indexOf("=") + 1, 1) == "0") ui->radio_lift1_thinwafer->setChecked(0);
                                break;
                            case 9: // Smif Type
                                if (line.mid(line.indexOf("=") + 1, 4) == "none")
                                {
                                    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->smif));
                                    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->asyst));
                                    if (ui->radio_lift1_notinstalled->isChecked() == 0)
                                    {
                                        ui->radio_lift1_default->setChecked(1);
                                        ui->frame_lift1_leica->show();
                                        ui->frame_lift1_selectSMIF->hide();
                                    }
                                    else
                                    {
                                        ui->frame_lift1_leica->hide();
                                    }
                                    ui->frame_lift1_selectSMIF->hide();
                                }
                                else
                                {
                                    if (userindex != 5)
                                    {
                                        if (ui->combo_lift1_SMIF_select->currentText().left(3) == "ISE")
                                        {
                                            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->smif), ui->smif, "SMIF");
                                        }
                                        else if (ui->combo_lift1_SMIF_select->currentText().left(3) == "ASY")
                                        {
                                            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->asyst), ui->asyst, "ASYST");
                                        }
                                    }
                                    ui->radio_lift1_SMIF->setChecked(1);
                                    ui->frame_lift1_selectSMIF->show();
                                    ui->p_lift1_SMIF->show();
                                    ui->combo_lift1_SMIF_select->itemText(0);
                                    ui->combo_lift1_SMIF_select->setCurrentText(linestr);
                                    ui->frame_lift1_leica->hide();
                                }
                                SMIFTYPE1 = linestr;
                                break;
                            case 10: // Smif Port
                                //                            ui->combo_lift1_SMIF_com->setCurrentText(linestr);
                                break;
                            case 11: // 4" Cassette Nr
                                ui->combo_4inchsel->setCurrentText(linestr);
                                break;
                            case 12: // 5" Cassette Nr
                                ui->combo_5inchsel->setCurrentText(linestr);
                                break;
                            case 13: // 6" Cassette Nr
                                ui->combo_6inchsel->setCurrentText(linestr);
                                break;
                            case 14: // 8" Cassette Nr
                                ui->combo_8inchsel->setCurrentText(linestr);
                                break;
                            }
                        }
                        else i--; // wegen Leerzeile wird Zähler nicht erhöht
                    }
                }
                else if (line.mid(1, line.size() - 3) == "Lift2")
                {
                    for (i = 0; i <= 15; ++i)
                    { // Block hat 15 Zeilen
                        line = f.readLine();
                        if (line.at(0) != '\n')
                        {
                            linestr = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                            switch (i)
                            {
                            case 0: // Lift present
                                if (line.mid(line.indexOf("=") + 1, 1) == "1")
                                {
                                    ui->check_lift2_deactivate->setChecked(1);
                                    ui->p_readBoard2->setDisabled(0);
                                    ui->p_RES_L2_Height->setDisabled(0);
                                    ui->groupBox_Lift2->setDisabled(false);
                                    //                                 ui->p_Invent_Lift2->setDisabled(false);
                                    //                                 ui->frame_lock2->setDisabled(false);
                                    //                                 ui->frame_port_smif_2->show();
                                }
                                else
                                {
                                    ui->radio_lift2_notinstalled->setChecked(1);
                                    ui->check_lift2_deactivate->setChecked(0);
                                    ui->frame_lift2_selectSMIF->hide();
                                    ui->frame_Lift2_leica->hide();
                                    ui->p_readBoard2->setDisabled(1);
                                    ui->p_RES_L2_Height->setDisabled(1);
                                    ui->label_res_L2H->setStyleSheet("QLabel { background-color: grey }");
                                    //                                 ui->groupBox_Lift2->setDisabled(true);
                                    //                                 ui->p_Invent_Lift2->setDisabled(true);
                                    //                                 ui->frame_lock2->setDisabled(true);
                                }
                                break;
                            case 1: // Wafersensor height
                                tmpReso = getResolution("Lift2 height motor").toFloat();
                                val = linestr.toFloat(&ok) / tmpReso;
                                ui->line_lift2_wafersensor_height_mm->setText(QString::number(val, 'f', 3));
                                ui->line_lift2_wafersensor_height->setText(linestr);
                                break;
                            case 2: // Unload operator height
                                tmpReso = getResolution("Lift2 height motor").toFloat();
                                val = linestr.toFloat(&ok) / tmpReso;
                                ui->line_lift2_unload_height_mm->setText(QString::number(val, 'f', 3));
                                ui->line_lift2_unload_height->setText(linestr);
                                break;
                            case 3: // XY-Loader height
                                tmpReso = getResolution("Lift2 height motor").toFloat();
                                val = linestr.toFloat(&ok) / tmpReso;
                                ui->line_lift2_xyloader_height_mm->setText(QString::number(val, 'f', 3));
                                ui->line_lift2_xyloader_height->setText(linestr);
                                break;
                            case 4: // Measuring Unit Height
                                tmpReso = getResolution("Lift2 height motor").toFloat();
                                val = linestr.toFloat(&ok) * tmpReso;
                                ui->line_lift2_measuring_height->setText(QString::number(val, 'f', 3));
                                ui->line_lift2_measuring_height_mm->setText(linestr);
                                break;
                            case 5: // Tilt present
                                if (line.mid(line.indexOf("=") + 1, 1) == "1")
                                {
                                    ui->label_Tilt2Present->setStyleSheet("background-color: green");
                                    ui->label_Tilt2_present->setText("Tilt2 active");
                                    ui->check_tilt2_deactivate->setText("deactivate");
                                    ui->check_tilt2_deactivate->setChecked(1);
                                    ui->p_RES_L2_Tilt->setDisabled(0);
                                }
                                else
                                {
                                    ui->label_Tilt2Present->setStyleSheet("background-color: Red");
                                    ui->label_Tilt2_present->setText("Tilt2 deactive");
                                    ui->check_tilt2_deactivate->setText("activate");
                                    ui->check_tilt2_deactivate->setChecked(0);
                                    ui->p_RES_L2_Tilt->setDisabled(1);
                                    ui->label_res_L2T->setStyleSheet("QLabel { background-color: grey }");
                                }
                                break;
                            case 6: // Tilt on position
                                tmpReso = getResolution("Lift2 tilt motor").toFloat();
                                val = linestr.toFloat(&ok) / tmpReso;
                                ui->line_lift2_tiltactpos_mm->setText(QString::number(val, 'f', 3));
                                ui->line_lift2_tiltactpos->setText(linestr);
                                break;
                            case 7: // Tilt off position
                                tmpReso = getResolution("Lift2 tilt motor").toFloat();
                                val = linestr.toFloat(&ok) / tmpReso;
                                ui->line_lift2_tiltinactpos_mm->setText(QString::number(val, 'f', 3));
                                ui->line_lift2_tiltinactpos->setText(linestr);
                                break;
                            case 8: // Wafertype thin
                                // if (line.mid(line.indexOf("=") + 1, 1) == "1") ui->radio_lift2_thinwafer->setChecked(1);
                                // else ui->radio_lift2_thinwafer->setChecked(0);
                                break;
                            case 9: // Smif Type
                                if (line.mid(line.indexOf("=") + 1, 4) == "none")
                                {
                                    if (ui->radio_lift1_SMIF->isChecked() == 0) ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->smif));
                                    if (ui->radio_lift2_notinstalled->isChecked() == 0)
                                    {
                                        ui->radio_lift2_default->setChecked(1);
                                        ui->frame_Lift2_leica->show();
                                        ui->frame_lift2_selectSMIF->hide();
                                    }
                                    else
                                    {
                                        ui->frame_Lift2_leica->hide();
                                    }
                                    ui->frame_lift2_selectSMIF->hide();
                                }
                                else
                                {
                                    ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->smif), ui->smif, "SMIF");
                                    ui->radio_lift2_SMIF->setChecked(1);
                                    ui->frame_lift2_selectSMIF->show();
                                    ui->p_lift2_SMIF->show();
                                    ui->combo_lift2_SMIF_select->itemText(0);
                                    ui->combo_lift2_SMIF_select->setCurrentText(linestr);

                                    ui->frame_Lift2_leica->hide();
                                }
                                SMIFTYPE2 = linestr;
                                break;
                            case 10: // Smif Port
                                //                             ui->combo_lift2_SMIF_com->setCurrentText(linestr);
                                break;
                            case 11: // 4" Cassette Nr
                                ui->combo_lift2_4inchsel->setCurrentText(linestr);
                                break;
                            case 12: // 5" Cassette Nr
                                ui->combo_lift2_5inchsel->setCurrentText(linestr);
                                break;
                            case 13: // 6" Cassette Nr
                                ui->combo_lift2_6inchsel->setCurrentText(linestr);
                                break;
                            case 14: // 8" Cassette Nr
                                ui->combo_lift2_8inchsel->setCurrentText(linestr);
                                break;
                            }
                        }
                        else i--; // wegen Leerzeile wird Zähler nicht erhöht
                    }
                }
                else if (line.mid(1, line.size() - 3) == "Loader")
                {
                    tmpResoLDX = getResolution("Loader x - motor").toFloat();
                    tmpResoLDY = getResolution("Loader y - motor").toFloat();

                    for (i = 0; i <= 12; ++i)
                    {
                        // Block hat 12 Zeilen
                        line = f.readLine();
                        if (line.at(0) != '\n')
                        {
                            linestr = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                            switch (i)
                            {
                            case 0: // x-L1 position
                                val = linestr.toFloat(&ok) / tmpResoLDX;
                                ui->line_loader_xlift1pos_3->setText(QString::number(val, 'f', 3));
                                ui->line_loader_xlift1pos->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 1: // x-L2 position
                                val = linestr.toFloat(&ok) / tmpResoLDX;
                                ui->line_loader_xlift2pos_3->setText(QString::number(val, 'f', 3));
                                ui->line_loader_xlift2pos->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 2: // x-L3 position
                                // ui->line_loader_xlift3pos->setText(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                                break;
                            case 3: // x-PA free position
                                val = linestr.toFloat(&ok) / tmpResoLDX;
                                ui->line_loader_xpreafreepos_3->setText(QString::number(val, 'f', 3));
                                ui->line_loader_xpreafreepos->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 4: // x-PA position
                                val = linestr.toFloat(&ok) / tmpResoLDX;
                                ui->line_loader_xpreapos_3->setText(QString::number(val, 'f', 3));
                                ui->line_loader_xpreapos->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 5: // y-L1 position
                                val = linestr.toFloat(&ok) / tmpResoLDY;
                                ui->line_loader_ylift1inpos_3->setText(QString::number(val, 'f', 3));
                                ui->line_loader_ylift1inpos->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 6: // y-L2 position
                                val = linestr.toFloat(&ok) / tmpResoLDY;
                                ui->line_loader_ylift2inpos_3->setText(QString::number(val, 'f', 3));
                                ui->line_loader_ylift2inpos->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 7: // y-L3 position
                                //  ui->line_loader_ylift3inpos->setText(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                                break;
                            case 8: // y-PA position
                                val = linestr.toFloat(&ok) / tmpResoLDY;
                                ui->line_loader_ypreapos_3->setText(QString::number(val, 'f', 3));
                                ui->line_loader_ypreapos->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 9: // y-Out lift position
                                val = linestr.toFloat(&ok) / tmpResoLDY;
                                ui->line_loader_youtlift_3->setText(QString::number(val, 'f', 3));
                                ui->line_loader_youtlift->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 10: // y-In lift displacement
                                ui->line_loader_yliftdispl->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 11: // 6" Cassette displacement
                                //  ui->line_loader_->setCurrentText(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                                break;
                            }
                        }
                        else i--; // wegen Leerzeile wird Zähler nicht erhöht
                    }
                }
                else if (line.mid(1, line.size() - 3) == "Prealigner")
                {
                    tmpResoPAH = getResolution("Prealigner height motor").toFloat();
                    tmpResoPAP = getResolution("Prealigner phi motor").toFloat();
                    tmpResoWOT = getResolution("Wobbler phi motor").toFloat();
                    tmpResoWOR = getResolution("Wobbler rotation motor").toFloat();
                    //    qDebug()<<"INI-Value Prealigner height motor"<<tmpResoPAH;
                    //    qDebug()<<"INI-Value Prealigner phi motor"<<tmpResoPAP;
                    //    qDebug()<<"INI-Value Wobbler phi motor"<<tmpResoWOT;
                    //    qDebug()<<"INI-Value Wobbler rotation motor"<<tmpResoWOR;

                    for (i = 0; i <= 20; ++i)
                    { // Block hat 21 Zeilen
                        line = f.readLine();
                        if (line.at(0) != '\n')
                        {
                            linestr = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                            switch (i)
                            {
                            case 0: // Wobbler present
                                if (line.mid(line.indexOf("=") + 1, 1) == "1")
                                {
                                    ui->check_wob_deactiv->setChecked(1);
                                    on_check_wob_deactiv_toggled(1);
                                    ui->p_RES_PREA_TILT->setDisabled(0);
                                    ui->p_RES_PREA_ROTPOS->setDisabled(0);
                                    ui->frame_wobble->setDisabled(0);
                                    ui->p_INIT_PA_Tilt->setDisabled(0);
                                    ui->p_INIT_PA_RotPos->setDisabled(0);
                                    ui->frame_pa_rot->setDisabled(0);
                                    ui->frame_pa_tilt->setDisabled(0);
                                    ui->check_API_loop_macro->setDisabled(0);
                                }
                                else
                                {
                                    ui->check_wob_deactiv->setChecked(0);
                                    on_check_wob_deactiv_toggled(0);
                                    ui->p_RES_PREA_TILT->setDisabled(1);
                                    ui->p_RES_PREA_ROTPOS->setDisabled(1);
                                    ui->frame_wobble->setDisabled(1);
                                    ui->p_INIT_PA_Tilt->setDisabled(1);
                                    ui->p_INIT_PA_RotPos->setDisabled(1);
                                    ui->frame_pa_rot->setDisabled(1);
                                    ui->frame_pa_tilt->setDisabled(1);
                                    ui->label_resPAR->setStyleSheet("QLabel { background-color: grey }");
                                    ui->label_resPAT->setStyleSheet("QLabel { background-color: grey }");
                                    ui->check_API_loop_macro->setDisabled(1);
                                }
                                break;
                            case 1: // Below LO height
                                val = linestr.toFloat(&ok) / tmpResoPAH;
                                ui->line_belowloader_3->setText(QString::number(val, 'f', 3));
                                ui->line_belowloader->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 2: // Below LO height thin
                               // ui->line_belowloaderthin->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 3: // LO height

                                val = linestr.toFloat(&ok) / tmpResoPAH;
                                ui->line_loaderheight_3->setText(QString::number(val, 'f', 3));
                                ui->line_loaderheight->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 4: // Above LO height thin
                              //  ui->line_aboveloaderthin->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 5: // Above LO height
                                val = linestr.toFloat(&ok) / tmpResoPAH;
                                ui->line_aboveloader_3->setText(QString::number(val, 'f', 3));
                                ui->line_aboveloader->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 6: // PA height
                                val = linestr.toFloat(&ok) / tmpResoPAH;
                                ui->line_preaheight_3->setText(QString::number(val, 'f', 3));
                                ui->line_preaheight->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 7: // CH height
                                val = linestr.toFloat(&ok) / tmpResoPAH;
                                ui->line_chuckheight_3->setText(QString::number(val, 'f', 3));
                                ui->line_chuckheight->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 8: // WO angle
                                val = linestr.toFloat(&ok) / tmpResoWOT;
                                ui->line_wobbtiltangle_3->setText(QString::number(val, 'f', 3));
                                ui->line_wobbtiltangle->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 9: // WO rotational position
                                val = linestr.toFloat(&ok) / tmpResoWOR;
                                ui->line_wobrotpos_3->setText(QString::number(val, 'f', 3));
                                ui->line_wobrotpos->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 10: // Measurement present
                                if (line.mid(line.indexOf("=") + 1, 1) == "1") ui->check_measureused->setChecked(1);
                                else ui->check_measureused->setChecked(0);
                                break;
                            case 11: // PA angle
                                val = linestr.toFloat(&ok) / tmpResoPAP;
                                ui->line_preasensangle_3->setText(QString::number(val, 'f', 3));
                                ui->line_preasensangle->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 12: // PA precount
                                val = linestr.toFloat(&ok) / tmpResoPAP;
                                ui->line_preaprecount_3->setText(QString::number(val, 'f', 3));
                                ui->line_preaprecount->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 13: // PA count
                                val = linestr.toFloat(&ok) / tmpResoPAP;
                                ui->line_preacount_3->setText(QString::number(val, 'f', 3));
                                ui->line_preacount->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 14: // PA postcount
                                val = linestr.toFloat(&ok) / tmpResoPAP;
                                ui->line_preapostcount_3->setText(QString::number(val, 'f', 3));
                                ui->line_preapostcount->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 15: // Align to front
                                ui->line_wobphispeed->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 16: // Reader displacement
                                ui->line_readdispl->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 17: // Wobbler displacement
                                ui->line_wobbdispl->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 18: // Normal displacement
                                ui->line_normaldispl->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            case 19: // Profilecalibration
                                if (line.mid(line.indexOf("=") + 1, 1) == "Y") ui->check_profilecalib->setChecked(1);
                                else ui->check_profilecalib->setChecked(0);
                                break;
                            case 20: // Slitlength
                                ui->line_slitlenght->setText(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                                break;
                            }
                        } else i--; // wegen Leerzeile wird Zähler nicht erhöht
                    }
                }
                else if (line.mid(0, line.indexOf("]") + 1) == "[Waferchanger]")
                {
                    tmpResoWCH = getResolution("Waferchanger height motor").toFloat();
                    tmpResoWCP = getResolution("Waferchanger phi motor").toFloat();

                    do
                    {
                        line = f.readLine();
                        if (line.at(0) != '\n')
                        {
                            linestr = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();

                            if (line.mid(0, line.indexOf('=')).toLower() == "above ch height thin")
                            {
                                // val = linestr.toFloat(&ok) / tmpResoWCH;
                                // ui->line_wc_thin_3->setText(QString::number(val, 'f', 3));
                                // ui->line_wc_thin->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "above ch height")
                            {
                                val = linestr.toFloat(&ok) / tmpResoWCH;
                                ui->line_wc_abovechuckheight_4->setText(
                                            QString::number(val, 'f', 3));
                                ui->line_wc_abovechuckheight->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                                ui->line_wc_abovechuckheight_3->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "ch height")
                            {
                                val = linestr.toFloat(&ok) / tmpResoWCH;
                                ui->line_wc_chuckheight_4->setText(
                                            QString::number(val, 'f', 3));
                                ui->line_wc_chuckheight->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                                ui->line_wc_chuckheight_3->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "below ch height") {
                                val = linestr.toFloat(&ok) / tmpResoWCH;
                                ui->line_wc_belowchuckheight_3->setText(
                                            QString::number(val, 'f', 3));
                                ui->line_wc_belowchuckheight->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "left position") {
                                val = linestr.toFloat(&ok) / tmpResoWCP;
                                ui->line_wc_leftpos_4->setText(QString::number(val, 'f', 3));
                                ui->line_wc_leftpos->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                                ui->line_wc_leftpos_3->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "middle position") {
                                val = linestr.toFloat(&ok) / tmpResoWCP;
                                ui->line_wc_middlepos_4->setText(QString::number(val, 'f', 3));
                                ui->line_wc_middlepos->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                                ui->line_wc_middlepos_3->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "right position") {
                                val = linestr.toFloat(&ok) / tmpResoWCP;
                                ui->line_wc_rightpos_3->setText(QString::number(val, 'f', 3));
                                ui->line_wc_rightpos->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "waferchanger present") {
                                if (line.mid(line.indexOf("=") + 1, 1) == "1") {
                                    ui->check_wc_deactivate->setChecked(1);
                                } else if (line.mid(line.indexOf("=") + 1, 1) == "0") {
                                    ui->check_wc_deactivate->setChecked(0);
                                }
                            }
                        }
                    }
                    while (line.at(0) != '[');
                    set_WCangle();
                    tmpline = line;
                }
                else if (line.mid(1, line.size() - 3) == "Vacuum")
                {
                    do
                    {
                        line = f.readLine();
                        if (line.mid(0, line.indexOf('=')).toLower() == "check vacuum")
                        {
                            if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "Y" || line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "1") ui->check_vac_checkvac->setChecked(1);
                            else ui->check_vac_checkvac->setChecked(0);
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "check main vacuum")
                        {
                            if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "Y" || line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "1") ui->check_vac_checkmainvac->setChecked(1);
                            else ui->check_vac_checkmainvac->setChecked(0);
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "main vacuum polltime")
                        {
                            ui->line_vac_polltime->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck sequence") {
                            if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "1") ui->check_vac_sequence->setChecked(1);
                            else ui->check_vac_sequence->setChecked(0);
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "use chuck 6\" vacuum")
                        {
                            if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "Y" || line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "1") ui->check_vac_use6inch->setChecked(1);
                            else ui->check_vac_use6inch->setChecked(0);
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "use chuck 8\" vacuum")
                        {
                            if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "Y" || line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "1") ui->check_vac_use8inch->setChecked(1);
                            else ui->check_vac_use8inch->setChecked(0);
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "loader pulstime") ui->line_vac_LD_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "loader timeout") ui->line_vac_LD_timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "loader on threshold") ui->line_vac_LD_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "loader off threshold") ui->line_vac_LD_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "changer left pulstime") ui->line_vac_WC1_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "changer left timeout") ui->line_vac_WC1_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "changer left on threshold") ui->line_vac_WC1_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "changer left off threshold") ui->line_vac_WC1_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "changer right pulstime") ui->line_vac_WC2_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "changer right timeout") ui->line_vac_WC2_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "changer right on threshold") ui->line_vac_WC2_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "changer right off threshold") ui->line_vac_WC2_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner pulstime") ui->line_vac_PA_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner timeout") ui->line_vac_PA_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner on threshold") ui->line_vac_PA_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner off threshold") ui->line_vac_PA_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" pulstime") ui->line_vac_CH4_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" timeout") ui->line_vac_CH4_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" on threshold") ui->line_vac_CH4_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" off threshold") ui->line_vac_CH4_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" pulstime") ui->line_vac_CH6_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" timeout") ui->line_vac_CH6_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" on threshold") ui->line_vac_CH6_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" off threshold") ui->line_vac_CH6_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" pulstime") ui->line_vac_CH8_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" timeout") ui->line_vac_CH8_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" on threshold") ui->line_vac_CH8_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" off threshold") ui->line_vac_CH8_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "main pulstime") ui->line_vac_MainVac_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "main timeout") ui->line_vac_MainVac_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "main on threshold") ui->line_vac_MainVac_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "main off threshold") ui->line_vac_MainVac_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "default pulstime") ui->line_vac_default_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "default timeout") ui->line_vac_default_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "default on threshold") ui->line_vac_default_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "default off threshold") ui->line_vac_default_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lowld") ui->line_vac_LD_ThrsON_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lowpa") ui->line_vac_PA_ThrsON_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lowch") ui->line_vac_CH4_ThrsON_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lowwc1") ui->line_vac_WC1_ThrsON_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lowwc2") ui->line_vac_WC2_ThrsON_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "semi friction")
                        {
                            if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "1") ui->check_vac_lowactive->setChecked(1);
                            else ui->check_vac_lowactive->setChecked(0);
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "retry")
                        {
                            if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "1") ui->check_vac_rety->setChecked(1);
                            else ui->check_vac_rety->setChecked(0);
                        }
                    }
                    while (line.at(0) != '[');
                    tmpline = line;
                }
                else if (line.mid(1, line.size() - 3) == "Liftlock1") {
                    do {
                        line = f.readLine();
                        if (line.mid(0, line.indexOf('=')).toLower() == "delaytime")
                            ui->line_lock_delaytime->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "vacuumnumber")
                            ui->line_lock_vacnumber->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage1")
                            ui->line_lock_v1->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage2")
                            ui->line_lock_v2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage3")
                            ui->line_lock_v3->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage4")
                            ui->line_lock_v4->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage5")
                            ui->line_lock_v5->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() ==
                                 "unlockvoltage1")
                            ui->line_unlock_v1->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() ==
                                 "unlockvoltage2")
                            ui->line_unlock_v2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() ==
                                 "unlockvoltage3")
                            ui->line_unlock_v3->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() ==
                                 "unlockvoltage4")
                            ui->line_unlock_v4->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() ==
                                 "unlockvoltage5")
                            ui->line_unlock_v5->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                    } while (line.at(0) != '[');
                    tmpline = line;
                }
                else if (line.mid(1, line.size() - 3) == "Liftlock2")
                {
                    do
                    {
                        line = f.readLine();
                        if (line.mid(0, line.indexOf('=')).toLower() == "delaytime") ui->line_lock_delaytime_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "vacuumnumber")
                            ui->line_lock_vacnumber_2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage1")
                            ui->line_lock_v1_2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage2")
                            ui->line_lock_v2_2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage3")
                            ui->line_lock_v3_2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage4")
                            ui->line_lock_v4_2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage5")
                            ui->line_lock_v5_2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() ==
                                 "unlockvoltage1")
                            ui->line_unlock_v1_2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() ==
                                 "unlockvoltage2")
                            ui->line_unlock_v2_2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() ==
                                 "unlockvoltage3")
                            ui->line_unlock_v3_2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() ==
                                 "unlockvoltage4")
                            ui->line_unlock_v4_2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        else if (line.mid(0, line.indexOf('=')).toLower() ==
                                 "unlockvoltage5")
                            ui->line_unlock_v5_2->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                    } while (line.at(0) != '[');
                }
                else if (line.mid(1, line.size() - 3) == "Signaltower")
                {
                    do
                    {
                        line = f.readLine();
                        // if (line.mid(0, line.indexOf('=')).toLower() == "h-run") ui->combo_misc_runhorn->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "r-run") ui->combo_misc_runred->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "y-run") ui->combo_misc_runyellow->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "g-run") ui->combo_misc_rungreen->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "h-cassette") ui->combo_misc_casshorn->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "r-cassette") ui->combo_misc_cassred->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "y-cassette") ui->combo_misc_cassyellow->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "g-cassette") ui->combo_misc_cassgreen->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "h-standby") ui->combo_misc_stdbyhorn->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "r-standby") ui->combo_misc_stdbyred->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "y-standby") ui->combo_misc_stdbyyellow->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "g-standby") ui->combo_misc_stdbygreen->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "h-maintenance") ui->combo_misc_mainthorn->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "r-maintenance") ui->combo_misc_maintred->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "y-maintenance") ui->combo_misc_maintyellow->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "g-maintenance") ui->combo_misc_maintgreen->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "h-problem") ui->combo_misc_problemhorn->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "r-problem") ui->combo_misc_problemred->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "y-problem") ui->combo_misc_problemyellow->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "g-problem") ui->combo_misc_problemgreen->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "h-alarm") ui->combo_misc_alarmhorn->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "r-alarm") ui->combo_misc_alarmred->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "y-alarm") ui->combo_misc_alarmyellow->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                        // else if (line.mid(0, line.indexOf('=')).toLower() == "g-alarm") ui->combo_misc_alarmgreen->setCurrentText(converttower(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed()));
                    }
                    while (line.at(0) != '[');
                    tmpline = line;
                }
                else if (line.mid(1, line.size() - 3) == "Infab") {

                }
                else if (line.mid(1, line.size() - 3) == "Asyst") {

                }
                else if (line.trimmed().mid(1, line.size() - 3) == "Reader" || line.trimmed().mid(1, line.size() - 3) == "Siemens")
                {
                    do
                    {
                        line = f.readLine();
                        //      if(line.left(5) != ";----")
                        //       ui->textBrowser_reader->append(line.trimmed());
                    }
                    while (line.at(0) != ';');
                    tmpline = line;
                }
                else if (line.mid(1, line.size() - 3) == "Emergency")
                {

                }
                else if (line.mid(1, line.size() - 3) == "Scan")
                {

                }
                else if (line.mid(1, line.size() - 3) == "INS-Setup") {

                }
                else if (line.mid(1, line.size() - 3) == "WOBJOY")
                {
                    do
                    {
                        line = f.readLine();
                        if (line.mid(0, line.indexOf('=')).toLower() == "low_tilt") {
                            ui->line_joy_tiltmin->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        } else if (line.mid(0, line.indexOf('=')).toLower() == "up_tilt") {
                            ui->line_joy_tiltmax->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        } else if (line.mid(0, line.indexOf('=')).toLower() == "low_rot") {
                            ui->line_joy_rotmin->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        } else if (line.mid(0, line.indexOf('=')).toLower() == "up_rot") {
                            ui->line_joy_rotmax->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        } else if (line.mid(0, line.indexOf('=')).toLower() == "thres") {
                            ui->line_joy_threshold->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        } else if (line.mid(0, line.indexOf('=')).toLower() == "speed_tiltup") {
                            ui->line_joy_tiltspeedup->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        } else if (line.mid(0, line.indexOf('=')).toLower() == "speed_tiltdwn") {
                            ui->line_joy_tiltspeeddown->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        } else if (line.mid(0, line.indexOf('=')).toLower() == "speed_rotcw") {
                            ui->line_joy_rotCW->setText(
                                        line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                        .trimmed());
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "speed_rotccw")
                        {
                            ui->line_joy_rotCCW->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "setwojoy")
                        {
                            int val = line.mid(line.indexOf("=") + 1, 2).toInt(&ok, 10);

                            if (val & 0b00010000) ui->checkBox_Xjoy_phi->setChecked(1);
                            else ui->checkBox_Xjoy_phi->setChecked(0);
                            if (val & 0b00100000) ui->checkBox_Xjoy_rotation->setChecked(1);
                            else ui->checkBox_Xjoy_rotation->setChecked(0);
                            if (val & 0b01000000) ui->checkBox_Xjoy_tilt->setChecked(1);
                            else ui->checkBox_Xjoy_tilt->setChecked(0);
                            if (val & 0b00000001) ui->checkBox_Yjoy_phi->setChecked(1);
                            else ui->checkBox_Yjoy_phi->setChecked(0);
                            if (val & 0b00000010) ui->checkBox_Yjoy_rotation->setChecked(1);
                            else ui->checkBox_Yjoy_rotation->setChecked(0);
                            if (val & 0b00000100) ui->checkBox_Yjoy_tilt->setChecked(1);
                            else ui->checkBox_Yjoy_tilt->setChecked(0);

                          //  err_msgbox("VAL WOBJOY" + (line.mid(line.indexOf("=") + 1, 2)));
                        }
                    } while (line.at(0) != ';');
                    tmpline = line;
                }
                // else if (line.mid(1, line.size() - 3) == "MISC")
                // {
                //     do
                //     {
                //         line = f.readLine();

                //     }
                //     while (line.at(0) != ';');
                //     tmpline = line;
                // }
            }
        }
        logout << IDstring << '\n';
        logout << "Servicetool: " << version << '\n';
        logout << "LOG " + QDateTime::currentDateTime().toString() + '\n';
        logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "SETUP_File "<< FILE2OPEN << '\n';
        f.close();
    }

    MotparaReadVersion(MFILE2OPEN);
    SETUP_CASStype(0);
}
void MainWindow::set_WCangle()
{
    float flt = abs(ui->line_wc_leftpos->text().toInt(&ok, 10)) + abs(ui->line_wc_rightpos->text().toInt(&ok, 10));
    float res;
    res = getResolution("Waferchanger phi motor").toFloat();
    if (flt < 0)
    {
        s = QString::number(flt / res, 'f', 3);
    }
    else s = QString::number(flt / res, 10, 4);
    ui->line_wc_right2left->setText(s);
}
void MainWindow::on_p_dbg_clear_clicked()
{
    ui->textBrowser_maxid->clear();
    cyclecount = 0;
}
QString MainWindow::converttower(QString text) // Signaltower INI -> Lineedit
{
    if (text == "on" || text == "On" || text == "ON" || text == "1") return "on";
    else if (text == "off" || text == "Off" || text == "OFF" || text == "0") return "off";
    else if (text == "50:50") return "50";
    else return "0";
}
QString MainWindow::reconverttower(QString text) // Signaltower LineEdit -> EPROM INSBox
{
    if (text == "on" || text == "On" || text == "ON" || text == "1") return "ffff";
    else if (text == "off" || text == "Off" || text == "OFF" || text == "0") return "0000";
    else if (text == "50:50") return "8080";
    else return "0000";
}
QString MainWindow::INIconverttower(QString text) // Signaltower Lineedit -> INI
{
    if (text == "on" || text == "On" || text == "ON" || text == "1") return "on";
    else if (text == "off" || text == "Off" || text == "OFF" || text == "0") return "off";
    else if (text == "50") return "50:50";
    else return "0";
}
void MainWindow::SETUP_STAGEFILE()
{
    QString mtline;
    QFile f(DEFAULTMTFILE); // Daten aus Transferpos.INI einlesen
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
    QTextStream datain(&f);
    while (!f.atEnd())
    {
        mtline = datain.readLine();
        qDebug() << mtline;
        if (!mtline.isEmpty())
        {
            if (mtline.at(0) == '[') // all Strings, die mit [ beginnen
            {
                do
                {
                    mtline = datain.readLine();
                    if (!mtline.isEmpty())
                    {
                        if (mtline.mid(0, mtline.indexOf('=')).toLower() == "xpos")
                        {
                            qDebug() << mtline.mid(mtline.indexOf('=') + 1, mtline.indexOf('\r'));
                            ui->line_Transfer_x->setText(mtline.mid(mtline.indexOf('=') + 1, mtline.indexOf('\r')));
                        }
                        else if (mtline.mid(0, mtline.indexOf('=')).toLower() == "ypos")
                        {
                            qDebug() << mtline.mid(mtline.indexOf('=') + 1, mtline.indexOf('\r'));
                            ui->line_Transfer_y->setText(mtline.mid(mtline.indexOf('=') + 1, mtline.indexOf('\r')));
                        }
                    }
                } while (mtline.at(0) != ";");
            }
        }
    }
    if (f.exists()) f.close();
}
void MainWindow::on_p_INIT_saveEPROM_clicked() // speichert Setup-Daten ins EEPROM
{
    QMessageBox warn;
    if (warn.warning(this, "Attention!", "All data will override. Are you sure?", warn.Cancel | warn.Ok) == warn.Ok)
    {
        writeEEPROMcomplete();
    }
}
void MainWindow::on_p_INIT_save_allmot_EPROM_clicked() // cmdaktiv = 2
{
    int i = 0;
    int dataset = 0;
    int cntlines = 12; // maximal 12 Motordatensätze bei einer 2k Maschine
    int cntdata = 41;  // max. 41 Datenbytes

    QMessageBox warn;
    if (warn.warning(this, "Attention!", "All data will override. Are you sure?", warn.Cancel | warn.Ok) == warn.Ok)
    {
        motall = 1; // all motor sets
        cleararray();
        EEPROM.clear();     // alte Arraydaten löschen
        EEPROM.append("_"); // Startzeichen zur Delimiter Abgrenzung
        QFile f1(MFILE2OPEN);
        if (!f1.open(QIODevice::ReadOnly | QIODevice::Text)) return;
        QTextStream datain(&f1);
        while (!datain.atEnd()) // komplette INSMOTOR.ini durcharbeiten
        {
            QString line = datain.readLine();
            if (line.size() != 0)
            {
                if (line.at(0) == '[') // es gibt bis zu 14 Motorachsen, aktiv sind max.
                    // 12 (2K, WOB), 14 nur bei MACRO INS/LDS3300
                {
                    //   qDebug() << line;
                    if (line.mid(1, line.size() - 2) != "Version") // Sektion [Version] wird übersprungen
                    {
                        if (line.mid(1, line.size() - 2).toLower() == "lift1 height motor") dataset = 1;
                        else if (line.mid(1, line.size() - 2).toLower() == "lift1 tilt motor") dataset = 2;
                        else if (line.mid(1, line.size() - 2).toLower() == "lift2 height motor") dataset = 3;
                        else if (line.mid(1, line.size() - 2).toLower() == "lift2 tilt motor") dataset = 4;
                        else if (line.mid(1, line.size() - 2).toLower() == "loader x - motor") dataset = 5;
                        else if (line.mid(1, line.size() - 2).toLower() == "loader y - motor") dataset = 6;
                        else if (line.mid(1, line.size() - 2).toLower() == "prealigner height motor") dataset = 7;
                        else if (line.mid(1, line.size() - 2).toLower() == "prealigner phi motor") dataset = 8;
                        else if (line.mid(1, line.size() - 2).toLower() == "wobbler rotation motor") dataset = 9;
                        else if (line.mid(1, line.size() - 2).toLower() == "wobbler phi motor") dataset = 10;
                        else if (line.mid(1, line.size() - 2).toLower() == "waferchanger height motor") dataset = 11;
                        else if (line.mid(1, line.size() - 2).toLower() == "waferchanger phi motor") dataset = 12;
                        t_part_clear(); // löscht temporären Datenspeicher
                        for (i = 0; i < cntdata; ++i)
                        {
                            line = datain.readLine();
                            if (line.size() != 0) t_part_ee_insmotor(line, dataset); // liest Wert von line aus dem Datenset in
                            // QByteArray mot[14][41]
                        }
                    }
                }
            }
        }
        t_part_ee_mot(cntlines, cntdata); // schreibt Datensatz für einen Motor ins Array EEPROM

        QByteArray tmpEEPROM = EEPROM;
        char delimiter2[] = "#&";
        char *token;
        QString tmp;
        char *charptr = tmpEEPROM.data();
        int checksum = 0;
        charptr = charptr + 1; // erstes Zeichen entfernen
        token = strtok(charptr, delimiter2);
        tmp = token;
        checksum += tmp.toFloat();
        while (token) // token wird zerlegt bis \0
        {
            token = strtok(NULL, delimiter2);
            tmp = token;
            checksum += tmp.toFloat();
            qDebug() << tmp << "; " << checksum;
        }
        int intchecksum = checksum;
        qDebug() << QString::number(checksum) << QString::number(intchecksum);
        EEPROM.append('!');
        EEPROM.append(QString::number(intchecksum).toLatin1());
        EEPROM.append("\r");
        cmdaktiv = 2;                  // für Receive: filtert Motordaten
        serialSendFeeder(INSMOTSETUP); // "$PSET_1=50\r\n"
        f1.close();
        cntall = 0;
        partmot = 0;
    }
}
void MainWindow::test()
{
    QMessageBox msgBox;
    msgBox.setText("error: box");
    msgBox.exec();
}
void MainWindow::cleararray()
{
    for (int i = 0; i < 12; i++)
    {
        for (int k = 0; k < 41; k++)
        {
            mot[i][k] = 0;
        }
    }
}
void MainWindow::on_p_INIT_boxreset_clicked()
{
    if (on_p_INIT_boxreset_setup_clicked() == 0)
    {
        ui->p_INIT_boxreset->setStyleSheet(backLightGreen);
    }
    else
    {
        ui->p_INIT_boxreset->setStyleSheet(backLightGrey);
    }
}
int MainWindow::on_p_INIT_boxreset_setup_clicked()
{
    int ret = 0;

    if (serial_api->isOpen())
    {
        apireset = 1;
        serial_api->write(BoxReset); // Ruft Box Reset auf
        logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "<-" << BoxReset << "\n";
        ui->plainTextEdit_API_logerr->appendPlainText("<- @RESET");
        if (apitimeout->isActive() == FALSE)
        {
            apitimeout->start(APIcmdtimeout);
            qDebug() << "apitimeout start" << APIcmdtimeout;
        }
        else qDebug() << "INIT_boxreset apitimeout could not start";
    }
    else
    {
        f_setAPIPort();
        if (serial_api->open(QIODevice::ReadWrite))
        {
            //        qDebug()<<"serial_api->isOpen()"<<serial_api->isOpen();
            apireset = 1;
            serial_api->write(BoxReset); // Ruft Box Reset auf
            logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "<-" << BoxReset << "\n";
            ui->plainTextEdit_API_logerr->appendPlainText("<- @RESET");
            if (apitimeout->isActive() == FALSE)
            {
                apitimeout->start(APIcmdtimeout);
                qDebug() << "apitimeout start" << APIcmdtimeout;
            }
            else qDebug() << "INIT_boxreset apitimeout could not start";
        }
        else
        {
            ui->p_INIT_boxreset_setup->setStyleSheet(backLightGrey);
            err_msgbox("PORT API not available");
            ret = 1;
        }
    }
    return ret;
}
void MainWindow::on_p_INIT_boxRAC_clicked()
{
    serialSendFeeder(BoxResRAC); // Ruft Box Reset auf
}
void MainWindow::changeWidget(QString name)
{
    qDebug() << "changeWidget" << name;
    QString currentTabText;
    int i = 0;
    while (currentTabText != name)
    {
        currentTabText = ui->tabWidget->tabText(i);
        if (i < 20) i++;
        else
        {
            err_msgbox("Tab nicht vorhanden");
            i = 0;
            break;
        }
    }
    if (i > 0) ui->tabWidget->setCurrentIndex(i - 1);
}
void MainWindow::on_p_setup_clearlog_clicked()
{
    ui->plainText_sendlog->clear();
}
void MainWindow::on_p_INIT_save_allmot_boards_clicked()
{
    serialSendFeeder(resInitMot); //"$SET_4=1\r\n"  set EEMOTDATOK=0 ->
    //initMotDat() wird ausgeführt
}
// ------------------ EEPROM -----------------------------
void MainWindow::writeEEPROMcomplete() // liest Daten aus INSSETUP.INI und speichert diese ins INSBox-EEPROM
{
    QString tmpstr;
    QString SMIFcode1; // eingelesener SMIF-Name wird einer Zahl zugeordnet
    QString SMIFcode2;
    QString Retry = "0";

    int i = 0;
    int flats = 0;
    int glases = 0;
    int stop = 0;
    EEPROM.clear();     // alte Arraydaten löschen
    EEPROM.append("_"); // Startzeichen zur Delimiter Abgrenzung
    QFile f(FILE2OPEN); // default oder selektiertes File öffnen
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) err_msgbox("can't open file");
    QTextStream datain(&f);
    while (!datain.atEnd())
    {
        QString line = datain.readLine();
        if (line.size() != 0)
        {
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                if (line.mid(1, line.size() - 2) != "Version" &&
                        line.mid(1, line.size() - 2) != "Lift3" &&
                        line.mid(1, line.size() - 2) != "Waferchanger 2" &&
                        line.mid(1, line.size() - 2) != "Liftlock3" &&
                        line.mid(1, line.size() - 2) != "Scan" &&
                        line.mid(1, line.size() - 2) != "Infab" &&
                        line.mid(1, line.size() - 2) != "Asyst" &&
                        line.mid(1, line.size() - 2) != "INS-Setup")
                {
                    if (line.mid(1, 4) == "Cass") // Cass.-Data (ohne type=nOnE)
                    {
                        QString str = line.mid(5, line.indexOf(']'));
                        int flatnr = str.remove(QChar(']')).toInt(&ok, 10);
                        qDebug() << "flatnr" << flatnr;
                        EEPROM.append("&");
                        t_part_clear();
                        stop = 1;
                        line = datain.readLine();
                        if (line.size() != 0 && line.mid(0, 9) != "type=nOnE") {
                            while (stop) {
                                line = datain.readLine();
                                if (line.size() != 0) {
                                    if (line.mid(0, line.indexOf("=")) == "Slots")
                                        tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "First slot")
                                        tempwc2.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Slot distance")
                                        tempwc3.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Slotsizewindow")
                                        tempwc4.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Wafersizewindow")
                                        tempwc5.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Wafer Height Offset")
                                        tempwc6.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Finger Height Offset")
                                        tempwc7.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Flat")
                                    {
                                        int flat = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toInt(&ok, 10);
                                        flats |= flat << (flatnr - 1);
                                        qDebug() << "flat" << flat << "flats" << flats;
                                    }
                                    else if (line.mid(0, line.indexOf("=")) == "Glas")
                                    {
                                        int glas = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toInt(&ok, 10);
                                        glases |= glas << (flatnr - 1);
                                        qDebug() << "glas" << glas << "glases" << glases;
                                    }
                                }
                                else stop = 0;
                            }
                            t_part_ee(7); // flats und glases werden später angehängt
                        }
                        else if (line.mid(0, 9) == "type=nOnE")
                        {
                            for (i = 0; i < 7; i++)
                            {
                                EEPROM.append("0");
                                EEPROM.append("#");
                            }
                        }
                        else if (line.size() != 0 && line.at(0) == ';') stop = 0;
                    }
                    else if (line.mid(1, line.size() - 3) == "Lift") // Lift1 und Lift2 Data ohne SMIF
                    {
                        QString liftnr = line /*.mid(5,line.size()-3)*/;
                        EEPROM.append("&");
                        t_part_clear();
                        stop = 1;
                        while (stop) //
                        {
                            line = datain.readLine();
                            if (line.size() != 0 && line.mid(0, 4) != "Smif" && line.at(0) != ';')
                            {
                                if (line.size() != 0)
                                {
                                    if (line.mid(0, line.indexOf("=")) == "Lift present") tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Wafersensor height") tempwc2.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Unload operator height") tempwc3.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "XY-Loader height") tempwc4.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Measuring Unit Height") tempwc5.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Tilt present") tempwc6.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Tilt on position") tempwc7.append( line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Tilt off position") tempwc8.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Wafertype")
                                    {
                                        if ((line.mid(line.indexOf("=") + 1, line.indexOf('\n'))).size() == 1) tempwc9.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                        else if (line.mid(line.indexOf("=") + 1,line.indexOf('\n')) == "normal") tempwc9.append('0');
                                        else if (line.mid(line.indexOf("=") + 1,line.indexOf('\n')) == "thin") tempwc9.append('1');
                                    }
                                    else if (line.mid(0, line.indexOf("=")) == "4\" Cassette Nr") tempwc10.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "5\" Cassette Nr") tempwc11.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "6\" Cassette Nr") tempwc12.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "8\" Cassette Nr") tempwc13.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                } else if (line.size() != 0 && line.at(0) == ';') stop = 0;
                            }
                            else if (line.size() != 0 && line.mid(0, 5) == "Smif=" && line.at(0) != ';')
                            {
                                qDebug() << "Liftnr" << liftnr;
                                if (liftnr == "[Lift1]")
                                {
                                    if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "ASYST 200") SMIFcode1 = "4";
                                    else if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "ASYST 150") SMIFcode1 = "5";
                                    else if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "ISE 100") SMIFcode1 = "3";
                                    else if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "ISE 150") SMIFcode1 = "2";
                                    else if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "ISE 200") SMIFcode1 = "1";
                                    else if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "none") SMIFcode1 = "0";
                                    qDebug() << "SMIFcode1" << SMIFcode1;
                                }
                                else if (liftnr == "[Lift2]")
                                {
                                    if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "ASYST 200") SMIFcode2 = "4";
                                    else if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "ASYST 150") SMIFcode2 = "5";
                                    else if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "ISE 100") SMIFcode2 = "3";
                                    else if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "ISE 150") SMIFcode2 = "2";
                                    else if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "ISE 200") SMIFcode2 = "1";
                                    else if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "none") SMIFcode2 = "0";
                                    qDebug() << "SMIFcode2" << SMIFcode2;
                                }
                            } else if (line.size() != 0 && line.at(0) == ';') stop = 0;
                        }
                        t_part_ee(13);
                    }
                    else if (line.mid(1, line.size() - 2) == "Loader") // Loader Data ohne L3 Positionen
                    {
                        EEPROM.append("&");
                        t_part_clear();
                        stop = 1;
                        while (stop) //
                        {
                            line = datain.readLine();
                            if (line.mid(2, 2) != "L3") {
                                if (line.size() != 0 && line.at(0) != ';') {
                                    if (line.mid(0, line.indexOf("=")) == "x-L1 position")
                                        tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "x-L2 position")
                                        tempwc2.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "x-PA free position")
                                        tempwc3.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "x-PA position")
                                        tempwc4.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "y-L1 position")
                                        tempwc5.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "y-L2 position")
                                        tempwc6.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "y-PA position")
                                        tempwc7.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "y-Out lift position")
                                        tempwc8.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "y-In lift displacement")
                                        tempwc9.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "6\" Cassette displacement")
                                        tempwc10.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                } else if (line.size() != 0 && line.at(0) == ';')
                                    stop = 0;
                            }
                        }
                        t_part_ee(10);
                    }
                    else if (line.mid(1, line.size() - 2) == "Prealigner") // Prealigner Data
                    {
                        EEPROM.append("&");
                        t_part_clear();
                        stop = 1;
                        /*for (i = 0; i < 22; ++i)   */ //
                        while (stop) {
                            line = datain.readLine();
                            if (line.size() != 0 && line.at(0) != ';')
                            {
                                if (line.mid(0, line.indexOf("=")) == "Wobbler present") tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Below LO height") tempwc2.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Below LO height thin") tempwc3.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "LO height") tempwc4.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Above LO height thin") tempwc5.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Above LO height") tempwc6.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "PA height") tempwc7.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "CH height") tempwc8.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "WO angle") tempwc9.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "WO rotational position") tempwc10.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Measurement present") tempwc11.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "PA angle") tempwc12.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "PA precount") tempwc13.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "PA count") tempwc14.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "PA postcount") tempwc15.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Align to front") tempwc16.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Reader displacement") tempwc17.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Wobbler displacement") tempwc18.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Normal displacement") tempwc19.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Wobbler displacement") tempwc18.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Normal displacement") tempwc19.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Profilecalibration")
                                {
                                    if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "Y") tempwc20.append("1"); // Y(N) in 1(0) umwandeln
                                    else tempwc20.append("0");
                                }
                                else if (line.mid(0, line.indexOf("=")) == "Slitlength") tempwc21.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                            }
                            else if (line.size() != 0 && line.at(0) == ';') stop = 0;
                        }
                        qDebug() << "pa slit" << tempwc21;
                        t_part_ee(21);
                    }
                    else if (line.mid(1, line.size() - 2) == "Waferchanger") // Waferchanger Data
                    {
                        EEPROM.append("&");
                        t_part_clear();
                        stop = 1;
                        while (stop) //
                        {
                            line = datain.readLine();
                            if (line.size() != 0 && line.at(0) != ';') {
                                if (line.mid(0, line.indexOf("=")) == "Waferchanger present") tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Above CH height thin") tempwc2.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Above CH height") tempwc3.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Ch height") tempwc4.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Below CH height") tempwc5.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "CH free height") tempwc6.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Left position") tempwc7.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Middle position") tempwc8.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "Right position") tempwc9.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                else if (line.mid(0, line.indexOf("=")) == "LO height") tempwc10.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                            }
                            else if (line.size() != 0 && line.at(0) == ';') stop = 0;
                        }
                        t_part_ee(10);
                    }
                    else if (line.mid(1, line.size() - 2) == "Vacuum") // Vacuum Data ohne WC2 und Chuck2 Data
                    {
                        EEPROM.append("&"); // neue Sektion
                        t_part_clear();
                        stop = 1;
                        while (stop) //
                        {
                            line = datain.readLine();
                            if (line.size() != 0 && line.mid(0, 10) != "Use Chuck2" && line.mid(0, 8) != "Changer2" && line.mid(0, 6) != "Chuck2") // Ausschlüsse
                            {
                                if (line.size() != 0 && line.at(0) != ';')
                                {
                                    if (line.mid(0, line.indexOf("=")) == "Check vacuum")
                                    {
                                        if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "Y" || line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "1") tempwc1.append("1"); // Y(N) in 1(0) umwandeln
                                        else tempwc1.append("0");
                                    }
                                    else if (line.mid(0, line.indexOf("=")) == "Check main vacuum")
                                    {
                                        if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "Y" ||
                                                line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "1")
                                            tempwc2.append("1"); // Y(N) in 1(0) umwandeln
                                        else tempwc2.append("0");
                                    }
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck sequence")
                                    {
                                        if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "1") tempwc3.append("1"); //
                                        else tempwc3.append("0");
                                    }
                                    else if (line.mid(0, line.indexOf("=")) == "Use chuck 6\" vacuum")
                                    {
                                        if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "Y" ||
                                                line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "1") tempwc4.append("1"); // Y(N) in 1(0) umwandeln
                                        else  tempwc4.append("0");
                                    }
                                    else if (line.mid(0, line.indexOf("=")) == "Use chuck 8\" vacuum")
                                    {
                                        if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "Y" ||
                                                line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "1") tempwc5.append("1"); // Y(N) in 1(0) umwandeln
                                        else tempwc5.append("0");
                                    }
                                    else if (line.mid(0, line.indexOf("=")) == "lowLD") tempwc6.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "lowPA") tempwc7.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "lowCH") tempwc8.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "lowWC1") tempwc9.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "lowWC2") tempwc10.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    else if (line.mid(0, line.indexOf("=")) == "Semi Friction")
                                    {
                                        if (line.mid(line.indexOf("=") + 1, line.indexOf('\n')) == "1") tempwc11.append("1");
                                        else tempwc11.append("0");
                                    }
                                    else if (line.mid(0, line.indexOf("=")) == "Main On Threshold")
                                    {
                                        tempwc12.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
                                    }
                                    else if (line.mid(0, line.indexOf('=')).toLower() == "retry")
                                    {
                                        if(line.mid(line.indexOf("=") + 1, 1) == "1") ui->check_vac_rety->setChecked(1);
                                        else if(line.mid(line.indexOf("=") + 1, 1) == "0") ui->check_vac_rety->setChecked(0);
                                        Retry = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                                    }
                                    // else if (line.mid(0, line.indexOf("=")) == "Loader On Threshold") tempwc12.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Loader Off Threshold") tempwc13.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Changer Left Pulstime") tempwc14.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Changer Left Timeout") tempwc15.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Changer Left On Threshold") tempwc16.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Changer Left Off Threshold") tempwc17.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Changer Right Pulstime") tempwc18.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Changer Right Timeout") tempwc19.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Changer Right On Threshold") tempwc20.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Changer Right Off Threshold") tempwc21.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Prealigner Pulstime") tempwc22.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Prealigner Timeout") tempwc23.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Prealigner On Threshold") tempwc24.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Prealigner Off Threshold") tempwc25.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 4\" Pulstime") tempwc26.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 4\" Timeout") tempwc27.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 4\" On Threshold") tempwc28.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 4\" Off Threshold") tempwc29.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 6\" Pulstime") tempwc30.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 6\" Timeout") tempwc31.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 6\" On Threshold") tempwc32.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 6\" Off Threshold") tempwc33.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 8\" Pulstime") tempwc34.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 8\" Timeout") tempwc35.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 8\" On Threshold") tempwc36.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "Chuck 8\" Off Threshold") tempwc37.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "default Pulstime") tempwc38.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "default Timeout") tempwc39.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "default On Threshold") tempwc40.append("0");
                                    else if (line.mid(0, line.indexOf("=")) == "default Off Threshold") tempwc41.append("0");
                                }
                                else if (line.size() != 0 && line.at(0) == ';') stop = 0;
                            }
                        }
                        t_part_ee(41);
                    }
                    else if (line.mid(1, line.size() - 2) == "Liftlock1") // Liftlock1 Data ## nur Boardparameter
                    {
                        EEPROM.append("&");
                        stop = 1;
                        while (stop) //
                        {
                            line = datain.readLine();
                            if (line.size() != 0 && line.at(0) != ';')
                            {
                                EEPROM.append("0");
                                EEPROM.append("#");
                            }
                            else if (line.size() != 0 && line.at(0) == ';') stop = 0;
                        }
                    }
                    else if (line.mid(1, line.size() - 2) == "Liftlock2") // Liftlock2 Data ## nur Boardparameter
                    {
                        EEPROM.append("&");
                        stop = 1;
                        while (stop) //
                        {
                            line = datain.readLine();
                            if (line.size() != 0 && line.at(0) != ';')
                            {
                                EEPROM.append("0");
                                EEPROM.append("#");
                            }
                            else if (line.size() != 0 && line.at(0) == ';') stop = 0;
                        }
                    }
                    else if (line.mid(1, line.size() - 2) == "Signaltower") // Signaltower Data 0=off,1=on,2=50:50 ## keine Anwendung mehr
                    {
                        EEPROM.append("&");

                        for(int i = 0;i < 24;i++)       // [Signaltower] wurde entfernt
                        {
                            EEPROM.append("0#");
                        }                       
                    }
                    // else if (line.mid(1, line.size() - 2) == "MISC") // MISC RETRY
                    // {
                    //     int cnt = 0;
                    //     EEPROM.append("&");
                    //     t_part_clear();
                    //     stop = 1;
                    //     line = datain.readLine();
                    //     if (line.size() != 0 && line.at(0) != ';')
                    //     {
                    //         // tmpstr = line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                    //         // if (line.mid(0, line.indexOf('=')).toLower() == "retry") tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')));
                    //         cnt++;
                    //     }
                    //     else if (line.size() != 0 && line.at(0) == ';') stop = 0;
                    //     t_part_ee(cnt);
                    // }
                }
            }
        }
    }
    EEPROM.append("&");
    EEPROM.append(Retry.toLatin1()); // Retry
    EEPROM.append("#");
    EEPROM.append("&");
    EEPROM.append(SMIFcode1.toLatin1()); // SMIF type wird bei write SETUPdata erst am Ende geschickt
    EEPROM.append("#");
    EEPROM.append("&");
    EEPROM.append(SMIFcode2.toLatin1());
    EEPROM.append("#");
    EEPROM.append("&");
    EEPROM.append(QString::number(flats).toLatin1());
    EEPROM.append("#");
    EEPROM.append("&");
    EEPROM.append(QString::number(glases).toLatin1());
    EEPROM.append("#");

    QByteArray tmpEEPROM = EEPROM;
    char delimiter1[] = "&";
    char delimiter2[] = "#&";
    char *token;
    QString tmp;
    int tmpf = 0;
    char *charptr = tmpEEPROM.data();
    int checksum = 0;

    token = strtok(charptr, delimiter1); // erstes Zeichen entfernen
    while (token)                        // token wird zerlegt bis \0
    {
        token = strtok(NULL, delimiter2);
        tmp = token;
        tmpf = tmp.toFloat();
        checksum += tmpf;
    //    qDebug()<<checksum;
    }
    qDebug()<< QString::number(checksum);
    EEPROM.append('!');
    EEPROM.append(QString::number(checksum).toLatin1());
    EEPROM.append("\r");
    cmdaktiv = 1;             // sendet Setupdaten
    serialSendFeeder(PSET_1); // Ruft EEPROM Routine in der Box auf
    f.close();
}
void MainWindow::t_part_clear() // EE-DAT: löscht alle temporären Datenspeicher
{
    tempwc1 = 0;
    tempwc2 = 0;
    tempwc3 = 0;
    tempwc4 = 0;
    tempwc5 = 0;
    tempwc6 = 0;
    tempwc7 = 0;
    tempwc8 = 0;
    tempwc9 = 0;
    tempwc10 = 0;
    tempwc11 = 0;
    tempwc12 = 0;
    tempwc13 = 0;
    tempwc14 = 0;
    tempwc15 = 0;
    tempwc16 = 0;
    tempwc17 = 0;
    tempwc18 = 0;
    tempwc19 = 0;
    tempwc20 = 0;
    tempwc21 = 0;
    tempwc22 = 0;
    tempwc23 = 0;
    tempwc24 = 0;
    tempwc25 = 0;
    tempwc26 = 0;
    tempwc27 = 0;
    tempwc28 = 0;
    tempwc29 = 0;
    tempwc30 = 0;
    tempwc30 = 0;
    tempwc31 = 0;
    tempwc32 = 0;
    tempwc33 = 0;
    tempwc34 = 0;
    tempwc35 = 0;
    tempwc36 = 0;
    tempwc37 = 0;
    tempwc38 = 0;
    tempwc39 = 0;
    tempwc40 = 0;
    tempwc41 = 0;
    tempwc42 = 0;
}
void MainWindow::t_part_ee(int lines) // -> EE-DAT: schreibt die Datensets in der definierten Reihenfolge, lines=Anzahl
{
    int i = 0;
  //  qDebug()<< lines;
    if (lines > i) EEPROM.append(tempwc1);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc2);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc3);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc4);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc5);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc6);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc7);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc8);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc9);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc10);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc11);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc12);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc13);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc14);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc15);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc16);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc17);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc18);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc19);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc20);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc21);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc22);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc23);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc24);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc25);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc26);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc27);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc28);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc29);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc30);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc31);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc32);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc33);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc34);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc35);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc36);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc37);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc38);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc39);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc40);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc41);
    if (lines > i++) EEPROM.append("#");
    if (lines > i) EEPROM.append(tempwc42);
    if (lines > i++) EEPROM.append("#");
}
void MainWindow::t_part_ee_mot(int cntlines, int cntdata) // EE-MOT: schreibt die Datensets in der definierten Reihenfolge
{
    for (int i = 0; i < cntlines; i++)
    {
        for (int k = 0; k < cntdata; k++)
        {
            EEPROM.append(mot[i][k]);
            EEPROM.append("#");
        }
        EEPROM.append("&"); // hier endet der Datensatz
    }
}
void MainWindow::t_part_ee_insmotor(QString line, int dataset) // MOT: liest Wert aus dem Datenset des übergebenen Motors
{
    if(dataset > 0) dataset = dataset - 1;

    //    qDebug()<<"line"<<line<<"set"<<dataset;

    if (line.mid(0, line.indexOf("=")).toLower() == "acceleration0") mot[dataset][0].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "velocity0")
    {
        int zahl = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toInt(&ok, 10);
        mot[dataset][1].append(QString::number(zahl).toLatin1());
    }
    else if (line.mid(0, line.indexOf("=")).toLower() == "current0") mot[dataset][2].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "acceleration1") mot[dataset][3].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "velocity1")
    {
        int zahl = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toInt(&ok, 10);
        mot[dataset][4].append(QString::number(zahl).toLatin1());
    }
    else if (line.mid(0, line.indexOf("=")).toLower() == "current1") mot[dataset][5].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "acceleration2") mot[dataset][6].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "velocity2")
    {
        int zahl = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toInt(&ok, 10);
        mot[dataset][7].append(QString::number(zahl).toLatin1());
    }
    else if (line.mid(0, line.indexOf("=")).toLower() == "current2") mot[dataset][8].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "acceleration3") mot[dataset][9].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "velocity3")
    {
        int zahl = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toInt(&ok, 10);
        mot[dataset][10].append(QString::number(zahl).toLatin1());
    }
    else if (line.mid(0, line.indexOf("=")).toLower() == "current3") mot[dataset][11].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "deceleration") mot[dataset][12].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "standby current") mot[dataset][13].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "current risetime") mot[dataset][14].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "motor resolution") mot[dataset][15].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "encoder resolution") mot[dataset][16].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "gear1") mot[dataset][17].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "gear2") mot[dataset][18].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "lower softwarelimit") mot[dataset][19].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "upper softwarelimit") mot[dataset][20].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "use software limits") mot[dataset][21].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "use lower limit sensor") mot[dataset][22].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "use upper limit sensor") mot[dataset][23].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "sensor polarity") mot[dataset][24].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "init distance") mot[dataset][25].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "position by encoder") mot[dataset][26].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "interpolator") mot[dataset][27].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "encoder on motor-shaft") mot[dataset][28].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "stop on max deviation") mot[dataset][29].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "use closed loop") mot[dataset][30].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "maximum deviation") mot[dataset][31].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "check position") mot[dataset][32].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "init by moving") mot[dataset][33].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "retrycount") mot[dataset][34].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "position delay") mot[dataset][35].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "linear correction") mot[dataset][36].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "ramp type") mot[dataset][37].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "check voltage") mot[dataset][38].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "transmisson") mot[dataset][39].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else if (line.mid(0, line.indexOf("=")).toLower() == "resolution") mot[dataset][40].append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).toLatin1());
    else mot[dataset][38].append("0");
}
void MainWindow::STORE_FILE_partCASS(int cassnr) // schreibt geänderte Cass-Daten ins INSSETUP.INI File
{
    store = 1;
    QFile f(FILE2OPEN);
    QFile f2(tmpINIFILE);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
    if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) return;
    QTextStream datain(&f);
    QTextStream dataout(&f2);
    while (!datain.atEnd())
    {
        QString line = datain.readLine();
        if (line.size() != 0)
        {
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                dataout << line.append('\n');
                if (line.mid(1, 4) == "Cass")
                {
                    if (line.mid(5, line.indexOf(']') - 5).toInt() == cassnr)
                    {
                        qDebug() << "cass:" << line.mid(5, line.indexOf(']') - 5);
                        static int linecnt = 0; // wird nach type auf 1 gesetzt, um nicht
                        // definierte Cass zu erkennen
                        static int linecnt2 = 0; // zählt die Zeilen, um fehlende Zeile Flat zu erkennen
                        do
                        {
                            line = datain.readLine();
                            if (line.length() > 0)
                            {
                                qDebug() << "cass:line>0" << line;
                                if (line.mid(0, line.indexOf('=')).toLower() == "type") // type ist immer vorhanden (Carriername)
                                {
                                    QString tVAL;
                                    if (ui->radio_lift1_SMIF->isChecked()) tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_cassname_smif->text());
                                    else tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_cassname->text());
                                    linecnt = 1;
                                    linecnt2++;
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "slots")
                                {
                                    QString tVAL;
                                    if (ui->radio_lift1_SMIF->isChecked()) tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->lineCass_numbSlots_smif->text());
                                    else tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->lineCass_numbSlots->text());
                                    dataout << tVAL.append('\n');
                                    linecnt2++;
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "first slot")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->spinCass_firstSlot->text());
                                    dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                                    linecnt2++;
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "slot distance")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->spinCass_SlotDist->text());
                                    dataout << tVAL.append('\n');
                                    linecnt2++;
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "wafer height offset")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->spinCass_WafheightOff->text());
                                    dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                                    linecnt2++;
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "finger height offset")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->spinCass_fingerHeightOff->text());
                                    dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                                    linecnt2++;
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "wafersizewindow")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->spinCass_WafSizeWdw->text());
                                    dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                                    linecnt2++;
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "slotsizewindow")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->spinCass_SlotWdw->text());
                                    dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                                    linecnt2++;
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "flat")
                                {
                                    QString strfn;
                                    if (ui->radio_lift1_SMIF->isChecked())
                                    {
                                        if (ui->checkCass_flat_smif->checkState()) strfn = "1";
                                        else strfn = "0";
                                    }
                                    else
                                    {
                                        if (ui->checkCass_flat->checkState()) strfn = "1";
                                        else strfn = "0";
                                    }
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(strfn);
                                    dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                                    linecnt2++;
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "glas")
                                {
                                    QString strglas;
                                    if (ui->radio_lift1_SMIF->isChecked())
                                    {
                                        if (ui->checkCass_glaswafer_smif->checkState()) strglas = "1";
                                        else strglas = "0";
                                    }
                                    else
                                    {
                                        if (ui->checkCass_glaswafer->checkState()) strglas = "1";
                                        else strglas = "0";
                                    }
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(strglas);
                                    dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                                    linecnt = 0;
                                    linecnt2 = 0;
                                }
                                else dataout << line.append('\n');
                            }
                            else
                            {
                                if (linecnt == 1 && linecnt2 == 1)
                                {
                                    QString tVAL;
                                    if (ui->radio_lift1_SMIF->isChecked()) tVAL = "Slots=" + ui->lineCass_numbSlots_smif->text();
                                    else tVAL = "Slots=" + ui->lineCass_numbSlots->text();
                                    dataout << tVAL.append('\n');

                                    tVAL = "First slot=" + ui->spinCass_firstSlot->text();
                                    dataout << tVAL.append('\n');

                                    tVAL = "Slot distance=" + ui->spinCass_SlotDist->text();
                                    dataout << tVAL.append('\n');

                                    tVAL = "Wafer Height Offset=" +
                                            ui->spinCass_WafheightOff->text();
                                    dataout << tVAL.append('\n');

                                    tVAL = "Finger Height Offset=" +
                                            ui->spinCass_fingerHeightOff->text();
                                    dataout << tVAL.append('\n');

                                    tVAL = "Slotsizewindow=" + ui->spinCass_SlotWdw->text();
                                    dataout << tVAL.append('\n');

                                    tVAL = "Wafersizewindow=" + ui->spinCass_WafSizeWdw->text();
                                    dataout << tVAL.append('\n');

                                    QString strfn;
                                    if (ui->radio_lift1_SMIF->isChecked()) {
                                        if (ui->checkCass_flat_smif->checkState())
                                            strfn = "1";
                                        else
                                            strfn = "0";
                                    } else {
                                        if (ui->checkCass_flat->checkState())
                                            strfn = "1";
                                        else
                                            strfn = "0";
                                    }
                                    tVAL = "Flat=" + strfn;
                                    dataout << tVAL.append('\n');

                                    QString strglas;
                                    if (ui->radio_lift1_SMIF->isChecked()) {
                                        if (ui->checkCass_glaswafer_smif->checkState())
                                            strglas = "1";
                                        else
                                            strglas = "0";
                                    } else {
                                        if (ui->checkCass_glaswafer->checkState())
                                            strglas = "1";
                                        else
                                            strglas = "0";
                                    }
                                    tVAL = "Glas=" + strglas;
                                    dataout << tVAL.append('\n');

                                    dataout << '\n';
                                    line = '0';
                                    linecnt = 2;
                                    linecnt2 = 0;
                                } else if (linecnt2 == 8) {
                                    QString strfn;
                                    if (ui->radio_lift1_SMIF->isChecked()) {
                                        if (ui->checkCass_flat_smif->checkState())
                                            strfn = "1";
                                        else
                                            strfn = "0";
                                    } else {
                                        if (ui->checkCass_flat->checkState())
                                            strfn = "1";
                                        else
                                            strfn = "0";
                                    }
                                    QString tVAL = "Flat=" + strfn;
                                    dataout << tVAL.append('\n');

                                    QString strglas;
                                    if (ui->radio_lift1_SMIF->isChecked()) {
                                        if (ui->checkCass_glaswafer_smif->checkState())
                                            strglas = "1";
                                        else
                                            strglas = "0";
                                    } else {
                                        if (ui->checkCass_glaswafer->checkState())
                                            strglas = "1";
                                        else
                                            strglas = "0";
                                    }
                                    tVAL = "Glas=" + strglas;
                                    dataout << tVAL.append('\n');
                                    dataout << '\n';
                                    line = '0';
                                    linecnt = 2;
                                    linecnt2 = 0;
                                } else if (linecnt2 == 9) {
                                    QString strglas;
                                    if (ui->radio_lift1_SMIF->isChecked()) {
                                        if (ui->checkCass_glaswafer_smif->checkState())
                                            strglas = "1";
                                        else
                                            strglas = "0";
                                    } else {
                                        if (ui->checkCass_glaswafer->checkState())
                                            strglas = "1";
                                        else
                                            strglas = "0";
                                    }
                                    QString tVAL = "Glas=" + strglas;
                                    dataout << tVAL.append('\n');
                                    dataout << '\n';
                                    line = '0';
                                    linecnt = 2;
                                    linecnt2 = 0;
                                } else {
                                    dataout << line.append('\n');
                                    line = '0';
                                    linecnt = 0;
                                    linecnt2 = 0;
                                }
                            }
                        } while (line.at(0) != '[' && linecnt != 2);
                        linecnt = 0;
                    }
                }
            } else
                dataout << line.append('\n');
        } else
            dataout << line.append('\n');
    }
    if (QFile::exists(renameINIFILE)) QFile::remove(renameINIFILE); // letztes Inssetup.0 wird entfernt
    if (!f.rename(renameINIFILE))  fehler = 2;
    if (!f2.rename(DEFAULTINIFILE))  fehler = 2;
    if (f2.exists()) f2.close();
    if (f.exists()) f.close();
    if (fehler) err_lineinput(fehler);
    else {
        SETUP_FILE_partCASS(cassnr); // alle INI-Values neu einlesen
        SETUP_CASStype(0);           // cass typen neu einlesen
    }
}
void MainWindow::STORE_FILE_partLIFT(int liftnr) // schreibt Lift-Daten ins INSSETUP.INI File und ins EEPROM
{
    store = 1; // Freigabe für Datenexport zum INSBox EPROM

    QFile f(FILE2OPEN);
    QFile f2(tmpINIFILE);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
    if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) return;
    QTextStream datain(&f);
    QTextStream dataout(&f2);

    int unitsteps;
    int heightsteps;

    if (liftnr == 1 && ui->radio_lift1_addtohgt->isChecked())
    {
        unitsteps = ui->line_lift1_measuring_height->text().toInt(&ok, 10);

        heightsteps = ui->line_lift1_xyloader_height->text().toInt(&ok, 10);
        ui->line_lift1_xyloader_height->setText(QString::number(heightsteps - unitsteps));
        heightsteps = ui->line_lift1_wafersensor_height->text().toInt(&ok, 10);
        ui->line_lift1_wafersensor_height->setText(QString::number(heightsteps - unitsteps));
        ui->radio_lift1_addtohgt->setChecked(false);
    }
    if (liftnr == 2 && ui->radio_lift2_addtohgt->isChecked()) {
        unitsteps = ui->line_lift2_measuring_height->text().toFloat(&ok);

        heightsteps = ui->line_lift2_xyloader_height->text().toFloat(&ok);
        ui->line_lift2_xyloader_height->setText(
                    QString::number(heightsteps - unitsteps));
        heightsteps = ui->line_lift2_wafersensor_height->text().toFloat(&ok);
        ui->line_lift2_wafersensor_height->setText(
                    QString::number(heightsteps - unitsteps));
        ui->radio_lift2_addtohgt->setChecked(false);
    }
    while (!datain.atEnd())
    {
        QString line = datain.readLine();
        if (line.size() != 0)
        {
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                dataout << line.append('\n');
                if (line.mid(1, 5) == "Lift1" && liftnr == 1)
                {
                    do
                    {
                        line = datain.readLine();
                        if (line.length() > 0)
                        {
                            if (line.mid(0, line.indexOf('=')).toLower() == "lift present")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_lift1_deactivate->isChecked()));
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "wafersensor height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lift1_wafersensor_height->text());                               
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "unload operator height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lift1_unload_height->text());                                
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "xy-loader height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lift1_xyloader_height->text());                                
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "measuring unit height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lift1_measuring_height_mm->text());                                
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "tilt present")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_tilt1_deactivate->isChecked()));                                
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "tilt on position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lift1_tiltactpos->text());                                
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "tilt off position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lift1_tiltinactpos->text());                                
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "wafertype")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "smif")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_lift1_SMIF_select->currentText());                                
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "4\" cassette nr")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_4inchsel->currentText());                                
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "5\" cassette nr")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_5inchsel->currentText());                                
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "6\" cassette nr")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_6inchsel->currentText());                                
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "8\" cassette nr")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_8inchsel->currentText());                               
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else dataout << line.append('\n');
                        }
                        else
                        {
                            dataout << line.append('\n');
                            line = '0';
                        }
                    }
                    while (line.at(0) != '[');
                }
                else if (line.mid(1, 5) == "Lift2" && liftnr == 2)
                {
                    do {
                        line = datain.readLine();
                        if (line.length() > 0)
                        {
                            if (line.mid(0, line.indexOf('=')).toLower() == "lift present") {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(QString::number(
                                                    ui->check_lift2_deactivate->isChecked()));
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() ==
                                       "wafersensor height") {

                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_lift2_wafersensor_height->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "unload operator height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lift2_unload_height->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "xy-loader height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lift2_xyloader_height->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "measuring unit height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lift2_measuring_height_mm->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "tilt present") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_tilt2_deactivate->isChecked()));
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() ==
                                       "tilt on position") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_lift2_tiltactpos->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "tilt off position") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lift2_tiltinactpos->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "wafertype") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "smif") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_lift2_SMIF_select->currentText());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "4\" cassette nr") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_lift2_4inchsel->currentText());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "5\" cassette nr") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_lift2_5inchsel->currentText());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "6\" cassette nr") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_lift2_6inchsel->currentText());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "8\" cassette nr") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_lift2_8inchsel->currentText());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else dataout << line.append('\n');
                        }
                        else
                        {
                            dataout << line.append('\n');
                            line = '0';
                        }
                    } while (line.at(0) != '[');
                }
            }
            else dataout << line.append('\n');
        } else dataout << line.append('\n');
    }
    if (QFile::exists(renameINIFILE)) QFile::remove(renameINIFILE); // letztes Inssetup.0 wird entfernt
    if (!f.rename(renameINIFILE)) fehler = 2;
    if (!f2.rename(DEFAULTINIFILE)) fehler = 2;
    if (f2.exists()) f2.close();
    if (f.exists()) f.close();
    if (fehler) err_lineinput(fehler);
    else SETUP_FILE_partLIFT(liftnr); // alle INI-Values neu einlesen
}
void MainWindow::STORE_FILE_partPREAS() // schreibt Prea-Daten ins INSSETUP.INI File und ins EEPROM
{
    store = 1;
    QFile f(FILE2OPEN);
    QFile f2(tmpINIFILE);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
    if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) return;
    QTextStream datain(&f);
    QTextStream dataout(&f2);
    // if (ui->radio_prea_stepsmm->isChecked()) // Anzeige in mm wird in steps zurück konvertiert
    // {
    //     PA_conv2steps();
    //     ui->radio_prea_stepsmm->setChecked(false);
    // }
    while (!datain.atEnd()) {
        QString line = datain.readLine();
        if (line.size() != 0) {
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                dataout << line.append('\n');
                if (line.mid(1, 10) == "Prealigner")
                {
                    do
                    {
                        line = datain.readLine();
                        if (line.length() > 0)
                        {
                            if (line.mid(0, line.indexOf('=')).toLower() == "wobbler present")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_wob_deactiv->isChecked()));
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "below lo height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_belowloader->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "below lo height thin")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "lo height") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_loaderheight->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "above lo height thin")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "above lo height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_aboveloader->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "pa height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_preaheight->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "ch height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_chuckheight->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "wo angle")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_wobbtiltangle->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "wo rotational position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_wobrotpos->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "measurement present")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_measureused->isChecked()));
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "pa angle")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_preasensangle->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "pa precount")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_preaprecount->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "pa count")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_preacount->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "pa postcount")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_preapostcount->text());
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "align to front")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_wobphispeed->text());
                                qDebug() << "part align to front" << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "reader displacement")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_readdispl->text());
                                qDebug() << tVAL;
                                if (tVAL.contains(",")) tVAL.replace(tVAL.indexOf(","), 1, ".");
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "wobbler displacement")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_wobbdispl->text());
                                qDebug() << tVAL;
                                if (tVAL.contains(",")) tVAL.replace(tVAL.indexOf(","), 1, ".");
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "normal displacement")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_normaldispl->text());
                                qDebug() << tVAL;
                                if (tVAL.contains(",")) tVAL.replace(tVAL.indexOf(","), 1, ".");
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "profilecalibration")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_profilecalib->isChecked()));
                                qDebug() << tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "slitlength")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_slitlenght->text());
                                qDebug() << tVAL;
                                if (tVAL.contains(",")) tVAL.replace(tVAL.indexOf(","), 1, ".");
                                dataout << tVAL.append('\n');
                            }
                            else dataout << line.append('\n');
                        }
                        else
                        {
                            dataout << line.append('\n');
                            line = '0';
                        }
                    }
                    while (line.at(0) != '[');
                }
            }
            else dataout << line.append('\n');
        } else dataout << line.append('\n');
    }
    // zuerst Original Inssetup.INI f umbenennen
    if (QFile::exists(renameINIFILE)) QFile::remove(renameINIFILE); // letztes Inssetup.0 wird entfernt
    if (!f.rename(renameINIFILE)) fehler = 2;
    if (!f2.rename(DEFAULTINIFILE)) fehler = 2; // dann f2 umbenennen in Inssetup.INI
    if (f2.exists()) f2.close();
    if (f.exists()) f.close();
    if (fehler) err_lineinput(fehler);
    else SETUP_FILE_partPA(); // alle INI-Values neu einlesen
}
void MainWindow::STORE_FILE_partLOADER() // schreibt Loader-Daten ins INSSETUP.INI File und ins EEPROM
{
    store = 1;
    QFile f(FILE2OPEN);
    QFile f2(tmpINIFILE);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
    if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) return;
    QTextStream datain(&f);
    QTextStream dataout(&f2);

    while (!datain.atEnd()) {
        QString line = datain.readLine();
        if (line.size() != 0) {
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                dataout << line.append('\n');
                if (line.mid(1, 6) == "Loader")
                {
                    do
                    {
                        line = datain.readLine();
                        if (line.length() > 0)
                        {
                            if (line.mid(0, line.indexOf('=')).toLower() == "x-l1 position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_loader_xlift1pos->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "x-l2 position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_loader_xlift2pos->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "x-pa free position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_loader_xpreafreepos->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "x-pa position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_loader_xpreapos->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "y-l1 position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_loader_ylift1inpos->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "y-l2 position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_loader_ylift2inpos->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "y-pa position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_loader_ypreapos->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "y-out lift position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_loader_youtlift->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "y-in lift displacement")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_loader_yliftdispl->text());
                                if (tVAL.contains(",")) tVAL.replace(tVAL.indexOf(","), 1, ".");
                                dataout << tVAL.append('\n');
                            }
                            else dataout << line.append('\n');
                        }
                        else
                        {
                            dataout << line.append('\n');
                            line = '0';
                        }
                    }
                    while (line.at(0) != '[');
                }
            }
            else dataout << line.append('\n');
        }
        else dataout << line.append('\n');
    }
    // zuerst Original Inssetup.INI f umbenennen
    if (QFile::exists(renameINIFILE)) QFile::remove(renameINIFILE); // letztes Inssetup.0 wird entfernt
    if (!f.rename(renameINIFILE)) fehler = 2;
    // dann f2 umbenennen in Inssetup.INI
    if (!f2.rename(DEFAULTINIFILE)) fehler = 2;
    if (f2.exists()) f2.close();
    if (f.exists()) f.close();
    if (fehler) err_lineinput(fehler);
    else SETUP_FILE_partLD();
}
void MainWindow::STORE_FILE_partWC() // schreibt WC-Daten ins INSSETUP.INI File und ins EEPROM
{
    store = 1;
    QFile f(FILE2OPEN);
    QFile f2(tmpINIFILE);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
    if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) return;
    QTextStream datain(&f);
    QTextStream dataout(&f2);
    QString linestr;

    // if (ui->radio_wc_stepsmm->isChecked()) // Anzeige in mm wird in steps zurück konvertiert
    // {
    //     WC_conv2steps();
    //     ui->radio_wc_stepsmm->setChecked(false);
    // }
    while (!datain.atEnd())
    {
        QString line = datain.readLine();
        if (line.size() != 0)
        {
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                dataout << line.append('\n');
                if (line.mid(0, 14) == "[Waferchanger]")
                {
                    do
                    {
                        line = datain.readLine();
                        linestr = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                        qDebug() << line.length();
                        if (line.length() > 0)
                        {
                            if (line.mid(0, line.indexOf('=')).toLower() == "waferchanger present")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_wc_deactivate->isChecked()));
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "above ch height thin")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "above ch height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_wc_abovechuckheight->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "ch height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_wc_chuckheight->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "below ch height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_wc_belowchuckheight->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "ch free height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_wc_belowchuckheight->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "left position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_wc_leftpos->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "middle position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_wc_middlepos->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "right position")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_wc_rightpos->text());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "lo height")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n');
                            }
                            else dataout << line.append('\n');
                        }
                        else
                        {
                            dataout << line.append('\n');
                            line = '0';
                        }
                    }
                    while (line.at(0) != '[');
                }
            }
            else dataout << line.append('\n');
        }
        else dataout << line.append('\n');
    }
    if (QFile::exists(renameINIFILE)) QFile::remove(renameINIFILE); // letztes Inssetup.0 wird entfernt
    if (!f.rename(renameINIFILE)) fehler = 2;
    if (!f2.rename(DEFAULTINIFILE)) fehler = 2;
    if (f2.exists()) f2.close();
    if (f.exists()) f.close();
    if (fehler) err_lineinput(fehler);
    else SETUP_FILE_partWC(); // alle INI-Values neu einlesen
}
void MainWindow::STORE_FILE_partVAC() // schreibt vac data ins INSSETUP.INI File
{
    QFile f(FILE2OPEN);
    QFile f2(tmpINIFILE);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
    if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) return;
    QTextStream datain(&f);
    QTextStream dataout(&f2);
    while (!datain.atEnd())
    {
        QString line = datain.readLine();
        if (line.size() != 0) // INSSETUP.ini schreiben
        {
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                dataout << line.append('\n');
                if (line.mid(0, 8) == "[Vacuum]")
                {
                    do
                    {
                        line = datain.readLine();
                        qDebug() << line.length();
                        if (line.length() > 0) // Daten ins INSSETUP.ini schreiben
                        {
                            if (line.mid(0, line.indexOf('=')).toLower() == "check vacuum")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_vac_checkvac->isChecked()));
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "check main vacuum")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_vac_checkmainvac->isChecked()));
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "main vacuum polltime")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_vac_polltime->text());   //  qDebug()<<tVAL;
                                if (ui->line_vac_polltime->text().toUInt(&ok,10) > 255) err_msgbox("value vac polltime not in range");
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "chuck sequence")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_vac_sequence->isChecked()));
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "use chuck 6\" vacuum")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_vac_use6inch->isChecked()));
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "use chuck 8\" vacuum")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(QString::number(
                                                    ui->check_vac_use8inch->isChecked()));
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "loader pulstime")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_vac_LD_puls->text()); //  qDebug()<<tVAL;
                                if (ui->line_vac_LD_puls->text().toUInt(&ok,10) > 255) err_msgbox("value vac LD pulstime not in range");
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "loader timeout") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_LD_timeout->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "loader on threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_LD_ThrsON->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "loader off threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_LD_ThrsOFF->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "changer left pulstime")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_WC1_puls->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "changer left timeout")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_vac_WC1_Timeout->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "changer left on threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_WC1_ThrsON->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "changer left off threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_WC1_ThrsOFF->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "changer right pulstime") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_WC2_puls->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "changer right timeout") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_WC2_Timeout->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "changer right on threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_WC2_ThrsON->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "changer right off threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_WC2_ThrsOFF->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner pulstime") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_PA_puls->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner timeout") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_PA_Timeout->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner on threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_PA_ThrsON->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner off threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_PA_ThrsOFF->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" pulstime") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH4_puls->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" timeout")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH4_Timeout->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" on threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH4_ThrsON->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" off threshold")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH4_ThrsOFF->text().toLatin1());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" pulstime") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH6_puls->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" timeout") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH6_Timeout->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" on threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH6_ThrsON->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" off threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH6_ThrsOFF->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" pulstime") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH8_puls->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" timeout") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH8_Timeout->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" on threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH8_ThrsON->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" off threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH8_ThrsOFF->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "main pulstime") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_MainVac_puls->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "main timeout") {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_MainVac_Timeout->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "main on threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_MainVac_ThrsON->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "main off threshold") {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_MainVac_ThrsOFF->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "default pulstime") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_default_puls->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "default timeout") {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_default_Timeout->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "default on threshold") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_default_ThrsON->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "default off threshold") {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_default_ThrsOFF->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "lowld") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_LD_ThrsON_2->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "lowpa") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_PA_ThrsON_2->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "lowch") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_CH4_ThrsON_2->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "lowwc1") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_WC1_ThrsON_2->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            } else if (line.mid(0, line.indexOf('=')).toLower() == "lowwc2") {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_vac_WC2_ThrsON_2->text());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "semi friction")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_vac_lowactive->isChecked()));
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "retry")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(ui->check_vac_rety->isChecked()));
                                dataout << tVAL.append('\n');
                            }
                            else dataout << line.append('\n');
                        }
                        else
                        {
                            dataout << line.append('\n');
                            line = '0';
                        }
                    }
                    while (line.at(0) != '[');
                }
            }
            else dataout << line.append('\n');
        }
        else dataout << line.append('\n');
    }
    if (QFile::exists(renameINIFILE)) QFile::remove(renameINIFILE); // letztes Inssetup.0 wird entfernt
    if (!f.rename(renameINIFILE)) fehler = 2;
    if (!f2.rename(DEFAULTINIFILE)) fehler = 2;
    if (f2.exists()) f2.close();
    if (f.exists()) f.close();
    if (fehler) err_lineinput(fehler);
    else SETUP_FILE_partVAC(1); // alle INI-Values neu einlesen
}
void MainWindow::STORE_FILE_partLOCK(int liftnr) // schreibt Towerdaten ins INSSETUP.INI File und ins EEPROM
{
    QFile f(FILE2OPEN);
    QFile f2(tmpINIFILE);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) err_msgbox("could not open Inssetup.INI file");
    if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) err_msgbox("could not open tmp file");
    QTextStream datain(&f);
    QTextStream dataout(&f2);
    while (!datain.atEnd())
    {
        QString line = datain.readLine();
        if (line.size() != 0)
        {
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                dataout << line.append('\n');
                if (liftnr == 1)
                {
                    if (line.mid(0, 11) == "[Liftlock1]")
                    {
                        do
                        {
                            line = datain.readLine();

                            if (line.length() > 0)
                            {
                                if (line.mid(0, line.indexOf('=')).toLower() == "delaytime")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lock_delaytime->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "vacuumnumber")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lock_vacnumber->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage1")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lock_v1->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage2")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lock_v2->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage3")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lock_v3->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage4")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lock_v4->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage5")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lock_v5->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage1")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_unlock_v1->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage2")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_unlock_v2->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage3")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_unlock_v3->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage4")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_unlock_v4->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage5")
                                {
                                    QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_unlock_v5->text().toLower());
                                    dataout << tVAL.append('\n');
                                }
                                else dataout << line.append('\n');
                            }
                            else
                            {
                                dataout << line.append('\n');
                                line = '0';
                            }
                        }
                        while (line.at(0) != '[');
                    }
                }
                else if (liftnr == 2)
                {
                    if (line.mid(0, 11) == "[Liftlock2]")
                    {
                        qDebug() << "Liftlock2" << line.mid(0, 11);
                        do
                        {
                            line = datain.readLine();

                            if (line.length() > 0)
                            {
                                qDebug() << "line.count()" << line.length() << "line.at(0)" << line.at(0);
                                if (line.mid(0, line.indexOf('=')).toLower() == "delaytime") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_lock_delaytime_2->text().toLower());
                                    qDebug() << "tval" << tVAL;
                                    dataout << tVAL.append('\n');
                                } else if (line.mid(0, line.indexOf('=')).toLower() == "vacuumnumber") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_lock_vacnumber_2->text().toLower());
                                    qDebug() << "tval" << tVAL;
                                    dataout << tVAL.append('\n');
                                } else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage1") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_lock_v1_2->text().toLower());
                                    qDebug() << "tval" << tVAL;
                                    dataout << tVAL.append('\n');
                                } else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage2") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_lock_v2_2->text().toLower());
                                    qDebug() << "tval" << tVAL;
                                    dataout << tVAL.append('\n');
                                } else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage3") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_lock_v3_2->text().toLower());
                                    qDebug() << tVAL;
                                    dataout << tVAL.append('\n');
                                } else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage4") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_lock_v4_2->text().toLower());
                                    qDebug() << tVAL;
                                    dataout << tVAL.append('\n');
                                } else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage5") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_lock_v5_2->text().toLower());
                                    qDebug() << tVAL;
                                    dataout << tVAL.append('\n');
                                } else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage1") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_unlock_v1_2->text().toLower());
                                    qDebug() << tVAL;
                                    dataout << tVAL.append('\n');
                                } else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage2") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_unlock_v2_2->text().toLower());
                                    qDebug() << tVAL;
                                    dataout << tVAL.append('\n');
                                } else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage3") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_unlock_v3_2->text().toLower());
                                    qDebug() << tVAL;
                                    dataout << tVAL.append('\n');
                                } else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage4") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_unlock_v4_2->text().toLower());
                                    qDebug() << tVAL;
                                    dataout << tVAL.append('\n');
                                } else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage5") {
                                    QString tVAL =
                                            line.mid(0, line.indexOf("=") + 1)
                                            .append(ui->line_unlock_v5_2->text().toLower());
                                    qDebug() << tVAL;
                                    dataout << tVAL.append('\n');
                                } else dataout << line.append('\n');
                            }
                            else
                            {
                                dataout << line.append('\n');
                                line = '0';
                            }
                        }
                        while (line.at(0) != '[');
                    }
                }
            }
            else dataout << line.append('\n');
        }
        else dataout << line.append('\n');
    }
    if (QFile::exists(renameINIFILE)) QFile::remove(renameINIFILE); // letztes Inssetup.0 wird entfernt
    if (!f.rename(renameINIFILE)) fehler = 2;
    if (!f2.rename(DEFAULTINIFILE)) fehler = 2;
    if (f2.exists()) f2.close();
    if (f.exists()) f.close();
    if (fehler) err_lineinput(fehler);
    else SETUP_FILE_partLOCK(liftnr, FALSE); // alle INI-Values neu einlesen
}
void MainWindow::STORE_FILE_partWOBJOY()
{
    store = 1; // 1=write new data to EPROM
    QFile f(FILE2OPEN);
    QFile f2(tmpINIFILE);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) err_msgbox("could not open Inssetup.INI file");
    if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) err_msgbox("could not open tmp file");
    QTextStream datain(&f);
    QTextStream dataout(&f2);
    while (!datain.atEnd())
    {
        QString line = datain.readLine();
        if (line.size() != 0)
        {
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                dataout << line.append('\n');
                if (line.mid(0, 8) == "[WOBJOY]")
                {
                    do
                    {
                        line = datain.readLine();

                        if (line.length() > 0)
                        {
                            if (line.mid(0, line.indexOf('=')).toLower() == "low_tilt")
                            {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_joy_tiltmin->text().toLower());
                                //                                qDebug()<<"tval"<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "up_tilt")
                            {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_joy_tiltmax->text().toLower());
                                //                                qDebug()<<"tval"<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "low_rot")
                            {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_joy_rotmin->text().toLower());
                                //                                qDebug()<<"tval"<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "up_rot")
                            {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_joy_rotmax->text().toLower());
                                //                                qDebug()<<"tval"<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "thres")
                            {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_joy_threshold->text().toLower());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "speed_tiltup")
                            {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_joy_tiltspeedup->text().toLower());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "speed_tiltdwn")
                            {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_joy_tiltspeeddown->text().toLower());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "speed_rotcw")
                            {
                                QString tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_joy_rotCW->text().toLower());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "speed_rotccw")
                            {
                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_joy_rotCCW->text().toLower());// qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "setwojoy")
                            {
                                int joy = 0;

                                if (ui->checkBox_Xjoy_phi->isChecked()) joy |= 0b00010000;
                                if (ui->checkBox_Xjoy_rotation->isChecked()) joy |= 0b00100000;
                                if (ui->checkBox_Xjoy_tilt->isChecked()) joy |= 0b01000000;
                                if (ui->checkBox_Yjoy_phi->isChecked()) joy |= 0b00000001;
                                if (ui->checkBox_Yjoy_rotation->isChecked()) joy |= 0b00000010;
                                if (ui->checkBox_Yjoy_tilt->isChecked()) joy |= 0b00000100;

                                QString tVAL = line.mid(0, line.indexOf("=") + 1).append(QString::number(joy));
                                qDebug()<<"joyx"<<joy;
                                dataout << tVAL.append('\n');
                            }
                            else dataout << line.append('\n');
                        }
                        else
                        {
                            dataout << line.append('\n');
                            line = '0';
                        }
                    }
                    while (line.at(0) != ';');
                }
            }
            else dataout << line.append('\n');
        } else dataout << line.append('\n');
    }
    if (QFile::exists(renameINIFILE)) QFile::remove(renameINIFILE); // letztes Inssetup.0 wird entfernt
    if (!f.rename(renameINIFILE)) fehler = 2;
    if (!f2.rename(DEFAULTINIFILE)) fehler = 2;
    if (f2.exists()) f2.close();
    if (f.exists()) f.close();
    if (fehler) err_lineinput(fehler);
    else SETUP_FILE_partWOBJOY(); // alle INI-Values neu einlesen und Daten ins EE
    // schreiben
}
void MainWindow::Store_File_Mot(int motor) // schreibt neue Daten des ausgewählten Motors in die Motor-Ini
{
    QString tVAL;

    QFile f1(MFILE2OPEN); // Daten aus Motor.INI einlesen
    QFile f2(tmpMOTFILE);
    if (!f1.open(QIODevice::ReadOnly | QIODevice::Text)) err_msgbox("open Insmotor.INI failed");
    if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) err_msgbox("open Insmotor.tmp failed");
    QTextStream datain(&f1);
    QTextStream dataout(&f2);
    QString mot;

    switch (motor)
    {
    case 1:
        mot = "lift1 height";
        break;
    case 2:
        mot = "lift1 tilt";
        break;
    case 3:
        mot = "lift2 height";
        break;
    case 4:
        mot = "lift2 tilt";
        break;
    case 5:
        mot = "loader x";
        break;
    case 6:
        mot = "loader y";
        break;
    case 7:
        mot = "prealigner height";
        break;
    case 8:
        mot = "prealigner phi";
        break;
    case 9:
        mot = "wobbler rotation";
        break;
    case 10:
        mot = "wobbler phi";
        break;
    case 11:
        mot = "waferchanger height";
        break;
    case 12:
        mot = "waferchanger phi";
        break;
    }

    while (!datain.atEnd())
    {
        QString line = datain.readLine();
        if (line.size() != 0)
        {
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                dataout << line.append('\n');

                if (line.contains(mot, Qt::CaseInsensitive))
                {
                    do
                    {
                        line = datain.readLine();
                        if (line.length() > 0) {
                            if (line.mid(0, line.indexOf('=')).toLower() == "acceleration0") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_accelfull->text().trimmed());
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "velocity0") {
                                tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(QString::number(
                                                    ui->line_velofull->text().trimmed().toInt(&ok, 10) *
                                                    1000));
                                //   qDebug()<<"slots "<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "current0") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_currfull->text().trimmed());
                                //   qDebug()<<"first slot "<<tVAL;
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "acceleration1") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_accelempty->text().trimmed());
                                //  qDebug()<<tVAL;
                                dataout << tVAL.append('\n');
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "velocity1") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(QString::number(
                                                    ui->line_veloempty->text().trimmed().toInt(&ok,
                                                                                               10) *
                                                    1000));
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "current1") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_currempty->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "acceleration2") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_accelmove->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "velocity2") {
                                tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(QString::number(
                                                    ui->line_velomove->text().trimmed().toInt(&ok, 10) *
                                                    1000));
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "current2") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_currmove->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "acceleration3") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_accelinit->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "velocity3") {
                                tVAL =
                                        line.mid(0, line.indexOf("=") + 1)
                                        .append(QString::number(
                                                    ui->line_veloinit->text().trimmed().toInt(&ok, 10) *
                                                    1000));
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "current3") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_currinit->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "deceleration") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_fastdecel->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "standby current") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_stdbycurr->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "current risetime") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_currrisetime->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "motor resolution") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_motresolution->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "encoder resolution") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_encresolution->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "transmisson") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_transmission->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "gear1")
                            {
                                tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_gear1->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "gear2")
                            {
                                tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_gear2->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "lower softwarelimit")
                            {
                                tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_lowsoftlimit->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "upper softwarelimit")
                            {
                                tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_upsoftlimit->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "use software limits")
                            {
                                if (ui->check_usesoftlimit->isChecked()) tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                else tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "use lower limit sensor")
                            {
                                if (ui->check_uselowsensor->isChecked()) tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                else tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "use upper limit sensor") {
                                if (ui->check_useupsensor->isChecked())
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                else
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "sensor polarity")
                            {
                                tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_senspolar->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "init distance")
                            {
                                tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_initdistance->text().trimmed());                               
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben                               
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "position by encoder")
                            {
                                if (ui->check_posencoder->isChecked())
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                else
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "interpolator") {
                                if (ui->check_interpolator->isChecked())
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                else
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "encoder on motor-shaft")
                            {
                                if (ui->check_enconmotor->isChecked()) tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                else tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "stop on max deviation")
                            {
                                if (ui->check_stopatmaxdev->isChecked()) tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                else tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "use closed loop") {
                                if (ui->check_closedloop->isChecked())
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                else
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "maximum deviation") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_maxdeviation->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "check position") {
                                if (ui->check_checkpos->isChecked())
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                else
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "init by moving") {
                                if (ui->check_initbymove->isChecked())
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                else
                                    tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "retrycount") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_posretrycount->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "position delay") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_posdelay->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "linear correction") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_lincorr->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "resolution") {
                                tVAL = line.mid(0, line.indexOf("=") + 1)
                                        .append(ui->line_resolution->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "ramp type")
                            {
                                tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->line_ramptype->text().trimmed());
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else if (line.mid(0, line.indexOf('=')).toLower() == "check voltage")
                            {
                                if (ui->check_checkmotvolt->isChecked()) tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                else tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                            }
                            else dataout << line.append('\n');
                        }
                        else
                        {
                            dataout << line.append('\n');
                            line = '0';
                        }
                    }
                    while (line.at(0) != '[' && line != '0');
                }
            }
            else dataout << line.append('\n');
        }
        else dataout << line.append('\n');
    }
    if (QFile::exists(renameMOTFILE)) QFile::remove(renameMOTFILE); // letztes Insmotor.0 wird entfernt
    if (!f1.rename(renameMOTFILE)) fehler = 2;
    if (!f2.rename(DEFAULTMOTFILE)) fehler = 2;
    if (f2.exists()) f2.close();
    if (f1.exists()) f1.close();
    if (fehler) err_lineinput(fehler);
    else setEngineValues(mot); // alle INI-Values neu einlesen
    if (mot == "prealigner phi")
    {
        QByteArray tmp = "$SET_29=";
        tmp.append(ui->line_maxdeviation_friction->text().toLatin1() + "\r\n");
        serialSendFeeder(tmp);
    }
}
void MainWindow::SETUP_CASStype(bool copy)
{
    FILE2OPEN = DEFAULTINIFILE;
    QFile f(FILE2OPEN);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) err_msgbox("open Inssetup.INI failed");
    line.clear();
    int i = 1;
    int isType;

    if (ui->radio_lift1_SMIF->isChecked())
    {
        if (copy) isType = ui->spinBox_destinationcass_smif->text().toInt(&ok, 10);
        else isType = ui->comboCass_Type_smif->currentIndex();
    }
    else
    {
        if (copy) isType = ui->spinBox_destinationcass->text().toInt(&ok, 10);
        else isType = ui->comboCass_Type->currentIndex();
    }

    if (ui->radio_lift1_SMIF->isChecked()) ui->comboCass_Type_smif->setEditable(1);
    else ui->comboCass_Type->setEditable(1);

    int count;
    if (ui->radio_lift1_SMIF->isChecked()) count = ui->comboCass_Type_smif->count();
    else count = ui->comboCass_Type->count();

    for (int i = count; i > 0; i--)
    {
        if (ui->radio_lift1_SMIF->isChecked()) ui->comboCass_Type_smif->removeItem(i);
        else ui->comboCass_Type->removeItem(i);
    }

    while (!f.atEnd())
    {
        line = f.readLine().trimmed();
        if (line.length() > 0 && line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            //   qDebug()<<"line cass"<<line.mid(1,line.indexOf("]")-1);
            if (line.mid(1, 4) == "Cass") {
                QString tmp;
                QString s;

                do {
                    line = f.readLine();

                    if (line.mid(0, line.indexOf('=')).toLower() == "type") {
                        if (i < 5)
                            tmp = "8-";
                        else if (i < 9)
                            tmp = "6-";
                        else if (i < 13)
                            tmp = "5-";
                        else if (i < 17)
                            tmp = "4-";
                        tmp +=
                                line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                        if (ui->radio_lift1_SMIF->isChecked())
                            ui->comboCass_Type_smif->addItem(tmp);
                        else
                            ui->comboCass_Type->addItem(tmp);
                        //                        qDebug()<<"i"<<i<<"count"<<ui->comboCass_Type->count();
                    }

                } while (line.mid(0, line.indexOf('=')).toLower() != "type");
                i++;
            }
        }
    }
    if (ui->radio_lift1_SMIF->isChecked()) ui->comboCass_Type_smif->setEditable(0);
    else ui->comboCass_Type->setEditable(0);

    logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "SETUP_CASStype " << isType << '\n';
    f.close();

    if (ui->radio_lift1_SMIF->isChecked()) ui->comboCass_Type_smif->setCurrentIndex(isType);
    else ui->comboCass_Type->setCurrentIndex(isType);
}
void MainWindow::SETUP_FILE_partCASS(int cassnr) // liest CASS INI-Daten in die Maske ein
{
    EEPROM.clear();     // alte Arraydaten löschen
    EEPROM.append("_"); // Startzeichen zur Delimiter Abgrenzung
    FILE2OPEN = DEFAULTINIFILE;
    QFile f(FILE2OPEN);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text))
        return;
    line.clear();
    int i = 1;
    if (store)
        t_part_clear();
    while (!f.atEnd()) {
        line = f.readLine();
        if (line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            if (line.mid(1, 4) == "Cass") {
                if (i == cassnr) {
                    QString tmp;
                    float flt;
                    QString s;
                    do {
                        line = f.readLine();
                        //    qDebug()<<"SETUP_FILE_partCASS:"<<line.mid(0,line.indexOf('=')).toLower();
                        if (line.mid(0, line.indexOf('=')).toLower() == "type") {
                            if (ui->radio_lift1_SMIF->isChecked())
                                ui->line_cassname_smif->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                            else
                                ui->line_cassname->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                            if (line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                    .trimmed()
                                    .toLower() == "none") {
                                ui->lineCass_numbSlots->setText("-");
                                ui->spinCass_firstSlot->clear();
                                ui->lineCass_firstSlot_3->setText("-");
                                ui->spinCass_SlotDist->clear();
                                ui->lineCass_SlotDist_3->setText("-");
                                ui->spinCass_WafheightOff->clear();
                                ui->spinCass_fingerHeightOff->clear();
                                ui->spinCass_WafSizeWdw->clear();
                                ui->spinCass_SlotWdw->clear();
                                ui->lineCass_WafheightOff_3->setText("-");
                                ui->lineCass_fingerHeightOff_3->setText("-");
                                ui->lineCass_WafSizeWdw_3->setText("-");
                                ui->lineCass_SlotWdw_3->setText("-");
                            }
                        } else if (line.mid(0, line.indexOf('=')).toLower() == "slots") {
                            if (ui->radio_lift1_SMIF->isChecked())
                                ui->lineCass_numbSlots_smif->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                            else
                                ui->lineCass_numbSlots->setText(
                                            line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                            .trimmed());
                            tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n'))
                                           .trimmed());
                        } else if (line.mid(0, line.indexOf('=')).toLower() ==
                                   "first slot") {
                            tempwc2.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n'))
                                           .trimmed());
                            tmp =
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                            ui->spinCass_firstSlot->setValue(tmp.toInt(&ok, 10));
                            flt = tmp.toInt(&ok, 10);
                            s = QString::number(flt / 360.00, 10, 4);
                            ui->lineCass_firstSlot_3->setText(s);
                        } else if (line.mid(0, line.indexOf('=')).toLower() ==
                                   "slot distance") {
                            tempwc3.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n'))
                                           .trimmed());
                            tmp =
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                            flt = tmp.toInt(&ok, 10);
                            s = QString::number(flt / 360.00, 10, 4);
                            ui->lineCass_SlotDist_3->setText(s);
                            ui->spinCass_SlotDist->setValue(tmp.toInt(&ok, 10));
                        } else if (line.mid(0, line.indexOf('=')).toLower() ==
                                   "wafer height offset") {
                            tempwc6.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n'))
                                           .trimmed());
                            tmp =
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                            flt = tmp.toInt(&ok, 10);
                            s = QString::number(flt / 360.00, 10, 4);
                            ui->lineCass_WafheightOff_3->setText(s);
                            ui->spinCass_WafheightOff->setValue(tmp.toInt(&ok, 10));
                        } else if (line.mid(0, line.indexOf('=')).toLower() ==
                                   "finger height offset") {
                            tempwc7.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n'))
                                           .trimmed());
                            tmp =
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                            flt = tmp.toInt(&ok, 10);
                            s = QString::number(flt / 360.00, 10, 4);
                            ui->lineCass_fingerHeightOff_3->setText(s);
                            ui->spinCass_fingerHeightOff->setValue(tmp.toInt(&ok, 10));
                        } else if (line.mid(0, line.indexOf('=')).toLower() ==
                                   "wafersizewindow") {
                            tempwc5.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n'))
                                           .trimmed());
                            tmp =
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                            flt = tmp.toInt(&ok, 10);
                            s = QString::number(flt / 360.00, 10, 4);
                            ui->lineCass_WafSizeWdw_3->setText(s);
                            ui->spinCass_WafSizeWdw->setValue(tmp.toInt(&ok, 10));
                        } else if (line.mid(0, line.indexOf('=')).toLower() ==
                                   "slotsizewindow") {
                            tempwc4.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n'))
                                           .trimmed());
                            tmp =
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                            flt = tmp.toInt(&ok, 10);
                            s = QString::number(flt / 360.00, 10, 4);
                            ui->lineCass_SlotWdw_3->setText(s);
                            ui->spinCass_SlotWdw->setValue(tmp.toInt(&ok, 10));
                        } else if (line.mid(0, line.indexOf('=')).toLower() == "flat") {
                            tempwc8.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n'))
                                           .trimmed());
                            tmp =
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                            if (tmp == "1") {
                                if (ui->radio_lift1_SMIF->isChecked()) {
                                    ui->checkCass_notch_smif->setChecked(0);
                                    ui->checkCass_flat_smif->setChecked(1);
                                } else {
                                    ui->checkCass_notch->setChecked(0);
                                    ui->checkCass_flat->setChecked(1);
                                }
                            } else {
                                if (ui->radio_lift1_SMIF->isChecked()) {
                                    ui->checkCass_notch_smif->setChecked(1);
                                    ui->checkCass_flat_smif->setChecked(0);
                                } else {
                                    ui->checkCass_notch->setChecked(1);
                                    ui->checkCass_flat->setChecked(0);
                                }
                            }
                        } else if (line.mid(0, line.indexOf('=')).toLower() == "glas") {
                            tempwc9.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n'))
                                           .trimmed());
                            tmp =
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                            if (tmp == "1") {
                                if (ui->radio_lift1_SMIF->isChecked())
                                    ui->checkCass_glaswafer_smif->setChecked(1);
                                else
                                    ui->checkCass_glaswafer->setChecked(1);
                            } else {
                                if (ui->radio_lift1_SMIF->isChecked())
                                    ui->checkCass_glaswafer_smif->setChecked(0);
                                else
                                    ui->checkCass_glaswafer->setChecked(0);
                            }
                        }
                    } while (line.at(0) != '[');
                    i++;
                } else
                    i++;
            }
        }
    }
    f.close();
    if (store) // neue cass data ins EE schicken
    {
        t_part_ee(9);
        QByteArray tmpEEPROM = EEPROM;
        char delimiter1[] = "_#";
        char *token;
        QString tmp;
        int tmpf = 0;
        char *charptr = tmpEEPROM.data();
        int checksum = 0;

        token = strtok(charptr, delimiter1); // erstes Zeichen entfernen
        //    qDebug()<<"token1 "<<token;
        tmp = token;
        checksum = tmp.toFloat();
        while (token) // token wird zerlegt bis \0
        {
            token = strtok(NULL, delimiter1);
            //   qDebug()<<"token2 "<<token;
            tmp = token;
            tmpf = tmp.toFloat();
            //   qDebug()<<tmpf;
            checksum += tmpf;
            //   qDebug()<<checksum;
        }
    //    qDebug()<< QString::number(checksum);
        EEPROM.append('!');
        EEPROM.append(QString::number(checksum).toLatin1());
        EEPROM.append("\r");
    //    qDebug()<<"EEPROM valuestring"<< EEPROM;
        QByteArray arr = EEPDATA0;
        arr.append(QString::number(cassnr + 2).toLatin1());
        arr.append("\r\n");
        serialSendFeeder(arr);
        store = 0;
        cmdaktiv = 1;
    }
}
void MainWindow::copy_FILE_partCASS(int source, int dest) // liest CASS INI-Daten neu in die Maske ein
{
    QString casssource[10];
    QString cassdest[10];
    int step = 0;

    QFile f2(tmpINIFILE);
    if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) err_msgbox("could not open tmp file");
    QTextStream dataout(&f2);

    FILE2OPEN = DEFAULTINIFILE;
    QFile f(FILE2OPEN);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) err_msgbox("could not open Inssetup.INI file");
    QTextStream datain(&f);
    line.clear();
    int i = 1;
    while (!f.atEnd())
    {
        line = f.readLine();
        if (line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            if (line.mid(1, 4) == "Cass")
            {
                if (i == source)
                {
                    QString tmp;
                    QString s;
                    do
                    {
                        line = f.readLine();
                        if (line.mid(0, line.indexOf('=')).toLower() == "type")
                        {
                            casssource[0] = line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                            if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed().toLower() == "none")
                            {
                                casssource[1] = "-";
                                casssource[2] = "-";
                                casssource[3] = "-";
                                casssource[4] = "-";
                                casssource[5] = "-";
                                casssource[6] = "-";
                                casssource[7] = "-";
                            }
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "slots")
                        {
                            casssource[1] = line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "first slot")
                        {
                            casssource[2] = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "slot distance")
                        {
                            casssource[3] = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "wafer height offset")
                        {
                            casssource[6] = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "finger height offset")
                        {
                            casssource[7] = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "wafersizewindow")
                        {
                            casssource[5] = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "slotsizewindow")
                        {
                            casssource[4] = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "flat")
                        {
                            casssource[8] = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                        }
                        else if (line.mid(0, line.indexOf('=')).toLower() == "glas")
                        {
                            casssource[9] = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                        }
                    }
                    while (line.at(0) != '[');
                    i++;
                }
                else i++;
            }
        }
    }
    qDebug() << "s0" << casssource[0] << "s1" << casssource[1] << "s2"
             << casssource[2] << "s3" << casssource[3] << "s4" << casssource[4]
                << "s5" << casssource[5] << "s6" << casssource[6];
    f.close();

    if (!f.open(QIODevice::ReadWrite | QIODevice::Text)) err_msgbox("could not open Inssetup.INI file");
    line.clear();
    f.reset();
    while (!f.atEnd())
    {
        line = f.readLine();
        if (line.size() != 0)
        {
            if (line.at(0) == '[') // all Strings, die mit [ beginnen
            {
                dataout << line;
                if (line.mid(1, 4) == "Cass")
                {
                    if (line.mid(5, line.indexOf(']') - 5).toInt() == dest)
                    {
                        static int linecnt = 0;
                        do
                        {
                            line = f.readLine().trimmed();
                            if (line.length() > 0)
                            {
                                switch (step)
                                {
                                case 0:
                                    dataout << "type=copy" + casssource[0].append('\n');
                                    linecnt = 1;
                                    break;
                                case 1:
                                    dataout << "Slots=" + casssource[1].append('\n');
                                    break;
                                case 2:
                                    dataout << "First slot=" + casssource[2].append('\n');
                                    break;
                                case 3:
                                    dataout << "Slot distance=" + casssource[3].append('\n');
                                    break;
                                case 4:
                                    dataout << "Wafer Height Offset=" +
                                               casssource[6].append('\n');
                                    break;
                                case 5:
                                    dataout << "Finger Height Offset=" +
                                               casssource[7].append('\n');
                                    break;
                                case 6:
                                    dataout << "Slotsizewindow=" + casssource[4].append('\n');
                                    break;
                                case 7:
                                    dataout << "Wafersizewindow=" + casssource[5].append('\n');
                                    break;
                                case 8:
                                    dataout << "Flat=" + casssource[8].append('\n');
                                    break;
                                case 9:
                                    dataout << "Glas=" + casssource[9].append('\n');
                                    break;
                                }
                                step++;
                            }
                            else
                            {
                                if (linecnt == 1)
                                {
                                    dataout << "Slots=" + casssource[1].append('\n');
                                    dataout << "First slot=" + casssource[2].append('\n');
                                    dataout << "Slot distance=" + casssource[3].append('\n');
                                    dataout << "Wafer Height Offset=" + casssource[6].append('\n');
                                    dataout << "Finger Height Offset=" + casssource[7].append('\n');
                                    dataout << "Slotsizewindow=" + casssource[4].append('\n');
                                    dataout << "Wafersizewindow=" + casssource[5].append('\n');
                                    dataout << "Flat=" + casssource[8].append('\n');
                                    dataout << "Glas=" + casssource[9].append('\n');
                                    dataout << '\n';
                                    linecnt = 2;
                                }
                                else
                                {
                                    dataout << line.append('\n');
                                    linecnt = 0;
                                }
                            }
                        }
                        while (step < 8 && linecnt != 2);
                    }
                }
            } else dataout << line;
        }
    }
    if (QFile::exists(renameINIFILE)) QFile::remove(renameINIFILE); // letztes Inssetup.0 wird entfernt
    if (!f.rename(renameINIFILE)) fehler = 2;
    if (!f2.rename(DEFAULTINIFILE)) fehler = 2;
    if (f2.exists()) f2.close();
    if (f.exists()) f.close();
    SETUP_CASStype(1);
    SETUP_FILE_partCASS(dest);
}
void MainWindow::SETUP_FILE_partLIFT(int liftnr) // liest LIFT INI-Daten neu in die Maske ein
{
    float tmpReso;
    float val;
    QString linestr;

    FILE2OPEN = DEFAULTINIFILE;
    QFile f(FILE2OPEN);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text))
        err_msgbox("open Inssetup.INI failed");
    line.clear();
    if (store) {
        EEPROM.clear();     // alte Arraydaten löschen
        EEPROM.append("_"); // Startzeichen zur Delimiter Abgrenzung
        t_part_clear();
    }
    while (!f.atEnd()) {
        line = f.readLine();
        if (line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            if (line.mid(1, 5) == "Lift1" && liftnr == 1) {
                do {
                    line = f.readLine();
                    linestr =
                            line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                    if (line.mid(0, line.indexOf('=')).toLower() == "lift present") {
                        //    qDebug()<<line.mid(line.indexOf('=')+1,line.indexOf('\n')).trimmed().toInt(&ok,10);
                        ui->check_lift1_deactivate->setChecked(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n'))
                                    .trimmed()
                                    .toInt(&ok, 10));
                        if (line.mid(line.indexOf("=") + 1, 1) == "1") {
                            ui->check_lift1_deactivate->setChecked(1);

                        } else if (line.mid(line.indexOf("=") + 1, 1) == "0") {
                            ui->check_lift1_deactivate->setChecked(0);
                        }
                        tempwc1.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "wafersensor height") {
                        tmpReso = getResolution("Lift1 height motor").toFloat();
                        val = linestr.toFloat(&ok) / tmpReso;
                        ui->line_lift1_wafersensor_height_mm->setText(QString::number(val, 'f', 3));
                        ui->line_lift1_wafersensor_height->setText(linestr);
                        tempwc2.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "unload operator height")
                    {
                        tmpReso = getResolution("Lift1 height motor").toFloat();
                        val = linestr.toFloat(&ok) / tmpReso;
                        ui->line_lift1_unload_height_mm->setText(QString::number(val, 'f', 3));
                        ui->line_lift1_unload_height->setText(linestr);
                        tempwc3.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "xy-loader height")
                    {
                        tmpReso = getResolution("Lift1 height motor").toFloat();
                        val = linestr.toFloat(&ok) / tmpReso;
                        ui->line_lift1_xyloader_height_mm->setText(QString::number(val, 'f', 3));
                        ui->line_lift1_xyloader_height->setText(linestr);
                        tempwc4.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "measuring unit height")
                    {
                        tmpReso = getResolution("Lift1 height motor").toFloat();
                        val = linestr.toFloat(&ok) * tmpReso;
                        ui->line_lift1_measuring_height->setText(QString::number(qRound(val)));
                        ui->line_lift1_measuring_height_mm->setText(linestr);
                        tempwc5.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "tilt present")
                    {
                        tempwc6.append(linestr.toLatin1());
                        if (line.mid(line.indexOf("=") + 1, 1) == "1")
                        {
                            ui->label_Tilt1Present->setStyleSheet("background-color: green");
                            ui->check_tilt1_deactivate->setText("deactivate");
                            ui->check_tilt1_deactivate->setChecked(1);
                        }
                        else
                        {
                            ui->label_Tilt1Present->setStyleSheet("background-color: Red");
                            ui->check_tilt1_deactivate->setText("activate");
                            ui->check_tilt1_deactivate->setChecked(0);
                        }
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "tilt on position")
                    {
                        tmpReso = getResolution("Lift1 tilt motor").toFloat();
                        val = linestr.toFloat(&ok) / tmpReso;
                        ui->line_lift1_tiltactpos_mm->setText(QString::number(val, 'f', 3));
                        ui->line_lift1_tiltactpos->setText(linestr);
                        tempwc7.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "tilt off position")
                    {
                        tmpReso = getResolution("Lift1 tilt motor").toFloat();
                        val = linestr.toFloat(&ok) / tmpReso;
                        ui->line_lift1_tiltinactpos_mm->setText(QString::number(val, 'f', 3));
                        ui->line_lift1_tiltinactpos->setText(linestr);
                        tempwc8.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "wafertype")
                    {
                     //   ui->radio_lift1_thinwafer->setChecked((linestr.toInt(&ok, 10)));
                        tempwc9.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "smif")
                    {
                        //    qDebug()<<"SMIF linestr"<<linestr;
                        if (ui->radio_lift1_SMIF->isChecked())
                        {
                            qDebug() << "indexOf(ui->smif)" << ui->tabWidget->indexOf(ui->smif);
                            if (ui->tabWidget->indexOf(ui->smif) == -1)
                                ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->smif),ui->smif, "SMIF");
                            ui->p_lift1_SMIF->show();
                            ui->combo_lift1_SMIF_select->setCurrentText(linestr);
                            QString tmpsmif = linestr;
                            //    qDebug()<<"SMIF tmpsmif"<<tmpsmif;
                            if (linestr.contains("none")) SMIFTYPE1 = "0";
                            else if (linestr.contains("ISE 200")) SMIFTYPE1 = "1";
                            else if (tmpsmif.contains("ISE 150")) SMIFTYPE1 = "2";
                            else if (tmpsmif.contains("ISE 100")) SMIFTYPE1 = "3";
                            else if (tmpsmif.contains("ASYST 200")) SMIFTYPE1 = "4";
                            else if (tmpsmif.contains("ASYST 150")) SMIFTYPE1 = "5";
                        }
                        else
                        {
                            ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->smif));
                            SMIFTYPE1 = "0";
                        }
                        //    qDebug()<<"SMIF SMIFTYPE1"<<SMIFTYPE1;
                        tempwc14.append(SMIFTYPE1.toLatin1()); // #### Reihenfolge noch nicht in RAC definiert
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "4\" cassette nr")
                    {
                        ui->combo_4inchsel->setCurrentText(linestr);
                        tempwc10.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "5\" cassette nr")
                    {
                        ui->combo_5inchsel->setCurrentText(linestr);
                        tempwc11.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "6\" cassette nr")
                    {
                        ui->combo_6inchsel->setCurrentText(linestr);
                        tempwc12.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "8\" cassette nr")
                    {
                        ui->combo_8inchsel->setCurrentText(linestr);
                        tempwc13.append(linestr.toLatin1());
                    }
                }
                while (line.at(0) != '[');
            }
            else if (line.mid(1, 5) == "Lift2" && liftnr == 2)
            {
                do
                {
                    line = f.readLine();
                    linestr = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                    if (line.mid(0, line.indexOf('=')).toLower() == "lift present")
                    {
                        qDebug() << linestr.toInt(&ok, 10);
                        ui->check_lift2_deactivate->setChecked(linestr.toInt(&ok, 10));
                        if (line.mid(line.indexOf("=") + 1, 1) == "1")
                        {
                            ui->check_lift2_deactivate->setChecked(1);
                            ui->label_Lift2Present->setStyleSheet("background-color: green");
                            ui->check_lift2_deactivate->setText("deactivate");

                        } else if (line.mid(line.indexOf("=") + 1, 1) == "0")
                        {
                            ui->check_lift2_deactivate->setChecked(0);
                            ui->label_Lift2Present->setStyleSheet("background-color: red");
                            ui->check_lift2_deactivate->setText("activate");
                        }
                        tempwc1.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "wafersensor height")
                    {
                        tmpReso = getResolution("Lift2 height motor").toFloat();
                        val = linestr.toFloat(&ok) / tmpReso;
                        ui->line_lift2_wafersensor_height_mm->setText(QString::number(val, 'f', 3));
                        ui->line_lift2_wafersensor_height->setText(linestr);
                        tempwc2.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "unload operator height")
                    {
                        tmpReso = getResolution("Lift2 height motor").toFloat();
                        val = linestr.toFloat(&ok) / tmpReso;
                        ui->line_lift2_unload_height_mm->setText(QString::number(val, 'f', 3));
                        ui->line_lift2_unload_height->setText(linestr);
                        tempwc3.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "xy-loader height")
                    {
                        tmpReso = getResolution("Lift2 height motor").toFloat();
                        val = linestr.toFloat(&ok) / tmpReso;
                        ui->line_lift2_xyloader_height_mm->setText(QString::number(val, 'f', 3));
                        ui->line_lift2_xyloader_height->setText(linestr);
                        tempwc4.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "measuring unit height")
                    {
                        tmpReso = getResolution("Lift2 height motor").toFloat();
                        val = linestr.toFloat(&ok) * tmpReso;
                        ui->line_lift2_measuring_height->setText(QString::number(qRound(val)));
                        ui->line_lift2_measuring_height_mm->setText(linestr);
                        tempwc5.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "tilt present")
                    {
                        tempwc6.append(linestr.toLatin1());
                        if (line.mid(line.indexOf("=") + 1, 1) == "1") {
                            ui->label_Tilt2Present->setStyleSheet("background-color: green");
                            ui->check_tilt2_deactivate->setText("deactivate");
                            ui->check_tilt2_deactivate->setChecked(1);
                        }
                        else
                        {
                            ui->label_Tilt2Present->setStyleSheet("background-color: Red");
                            ui->check_tilt2_deactivate->setText("activate");
                            ui->check_tilt2_deactivate->setChecked(0);
                        }
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "tilt on position")
                    {
                        tmpReso = getResolution("Lift2 tilt motor").toFloat();
                        val = linestr.toFloat(&ok) / tmpReso;
                        ui->line_lift2_tiltactpos_mm->setText(QString::number(val, 'f', 3));
                        ui->line_lift2_tiltactpos->setText(linestr);
                        tempwc7.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "tilt off position")
                    {
                        tmpReso = getResolution("Lift2 tilt motor").toFloat();
                        val = linestr.toFloat(&ok) / tmpReso;
                        ui->line_lift2_tiltinactpos_mm->setText(QString::number(val, 'f', 3));
                        ui->line_lift2_tiltinactpos->setText(linestr);
                        tempwc8.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "wafertype")
                    {
                     //   ui->radio_lift2_thinwafer->setChecked(linestr.toInt(&ok, 10));
                        tempwc9.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "smif")
                    {
                        if (ui->radio_lift2_SMIF->isChecked()) {
                            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->smif),ui->smif, "SMIF");
                            ui->p_lift2_SMIF->show();
                            ui->combo_lift2_SMIF_select->setCurrentText(linestr);
                            QString tmpsmif = linestr;
                            if (tmpsmif.contains("none")) SMIFTYPE2 = "0";
                            else if (tmpsmif.contains("ISE 200")) SMIFTYPE2 = "1";
                            else if (tmpsmif.contains("ISE 150")) SMIFTYPE2 = "2";
                            else if (tmpsmif.contains("ISE 100")) SMIFTYPE2 = "3";
                            else if (tmpsmif.contains("ASYST 200")) SMIFTYPE2 = "4";
                            else if (tmpsmif.contains("ASYST 150")) SMIFTYPE2 = "5";
                        }
                        else
                        {
                            ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->smif));
                            SMIFTYPE2 = "0";
                        }
                        tempwc14.append(SMIFTYPE2.toLatin1()); // #### Reihenfolge noch nicht in RAC definiert
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "4\" cassette nr")
                    {
                        ui->combo_lift2_4inchsel->setCurrentText(linestr);
                        tempwc10.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "5\" cassette nr")
                    {
                        ui->combo_lift2_5inchsel->setCurrentText(linestr);
                        tempwc11.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "6\" cassette nr")
                    {
                        ui->combo_lift2_6inchsel->setCurrentText(linestr);
                        tempwc12.append(linestr.toLatin1());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "8\" cassette nr")
                    {
                        ui->combo_lift2_8inchsel->setCurrentText(linestr);
                        tempwc13.append(linestr.toLatin1());
                    }
                } while (line.at(0) != '[');
            }
        }
    }
    f.close();
    qDebug() << "<<<<<<<cmdaktiv<<<<<<<<<5" << ui->tabWidget->currentIndex();
    if (store) {
        t_part_ee(14);
        QByteArray tmpEEPROM = EEPROM;
        char delimiter1[] = "_#";
        char *token;
        QString tmp;
        int tmpf = 0;
        char *charptr = tmpEEPROM.data();
        int checksum = 0;

        token = strtok(charptr, delimiter1); // erstes Zeichen entfernen
        //        qDebug()<<"token1 "<<token;
        tmp = token;
        checksum = tmp.toFloat();
        while (token) // token wird zerlegt bis \0
        {
            token = strtok(NULL, delimiter1);
            qDebug() << "token2 " << token;
            tmp = token;
            tmpf = tmp.toFloat();
            //     qDebug()<<tmpf;
            checksum += tmpf;
            //    qDebug()<<checksum;
        }
        //        qDebug()<< QString::number(checksum);
        EEPROM.append('!');
        EEPROM.append(QString::number(checksum).toLatin1());
        EEPROM.append("\r");
        //        qDebug()<< EEPROM;
        QByteArray arr = EEPDATA0;           // "$PSET_1="
        arr.append(QString::number(liftnr).toLatin1()); // ID Lift1 ist 1
        arr.append("\r\n");
        serialSendFeeder(arr);
        store = 0;
        cmdaktiv = 1;
        qDebug() << "<<<<<<<cmdaktiv<<<<<<<<<4" << ui->tabWidget->currentIndex();
    }
}
void MainWindow::SETUP_FILE_partPA() // liest PA INI-Daten in die Maske ein
{
    float tmpResoPAH;
    float tmpResoPAP;
    float tmpResoWOR;
    float tmpResoWOT; // wob phi motor (Schneckenantrieb)
    float val;
    QString linestr;

    FILE2OPEN = DEFAULTINIFILE;
    QFile f(FILE2OPEN);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text))
        return;
    line.clear();
    if (store) {
        EEPROM.clear();     // alte Arraydaten löschen
        EEPROM.append("_"); // Startzeichen zur Delimiter Abgrenzung
        t_part_clear();
    }
    while (!f.atEnd()) {
        line = f.readLine();
        if (line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            if (line.mid(1, 10) == "Prealigner") {
                tmpResoPAH = getResolution("Prealigner height motor").toFloat();
                tmpResoPAP = getResolution("Prealigner phi motor").toFloat();
                tmpResoWOT = getResolution("Wobbler phi motor").toFloat();
                tmpResoWOR = getResolution("Wobbler rotation motor").toFloat();
                qDebug() << "read INI-Value Prealigner height motor" << tmpResoPAH;
                qDebug() << "read INI-Value Prealigner phi motor" << tmpResoPAP;
                qDebug() << "read INI-Value Wobbler phi motor" << tmpResoWOT;
                qDebug() << "read INI-Value Wobbler rotation motor" << tmpResoWOR;

                do {
                    line = f.readLine();
                    linestr =
                            line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                    if (line.mid(0, line.indexOf('=')).toLower() == "wobbler present")
                    {
                        if (line.mid(line.indexOf("=") + 1, 1) == "1")
                        {
                            ui->check_wob_deactiv->setChecked(1);
                            on_check_wob_deactiv_toggled(1);
                            ui->frame_wobble->setDisabled(0);
                            ui->p_INIT_PA_Tilt->setDisabled(0);
                            ui->p_INIT_PA_RotPos->setDisabled(0);
                            ui->frame_pa_rot->setDisabled(0);
                            ui->frame_pa_tilt->setDisabled(0);
                        }
                        else if (line.mid(line.indexOf("=") + 1, 1) == "0")
                        {
                            ui->check_wob_deactiv->setChecked(0);
                            on_check_wob_deactiv_toggled(0);
                            ui->frame_wobble->setDisabled(1);
                            ui->p_INIT_PA_Tilt->setDisabled(1);
                            ui->p_INIT_PA_RotPos->setDisabled(1);
                            ui->frame_pa_rot->setDisabled(1);
                            ui->frame_pa_tilt->setDisabled(1);
                        }
                        tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "below lo height")
                    {
                        val = linestr.toFloat(&ok) / tmpResoPAH;
                        ui->line_belowloader_3->setText(QString::number(val, 'f', 3));
                        ui->line_belowloader->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc2.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "below lo height thin")
                    {
                        // val = linestr.toFloat(&ok) / tmpResoPAH;
                        // ui->line_belowloaderthin_2->setText(QString::number(val, 'f', 3));
                        // ui->line_belowloaderthin->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc3.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lo height")
                    {
                        val = linestr.toFloat(&ok) / tmpResoPAH;
                        ui->line_loaderheight_3->setText(QString::number(val, 'f', 3));
                        ui->line_loaderheight->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc4.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "above lo height thin")
                    {
                        // val = linestr.toFloat(&ok) / tmpResoPAH;
                        // ui->line_aboveloaderthin_2->setText(QString::number(val, 'f', 3));
                        // ui->line_aboveloaderthin->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc5.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "above lo height")
                    {
                        val = linestr.toFloat(&ok) / tmpResoPAH;
                        ui->line_aboveloader_3->setText(QString::number(val, 'f', 3));
                        ui->line_aboveloader->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc6.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "pa height")
                    {
                        val = linestr.toFloat(&ok) / tmpResoPAH;
                        ui->line_preaheight_3->setText(QString::number(val, 'f', 3));
                        ui->line_preaheight->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc7.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "ch height")
                    {
                        val = linestr.toFloat(&ok) / tmpResoPAH;
                        ui->line_chuckheight_3->setText(QString::number(val, 'f', 3));
                        ui->line_chuckheight->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc8.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "wo angle")
                    {
                        val = linestr.toFloat(&ok) / tmpResoWOT;
                        qDebug() << "set wo angle" << tmpResoWOT << "linestr" << linestr
                                 << "val" << val;
                        ui->line_wobbtiltangle_3->setText(QString::number(val, 'f', 3));
                        ui->line_wobbtiltangle->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc9.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "wo rotational position") {
                        val = linestr.toFloat(&ok) / tmpResoWOR;
                        qDebug() << "set wo rotational position" << tmpResoWOR << "linestr"
                                 << linestr << "val" << val;
                        ui->line_wobrotpos_3->setText(QString::number(val, 'f', 3));
                        ui->line_wobrotpos->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc10.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "measurement present") {
                        if (line.mid(line.indexOf('=') + 1, 1) == "1")
                            ui->check_measureused->setChecked(1);
                        else
                            ui->check_measureused->setChecked(0);
                        tempwc11.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "pa angle") {
                        val = linestr.toFloat(&ok) / tmpResoPAP;
                        ui->line_preasensangle_3->setText(QString::number(val, 'f', 3));
                        ui->line_preasensangle->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc12.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "pa precount") {
                        val = linestr.toFloat(&ok) / tmpResoPAP;
                        ui->line_preaprecount_3->setText(QString::number(val, 'f', 3));
                        ui->line_preaprecount->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc13.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "pa count") {
                        val = linestr.toFloat(&ok) / tmpResoPAP;
                        ui->line_preacount_3->setText(QString::number(val, 'f', 3));
                        ui->line_preacount->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc14.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "pa postcount") {
                        val = linestr.toFloat(&ok) / tmpResoPAP;
                        ui->line_preapostcount_3->setText(QString::number(val, 'f', 3));
                        ui->line_preapostcount->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc15.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "align to front") {
                        qDebug() << "read align to front"
                                 << line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed();
                        ui->line_wobphispeed->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc16.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "reader displacement")
                    {
                        ui->line_readdispl->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc17.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "wobbler displacement")
                    {
                        ui->line_wobbdispl->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc18.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "normal displacement")
                    {
                        ui->line_normaldispl->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc19.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "profilecalibration")
                    {
                        if (line.mid(line.indexOf('=') + 1, 1) == "1") ui->check_profilecalib->setChecked(1);
                        else ui->check_profilecalib->setChecked(0);
                        tempwc20.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "slitlength") {
                        ui->line_slitlenght->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc21.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                }
                while (line.at(0) != '[');
            }
        }
    }
    f.close();
    if (store) {
        t_part_ee(21);
        QByteArray tmpEEPROM = EEPROM;
        char delimiter1[] = "_#";
        char *token;
        QString tmp;
        int tmpf = 0;
        char *charptr = tmpEEPROM.data();
        int checksum = 0;

        token = strtok(charptr, delimiter1); // erstes Zeichen entfernen
        qDebug() << "token1 " << token;
        tmp = token;
        checksum = tmp.toFloat();
        while (token) // token wird zerlegt bis \0
        {
            token = strtok(NULL, delimiter1);
            qDebug() << "token2 " << token;
            tmp = token;
            tmpf = tmp.toFloat();
            qDebug() << tmpf;
            checksum += tmpf;
            qDebug() << checksum;
        }
        qDebug() << QString::number(checksum);
        EEPROM.append('!');
        EEPROM.append(QString::number(checksum).toLatin1());
        EEPROM.append("\r");
        qDebug() << EEPROM;
        QByteArray arr = EEPDATA0;
        arr.append("20"); // Prealigner
        arr.append("\r\n");
        serialSendFeeder(arr);
        store = 0;
        cmdaktiv = 1;
    }
}
void MainWindow::SETUP_FILE_partWC() // liest WC INI-Daten in die Maske ein
{
    float tmpResoWCH;
    float tmpResoWCP;
    float val;
    QString linestr;

    FILE2OPEN = DEFAULTINIFILE;
    QFile f(FILE2OPEN);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text))
        return;
    line.clear();
    if (store) {
        EEPROM.clear();     // alte Arraydaten löschen
        EEPROM.append("_"); // Startzeichen zur Delimiter Abgrenzung
        t_part_clear();
    }
    while (!f.atEnd()) {
        line = f.readLine();
        if (line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            if (line.mid(0, 14) == "[Waferchanger]") {
                tmpResoWCH = getResolution("Waferchanger height motor").toFloat();
                tmpResoWCP = getResolution("Waferchanger phi motor").toFloat();

                do
                {
                    line = f.readLine();
                    linestr = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                    if (line.mid(0, line.indexOf('=')).toLower() == "above ch height thin")
                    {
                        // val = linestr.toFloat(&ok) / tmpResoWCH;
                        // ui->line_wc_thin_3->setText(QString::number(val, 'f', 3));
                        // ui->line_wc_thin->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc2.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "above ch height")
                    {
                        val = linestr.toFloat(&ok) / tmpResoWCH;
                        ui->line_wc_abovechuckheight_4->setText(QString::number(val, 'f', 3));
                        ui->line_wc_abovechuckheight->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc3.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "ch height")
                    {
                        val = linestr.toFloat(&ok) / tmpResoWCH;
                        ui->line_wc_chuckheight_4->setText(QString::number(val, 'f', 3));
                        ui->line_wc_chuckheight->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc4.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "below ch height")
                    {
                        val = linestr.toFloat(&ok) / tmpResoWCH;
                        ui->line_wc_belowchuckheight_3->setText(QString::number(val, 'f', 3));
                        ui->line_wc_belowchuckheight->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc5.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "ch free height")
                    {
                        // ui->line_wc_chuckfreeheight->setText(line.mid(line.indexOf('=')+1,line.indexOf('\n')).trimmed());
                        tempwc6.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "left position")
                    {
                        val = linestr.toFloat(&ok) / tmpResoWCP;
                        ui->line_wc_leftpos_4->setText(QString::number(val, 'f', 3));
                        ui->line_wc_leftpos->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc7.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "middle position")
                    {
                        val = linestr.toFloat(&ok) / tmpResoWCP;
                        ui->line_wc_middlepos_4->setText(QString::number(val, 'f', 3));
                        ui->line_wc_middlepos->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc8.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "right position")
                    {
                        val = linestr.toFloat(&ok) / tmpResoWCP;
                        ui->line_wc_rightpos_3->setText(QString::number(val, 'f', 3));
                        ui->line_wc_rightpos->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc9.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lo height")
                    {
                        //    ui->line_wc_loheight->setText(line.mid(line.indexOf('=')+1,line.indexOf('\n')).trimmed());
                        tempwc10.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "waferchanger present")
                    {
                        if (line.mid(line.indexOf("=") + 1, 1) == "1")
                        {
                            ui->check_wc_deactivate->setChecked(1);
                        }
                        else if (line.mid(line.indexOf("=") + 1, 1) == "0")
                        {
                            ui->check_wc_deactivate->setChecked(0);
                        }
                        tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                }
                while (line.at(0) != '[');
                set_WCangle();
            }
        }
    }
    f.close();
    if (store) {
        t_part_ee(10);
        QByteArray tmpEEPROM = EEPROM;
        char delimiter1[] = "_#";
        char *token;
        QString tmp;
        int tmpf = 0;
        char *charptr = tmpEEPROM.data();
        int checksum = 0;

        token = strtok(charptr, delimiter1); // erstes Zeichen entfernen
        qDebug() << "token1 " << token;
        tmp = token;
        checksum = tmp.toFloat();
        while (token) // token wird zerlegt bis \0
        {
            token = strtok(NULL, delimiter1);
            qDebug() << "token2 " << token;
            tmp = token;
            tmpf = tmp.toFloat();
            qDebug() << tmpf;
            checksum += tmpf;
            qDebug() << checksum;
        }
        qDebug() << QString::number(checksum);
        EEPROM.append('!');
        EEPROM.append(QString::number(checksum).toLatin1());
        EEPROM.append("\r");
        qDebug() << EEPROM;
        QByteArray arr = EEPDATA0;
        arr.append("21"); // ID für WC
        arr.append("\r\n");
        serialSendFeeder(arr);
        store = 0;
        cmdaktiv = 1;
    }
}
void MainWindow::SETUP_FILE_partLD() // liest LD INI-Daten neu in die Maske ein
{
    float tmpResoLDX;
    float tmpResoLDY;
    float val;
    QString linestr;

    FILE2OPEN = DEFAULTINIFILE;
    QFile f(FILE2OPEN);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text))
        return;
    line.clear();
    if (store) {
        EEPROM.clear();     // alte Arraydaten löschen
        EEPROM.append("_"); // Startzeichen zur Delimiter Abgrenzung
        t_part_clear();
    }
    while (!f.atEnd()) {
        line = f.readLine();
        if (line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            if (line.mid(1, 6) == "Loader") {
                tmpResoLDX = getResolution("Loader x - motor").toFloat();
                tmpResoLDY = getResolution("Loader y - motor").toFloat();

                do {
                    line = f.readLine();
                    linestr = line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed();
                    if (line.mid(0, line.indexOf('=')).toLower() == "x-l1 position")
                    {
                        val = linestr.toFloat(&ok) / tmpResoLDX;
                        ui->line_loader_xlift1pos_3->setText(QString::number(val, 'f', 3));
                        ui->line_loader_xlift1pos->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "x-l2 position")
                    {
                        val = linestr.toFloat(&ok) / tmpResoLDX;
                        ui->line_loader_xlift2pos_3->setText(QString::number(val, 'f', 3));
                        ui->line_loader_xlift2pos->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc2.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "x-pa free position")
                    {
                        val = linestr.toFloat(&ok) / tmpResoLDX;
                        ui->line_loader_xpreafreepos_3->setText(QString::number(val, 'f', 3));
                        ui->line_loader_xpreafreepos->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc3.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "x-pa position")
                    {
                        val = linestr.toFloat(&ok) / tmpResoLDX;
                        ui->line_loader_xpreapos_3->setText(QString::number(val, 'f', 3));
                        ui->line_loader_xpreapos->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc4.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "y-l1 position")
                    {
                        val = linestr.toFloat(&ok) / tmpResoLDX;
                        ui->line_loader_ylift1inpos_3->setText(QString::number(val, 'f', 3));
                        ui->line_loader_ylift1inpos->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc5.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "y-l2 position")
                    {
                        val = linestr.toFloat(&ok) / tmpResoLDX;
                        ui->line_loader_ylift2inpos_3->setText(QString::number(val, 'f', 3));
                        ui->line_loader_ylift2inpos->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc6.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "y-pa position")
                    {
                        val = linestr.toFloat(&ok) / tmpResoLDY;
                        ui->line_loader_ypreapos_3->setText(QString::number(val, 'f', 3));
                        ui->line_loader_ypreapos->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc7.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "y-out lift position")
                    {
                        val = linestr.toFloat(&ok) / tmpResoLDY;
                        ui->line_loader_youtlift_3->setText(QString::number(val, 'f', 3));
                        ui->line_loader_youtlift->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc8.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "y-in lift displacement")
                    {
                        ui->line_loader_yliftdispl->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc9.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "6\" cassette displacement")
                    {
                        //  ui->line_loader_yliftdispl->setText(line.mid(line.indexOf('=')+1,line.indexOf('\n')).trimmed());
                        tempwc10.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                }
                while (line.at(0) != '[');
            }
        }
    }
    f.close();
    if (store) {
        t_part_ee(10);
        QByteArray tmpEEPROM = EEPROM;
        char delimiter1[] = "_#";
        char *token;
        QString tmp;
        int tmpf = 0;
        char *charptr = tmpEEPROM.data();
        int checksum = 0;

        token = strtok(charptr, delimiter1); // erstes Zeichen entfernen
        tmp = token;
        checksum = tmp.toFloat();
        qDebug() << "token LD" << token << "part checksum" << checksum;
        while (token) // token wird zerlegt bis \0
        {
            token = strtok(NULL, delimiter1);
            tmp = token;
            tmpf = tmp.toFloat();
            checksum += tmpf;
            qDebug() << "token LD" << token << "part checksum" << checksum;
        }
        qDebug() << "complete checksum" << QString::number(checksum);
        EEPROM.append('!');
        EEPROM.append(QString::number(checksum).toLatin1());
        EEPROM.append("\r");
        qDebug() << EEPROM;
        QByteArray arr = EEPDATA0;
        arr.append("19"); // ID für LD
        arr.append("\r\n");
        serialSendFeeder(arr);
        store = 0;
        cmdaktiv = 1;
    }
}
void MainWindow::SETUP_FILE_partVAC(bool store) // liest Vacuum INI-Daten und speicher in INSBox EPROM
{
    FILE2OPEN = DEFAULTINIFILE;
    QFile f(FILE2OPEN);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
    line.clear();
    if (store) // Buffer löschen
    {
        EEPROM.clear();     // alte Arraydaten löschen
        EEPROM.append("_"); // Startzeichen zur Delimiter Abgrenzung
        t_part_clear();
    }
    while (!f.atEnd()) // Vac data einlesen und an Buffer anhängen
    {
        line = f.readLine();
        if (line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            if (line.mid(1, 6) == "Vacuum")
            {
                do
                {
                    line = f.readLine();

                    if (line.mid(0, line.indexOf('=')).toLower() == "check vacuum") // INSBox EPROM
                    {
                        if (line.mid(line.indexOf("=") + 1, 1) == "1") ui->check_vac_checkvac->setChecked(1);
                        else if (line.mid(line.indexOf("=") + 1, 1) == "0") ui->check_vac_checkvac->setChecked(0);
                        tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "check main vacuum") // INSBox EPROM
                    {
                        if (line.mid(line.indexOf("=") + 1, 1) == "1") ui->check_vac_checkmainvac->setChecked(1);
                        else if (line.mid(line.indexOf("=") + 1, 1) == "0") ui->check_vac_checkmainvac->setChecked(0);
                        tempwc2.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "main vacuum polltime")
                    {
                        ui->line_vac_polltime->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        // tempwc3.append("0");
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck sequence") // Chuck vakuum Schaltreihenfolge 8-6-4"
                    {
                        if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "1") ui->check_vac_sequence->setChecked(1);
                        else ui->check_vac_sequence->setChecked(0);
                        tempwc3.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "use chuck 6\" vacuum") // INSBox EPROM
                    {
                        if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "Y" ||
                            line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "1")
                            ui->check_vac_use6inch->setChecked(1);
                        else ui->check_vac_use6inch->setChecked(0);
                        tempwc4.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "use chuck 8\" vacuum") // INSBox EPROM
                    {
                        if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "Y" ||
                            line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "1")
                            ui->check_vac_use8inch->setChecked(1);
                        else ui->check_vac_use8inch->setChecked(0);
                        tempwc5.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lowld")
                    {
                        ui->line_vac_LD_ThrsON_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc6.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lowpa")
                    {
                        ui->line_vac_PA_ThrsON_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc7.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lowch")
                    {
                        ui->line_vac_CH4_ThrsON_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc8.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lowwc1")
                    {
                        ui->line_vac_WC1_ThrsON_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc9.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lowwc2")
                    {
                        ui->line_vac_WC2_ThrsON_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc10.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "semi friction")
                    {
                        if (line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed() == "1") ui->check_vac_lowactive->setChecked(1);
                        else ui->check_vac_lowactive->setChecked(0);
                        tempwc11.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "main on threshold")
                    {
                        ui->line_vac_MainVac_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc12.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "retry")
                    {
                        if(line.mid(line.indexOf("=") + 1, 1) == "1") ui->check_vac_rety->setChecked(1);
                        else if(line.mid(line.indexOf("=") + 1, 1) == "0") ui->check_vac_rety->setChecked(0);
                        tempwc13.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "changer left off threshold")
                    {
                        ui->line_vac_WC1_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc17.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "changer right pulstime")
                    {
                        ui->line_vac_WC2_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc18.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "changer right timeout")
                    {
                        ui->line_vac_WC2_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc19.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "changer right on threshold")
                    {
                        ui->line_vac_WC2_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc20.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "changer right off threshold")
                    {
                        ui->line_vac_WC2_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());    //   tempwc21.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner pulstime")
                    {
                        ui->line_vac_PA_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc22.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner timeout")
                    {
                        ui->line_vac_PA_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc23.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner on threshold")
                    {
                        ui->line_vac_PA_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc24.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "prealigner off threshold")
                    {
                        ui->line_vac_PA_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc25.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" pulstime")
                    {
                        ui->line_vac_CH4_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc26.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" timeout")
                    {
                        ui->line_vac_CH4_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc27.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" on threshold")
                    {
                        ui->line_vac_CH4_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc28.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 4\" off threshold")
                    {
                        ui->line_vac_CH4_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc29.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" pulstime")
                    {
                        ui->line_vac_CH6_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc30.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" timeout")
                    {
                        ui->line_vac_CH6_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc31.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" on threshold")
                    {
                        ui->line_vac_CH6_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc32.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 6\" off threshold")
                    {
                        ui->line_vac_CH6_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc33.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" pulstime")
                    {
                        ui->line_vac_CH8_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc34.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" timeout")
                    {
                        ui->line_vac_CH8_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc35.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" on threshold")
                    {
                        ui->line_vac_CH8_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        //   tempwc36.append(line.mid(line.indexOf("=")+1,line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "chuck 8\" off threshold")
                    {
                        ui->line_vac_CH8_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "main pulstime")
                    {
                        ui->line_vac_MainVac_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "main timeout")
                    {
                        ui->line_vac_MainVac_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "main on threshold")
                    {
                        ui->line_vac_MainVac_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "main off threshold")
                    {
                        ui->line_vac_MainVac_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "default pulstime")
                    {
                        ui->line_vac_default_puls->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "default timeout")
                    {
                        ui->line_vac_default_Timeout->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "default on threshold")
                    {
                        ui->line_vac_default_ThrsON->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "default off threshold")
                    {
                        ui->line_vac_default_ThrsOFF->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                    }                   
                }
                while (line.at(0) != '[');
            }
        }
    }
    f.close();
    if (store)
    {
        t_part_ee(13);
        QByteArray tmpEEPROM = EEPROM;
        char delimiter1[] = "_#";
        char *token;
        QString tmp;
        int tmpf = 0;
        char *charptr = tmpEEPROM.data();
        int checksum = 0;

        token = strtok(charptr, delimiter1); // erstes Zeichen entfernen
        qDebug() << "token1 " << token;
        tmp = token;
        checksum = tmp.toFloat();
        while (token) // token wird zerlegt bis \0
        {
            token = strtok(NULL, delimiter1);
            qDebug() << "token2 " << token;
            tmp = token;
            tmpf = tmp.toFloat();
            qDebug() << tmpf;
            checksum += tmpf;
            qDebug() << checksum;
        }
        qDebug() << QString::number(checksum);
        EEPROM.append('!');
        EEPROM.append(QString::number(checksum).toLatin1());
        EEPROM.append("\r");
        qDebug() << EEPROM;
        QByteArray arr = EEPDATA0;
        arr.append("22,1"); // ID für VAC, 1=ins EE speichern
        arr.append("\r\n");
        serialSendFeeder(arr);
        cmdaktiv = 1;
    }
}
void MainWindow::SETUP_FILE_partLOCK(int liftnr, bool store) {
    FILE2OPEN = DEFAULTINIFILE;
    QFile f(FILE2OPEN);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text))
        err_msgbox("could not open Inssetup.INI file");
    line.clear();
    if (store) {
        EEPROM.clear();     // alte Arraydaten löschen
        EEPROM.append("_"); // Startzeichen zur Delimiter Abgrenzung
        t_part_clear();
    }
    while (!f.atEnd()) {
        line = f.readLine();
        if (line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            qDebug() << "line" << line.mid(1, line.indexOf("]") - 1);
            if (line.mid(1, line.indexOf("]") - 1) == "Liftlock1" && liftnr == 1) {
                do {
                    line = f.readLine();
                    qDebug() << line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed().toInt(&ok, 10);
                    if (line.mid(0, line.indexOf('=')).toLower() == "delaytime") {
                        ui->line_lock_delaytime->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "vacuumnumber") {
                        ui->line_lock_vacnumber->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc2.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "lockvoltage1") {
                        ui->line_lock_v1->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc3.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "lockvoltage2") {
                        ui->line_lock_v2->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc4.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "lockvoltage3") {
                        ui->line_lock_v3->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc5.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "lockvoltage4") {
                        ui->line_lock_v4->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc6.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "lockvoltage5") {
                        ui->line_lock_v5->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc7.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "unlockvoltage1") {
                        ui->line_unlock_v1->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc8.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "unlockvoltage2") {
                        ui->line_unlock_v2->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc9.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "unlockvoltage3") {
                        ui->line_unlock_v3->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc10.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "unlockvoltage4") {
                        ui->line_unlock_v4->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc11.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "unlockvoltage5") {
                        ui->line_unlock_v5->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc12.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                }
                while (line.at(0) != '[');
            }
            else if (line.mid(1, line.indexOf("]") - 1) == "Liftlock2" && liftnr == 2)
            {
                do
                {
                    line = f.readLine();
                    if (line.mid(0, line.indexOf('=')).toLower() == "delaytime")
                    {
                        qDebug() << line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed().toInt(&ok, 10);
                        ui->line_lock_delaytime_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc1.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "vacuumnumber")
                    {
                        ui->line_lock_vacnumber_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc2.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage1")
                    {
                        ui->line_lock_v1_2->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc3.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage2")
                    {
                        ui->line_lock_v2_2->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc4.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage3")
                    {
                        ui->line_lock_v3_2->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc5.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage4")
                    {
                        ui->line_lock_v4_2->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc6.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "lockvoltage5")
                    {
                        ui->line_lock_v5_2->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc7.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage1")
                    {
                        ui->line_unlock_v1_2->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc8.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage2")
                    {
                        ui->line_unlock_v2_2->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc9.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage3")
                    {
                        ui->line_unlock_v3_2->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc10.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage4")
                    {
                        ui->line_unlock_v4_2->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc11.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "unlockvoltage5")
                    {
                        ui->line_unlock_v5_2->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc12.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                }
                while (line.at(0) != '[');
            }
        }
    }
    f.close();
    if (store) {
        t_part_ee(12);
        QByteArray tmpEEPROM = EEPROM;
        char delimiter1[] = "_#";
        char *token;
        QString tmp;
        int tmpf = 0;
        char *charptr = tmpEEPROM.data();
        int checksum = 0;

        token = strtok(charptr, delimiter1); // erstes Zeichen entfernen
        qDebug() << "token1 " << token;
        tmp = token;
        checksum = tmp.toFloat();
        while (token) // token wird zerlegt bis \0
        {
            token = strtok(NULL, delimiter1);
            qDebug() << "token2 " << token;
            tmp = token;
            tmpf = tmp.toFloat();
            qDebug() << tmpf;
            checksum += tmpf;
            qDebug() << checksum;
        }
        qDebug() << QString::number(checksum);
        EEPROM.append('!');
        EEPROM.append(QString::number(checksum).toLatin1());
        EEPROM.append("\r");
        qDebug() << EEPROM;
        QByteArray arr = EEPDATA0;
        if (liftnr == 1)
            arr.append("24");
        else if (liftnr == 2)
            arr.append("25");
        arr.append("\r\n");
        serialSendFeeder(arr);
        cmdaktiv = 1;
    }
}
void MainWindow::SETUP_FILE_partWOBJOY() // liest WC INI-Daten in die Maske ein
{
    FILE2OPEN = DEFAULTINIFILE;
    QFile f(FILE2OPEN);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
    line.clear();
    if (store)
    {
        EEPROM.clear();     // alte Arraydaten löschen
        EEPROM.append("_"); // Startzeichen zur Delimiter Abgrenzung
        t_part_clear();
    }
    while (!f.atEnd())
    {
        line = f.readLine();
        if (line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            if (line.mid(0, 8) == "[WOBJOY]")
            {
                do
                {
                    line = f.readLine();
                    if (line.mid(0, line.indexOf('=')).toLower() == "low_tilt") {
                        ui->line_joy_tiltmin->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc1.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "up_tilt") {
                        ui->line_joy_tiltmax->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc2.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "low_rot") {
                        ui->line_joy_rotmin->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc3.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "up_rot") {
                        ui->line_joy_rotmax->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc4.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "thres") {
                        ui->line_joy_threshold->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc5.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "speed_tiltup") {
                        ui->line_joy_tiltspeedup->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc6.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "speed_tiltdwn") {
                        ui->line_joy_tiltspeeddown->setText(
                                    line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc7.append(
                                    line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "speed_rotcw")
                    {
                        ui->line_joy_rotCW->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc8.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "speed_rotccw")
                    {
                        ui->line_joy_rotCCW->setText(line.mid(line.indexOf('=') + 1, line.indexOf('\n')).trimmed());
                        tempwc9.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                    else if (line.mid(0, line.indexOf('=')).toLower() == "setwojoy")
                    {
                        int val = line.mid(line.indexOf("=") + 1, 1).toInt(&ok, 10);

                        if (val & 0b00010000) ui->checkBox_Xjoy_phi->setChecked(1);
                        else ui->checkBox_Xjoy_phi->setChecked(0);
                        if (val & 0b00100000) ui->checkBox_Xjoy_rotation->setChecked(1);
                        else ui->checkBox_Xjoy_rotation->setChecked(0);
                        if (val & 0b01000000) ui->checkBox_Xjoy_tilt->setChecked(1);
                        else ui->checkBox_Xjoy_tilt->setChecked(0);
                        if (val & 0b00000001) ui->checkBox_Yjoy_phi->setChecked(1);
                        else ui->checkBox_Yjoy_phi->setChecked(0);
                        if (val & 0b00000010) ui->checkBox_Yjoy_rotation->setChecked(1);
                        else ui->checkBox_Yjoy_rotation->setChecked(0);
                        if (val & 0b00000100) ui->checkBox_Yjoy_tilt->setChecked(1);
                        else ui->checkBox_Yjoy_tilt->setChecked(0);

                        tempwc10.append(line.mid(line.indexOf("=") + 1, line.indexOf('\n')).trimmed());
                    }
                } while (line.at(0) != ';');
            }
        }
    }
    f.close();
    if (store) {
        t_part_ee(10); // Anzahl der Parameter
        QByteArray tmpEEPROM = EEPROM;
        char delimiter1[] = "_#";
        char *token;
        QString tmp;    // int tmpf = 0;
        char *charptr = tmpEEPROM.data();
        int checksum = 0;

        token = strtok(charptr, delimiter1); // erstes Zeichen entfernen
        qDebug() << "token1 " << token;
        tmp = token;
        checksum = tmp.toInt(&ok, 10);
        while (token) // token wird zerlegt bis \0
        {
            token = strtok(NULL, delimiter1);
            qDebug() << "token2 " << token;
            tmp = token;    // tmpf = tmp.toFloat();
            checksum += tmp.toInt(&ok, 10);
            qDebug() << checksum;
        }
        qDebug() << QString::number(checksum);
        EEPROM.append('!');
        EEPROM.append(QString::number(checksum).toLatin1());
        EEPROM.append("\r");
        qDebug() << EEPROM;
        QByteArray arr = EEPDATA0;
        arr.append("28"); // ID für WOBJOY
        arr.append("\r\n");
        serialSendFeeder(arr);
        store = 0;
        cmdaktiv = 1;
    }
}
void MainWindow::on_p_SET_EE_STR_clicked() // speichert EE String-Messages ins EEPROM
{
    serialSendFeeder(SET_EE_STR);
}
void MainWindow::on_p_setup_comparesetup_clicked()
{

}
void MainWindow::on_p_setup_comparemotor_clicked()
{

}
QString MainWindow::getResolution(QString name) // liest Resolution einer Achse ein
{
    float resolution = 0.000000;
    QFile f1(MFILE2OPEN);
    if (!f1.open(QIODevice::ReadOnly | QIODevice::Text))
        return "-0";
    line.clear();
    while (!f1.atEnd()) {
        line = f1.readLine();
        if (line.at(0) == '[') // all Strings, die mit [ beginnen
        {
            if (line.mid(1, line.size() - 3) == name) {
                int end = 0;
                do {
                    line = f1.readLine();
                    if (line.mid(0, line.indexOf('=')).toLower() == "resolution") {
                        resolution =
                                line.mid(line.indexOf("=") + 1, line.indexOf("\n")).toFloat();
                        end = 1;
                    }
                } while (line.at(0) != ';' && line.at(0) != '[' && end == 0);
            }
        }
    }
    //    qDebug()<<"read resolution"<<name<< resolution<<
    //    QString::number(resolution);
    return QString::number(resolution);
}
//------------------- Systemdata --------------------------
void MainWindow::resetFlags()
{
    // Zuordnung in der Reihenfolge s. ui_mainwindow.h
    qDebug() << "resetFlags" << "lastbutton" << lastcheckbutton << "new Button" << ui->buttonGroup->checkedId();
    switch (lastcheckbutton)
    {
    case -1:
        break;
    case -2:
        ui->check_Temperatur->setChecked(0);
        break;
    case -3:
        ui->check_voltagedc->setChecked(0);
        break;
    case -4:
        ui->check_vac->setChecked(0);
        break;
    case -5:
        ui->check_motvoltage->setChecked(0);
        break;
    case -6:
        ui->check_wolamp->setChecked(0);
        break;
    case -7:
        ui->check_WaferSensor->setChecked(0);
        break;
    case -8:
        ui->check_VacSwitch->setChecked(0);
        break;
    case -9:
        // ui->check_ports->setChecked(0);
        break;
    case -10:
        ui->check_Sensor->setChecked(0);
        break;
    case -11:
        qDebug() << "case -11";
        ui->check_EMO->setChecked(0);
        break;
    case -12:
        break;
    }
    pollflagDC = FALSE;
    pollflagTP = FALSE;
    pollflagAV = FALSE;
    pollflagWS = FALSE;
    pollflagVV = FALSE;
    pollflagMV = FALSE;
    pollflagPF = FALSE;
    pollflagIO = FALSE;
    pollflagPS = FALSE;
    pollflagWO = FALSE;
    pollflagMS = FALSE;
    pollflagEMO = FALSE;
    syspoll->stop();
}
void MainWindow::setFlags(int flag)
{
    qDebug() << "setFlags" << flag;
    switch (flag)
    {
    case 1:
        pollflagDC = TRUE;
        break;
    case 2:
        pollflagTP = TRUE;
        break;
    case 3:
        pollflagAV = TRUE; // analog Vac values
        break;
    case 4:
        pollflagWS = TRUE;
        break;
    case 5:
        pollflagVV = TRUE; // vac switches
        break;
    case 6:
        pollflagMV = TRUE;
        break;
    case 7:
        pollflagPF = TRUE;
        break;
    case 8:
        pollflagIO = TRUE;
        break;
    case 9:
        pollflagPS = TRUE;
        break;
    case 10:
        pollflagWO = TRUE;
        break;
    case 11:
        pollflagMS = TRUE;
        break;
    case 12:
        pollflagEMO = TRUE;
        break;
    }
    if (!syspoll->isActive())
    {
        qDebug() << "tabWidget current index=" << ui->tabWidget->currentIndex();

        if (ui->check_vac->isChecked() || ui->check_VacSwitch->isChecked()) syspoll->start(ui->line_sys_polltime->text().toUInt(&ok, 10));
        else if (ui->check_vac_poll->isChecked()) syspoll->start(ui->line_vac_polltime->text().toUInt(&ok, 10) * 1000);
        else syspoll->start(ui->line_sys_polltime->text().toUInt(&ok, 10)); // startet Polling des gesetzten Flags
    }
}
void MainWindow::on_check_voltagedc_clicked(bool checked) // DC
{
    resetFlags();
    if (checked)
        setFlags(1);
    lastcheckbutton = ui->buttonGroup->checkedId();
}
void MainWindow::on_check_Temperatur_clicked(bool checked) // TP
{
    resetFlags();
    if (checked)
        setFlags(2);
    lastcheckbutton = ui->buttonGroup->checkedId();
}
void MainWindow::on_check_Sensor_clicked(bool checked) // PS
{
    resetFlags();
    if (checked)
        setFlags(9);
    lastcheckbutton = ui->buttonGroup->checkedId();
}
void MainWindow::on_check_EMO_clicked(bool checked) {
    resetFlags();
    if (checked)
        setFlags(12);
    lastcheckbutton = ui->buttonGroup->checkedId();
}
void MainWindow::on_check_vac_clicked(bool checked) // Vac units
{
    qDebug() << "on_check_vac_clicked" << checked;
    resetFlags();
    if (checked)
        setFlags(3);
    lastcheckbutton = ui->buttonGroup->checkedId();
}
void MainWindow::on_check_LaserIntensity_clicked() // MS
{
    err_msgboxSysSenscalOK("select lift1 or lift2");
    if (calsens) {
        macroL1sens = TRUE;
        on_push_lift1_cal_intensity_clicked();
    } else if (calsens2) {
        macroL2sens = TRUE;
        on_push_lift2_cal_intensity_clicked();
    }
}
void MainWindow::on_check_WaferSensor_clicked(bool checked) // WS
{
    resetFlags();
    if (checked)
        setFlags(4);
    lastcheckbutton = ui->buttonGroup->checkedId();
}
void MainWindow::on_check_motvoltage_clicked(bool checked) // MV
{
    resetFlags();
    if (checked)
        setFlags(6);
    lastcheckbutton = ui->buttonGroup->checkedId();
}
void MainWindow::on_check_ports_clicked() // IO
{
    // int node;
    // int port = 1;

    //    resetFlags();
    //    if(checked) setFlags(8);
    //    lastcheckbutton = ui->buttonGroup->checkedId();
    // node = ui->comboBox_system_node->currentIndex() + 2; // index 1=node2, 9=node 15
    // qDebug() << "node" << node;
    // if (ui->check_system_inport1->isChecked()) port = 1;
    // else if (ui->check_system_inport2->isChecked()) port = 2;
    // else if (ui->check_system_outport->isChecked()) port = 3;
}
void MainWindow::on_check_wolamp_clicked(bool checked) // WO
{
    resetFlags();
    if (checked) setFlags(10);
    lastcheckbutton = ui->buttonGroup->checkedId();
}
void MainWindow::on_check_VacSwitch_clicked(bool checked) // VV
{
    resetFlags();
    if (checked) setFlags(5);
    lastcheckbutton = ui->buttonGroup->checkedId();
}
void MainWindow::on_p_readBoard2_clicked()
{
    svc0 = 1;
    boardno = 2;
    serialSendFeeder("&X0,0,2,1,0,0,0,8,0,\r\n"); // READ_INFO Board 2
}
void MainWindow::on_p_readBoard3_clicked()
{
    svc0 = 1;
    boardno = 3;
    serialSendFeeder("&X0,0,3,1,0,0,0,8,0,\r\n");
}
void MainWindow::on_p_readBoard4_clicked()
{
    svc0 = 1;
    boardno = 4;
    serialSendFeeder("&X0,0,4,1,0,0,0,8,0,\r\n");
}
void MainWindow::on_p_readBoard5_clicked()
{
    svc0 = 1;
    boardno = 5;
    serialSendFeeder("&X0,0,5,1,0,0,0,8,0,\r\n");
}
void MainWindow::on_p_readBoard6_clicked()
{
    svc0 = 1;
    boardno = 6;
    serialSendFeeder("&X0,0,6,1,0,0,0,8,0,\r\n");
}
void MainWindow::on_p_readBoard7_clicked()
{
    svc0 = 1;
    boardno = 7;
    serialSendFeeder("&X0,0,7,1,0,0,0,8,0,\r\n");
}
void MainWindow::on_p_readBoard8_clicked()
{
    svc0 = 1;
    boardno = 8;
    serialSendFeeder("&X0,0,8,1,0,0,0,8,0,\r\n");
}
void MainWindow::on_p_readBoard9_clicked()
{
    svc0 = 1;
    boardno = 9;
    serialSendFeeder("&X0,0,9,1,0,0,0,8,0,\r\n");
}
void MainWindow::on_p_readBoard15_clicked()
{
    svc0 = 1;
    boardno = 15;
    serialSendFeeder("&X0,0,15,1,0,0,0,8,0,\r\n");
}
void MainWindow::on_p_readINSBox_clicked()
{
    tmpstr = 0;
    tmpstr.append(READ); // $READ_
    tmpstr.append("30"); // 30 = Firmware RAC lesen
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_systemstate_clicked()
{
    tmpstr = 0;
    tmpstr.append(READ); // $READ_
    tmpstr.append("99"); // 99 = Systemdaten lesen
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_system_material_clicked()
{
    serialSendFeeder(svcgetmm); // "$GET_41=0\r\n"
}
void MainWindow::on_p_system_mm_clear_clicked()
{
    serialSendFeeder("$SET_70=1\r\n");
}
void MainWindow::on_p_system_mm_set_clicked()
{
    QByteArray mat;
    mat.clear();
    mat = "$SET_72=";
    mat.append(get_Materialliste().toLatin1());
    mat.append("\r\n");
    serialSendFeeder(mat);
}
void MainWindow::on_p_system_found_clear_clicked()
{
    serialSendFeeder("$SET_71=1\r\n");
}
void MainWindow::on_p_system_found_set_clicked()
{
    QByteArray mat;
    mat.clear();
    mat = "$SET_73=";
    mat.append(get_Foundwafliste().toLatin1());
    mat.append("\r\n");
    serialSendFeeder(mat);
}
void MainWindow::on_p_feederstate_clicked()
{
    serialSendFeeder("$READ_70\r\n");
}
void MainWindow::on_p_system_materialfound_clicked()
{
    serialSendFeeder("$GET_42=0\r\n"); // "$GET_42=0\r\n"
}
void MainWindow::on_p_system_getresetlist_clicked()
{
    serialSendFeeder("$GET_43=0\r\n"); // "$GET_43=0\r\n"
}
// void MainWindow::on_p_tower_store_clicked()
// {
//     STORE_FILE_partTOWER();
// }
void MainWindow::on_p_misc_sendHORN_clicked()
{
    QString tmpstr1;
    QString tmpstr2;

    tmpstr1 = ui->combo_misc_horn->currentText().toLower();
    tmpstr2 = ui->combo_misc_horn_2->currentText().toLower();

    f_towerset(TOWERHN1, tmpstr1, tmpstr2);
}
void MainWindow::on_p_misc_sendRED_clicked()
{
    QString tmpstr1;
    QString tmpstr2;

    tmpstr1 = ui->combo_misc_red->currentText().toLower();
    tmpstr2 = ui->combo_misc_red_2->currentText().toLower();

    f_towerset(TOWERLP1, tmpstr1, tmpstr2);
}
void MainWindow::on_p_misc_sendYELLOW_clicked()
{
    QString tmpstr1;
    QString tmpstr2;

    tmpstr1 = ui->combo_misc_yellow->currentText().toLower();
    tmpstr2 = ui->combo_misc_yellow_2->currentText().toLower();

    f_towerset(TOWERLP2, tmpstr1, tmpstr2);
}
void MainWindow::on_p_misc_sendGREEN_clicked()
{
    QString tmpstr1;
    QString tmpstr2;

    tmpstr1 = ui->combo_misc_green->currentText().toLower();
    tmpstr2 = ui->combo_misc_green_2->currentText().toLower();

    f_towerset(TOWERLP3, tmpstr1, tmpstr2);
}
void MainWindow::f_towerset(int lmp, QString tmpstr1, QString tmpstr2)
{
    qDebug() << "tmp1" << tmpstr1 << "tmp2" << tmpstr2;
    tmpstr.clear();

    if (lmp == TOWERHN1) tmpstr.append(towerHorn); // $SET_20=
    else if (lmp == TOWERLP1) tmpstr.append(towerRed); // $SET_23=
    else if (lmp == TOWERLP2) tmpstr.append(towerYellow); // $SET_22=
    else if (lmp == TOWERLP3) tmpstr.append(towerGreen); // $SET_21=

    if (tmpstr1 == "off") tmpstr.append("0");
    else if (tmpstr1 == "on") tmpstr.append("255");
    else if (tmpstr1 == "50") tmpstr.append("128");
    tmpstr.append(",");
    if (tmpstr2 == "off") tmpstr.append("0");
    else if (tmpstr2 == "on") tmpstr.append("255");
    else if (tmpstr2 == "50") tmpstr.append("128");
    tmpstr.append(CRLF);
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_system_unitpos_clicked()
{
    if (macrounitpos == 0)
        macrounitpos = 1;
    else
        err_msgbox("cmd already running");

    /*
   * serialSendFeeder("$X_2,0,0,5,1,0,0,0,3,1,\r\n");      // READ_POS LD-x
   * serialSendFeeder("$X_2,0,0,5,1,0,0,0,3,2,\r\n");      // READ_POS LD-Y
   * serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,1,\r\n");      // READ_POS Lift1
   Height
   * serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,2,\r\n");      // READ_POS Lift1
   Tilt
   * serialSendFeeder("$X_2,0,0,2,1,0,0,0,3,1,\r\n");      // READ_POS Lift2
   Height
   * serialSendFeeder("$X_2,0,0,2,1,0,0,0,3,2,\r\n");      // READ_POS Lift2
   Tilt
   * serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,3,\r\n");      // READ_POS PA Height
   * serialSendFeeder("$X_2,0,0,4,1,0,0,0,3,2,\r\n");      // READ_POS PA Phi
   * serialSendFeeder("$X_2,0,0,4,1,0,0,0,3,3,\r\n");      // READ_POS WO Tilt
   * serialSendFeeder("$X_2,0,0,4,1,0,0,0,3,1,\r\n");      // READ_POS WO Rotpos
   * serialSendFeeder("$X_2,0,0,5,1,0,0,0,3,3,\r\n");      // READ_POS WC Height
   * serialSendFeeder("$X_2,0,0,6,1,0,0,0,3,3,\r\n");      // READ_POS WC Phi

   * waitACTpos = readmotstat;
*/
}
void MainWindow::macroUnitPos(int ustep)
{
    if (macrounitpos)
    {
        waitACTpos = readmotstat;
        switch (ustep)
        {
        case 0:
            serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,1,\r\n"); // get pos L1 height
            break;
        default:
            waitACTpos = 0;
            break;
        }
    }
}
void MainWindow::on_p_sys_posWCmiddle_clicked()
{
    serialSendFeeder("$SET_60=0\r\n");
}
void MainWindow::on_p_system_DIAGLED_clicked()
{
    serialSendFeeder("$READ_71\r\n");
}
//------------------- Register LIFT 1 --------------------
// void MainWindow::on_radio_lift1_thinwafer_clicked() { child = "Wafertype"; }
void MainWindow::on_radio_lift1_addtohgt_clicked(bool checked)
{
    float height = 0.000000;
    int val;

    /* Wert von messunit wird xy-Loaderheight aufaddiert*/
    float unit = ui->line_lift1_measuring_height_mm->text().toFloat(&ok);
    int unitsteps = ui->line_lift1_measuring_height->text().toInt(&ok, 10);
    if (checked)
    {
        height = ui->line_lift1_xyloader_height_mm->text().toFloat(&ok); // mm
        ui->line_lift1_xyloader_height_mm->setText(QString::number((height + unit))); // mm + mm
        height = ui->line_lift1_wafersensor_height_mm->text().toFloat(&ok);
        ui->line_lift1_wafersensor_height_mm->setText(QString::number((height + unit)));

        val = ui->line_lift1_xyloader_height->text().toInt(&ok, 10); // steps
        ui->line_lift1_xyloader_height->setText(QString::number((val + unitsteps))); // steps + steps
        val = ui->line_lift1_wafersensor_height->text().toInt(&ok, 10);
        ui->line_lift1_wafersensor_height->setText(QString::number((val + unitsteps)));
    }
    else
    {
        height = ui->line_lift1_xyloader_height_mm->text().toFloat(&ok);
        ui->line_lift1_xyloader_height_mm->setText(QString::number(height - unit));
        height = ui->line_lift1_wafersensor_height_mm->text().toFloat(&ok);
        ui->line_lift1_wafersensor_height_mm->setText(QString::number((height - unit)));
        val = ui->line_lift1_xyloader_height->text().toInt(&ok, 10);
        ui->line_lift1_xyloader_height->setText(QString::number((val - unitsteps)));
        val = ui->line_lift1_wafersensor_height->text().toInt(&ok, 10);
        ui->line_lift1_wafersensor_height->setText(QString::number((val - unitsteps)));
    }
}
void MainWindow::on_line_lift1_measuring_height_textChanged(const QString &arg1)
{
    float unitsteps = arg1.toFloat(&ok);
    float tmpReso = getResolution("Lift1 height motor").toFloat();

    ui->line_lift1_measuring_height_mm->setText(QString::number((unitsteps / tmpReso)));
}
void MainWindow::L1_conv2mm()
{
    float height = 0.000000;
    float tmpReso = 0.000000;

    tmpReso = getResolution("Lift1 height motor").toFloat();
    height = ui->line_lift1_xyloader_height->text().toFloat(&ok);
    qDebug() << "reso" << tmpReso << "height" << height;
    ui->line_lift1_xyloader_height->setText(QString::number((height / tmpReso)));
    height = ui->line_lift1_wafersensor_height->text().toFloat(&ok);
    ui->line_lift1_wafersensor_height->setText(QString::number((height / tmpReso)));
    height = ui->line_lift1_unload_height->text().toFloat(&ok);
    ui->line_lift1_unload_height->setText(QString::number((height / tmpReso)));

    height = ui->line_lift1_xyloader_height_2->text().toFloat(&ok);
    ui->line_lift1_xyloader_height_2->setText(QString::number((height / tmpReso)));
    height = ui->line_lift1_wafersensor_height_2->text().toFloat(&ok);
    ui->line_lift1_wafersensor_height_2->setText(QString::number((height / tmpReso)));
    height = ui->line_lift1_unload_height_2->text().toFloat(&ok);
    ui->line_lift1_unload_height_2->setText(QString::number((height / tmpReso)));

    tmpReso = getResolution("Lift1 tilt motor").toFloat();
    height = ui->line_lift1_tiltactpos->text().toFloat(&ok);
    ui->line_lift1_tiltactpos->setText(QString::number((height / tmpReso), 'f', 3));
    height = ui->line_lift1_tiltinactpos->text().toFloat(&ok);
    ui->line_lift1_tiltinactpos->setText(QString::number((height / tmpReso), 'f', 3));

    height = ui->line_lift1_tiltactpos_2->text().toFloat(&ok);
    ui->line_lift1_tiltactpos_2->setText(QString::number((height / tmpReso), 'f', 3));
    height = ui->line_lift1_tiltinactpos_2->text().toFloat(&ok);
    ui->line_lift1_tiltinactpos_2->setText(QString::number((height / tmpReso), 'f', 3));
}
void MainWindow::L1_conv2steps()
{
    float height = 0.000000;
    float tmpReso = 0.000000;
    int val;

    tmpReso = getResolution("Lift1 height motor").toFloat();
    height = ui->line_lift1_xyloader_height->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift1_xyloader_height->setText(QString::number((val)));
    height = ui->line_lift1_wafersensor_height->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift1_wafersensor_height->setText(QString::number((val)));
    height = ui->line_lift1_unload_height->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift1_unload_height->setText(QString::number((val)));

    height = ui->line_lift1_xyloader_height_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift1_xyloader_height_2->setText(QString::number((val)));
    height = ui->line_lift1_wafersensor_height_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift1_wafersensor_height_2->setText(QString::number((val)));
    height = ui->line_lift1_unload_height_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift1_unload_height_2->setText(QString::number((val)));

    tmpReso = getResolution("Lift1 tilt motor").toFloat();
    height = ui->line_lift1_tiltactpos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift1_tiltactpos->setText(QString::number((val)));
    height = ui->line_lift1_tiltinactpos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift1_tiltinactpos->setText(QString::number((val)));

    height = ui->line_lift1_tiltactpos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift1_tiltactpos_2->setText(QString::number((val)));
    height = ui->line_lift1_tiltinactpos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift1_tiltinactpos_2->setText(QString::number((val)));
}
void MainWindow::on_push_lift1_engine_clicked()
{
    changeWidget("MOTOR");
}
void MainWindow::on_push_lift1_editcass_clicked() { changeWidget("CASS"); }
void MainWindow::on_push_lift1_lock_clicked() { changeWidget("LOCK"); }
void MainWindow::on_push_lift1_init_height_clicked() // ok
{
    feedertimeout = 30000;
    serialSendFeeder(RES_L1H);
}
void MainWindow::on_push_lift1_init_tilt_clicked() // ok
{
    feedertimeout = 10000;
    serialSendFeeder(RES_L1T);
}
void MainWindow::on_push_lift1_upload_clicked() // lädt aktuelle RAM Setupdaten für Lift1
{
    serialSendFeeder(EE_Lift1);
}
void MainWindow::on_push_lift1_cassswitch_clicked()
{
    serialSendFeeder("$READ_54=1\r\n");
}
void MainWindow::on_p_LDheight_xy_clicked()
{
    if (f_lift1xyhgt == 0)
    {
        on_p_LD_Yout_clicked();
        f_lift1xyhgt = 1;
    }
    else
    {
        tmpstr = 0;
        ui->line_lift1_xyloader_height->setInputMask("#99999");
        QString tmp = ui->line_lift1_xyloader_height->text();
        tmpstr.append(setpos);
        tmpstr.append("50="); // ID Lift1 Height ist 50
        tmpstr.append(tmp.toLatin1());
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
}
void MainWindow::on_p_wafersensor_height_clicked()
{
    if (f_lift1senshgt == 0)
    {
        on_p_LD_Yout_clicked();
        f_lift1senshgt = 1;
    }
    else
    {
        ui->line_lift1_wafersensor_height->setInputMask("#99999");
        tmpstr = 0;
        tmpstr.append(setpos); // "$SET_"
        tmpstr.append("50=");  // ID Lift1 Height ist 50
        tmpstr.append(ui->line_lift1_wafersensor_height->text().toLatin1());
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
        //        qDebug()<<"ws" <<
        //        ui->line_lift1_wafersensor_height->text().toUpper().right(8);
    }
}
void MainWindow::on_p_oper_height_clicked()
{
    if (f_lift1operhgt == 0) {
        on_p_LD_Yout_clicked();
        f_lift1operhgt = 1;
    } else {
        ui->line_lift1_unload_height->setInputMask("#99999");
        tmpstr = 0;
        tmpstr.append(setpos);
        tmpstr.append("50="); // ID Lift1 Height ist 50
        tmpstr.append(ui->line_lift1_unload_height->text().toLatin1());
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
}
void MainWindow::on_p_tilt_active_clicked()
{
    ui->line_lift1_tiltactpos->setInputMask("#99999");
    tmpstr = 0;
    tmpstr.append(setpos);
    tmpstr.append("51="); // ID Lift1 Tilt ist 51
    tmpstr.append(QString::number(ui->line_lift1_tiltactpos->text().toInt(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_tilt_inactive_clicked()
{
    ui->line_lift1_tiltinactpos->setInputMask("#99999");
    tmpstr = 0;
    tmpstr.append(setpos);
    tmpstr.append("51="); // ID Lift1 Tilt ist 51
    tmpstr.append(QString::number(ui->line_lift1_tiltinactpos->text().toInt(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_check_lift1_deactivate_stateChanged(int arg1)
{
    if (arg1 == 2)
    {
        ui->label_Lift1Present->setStyleSheet("background-color: green");
        ui->label_lift1_present->setText("Lift1 present");
    }
    else if (arg1 == 0)
    {
        ui->label_Lift1Present->setStyleSheet("background-color: Red");
        ui->label_lift1_present->setText("Lift1 not present");
    }
}
void MainWindow::on_check_tilt1_deactivate_stateChanged(int arg1)
{
    if (arg1 == 2)
    {
        ui->label_Tilt1Present->setStyleSheet("background-color: green");
        ui->label_Tilt1_present->setText("Tilt1 present");
    }
    else if (arg1 == 0)
    {
        ui->label_Tilt1Present->setStyleSheet("background-color: Red");
        ui->label_Tilt1_present->setText("Tilt1 not present");
    }
}
void MainWindow::on_check_lift1_moveconst_stateChanged() // checkbox Motor move -> Sliderfarbe setzen
{
}
void MainWindow::on_p_L1_getheight_clicked()
{
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,1,\r\n"); // READ_POS Lift1 Height

    ui->p_L1_getheight->setStyleSheet(backLightYello);

    waitACTpos = getLift1; // receive X2 Message
}
void MainWindow::on_p_L1_gettilt_clicked()
{
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,2,\r\n"); // READ_POS Lift1 Tilt

    ui->p_L1_gettilt->setStyleSheet(backLightYello);

    waitACTpos = getTilt1;
}
void MainWindow::on_spinL1_stepwidth_tilt_textChanged(const QString &arg1)
{
    // if (ui->check_lift1_moveconst->isChecked() && cmdfeeder == 0 && waitACTpos == 0)
    // {
    //     QByteArray xcmd;
    //     int a = 0;

    //     ui->spinL1_stepwidth_tilt->setStyleSheet(spinYelBlk);
    //     int addsteps = ui->spinL1_stepwidth_tilt->value();
    //     if (ui->line_lift1_tiltactpos->styleSheet() == backYello || ui->line_lift1_tiltinactpos->styleSheet() == backYello) {
    //         tmpstr.append("51="); // set Lift1 Tilt ist 51
    //         if (ui->line_lift1_tiltactpos->styleSheet() == backYello)
    //             a = ui->line_lift1_tiltactpos->text().toInt(&ok, 10);
    //         else if (ui->line_lift1_tiltinactpos->styleSheet() == backYello)
    //             a = ui->line_lift1_tiltinactpos->text().toInt(&ok, 10);

    //         int posval = addsteps + a;
    //         serialPosData(&bytedata1, posval);
    //         xcmd = "&X0,0,3,1,0,0,0,1,2," + bytedata1 + "," + MPslow + ",\r\n"; // POS_ABS Lift1 Tilt
    //     }
    //     serialSendFeeder(xcmd);
    //     ui->p_L1_gettilt->setStyleSheet("background-color: yellow");
    //     waitACTpos = setTilt1;
    // }
    // else if (ui->check_lift1_moveconst->isChecked() == 0)
    // {
    //     //   qDebug()<<"checked"<<ui->check_lift1_moveconst->isChecked();
    //     ui->spinL1_stepwidth_tilt->setSingleStep(ui->spinL1_stepwidth_tilt->value());
    //     float flt = arg1.toInt(&ok, 10);
    //     float res = 1;
    //     if (ui->line_lift1_tiltactpos->styleSheet() == backYello || ui->line_lift1_tiltinactpos->styleSheet() == backYello) {
    //         res = getResolution("Lift1 tilt motor").toFloat();
    //     }
    //     qDebug() << "res" << res;
    //     s = QString::number(flt / res, 10, 4);
    //     //        ui->lineL1_addsteps_tilt->setText(s);
    //     //        ui->spinL1_addsteps_tilt->setStyleSheet(backYello);
    // }
}
void MainWindow::on_push_lift1_cal_sensheight_clicked()
{
    int ret = msgboxOK("drive Lift1 down until the spacer is below laser beam");
    if (ret == 0) {
        calSensHeight = 1;
        feedertimeout = 30000;
        serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,1,255,255,10,0\r\n"); // Lift1 const nach oben
        // fahren
    }
}
void MainWindow::on_push_lift1_cal_intensity_clicked()
{
    if (msgboxOK("Press OK if lift1 height is below wafer senor height else " "press Cancel") == 0)
    {
        serialSendFeeder("&X0,0,7,1,0,0,0,17,84,\r\n");
        calsens = 1;
    }
}
void MainWindow::on_push_lift1_store_clicked() // ok
{
    STORE_FILE_partLIFT(1);
}
void MainWindow::on_p_Lift_map_clicked()
{
    if (ui->comboCass_Type->currentIndex() <= 0) err_msgbox("please select carrier");
    else
    {
        waitLDout = 2;
        on_p_LD_Yout_clicked();
    }
}
void MainWindow::getMap()
{
    int liftindex = 0;
    if (ui->checkCass_lift1->isChecked()) liftindex = 1;
    else if (ui->checkCass_lift2->isChecked()) liftindex = 2;
    else err_msgbox("please select lift");

    ui->lineL1_maplist->clear();
    tmpstr = 0;
    tmpstr.append(setpos);
    tmpstr.append("38=" + QString::number(liftindex).toLatin1() + "\r\n"); // GetMap
    serialSendFeeder(tmpstr);
    svc8 = 2;
}
void MainWindow::on_p_lift1_SMIF_clicked()
{
    if (ui->combo_lift1_SMIF_select->currentIndex() == 0) err_msgbox("select SMIF type first");
    else if (ui->combo_lift1_SMIF_select->currentIndex() > 2) changeWidget("SMIF");
    else changeWidget("ASYST");
}
void MainWindow::on_p_lift1_constpos_up_pressed()
{
    if (ui->check_lift1_constfast_up->isChecked())
    {
        serialSendFeeder( "$X_2,0,0,3,1,0,0,0,2,1,255,252,47,112\r\n"); // Fast, lift1 pos wird
        // kleiner -250000
        ui->p_lift1_constpos_up->setStyleSheet(backLightGreen);
    }
    else if (ui->check_lift1_constslow_up->isChecked())
    {
        serialSendFeeder( "$X_2,0,0,3,1,0,0,0,2,1,255,255,246,60\r\n"); // Slow, lift1 pos wird
        // kleiner -2500
        ui->p_lift1_constpos_up->setStyleSheet(backLightGreen);
    }
    else err_msgbox("select speed first");
}
void MainWindow::on_p_lift1_constpos_up_released()
{
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,1,0,0,0,0\r\n"); // Stop Lift 1
    ui->p_lift1_constpos_up->setStyleSheet(backDefault);
}
void MainWindow::on_p_lift1_constpos_down_pressed()
{
    if (ui->check_lift1_constfast_down->isChecked())
    {
        serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,1,0,3,208,144\r\n"); // Fast 250000
        ui->p_lift1_constpos_down->setStyleSheet(backLightGreen);
    }
    else if (ui->check_lift1_constslow_down->isChecked())
    {
        serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,1,0,0,9,196\r\n"); // Slow 2500
        ui->p_lift1_constpos_down->setStyleSheet(backLightGreen);
    }
    else err_msgbox("select speed first");
}
void MainWindow::on_p_lift1_constpos_down_released()
{
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,1,0,0,0,0\r\n"); // Stop Lift 1
    ui->p_lift1_constpos_down->setStyleSheet(backDefault);
}
void MainWindow::on_p_lift1_constpos_up_tilt_pressed()
{
    if (ui->check_lift1_constfast_up_tilt->isChecked())
    {
        serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,2,0,3,208,144\r\n"); // Fast, lift1 tilt up 25000
        ui->p_lift1_constpos_up_tilt->setStyleSheet(backLightGreen);
    }
    else if (ui->check_lift1_constslow_up_tilt->isChecked())
    {
        serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,2,0,0,9,196\r\n"); // Slow, lift1 tilt up 2500
        ui->p_lift1_constpos_up_tilt->setStyleSheet(backLightGreen);
    }
    else err_msgbox("select speed first");
}
void MainWindow::on_p_lift1_constpos_up_tilt_released()
{
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,2,0,0,0,0\r\n"); // Stop Tilt 1
    ui->p_lift1_constpos_up_tilt->setStyleSheet(backDefault);
}
void MainWindow::on_p_lift1_constpos_down_tilt_pressed()
{
    if (ui->check_lift1_constfast_up_tilt->isChecked())
    {
        serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,2,255,252,47,112\r\n"); // Fast, lift1 tilt down
        // -25000
        ui->p_lift1_constpos_down_tilt->setStyleSheet(backLightGreen);
    }
    else if (ui->check_lift1_constslow_up_tilt->isChecked())
    {
        serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,2,255,255,246,60\r\n"); // Slow, lift1 tilt down
        // -2500
        ui->p_lift1_constpos_down_tilt->setStyleSheet(backLightGreen);
    } else err_msgbox("select speed first");
}
void MainWindow::on_p_lift1_constpos_down_tilt_released()
{
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,2,0,0,0,0\r\n"); // Stop Tilt 1
    ui->p_lift1_constpos_down_tilt->setStyleSheet(backDefault);
}
void MainWindow::on_push_lift1_store_2_clicked()
{
    if (err_msgboxTransferOK("Change lift type. Are you sure?") == 0)
    {
        store = 1; // Freigabe für Datenexport zum INSBox EPROM

        QFile f(FILE2OPEN);
        QFile f2(tmpINIFILE);
        if (!f.open(QIODevice::ReadOnly | QIODevice::Text))
            return;
        if (!f2.open(QIODevice::ReadWrite | QIODevice::Text))
            return;
        QTextStream datain(&f);
        QTextStream dataout(&f2);
        QString line;
        QString tVAL;

        while (!datain.atEnd()) {
            line = datain.readLine();
            if (line.size() != 0) {
                if (line.at(0) == '[') // all Strings, die mit [ beginnen
                {
                    dataout << line.append('\n');
                    if (line.mid(1, 5) == "Lift1") {
                        do
                        {
                            line = datain.readLine();
                            if (line.length() > 0)
                            {
                                if (line.mid(0, line.indexOf('=')).toLower() == "lift present")
                                {
                                    if (ui->radio_lift1_default->isChecked() || ui->radio_lift1_SMIF->isChecked())
                                    {
                                        tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                    }
                                    else
                                    {
                                        tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                    }
                                    dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "smif")
                                {
                                    if (ui->radio_lift1_SMIF->isChecked())
                                    {
                                        if (ui->combo_lift1_SMIF_select->currentText() == "none")
                                        {
                                            err_msgbox("Please select SMIF type first");
                                            tVAL = line.mid(0, line.indexOf("=") + 1).append("none");
                                        }
                                        else
                                        {
                                            tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_lift1_SMIF_select->currentText());
                                            qDebug() << "SMIFtype" << tVAL;
                                        }
                                    }
                                    else tVAL = line.mid(0, line.indexOf("=") + 1).append("none");
                                    dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                                }
                                else dataout << line.append('\n');
                            }
                            else
                            {
                                dataout << line.append('\n');
                                line = '0';
                            }
                        }
                        while (line.at(0) != '[');
                    }
                }
                else dataout << line.append('\n');
            }
            else dataout << line.append('\n');
        }
        if (QFile::exists(renameINIFILE)) QFile::remove(renameINIFILE); // letztes Inssetup.0 wird entfernt
        if (!f.rename(renameINIFILE)) fehler = 2;
        if (!f2.rename(DEFAULTINIFILE)) fehler = 2;
        if (f2.exists()) f2.close();
        if (f.exists()) f.close();
        if (fehler) err_lineinput(fehler);
        else SETUP_FILE_partLIFT(1); // alle INI-Values neu einlesen
    }
}
void MainWindow::on_radio_lift1_SMIF_clicked(bool checked)
{
    if (checked)
    {
        ui->frame_lift1_leica->hide();
        ui->frame_lift1_selectSMIF->show();
        ui->p_lift1_SMIF->hide();
        ui->push_lift1_store_2->setEnabled(1);
    }
}
void MainWindow::on_radio_lift1_default_clicked(bool checked)
{
    if (checked)
    {
        ui->frame_lift1_leica->show();
        ui->frame_lift1_selectSMIF->hide();
        ui->push_lift1_store_2->setEnabled(1);
    }
}
void MainWindow::on_radio_lift1_notinstalled_clicked(bool checked)
{
    if (checked)
    {
        ui->frame_lift1_leica->hide();
        ui->frame_lift1_selectSMIF->hide();
        ui->push_lift1_store_2->setEnabled(1);
    }
}
//------------------- Register LIFT 2 --------------------
// void MainWindow::on_radio_lift2_thinwafer_clicked()
// {
//     child = "Wafertype";
// }
void MainWindow::on_radio_lift2_addtohgt_clicked(bool checked)
{
    float height = 0.000000;
    int val;

    /* Wert von messunit wird xy-Loaderheight aufaddiert*/
    float unit = ui->line_lift2_measuring_height_mm->text().toFloat(&ok);
    int unitsteps = ui->line_lift2_measuring_height->text().toInt(&ok, 10);

    if (checked)
    {
        height = ui->line_lift2_xyloader_height_mm->text().toFloat(&ok);
        ui->line_lift2_xyloader_height_mm->setText(QString::number((height + unit)));
        height = ui->line_lift2_wafersensor_height_mm->text().toFloat(&ok);
        ui->line_lift2_wafersensor_height_mm->setText(QString::number((height + unit)));

        val = ui->line_lift2_xyloader_height->text().toInt(&ok, 10); // steps
        ui->line_lift2_xyloader_height->setText(QString::number((val + unitsteps))); // steps + steps
        val = ui->line_lift2_wafersensor_height->text().toInt(&ok, 10);
        ui->line_lift2_wafersensor_height->setText(QString::number((val + unitsteps)));
    }
    else
    {
        height = ui->line_lift2_xyloader_height_mm->text().toFloat(&ok);
        ui->line_lift2_xyloader_height_mm->setText(QString::number(height - unit));
        height = ui->line_lift2_wafersensor_height_mm->text().toFloat(&ok);
        ui->line_lift2_wafersensor_height_mm->setText(QString::number((height - unit)));
        height = ui->line_lift2_xyloader_height->text().toFloat(&ok);

        val = ui->line_lift2_xyloader_height->text().toInt(&ok, 10);
        ui->line_lift2_xyloader_height->setText(QString::number((val - unitsteps)));
        val = ui->line_lift2_wafersensor_height->text().toInt(&ok, 10);
        ui->line_lift2_wafersensor_height->setText(QString::number((val - unitsteps)));
    }
}
void MainWindow::on_line_lift2_measuring_height_textChanged(const QString &arg1) {
    float unitsteps = arg1.toFloat(&ok);
    float tmpReso = getResolution("Lift2 height motor").toFloat();

    ui->line_lift2_measuring_height_mm->setText(
                QString::number((unitsteps / tmpReso)));
}
void MainWindow::L2_conv2mm() {
    float height = 0.000000;
    float tmpReso = 0.000000;

    tmpReso = getResolution("Lift2 height motor").toFloat();
    height = ui->line_lift2_xyloader_height->text().toFloat(&ok);
    ui->line_lift2_xyloader_height->setText(QString::number((height / tmpReso)));
    height = ui->line_lift2_wafersensor_height->text().toFloat(&ok);
    ui->line_lift2_wafersensor_height->setText(
                QString::number((height / tmpReso)));
    height = ui->line_lift2_unload_height->text().toFloat(&ok);
    ui->line_lift2_unload_height->setText(QString::number((height / tmpReso)));

    height = ui->line_lift2_xyloader_height_2->text().toFloat(&ok);
    ui->line_lift2_xyloader_height_2->setText(
                QString::number((height / tmpReso)));
    height = ui->line_lift2_wafersensor_height_2->text().toFloat(&ok);
    ui->line_lift2_wafersensor_height_2->setText(
                QString::number((height / tmpReso)));
    height = ui->line_lift2_unload_height_2->text().toFloat(&ok);
    ui->line_lift2_unload_height_2->setText(QString::number((height / tmpReso)));

    tmpReso = getResolution("Lift2 tilt motor").toFloat();
    height = ui->line_lift2_tiltactpos->text().toFloat(&ok);
    ui->line_lift2_tiltactpos->setText(
                QString::number((height / tmpReso), 'f', 3));
    height = ui->line_lift2_tiltinactpos->text().toFloat(&ok);
    ui->line_lift2_tiltinactpos->setText(
                QString::number((height / tmpReso), 'f', 3));

    height = ui->line_lift2_tiltactpos_2->text().toFloat(&ok);
    ui->line_lift2_tiltactpos_2->setText(
                QString::number((height / tmpReso), 'f', 3));
    height = ui->line_lift2_tiltinactpos_2->text().toFloat(&ok);
    ui->line_lift2_tiltinactpos_2->setText(
                QString::number((height / tmpReso), 'f', 3));
}
void MainWindow::L2_conv2steps() {
    float height = 0.000000;
    float tmpReso = 0.000000;
    int val;

    tmpReso = getResolution("Lift2 height motor").toFloat();
    height = ui->line_lift2_xyloader_height->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift2_xyloader_height->setText(QString::number((val)));
    height = ui->line_lift2_wafersensor_height->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift2_wafersensor_height->setText(QString::number((val)));
    height = ui->line_lift2_unload_height->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift2_unload_height->setText(QString::number((val)));

    height = ui->line_lift2_xyloader_height_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift2_xyloader_height_2->setText(QString::number((val)));
    height = ui->line_lift2_wafersensor_height_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift2_wafersensor_height_2->setText(QString::number((val)));
    height = ui->line_lift2_unload_height_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift2_unload_height_2->setText(QString::number((val)));

    tmpReso = getResolution("Lift2 tilt motor").toFloat();
    height = ui->line_lift2_tiltactpos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift2_tiltactpos->setText(QString::number((val)));
    height = ui->line_lift2_tiltinactpos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift2_tiltinactpos->setText(QString::number((val)));

    height = ui->line_lift2_tiltactpos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift2_tiltactpos_2->setText(QString::number((val)));
    height = ui->line_lift2_tiltinactpos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_lift2_tiltinactpos_2->setText(QString::number((val)));
}
void MainWindow::on_push_lift2_engine_clicked() { changeWidget("MOTOR"); }
void MainWindow::on_push_lift2_editcass_clicked() { changeWidget("CASS"); }
void MainWindow::on_push_lift2_lock_clicked() { changeWidget("LOCK"); }
void MainWindow::on_p_lift2_init_height_clicked()
{
    feedertimeout = 30000;
    serialSendFeeder(RES_L2H);
}
void MainWindow::on_p_lift2_init_tilt_clicked()
{
    feedertimeout = 10000;
    serialSendFeeder(RES_L2T);
}
void MainWindow::on_push_lift2_upload_clicked() { serialSendFeeder(EE_Lift2); }
void MainWindow::on_push_lift2_cassswitch_clicked()
{
    serialSendFeeder("$READ_55=1\r\n");
}
void MainWindow::on_p_LDheight_xy_2_clicked()
{
    if (f_lift2xyhgt == 0)
    {
        on_p_LD_Yout_clicked();
        f_lift2xyhgt = 1;
    }
    else
    {
        tmpstr = 0;
        ui->line_lift2_xyloader_height->setInputMask("#99999");
        QString tmp = ui->line_lift2_xyloader_height->text();
        tmpstr.append(setpos);
        tmpstr.append("52="); // ID Lift2 Height ist 52
        tmpstr.append(tmp.toLatin1());
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
}
void MainWindow::on_p_wafersensor_height_2_clicked()
{
    if (f_lift2senshgt == 0)
    {
        on_p_LD_Yout_clicked();
        f_lift2senshgt = 1;
    }
    else
    {
        ui->line_lift2_wafersensor_height->setInputMask("#99999");
        tmpstr = 0;
        tmpstr.append(setpos);
        tmpstr.append("52="); // ID Lift2 Height ist 52
        tmpstr.append(ui->line_lift2_wafersensor_height->text().toLatin1());
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
}
void MainWindow::on_p_oper_height_2_clicked()
{
    if (f_lift2operhgt == 0)
    {
        on_p_LD_Yout_clicked();
        f_lift2operhgt = 1;
    }
    else
    {
        ui->line_lift2_unload_height->setInputMask("#99999");
        tmpstr = 0;
        tmpstr.append(setpos);
        tmpstr.append("52="); // ID Lift2 Height ist 52
        tmpstr.append(ui->line_lift2_unload_height->text().toLatin1());
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
}
void MainWindow::on_p_tilt_active_2_clicked()
{
    ui->line_lift2_tiltactpos->setInputMask("#99999");
    tmpstr = 0;
    tmpstr.append(setpos);
    tmpstr.append("53="); // ID Lift2 Tilt ist 53
    tmpstr.append(QString::number(ui->line_lift2_tiltactpos->text().toInt(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_tilt_inactive_2_clicked()
{
    ui->line_lift2_tiltinactpos->setInputMask("#99999");
    tmpstr = 0;
    tmpstr.append(setpos);
    tmpstr.append("53="); // ID Lift2 Tilt ist 53
    tmpstr.append(QString::number(ui->line_lift2_tiltinactpos->text().toInt(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_check_lift2_deactivate_stateChanged(int arg1)
{
    if (arg1 == 2)
    {
        ui->label_Lift2Present->setStyleSheet("background-color: green");
        ui->label_Lift2_present->setText("Lift2 present");
    }
    else if (arg1 == 0)
    {
        ui->label_Lift2Present->setStyleSheet("background-color: Red");
        ui->label_Lift2_present->setText("Lift2 not present");
    }
}
void MainWindow::on_check_tilt2_deactivate_stateChanged(int arg1)
{
    qDebug() << arg1;
    if (arg1 == 2)
    {
        ui->label_Tilt2Present->setStyleSheet("background-color: green");
        ui->label_Tilt2_present->setText("Tilt2 active");
    }
    else if (arg1 == 0)
    {
        ui->label_Tilt2Present->setStyleSheet("background-color: Red");
        ui->label_Tilt2_present->setText("Tilt2 not active");
    }
}
void MainWindow::on_check_lift2_moveconst_stateChanged()
{
    //f_setSlidecolor();
}
void MainWindow::on_p_L2_getheight_clicked()
{

    serialSendFeeder("$X_2,0,0,2,1,0,0,0,3,1,\r\n"); // READ_POS Lift2 Height

    ui->p_L2_getheight->setStyleSheet(backLightYello);

    waitACTpos = getLift2;
}
void MainWindow::on_p_L2_gettilt_clicked()
{
    serialSendFeeder("$X_2,0,0,2,1,0,0,0,3,2,\r\n"); // READ_POS Lift2 Tilt

    ui->p_L2_gettilt->setStyleSheet(backLightYello);

    waitACTpos = getTilt2;
}
void MainWindow::on_spinL2_stepwidth_tilt_textChanged(const QString &arg1)
{
    // if (ui->check_lift2_moveconst->isChecked() && cmdfeeder == 0 && waitACTpos == 0)
    // {
    //     QByteArray xcmd;
    //     int a = 0;

    //     ui->spinL2_stepwidth_tilt->setStyleSheet(spinYelBlk);
    //     int addsteps = ui->spinL2_stepwidth_tilt->value();
    //     if (ui->line_lift2_tiltactpos->styleSheet() == backYello || ui->line_lift2_tiltinactpos->styleSheet() == backYello)
    //     {
    //         tmpstr.append("53="); // set Lift2 Tilt ist 53
    //         if (ui->line_lift2_tiltactpos->styleSheet() == backYello) a = ui->line_lift2_tiltactpos->text().toInt(&ok, 10);
    //         else if (ui->line_lift2_tiltinactpos->styleSheet() == backYello) a = ui->line_lift2_tiltinactpos->text().toInt(&ok, 10);

    //         int posval = addsteps + a;
    //         serialPosData(&bytedata1, posval);
    //         xcmd = "&X0,0,2,1,0,0,0,1,2," + bytedata1 + "," + MPslow + ",\r\n"; // POS_ABS Lift2 Tilt
    //     }
    //     serialSendFeeder(xcmd);
    //     ui->p_L2_gettilt->setStyleSheet("background-color: yellow");
    //     waitACTpos = setTilt2;
    // }
    // if (ui->check_lift1_moveconst->isChecked() == 0) {
    //     //   qDebug()<<"checked"<<ui->check_lift2_moveconst->isChecked();
    //     ui->spinL2_stepwidth_tilt->setSingleStep(
    //                 ui->spinL2_stepwidth_tilt->value());
    //     float flt = arg1.toInt(&ok, 10);
    //     float res = 1;
    //     if (ui->line_lift2_tiltactpos->styleSheet() == backYello ||
    //             ui->line_lift2_tiltinactpos->styleSheet() == backYello) {
    //         res = getResolution("Lift2 tilt motor").toFloat();
    //     }
    //     qDebug() << "res" << res;
    //     s = QString::number(flt / res, 10, 4);
    // }
}
void MainWindow::on_push_lift2_cal_senshgt_clicked()
{
    err_msgboxSensorHeightLift2("drive Lift1 down until the spacer is below laser beam");
    if (calSensHeight2)
    {
        feedertimeout = 30000;
        serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,255,255,10,0\r\n"); // Lift2 const nach oben fahren
    }
}
void MainWindow::on_push_lift2_cal_intensity_clicked()
{
    if (msgboxOK("Press OK if lift2 height is below wafer senor height else press Cancel") == 0)
    {
        serialSendFeeder("&X0,0,7,1,0,0,0,17,86,\r\n");
        calsens2 = 1;
    }
}
void MainWindow::on_push_lift2_store_clicked() { STORE_FILE_partLIFT(2); }
void MainWindow::on_p_lift2_SMIF_clicked() { changeWidget("SMIF"); }
void MainWindow::on_p_lift2_constpos_up_pressed()
{
    if (ui->check_lift2_constfast_up->isChecked())
    {
        serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,255,252,47,112\r\n"); // Fast, lift2 pos wird kleiner -250000
        ui->p_lift2_constpos_up->setStyleSheet(backLightGreen);
    }
    else if (ui->check_lift2_constslow_up->isChecked())
    {
        serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,255,255,246,60\r\n"); // Slow, lift2 pos wird kleiner -2500
        ui->p_lift2_constpos_up->setStyleSheet(backLightGreen);
    }
    else err_msgbox("select speed first");
}
void MainWindow::on_p_lift2_constpos_up_released()
{
    serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,0,0,0,0\r\n"); // Lift 2 stop
    ui->p_lift2_constpos_up->setStyleSheet(backDefault);
}
void MainWindow::on_p_lift2_constpos_down_pressed() {
    if (ui->check_lift2_constfast_down->isChecked()) {
        serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,0,3,208,144\r\n"); // Fast 250000
        ui->p_lift2_constpos_down->setStyleSheet(backLightGreen);
    } else if (ui->check_lift2_constslow_down->isChecked()) {
        serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,0,0,9,196\r\n"); // Slow 2500
        ui->p_lift2_constpos_down->setStyleSheet(backLightGreen);
    } else
        err_msgbox("select speed first");
}
void MainWindow::on_p_lift2_constpos_down_released() {
    serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,0,0,0,0\r\n"); // Stop Lift 2
    ui->p_lift2_constpos_down->setStyleSheet(backDefault);
}
void MainWindow::on_p_lift2_constpos_up_tilt_pressed() {
    if (ui->check_lift2_constfast_up_tilt->isChecked()) {
        serialSendFeeder(
                    "$X_2,0,0,2,1,0,0,0,2,2,0,3,208,144\r\n"); // Fast, lift2 tilt up 250000
        ui->p_lift2_constpos_up_tilt->setStyleSheet(backLightGreen);
    } else if (ui->check_lift2_constslow_up_tilt->isChecked()) {
        serialSendFeeder(
                    "$X_2,0,0,2,1,0,0,0,2,2,0,0,9,196\r\n"); // Slow, lift2 tilt up 2500
        ui->p_lift2_constpos_up_tilt->setStyleSheet(backLightGreen);
    } else
        err_msgbox("select speed first");
}
void MainWindow::on_p_lift2_constpos_up_tilt_released() {
    serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,2,0,0,0,0\r\n"); // Stop Tilt 2
    ui->p_lift2_constpos_up_tilt->setStyleSheet(backDefault);
}
void MainWindow::on_p_lift2_constpos_dwn_tilt_pressed() {
    if (ui->check_lift2_constfast_up_tilt->isChecked()) {
        serialSendFeeder(
                    "$X_2,0,0,2,1,0,0,0,2,2,255,252,47,112\r\n"); // Fast, lift2 tilt down
        // -25000
        ui->p_lift2_constpos_dwn_tilt->setStyleSheet(backLightGreen);
    } else if (ui->check_lift2_constslow_up_tilt->isChecked()) {
        serialSendFeeder(
                    "$X_2,0,0,2,1,0,0,0,2,2,255,255,246,60\r\n"); // Slow, lift2 tilt down
        // -2500
        ui->p_lift2_constpos_dwn_tilt->setStyleSheet(backLightGreen);
    } else
        err_msgbox("select speed first");
}
void MainWindow::on_p_lift2_constpos_dwn_tilt_released() {
    serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,2,0,0,0,0\r\n"); // Stop Tilt 2
    ui->p_lift2_constpos_dwn_tilt->setStyleSheet(backDefault);
}
void MainWindow::on_radio_lift2_SMIF_clicked(bool checked) {
    if (checked) {
        ui->frame_Lift2_leica->hide();
        ui->frame_lift2_selectSMIF->show();
        ui->p_lift2_SMIF->hide();
        ui->push_lift2_store_2->setEnabled(1);
    }
}
void MainWindow::on_radio_lift2_default_clicked(bool checked) {
    if (checked) {
        ui->frame_Lift2_leica->show();
        ui->frame_lift2_selectSMIF->hide();
        ui->push_lift2_store_2->setEnabled(1);
    }
}
void MainWindow::on_radio_lift2_notinstalled_clicked(bool checked) {
    if (checked) {
        ui->frame_Lift2_leica->hide();
        ui->frame_lift2_selectSMIF->hide();
        ui->push_lift2_store_2->setEnabled(1);
    }
}
void MainWindow::on_push_lift2_store_2_clicked()
{
    if (err_msgboxTransferOK("Change lift type. Are you sure?") == 0)
    {
        store = 1; // Freigabe für Datenexport zum INSBox EPROM

        QFile f(FILE2OPEN);
        QFile f2(tmpINIFILE);
        if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
        if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) return;
        QTextStream datain(&f);
        QTextStream dataout(&f2);
        QString line;
        QString tVAL;

        while (!datain.atEnd())
        {
            line = datain.readLine();
            if (line.size() != 0)
            {
                if (line.at(0) == '[') // all Strings, die mit [ beginnen
                {
                    dataout << line.append('\n');
                    if (line.mid(1, 5) == "Lift2")
                    {
                        do
                        {
                            line = datain.readLine();
                            if (line.length() > 0)
                            {
                                if (line.mid(0, line.indexOf('=')).toLower() == "lift present")
                                {
                                    if (ui->radio_lift2_default->isChecked() || ui->radio_lift2_SMIF->isChecked()) 
                                    {
                                        tVAL = line.mid(0, line.indexOf("=") + 1).append("1");
                                    }
                                    else
                                    {
                                        tVAL = line.mid(0, line.indexOf("=") + 1).append("0");
                                    }
                                    dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                                }
                                else if (line.mid(0, line.indexOf('=')).toLower() == "smif")
                                {
                                    if (ui->radio_lift2_SMIF->isChecked())
                                    {
                                        if (ui->combo_lift2_SMIF_select->currentText() == "none")
                                        {
                                            err_msgbox("Please select SMIF type first");
                                            tVAL = line.mid(0, line.indexOf("=") + 1).append("none");
                                        }
                                        else tVAL = line.mid(0, line.indexOf("=") + 1).append(ui->combo_lift2_SMIF_select->currentText());
                                    }
                                    else tVAL = line.mid(0, line.indexOf("=") + 1).append("none");
                                    dataout << tVAL.append('\n'); // Wert in INI-File neu schreiben
                                }
                                else dataout << line.append('\n');
                            }
                            else
                            {
                                dataout << line.append('\n');
                                line = '0';
                            }
                        }
                        while (line.at(0) != '[');
                    }
                }
                else dataout << line.append('\n');
            }
            else dataout << line.append('\n');
        }
        if (QFile::exists(renameINIFILE)) QFile::remove(renameINIFILE); // letztes Inssetup.0 wird entfernt
        if (!f.rename(renameINIFILE)) fehler = 2;
        if (!f2.rename(DEFAULTINIFILE)) fehler = 2;
        if (f2.exists()) f2.close();
        if (f.exists()) f.close();
        if (fehler) err_lineinput(fehler);
        else SETUP_FILE_partLIFT(2); // alle INI-Values neu einlesen
    }
}
//------------------- Register PREALIGNER ----------------
void MainWindow::on_radio_prea_stepsmm_clicked(bool checked) {
    if (checked)
        PA_conv2mm();
    else
        PA_conv2steps();
}
void MainWindow::PA_conv2mm() {
    float height = 0.000000;
    float tmpReso = 0.000000;

    // HEIGHT motor
    tmpReso = getResolution("Prealigner height motor").toFloat();
    height = ui->line_aboveloader->text().toFloat(&ok);
    qDebug() << "reso" << tmpReso << "height" << height;
    ui->line_aboveloader->setText(QString::number(height / tmpReso));
    height = ui->line_loaderheight->text().toFloat(&ok);
    ui->line_loaderheight->setText(QString::number((height / tmpReso)));
    height = ui->line_belowloader->text().toFloat(&ok);
    ui->line_belowloader->setText(QString::number((height / tmpReso)));
    height = ui->line_chuckheight->text().toFloat(&ok);
    ui->line_chuckheight->setText(QString::number((height / tmpReso)));
    height = ui->line_preaheight->text().toFloat(&ok);
    ui->line_preaheight->setText(QString::number((height / tmpReso)));

    height = ui->line_aboveloader_2->text().toFloat(&ok);
    ui->line_aboveloader_2->setText(QString::number(height / tmpReso));
    // height = ui->line_aboveloaderthin_2->text().toFloat(&ok);
    // ui->line_aboveloaderthin_2->setText(QString::number(height / tmpReso));
    height = ui->line_loaderheight_2->text().toFloat(&ok);
    ui->line_loaderheight_2->setText(QString::number((height / tmpReso)));
    height = ui->line_belowloader_2->text().toFloat(&ok);
    ui->line_belowloader_2->setText(QString::number((height / tmpReso)));
    // height = ui->line_belowloaderthin_2->text().toFloat(&ok);
    // ui->line_belowloaderthin_2->setText(QString::number((height / tmpReso)));
    height = ui->line_chuckheight_2->text().toFloat(&ok);
    ui->line_chuckheight_2->setText(QString::number((height / tmpReso)));
    height = ui->line_preaheight_2->text().toFloat(&ok);
    ui->line_preaheight_2->setText(QString::number((height / tmpReso)));

    // PHI motor
    tmpReso = getResolution("Prealigner phi motor").toFloat();
    height = ui->line_preasensangle->text().toFloat(&ok);
    ui->line_preasensangle->setText(QString::number((height / tmpReso), 'f', 3));
    height = ui->line_preasensangle_2->text().toFloat(&ok);
    ui->line_preasensangle_2->setText(
                QString::number((height / tmpReso), 'f', 3));
    // TILT motor
    tmpReso = getResolution("Wobbler phi motor").toFloat();
    height = ui->line_wobbtiltangle->text().toFloat(&ok);
    ui->line_wobbtiltangle->setText(QString::number((height / tmpReso), 'f', 3));
    height = ui->line_wobbtiltangle_2->text().toFloat(&ok);
    ui->line_wobbtiltangle_2->setText(
                QString::number((height / tmpReso), 'f', 3));
    // ROT motor
    tmpReso = getResolution("Wobbler rotation motor").toFloat();
    height = ui->line_wobrotpos->text().toFloat(&ok);
    ui->line_wobrotpos->setText(QString::number((height / tmpReso), 'f', 3));
    height = ui->line_wobrotpos_2->text().toFloat(&ok);
    ui->line_wobrotpos_2->setText(QString::number((height / tmpReso), 'f', 3));
}
void MainWindow::PA_conv2steps() {
    float height = 0.000000;
    float tmpReso = 0.000000;
    int val;

    tmpReso = getResolution("Prealigner height motor").toFloat();
    height = ui->line_aboveloader->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_aboveloader->setText(QString::number((val)));
    height = ui->line_loaderheight->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loaderheight->setText(QString::number((val)));
    height = ui->line_belowloader->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_belowloader->setText(QString::number((val)));
    height = ui->line_chuckheight->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_chuckheight->setText(QString::number((val)));
    height = ui->line_preaheight->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_preaheight->setText(QString::number((val)));

    height = ui->line_aboveloader_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_aboveloader_2->setText(QString::number((val)));
    // height = ui->line_aboveloaderthin_2->text().toFloat(&ok);
    // val = qRound(height * tmpReso);
    // ui->line_aboveloaderthin_2->setText(QString::number((val)));
    height = ui->line_loaderheight_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loaderheight_2->setText(QString::number((val)));
    height = ui->line_belowloader_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_belowloader_2->setText(QString::number((val)));
    // height = ui->line_belowloaderthin_2->text().toFloat(&ok);
    // val = qRound(height * tmpReso);
    // ui->line_belowloaderthin_2->setText(QString::number((val)));
    height = ui->line_chuckheight_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_chuckheight_2->setText(QString::number((val)));
    height = ui->line_preaheight_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_preaheight_2->setText(QString::number((val)));

    // PHI motor
    tmpReso = getResolution("Prealigner phi motor").toFloat();
    height = ui->line_preasensangle->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_preasensangle->setText(QString::number((val)));
    height = ui->line_preasensangle_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_preasensangle_2->setText(QString::number((val)));

    // TILT motor
    tmpReso = getResolution("Wobbler phi motor").toFloat();
    height = ui->line_wobbtiltangle->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wobbtiltangle->setText(QString::number((val)));
    height = ui->line_wobbtiltangle_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wobbtiltangle_2->setText(QString::number((val)));

    // ROT motor
    tmpReso = getResolution("Wobbler rotation motor").toFloat();
    height = ui->line_wobrotpos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wobrotpos->setText(QString::number((val)));
    height = ui->line_wobrotpos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wobrotpos_2->setText(QString::number((val)));
}
void MainWindow::on_p_aligner_engine_clicked() { changeWidget("MOTOR"); }
/* RESET Prealigner */
void MainWindow::on_p_INIT_PA_Height_clicked() {
    feedertimeout = 10000;
    serialSendFeeder(RES_PAH);
}
void MainWindow::on_p_INIT_PA_Phi_clicked() {
    feedertimeout = 10000;
    serialSendFeeder(RES_PAP);
}
void MainWindow::on_p_INIT_PA_Tilt_clicked() {
    feedertimeout = 10000;
    serialSendFeeder(RES_PAT);
}
void MainWindow::on_p_INIT_PA_RotPos_clicked() {
    feedertimeout = 10000;
    serialSendFeeder(RES_PAR);
}
/* POS Prealigner */
void MainWindow::on_p_PA_abovLDhgt_clicked() {
    tmpstr = 0;
    ui->line_aboveloader->setInputMask("#99999");
    QString tmp = ui->line_aboveloader->text();
    tmpstr.append(setpos); // $SET_
    tmpstr.append("58=");  // ID PA Height ist 58
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_PA_LDhgt_clicked() {
    tmpstr = 0;
    ui->line_loaderheight->setInputMask("#99999");
    QString tmp = ui->line_loaderheight->text();
    tmpstr.append(setpos);
    tmpstr.append("58="); // ID PA Height ist 58
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_PA_belowLDhgt_clicked() {
    tmpstr = 0;
    ui->line_belowloader->setInputMask("#99999");
    QString tmp = ui->line_belowloader->text();
    tmpstr.append(setpos);
    tmpstr.append("58="); // ID PA Height ist 58
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_PA_CHhgt_clicked() {
    tmpstr = 0;
    ui->line_chuckheight->setInputMask("#99999");
    QString tmp = ui->line_chuckheight->text();
    tmpstr.append(setpos);
    tmpstr.append("58="); // ID PA Height ist 58
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_PA_hgt_clicked() {
    tmpstr = 0;
    ui->line_preaheight->setInputMask("#99999");
    QString tmp = ui->line_preaheight->text();
    tmpstr.append(setpos);
    tmpstr.append("58="); // ID PA Height ist 58
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_PA_SnesAngle_clicked() {
    tmpstr = 0;
    ui->line_preasensangle->setInputMask("#99999");
    QString tmp = ui->line_preasensangle->text();
    tmpstr.append(setpos);
    tmpstr.append("59="); // ID PA Phi ist 59
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_PA_count_clicked() { err_msgbox("not in use"); }
void MainWindow::on_p_PA_precount_clicked() { err_msgbox("not in use"); }
void MainWindow::on_p_PA_postcount_clicked() { err_msgbox("not in use"); }
void MainWindow::on_p_PA_WOtilt_clicked() {
    tmpstr = 0;
    //   ui->line_wobbtiltangle->setInputMask("#99999");
    QString tmp = ui->line_wobbtiltangle->text();
    tmpstr.append(setpos); // $SET_
    tmpstr.append("56=");  // PA Tilt
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_PA_WOrotpos_clicked() {
    tmpstr = 0;
    //   ui->line_wobrotpos->setInputMask("#99999");
    QString tmp = ui->line_wobrotpos->text();
    tmpstr.append(setpos);
    tmpstr.append("57="); // ID PA RotPos ist 57
    tmpstr.append(QString::number(tmp.toInt(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_check_preavac_clicked(bool checked) {
    resCLEANflags();
    if (checked == 0)
        serialSendFeeder(vacoffPA);
    else
        serialSendFeeder(vaconPA); // aligner
}
void MainWindow::on_check_wob_deactiv_toggled(bool checked) {
    if (checked == 1) {
        ui->label_preawobbpresent->setStyleSheet("background-color: green");
        ui->label_wobpresent->setText("Wobble present");

    } else if (checked == 0) {
        ui->label_preawobbpresent->setStyleSheet("background-color: Red");
        ui->label_wobpresent->setText("Wobble not present");
    }
}
void MainWindow::on_check_woturn_clicked(bool checked) {
    if (checked)
        serialSendFeeder("&X0,0,4,1,0,0,0,2,1,0,1,56,128,\r\n"); // Slow
    else
        serialSendFeeder("&X0,0,4,1,0,0,0,2,1,0,0,0,0,\r\n"); // Stop
}
void MainWindow::on_check_preaturn_clicked(bool checked) {
    if (checked)
        serialSendFeeder("&X0,0,4,1,0,0,0,2,2,0,1,39,128,\r\n"); // Slow
    else
        serialSendFeeder("&X0,0,4,1,0,0,0,2,2,0,0,0,0,\r\n"); // Stop
}
void MainWindow::on_p_PA_store_clicked() // ok
{
    STORE_FILE_partPREAS();
}
void MainWindow::on_push_PA_upload_clicked() { serialSendFeeder(EE_Aligner); }
void MainWindow::on_check_PA_moveconst_stateChanged()
{
  //  f_setSlidecolor();
}
// void MainWindow::on_hSlide_PA_aLDH_actionTriggered(int action) {
//     int stepsplus = ui->spinPA_stepwidth->value();
//     float addheight = ui->spinPA_stepwidth->text().toFloat(&ok);
//     float tmpReso = getResolution("Prealigner height motor").toFloat();
//     int line = ui->line_aboveloader->text().toInt(&ok, 10);
//     float line_mm = ui->line_aboveloader_3->text().toFloat(&ok);

//     qDebug() << "line_mm" << line_mm << "height" << addheight << "height/tmpReso"
//              << addheight / tmpReso
//              << "QString::number((line_mm + addheight/tmpReso), 'f', 4)"
//              << QString::number((line_mm + addheight / tmpReso), 'f', 4);

//     if (cmdfeeder == 0) {
//         switch (action) {
//         case 1:
//             ui->line_aboveloader_3->setText(
//                         QString::number((line_mm + addheight / tmpReso), 'f', 3));
//             ui->line_aboveloader->setText(QString::number(line + stepsplus));
//             break;
//         case 2:
//             ui->line_aboveloader_3->setText(
//                         QString::number((line_mm - addheight / tmpReso), 'f', 3));
//             ui->line_aboveloader->setText(QString::number(line - stepsplus));
//             break;
//         case 7:
//             ui->hSlide_PA_aLDH->setValue(0);
//             break;
//         }
//         if (ui->check_PA_moveconst->isChecked()) {
//             ui->hSlide_PA_aLDH->setStyleSheet(hSliderYello);
//             serializePosData(&bytedata1, ui->line_aboveloader);
//             QByteArray xcmd =
//                     "&X0,0,3,1,0,0,0,1,3," + bytedata1 + "," + MPslow + ",\r\n";
//             serialSendFeeder(xcmd);
//         }
//     }
// }
// void MainWindow::on_hSlide_PA_LDH_actionTriggered(int action) {
//     int stepsplus = ui->spinPA_stepwidth->value();
//     int line = ui->line_loaderheight->text().toInt(&ok, 10);
//     float addheight = ui->spinPA_stepwidth->text().toFloat(&ok);
//     float tmpReso = getResolution("Prealigner height motor").toFloat();
//     float line_mm = ui->line_loaderheight_3->text().toFloat(&ok);

//     if (cmdfeeder == 0) {
//         switch (action) {
//         case 1:
//             ui->line_loaderheight_3->setText(
//                         QString::number((line_mm + addheight / tmpReso), 'f', 3));
//             ui->line_loaderheight->setText(QString::number(line + stepsplus));
//             break;
//         case 2:
//             ui->line_loaderheight_3->setText(
//                         QString::number((line_mm - addheight / tmpReso), 'f', 3));
//             ui->line_loaderheight->setText(QString::number(line - stepsplus));
//             break;
//         case 7:
//             ui->hSlide_PA_LDH->setValue(0);
//             break;
//         }
//         if (ui->check_PA_moveconst->isChecked()) {
//             ui->hSlide_PA_LDH->setStyleSheet(hSliderYello);
//             serializePosData(&bytedata1, ui->line_loaderheight);
//             QByteArray xcmd =
//                     "&X0,0,3,1,0,0,0,1,3," + bytedata1 + "," + MPslow + ",\r\n";
//             serialSendFeeder(xcmd);
//         }
//     }
// }
// void MainWindow::on_hSlide_PA_bLDH_actionTriggered(int action)
// {
//     int stepsplus = ui->spinPA_stepwidth->value();
//     int line = ui->line_belowloader->text().toInt(&ok, 10);
//     float addheight = ui->spinPA_stepwidth->text().toFloat(&ok);
//     float tmpReso = getResolution("Prealigner height motor").toFloat();
//     float line_mm = ui->line_belowloader_3->text().toFloat(&ok);

//     if (cmdfeeder == 0)
//     {
//         switch (action)
//         {
//         case 1:
//             ui->line_belowloader_3->setText(QString::number((line_mm + addheight / tmpReso), 'f', 3));
//             ui->line_belowloader->setText(QString::number(line + stepsplus));
//             break;
//         case 2:
//             ui->line_belowloader_3->setText(
//                         QString::number((line_mm - addheight / tmpReso), 'f', 3));
//             ui->line_belowloader->setText(QString::number(line - stepsplus));
//             break;
//         case 7:
//             ui->hSlide_PA_bLDH->setValue(0);
//             break;
//         }
//         if (ui->check_PA_moveconst->isChecked())
//         {
//             ui->hSlide_PA_bLDH->setStyleSheet(hSliderYello);
//             serializePosData(&bytedata1, ui->line_belowloader);
//             QByteArray xcmd = "&X0,0,3,1,0,0,0,1,3," + bytedata1 + "," + MPslow + ",\r\n";
//             serialSendFeeder(xcmd);
//         }
//     }
// }
// void MainWindow::on_hSlide_PA_CHH_actionTriggered(int action)
// {
//     int stepsplus = ui->spinPA_stepwidth->value();
//     int line = ui->line_chuckheight->text().toInt(&ok, 10);
//     float addheight = ui->spinPA_stepwidth->text().toFloat(&ok);
//     float tmpReso = getResolution("Prealigner height motor").toFloat();
//     float line_mm = ui->line_chuckheight_3->text().toFloat(&ok);

//     if (cmdfeeder == 0) {
//         switch (action) {
//         case 1:
//             ui->line_chuckheight_3->setText(
//                         QString::number((line_mm + addheight / tmpReso), 'f', 3));
//             ui->line_chuckheight->setText(QString::number(line + stepsplus));
//             break;
//         case 2:
//             ui->line_chuckheight_3->setText(
//                         QString::number((line_mm - addheight / tmpReso), 'f', 3));
//             ui->line_chuckheight->setText(QString::number(line - stepsplus));
//             break;
//         case 7:
//             ui->hSlide_PA_CHH->setValue(0);
//             break;
//         }
//         if (ui->check_PA_moveconst->isChecked()) {
//             ui->hSlide_PA_CHH->setStyleSheet(hSliderYello);
//             serializePosData(&bytedata1, ui->line_chuckheight);
//             QByteArray xcmd =
//                     "&X0,0,3,1,0,0,0,1,3," + bytedata1 + "," + MPslow + ",\r\n";
//             serialSendFeeder(xcmd);
//         }
//     }
// }
// void MainWindow::on_hSlide_PA_PAH_actionTriggered(int action) {
//     int stepsplus = ui->spinPA_stepwidth->value();
//     int line = ui->line_preaheight->text().toInt(&ok, 10);
//     float addheight = ui->spinPA_stepwidth->text().toFloat(&ok);
//     float tmpReso = getResolution("Prealigner height motor").toFloat();
//     float line_mm = ui->line_preaheight_3->text().toFloat(&ok);

//     if (cmdfeeder == 0) {
//         switch (action) {
//         case 1:
//             ui->line_preaheight_3->setText(
//                         QString::number((line_mm + addheight / tmpReso), 'f', 3));
//             ui->line_preaheight->setText(QString::number(line + stepsplus));
//             break;
//         case 2:
//             ui->line_preaheight_3->setText(
//                         QString::number((line_mm - addheight / tmpReso), 'f', 3));
//             ui->line_preaheight->setText(QString::number(line - stepsplus));
//             break;
//         case 7:
//             ui->hSlide_PA_PAH->setValue(0);
//             break;
//         }
//         if (ui->check_PA_moveconst->isChecked()) {
//             ui->hSlide_PA_PAH->setStyleSheet(hSliderYello);
//             serializePosData(&bytedata1, ui->line_preaheight);
//             QByteArray xcmd =
//                     "&X0,0,3,1,0,0,0,1,3," + bytedata1 + "," + MPslow + ",\r\n";
//             serialSendFeeder(xcmd);
//         }
//     }
// }
// void MainWindow::on_hSlide_PA_SensAngle_actionTriggered(int action) {
//     int stepsplus = ui->spinPA_stepwidth_phi->value();
//     int line = ui->line_preasensangle->text().toInt(&ok, 10);
//     float addheight = ui->spinPA_stepwidth_phi->text().toFloat(&ok);
//     float tmpReso = getResolution("Prealigner phi motor").toFloat();
//     float line_mm = ui->line_preasensangle_3->text().toFloat(&ok);

//     if (cmdfeeder == 0) {
//         switch (action) {
//         case 1:
//             ui->line_preasensangle_3->setText(
//                         QString::number((line_mm + addheight / tmpReso), 'f', 3));
//             ui->line_preasensangle->setText(QString::number(line + stepsplus));
//             break;
//         case 2:
//             ui->line_preasensangle_3->setText(
//                         QString::number((line_mm - addheight / tmpReso), 'f', 3));
//             ui->line_preasensangle->setText(QString::number(line - stepsplus));
//             break;
//         case 7:
//             ui->hSlide_PA_SensAngle->setValue(0);
//             break;
//         }
//         if (ui->check_PA_moveconst->isChecked()) {
//             ui->hSlide_PA_SensAngle->setStyleSheet(hSliderYello);
//             serializePosData(&bytedata1, ui->line_preasensangle);
//             QByteArray xcmd =
//                     "&X0,0,4,1,0,0,0,1,2," + bytedata1 + "," + MPslow + ",\r\n";
//             serialSendFeeder(xcmd);
//         }
//     }
// }
// void MainWindow::on_hSlide_PA_WOTilt_actionTriggered(int action) {
//     int stepsplus = ui->spinPA_stepwidth_tilt->value();
//     int line = ui->line_wobbtiltangle->text().toInt(&ok, 10);
//     float addheight = ui->spinPA_stepwidth_tilt->text().toFloat(&ok);
//     float tmpReso = getResolution("Prealigner height motor").toFloat();
//     float line_mm = ui->line_wobbtiltangle_3->text().toFloat(&ok);

//     if (cmdfeeder == 0) {
//         switch (action) {
//         case 1:
//             ui->line_wobbtiltangle_3->setText(
//                         QString::number((line_mm + addheight / tmpReso), 'f', 3));
//             ui->line_wobbtiltangle->setText(QString::number(line + stepsplus));
//             break;
//         case 2:
//             ui->line_wobbtiltangle_3->setText(
//                         QString::number((line_mm - addheight / tmpReso), 'f', 3));
//             ui->line_wobbtiltangle->setText(QString::number(line - stepsplus));
//             break;
//         case 7:
//             ui->hSlide_PA_WOTilt->setValue(0);
//             break;
//         }
//         if (ui->check_PA_moveconst->isChecked()) {
//             ui->hSlide_PA_WOTilt->setStyleSheet(hSliderYello);
//             serializePosData(&bytedata1, ui->line_wobbtiltangle);
//             QByteArray xcmd =
//                     "&X0,0,4,1,0,0,0,1,3," + bytedata1 + "," + MPslow + ",\r\n";
//             serialSendFeeder(xcmd);
//         }
//     }
// }
// void MainWindow::on_hSlide_PA_WORot_actionTriggered(int action) {
//     int stepsplus = ui->spinPA_stepwidth_rot->value();
//     int line = ui->line_wobrotpos->text().toInt(&ok, 10);
//     float addheight = ui->spinPA_stepwidth_rot->text().toFloat(&ok);
//     float tmpReso = getResolution("Prealigner height motor").toFloat();
//     float line_mm = ui->line_wobrotpos_3->text().toFloat(&ok);

//     if (cmdfeeder == 0) {
//         switch (action) {
//         case 1:
//             ui->line_wobrotpos_3->setText(
//                         QString::number((line_mm + addheight / tmpReso), 'f', 3));
//             ui->line_wobrotpos->setText(QString::number(line + stepsplus));
//             break;
//         case 2:
//             ui->line_wobrotpos_3->setText(
//                         QString::number((line_mm - addheight / tmpReso), 'f', 3));
//             ui->line_wobrotpos->setText(QString::number(line - stepsplus));
//             break;
//         case 7:
//             ui->hSlide_PA_WORot->setValue(0);
//             break;
//         }
//         if (ui->check_PA_moveconst->isChecked()) {
//             ui->hSlide_PA_WORot->setStyleSheet(hSliderYello);
//             serializePosData(&bytedata1, ui->line_wobrotpos);
//             QByteArray xcmd =
//                     "&X0,0,4,1,0,0,0,1,1," + bytedata1 + "," + MPslow + ",\r\n";
//             serialSendFeeder(xcmd);
//         }
//     }
// }
void MainWindow::on_p_PA_getheight_clicked() {
    waitACTpos = getPrea;
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,3,\r\n"); // READ_POS PA Height
    ui->p_PA_getheight->setStyleSheet(backLightYello);
}
void MainWindow::on_p_PA_getPhi_clicked() {
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,3,2,\r\n"); // READ_POS PA Phi
    ui->p_PA_getPhi->setStyleSheet(backLightYello);
    waitACTpos = getPreaPhi;
}
void MainWindow::on_p_PA_getTilt_clicked() {
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,3,3,\r\n"); // READ_POS WO Tilt
    ui->p_PA_getTilt->setStyleSheet(backLightYello);
    waitACTpos = getTilt;
}
void MainWindow::on_p_PA_getRot_clicked() {
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,3,1,\r\n"); // READ_POS WO Rotpos
    ui->p_PA_getRot->setStyleSheet(backLightYello);
    ui->p_PA_getRot_2->setStyleSheet(backLightYello);
    waitACTpos = getRotPos;
}
void MainWindow::on_p_align_constpos_height_up_pressed() // Node3 Motor3 PA height
{
    serialSendFeeder(
                "$X_2,0,0,3,1,0,0,0,2,3,255,255,216,240\r\n"); // PA height slow up -10000
    ui->p_align_constpos_height_up->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_align_constpos_height_dwn_pressed() // Node3 Motor3 PA height
{
    serialSendFeeder(
                "$X_2,0,0,3,1,0,0,0,2,3,0,0,39,16\r\n"); // PA height slow down 10000
    ui->p_align_constpos_height_dwn->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_align_constpos_height_up_released() {
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,3,0,0,0,0\r\n"); // Stop PA height
    ui->p_align_constpos_height_up->setStyleSheet(backDefault);
}
void MainWindow::on_p_align_constpos_height_dwn_released() {
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,3,0,0,0,0\r\n"); // PA height stop
    ui->p_align_constpos_height_dwn->setStyleSheet(backDefault);
}
void MainWindow::on_p_align_constpos_phi_cw_pressed() // Node 4, Motor 2
{
    serialSendFeeder(
                "$X_2,0,0,4,1,0,0,0,2,2,255,255,216,240\r\n"); // PA phi cw -10000
    ui->p_align_constpos_phi_cw->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_align_constpos_phi_cw_released() {
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,2,0,0,0,0\r\n"); // PA phi stop
    ui->p_align_constpos_phi_cw->setStyleSheet(backDefault);
}
void MainWindow::on_p_align_constpos_phi_ccw_pressed() {
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,2,0,0,39,16\r\n"); // PA phi ccw 10000
    ui->p_align_constpos_phi_ccw->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_align_constpos_phi_ccw_released() {
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,2,0,0,0,0\r\n"); // PA phi stop
    ui->p_align_constpos_phi_ccw->setStyleSheet(backDefault);
}
void MainWindow::on_p_align_constpos_tilt_up_pressed() // Node 4, Motor 3
{
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,3,0,0,39,16\r\n"); // PA tilt up 10000
    ui->p_align_constpos_tilt_up->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_align_constpos_tilt_up_released() {
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,3,0,0,0,0\r\n"); // PA tilt stop
    ui->p_align_constpos_tilt_up->setStyleSheet(backDefault);
}
void MainWindow::on_p_align_constpos_tilt_dwn_pressed() {
    serialSendFeeder(
                "$X_2,0,0,4,1,0,0,0,2,3,255,255,216,240\r\n"); // PA tilt down -10000
    ui->p_align_constpos_tilt_dwn->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_align_constpos_tilt_dwn_released() {
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,3,0,0,0,0\r\n"); // Stop PA tilt
    ui->p_align_constpos_tilt_dwn->setStyleSheet(backDefault);
}
void MainWindow::on_p_align_constpos_rot_cw_pressed() // Node 4, Motor 1
{
    serialSendFeeder(
                "$X_2,0,0,4,1,0,0,0,2,1,0,0,39,16\r\n"); // PA rotpos cw 10000
    ui->p_align_constpos_rot_cw->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_align_constpos_rot_cw_released() {
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,1,0,0,0,0\r\n"); // PA rotpos stop
    ui->p_align_constpos_rot_cw->setStyleSheet(backDefault);
}
void MainWindow::on_p_align_constpos_rot_ccw_pressed() {
    serialSendFeeder(
                "$X_2,0,0,4,1,0,0,0,2,1,255,255,216,240\r\n"); // PA rotpos ccw -10000
    ui->p_align_constpos_rot_ccw->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_align_constpos_rot_ccw_released() {
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,1,0,0,0,0\r\n"); // PA rotpos stop
    ui->p_align_constpos_rot_ccw->setStyleSheet(backDefault);
}
void MainWindow::on_p_align_getws_clicked() {
    tmpstr = 0;
    tmpstr.append(READ);
    tmpstr.append("56"); // Wafer Sensor
    // tmpstr.append("=");
    // tmpstr.append("1");
    tmpstr.append(CRLF);
    serialSendFeeder(tmpstr);
}
//------------------- Register WAFERCHANGER --------------
void MainWindow::on_radio_wc_stepsmm_clicked(bool checked) {
    if (checked)
        WC_conv2mm();
    else
        WC_conv2steps();
}
void MainWindow::WC_conv2mm() {
    float height = 0.000000;
    float tmpReso = 0.000000;

    // Waferchanger height motor
    tmpReso = getResolution("Waferchanger height motor").toFloat();
    height = ui->line_wc_abovechuckheight->text().toFloat(&ok);
    ui->line_wc_abovechuckheight->setText(QString::number(height / tmpReso));
    height = ui->line_wc_chuckheight->text().toFloat(&ok);
    ui->line_wc_chuckheight->setText(QString::number((height / tmpReso)));
    height = ui->line_wc_belowchuckheight->text().toFloat(&ok);
    ui->line_wc_belowchuckheight->setText(QString::number((height / tmpReso)));
    // height = ui->line_wc_chuckfreeheight->text().toFloat(&ok);
    // ui->line_wc_chuckfreeheight->setText(QString::number((height/tmpReso)));
    // height = ui->line_wc_loheight->text().toFloat(&ok);
    // ui->line_wc_loheight->setText(QString::number((height/tmpReso)));

    height = ui->line_wc_abovechuckheight_2->text().toFloat(&ok);
    ui->line_wc_abovechuckheight_2->setText(QString::number(height / tmpReso));
    height = ui->line_wc_chuckheight_2->text().toFloat(&ok);
    ui->line_wc_chuckheight_2->setText(QString::number((height / tmpReso)));
    height = ui->line_wc_belowchuckheight_2->text().toFloat(&ok);
    ui->line_wc_belowchuckheight_2->setText(QString::number((height / tmpReso)));
    // height = ui->line_wc_chuckfreeheight_2->text().toFloat(&ok);
    // ui->line_wc_chuckfreeheight_2->setText(QString::number((height/tmpReso)));
    // height = ui->line_wc_loheight_2->text().toFloat(&ok);
    // ui->line_wc_loheight_2->setText(QString::number((height/tmpReso)));

    // PHI motor
    tmpReso = getResolution("Waferchanger phi motor").toFloat();
    height = ui->line_wc_leftpos->text().toFloat(&ok);
    ui->line_wc_leftpos->setText(QString::number((height / tmpReso), 'f', 3));
    height = ui->line_wc_middlepos->text().toFloat(&ok);
    ui->line_wc_middlepos->setText(QString::number((height / tmpReso), 'f', 3));
    height = ui->line_wc_rightpos->text().toFloat(&ok);
    ui->line_wc_rightpos->setText(QString::number((height / tmpReso), 'f', 3));

    height = ui->line_wc_leftpos_2->text().toFloat(&ok);
    ui->line_wc_leftpos_2->setText(QString::number((height / tmpReso), 'f', 3));
    height = ui->line_wc_middlepos_2->text().toFloat(&ok);
    ui->line_wc_middlepos_2->setText(QString::number((height / tmpReso), 'f', 3));
    height = ui->line_wc_rightpos_2->text().toFloat(&ok);
    ui->line_wc_rightpos_2->setText(QString::number((height / tmpReso), 'f', 3));
}
void MainWindow::WC_conv2steps() {
    float height = 0.000000;
    float tmpReso = 0.000000;
    int val;

    // Waferchanger height motor
    tmpReso = getResolution("Waferchanger height motor").toFloat();
    height = ui->line_wc_abovechuckheight->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_abovechuckheight->setText(QString::number((val)));
    height = ui->line_wc_chuckheight->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_chuckheight->setText(QString::number((val)));
    height = ui->line_wc_belowchuckheight->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_belowchuckheight->setText(QString::number((val)));
    // height = ui->line_wc_chuckfreeheight->text().toFloat(&ok);
    // val = qRound(height*tmpReso);
    // ui->line_wc_chuckfreeheight->setText(QString::number((val)));
    // height = ui->line_wc_loheight->text().toFloat(&ok);
    // val = qRound(height*tmpReso);
    // ui->line_wc_loheight->setText(QString::number((val)));

    height = ui->line_wc_abovechuckheight_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_abovechuckheight_2->setText(QString::number((val)));
    height = ui->line_wc_chuckheight_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_chuckheight_2->setText(QString::number((val)));
    height = ui->line_wc_belowchuckheight_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_belowchuckheight_2->setText(QString::number((val)));
    // height = ui->line_wc_chuckfreeheight_2->text().toFloat(&ok);
    // val = qRound(height*tmpReso);
    // ui->line_wc_chuckfreeheight_2->setText(QString::number((val)));
    // height = ui->line_wc_loheight_2->text().toFloat(&ok);
    // val = qRound(height*tmpReso);
    // ui->line_wc_loheight_2->setText(QString::number((val)));

    // PHI motor
    tmpReso = getResolution("Waferchanger phi motor").toFloat();
    height = ui->line_wc_leftpos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_leftpos->setText(QString::number((val)));
    height = ui->line_wc_middlepos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_middlepos->setText(QString::number((val)));
    height = ui->line_wc_rightpos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_rightpos->setText(QString::number((val)));

    height = ui->line_wc_leftpos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_leftpos_2->setText(QString::number((val)));
    height = ui->line_wc_middlepos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_middlepos_2->setText(QString::number((val)));
    height = ui->line_wc_rightpos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_wc_rightpos_2->setText(QString::number((val)));
}
void MainWindow::on_check_wc_deactivate_stateChanged(int arg1) {
    if (arg1 == 2) {
        ui->label_wcpresent->setStyleSheet("background-color: green");
        ui->label_wcpresentlabel->setText("Wafer changer present");
    } else if (arg1 == 0) {
        ui->label_wcpresent->setStyleSheet("background-color: Red");
        ui->label_wcpresentlabel->setText("Wafer changer not present");
    }
}
void MainWindow::on_p_wc_engine_clicked() { changeWidget("MOTOR"); }
void MainWindow::on_p_wc_initheight_clicked() {
    feedertimeout = 10000;
    serialSendFeeder(RES_WCH);
}
void MainWindow::on_p_wc_initangle_clicked() {
    feedertimeout = 6000;
    serialSendFeeder(RES_WCP);
}
void MainWindow::on_push_WC_upload_clicked() { serialSendFeeder(EE_WC); }
void MainWindow::on_p_WC_abovCHhgt_clicked() { wc_pos_abovechuckhgt(); }
void MainWindow::on_p_WC_CHhgt_clicked() { wc_pos_chuckhgt(); }
void MainWindow::on_p_WC_belowCHhgt_clicked() {
    tmpstr = 0;
    ui->line_wc_belowchuckheight->setInputMask("#99999");
    QString tmp = ui->line_wc_belowchuckheight->text();
    tmpstr.append(setpos);
    tmpstr.append("61="); // ID WC Height ist 61
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_WC_left_clicked() {
    tmpstr = 0;
    ui->line_wc_leftpos->setInputMask("#9999999");
    QString tmp = ui->line_wc_leftpos->text();
    tmpstr.append(setpos);
    tmpstr.append("62="); // ID WC Phi ist 62
    tmpstr.append(QString::number(tmp.toInt()).toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 8000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_WC_middle_clicked() { wc_pos_middle(); }
void MainWindow::on_p_sys_posWCmiddle_2_clicked() {
    serialSendFeeder("$SET_60=0\r\n"); // setzt auch API-Flag WCok
}
void MainWindow::on_p_WC_right_clicked() {
    tmpstr = 0;
    ui->line_wc_rightpos->setInputMask("#9999999");
    QString tmp = ui->line_wc_rightpos->text();
    tmpstr.append(setpos);
    tmpstr.append("62="); // ID WC Phi ist 62
    tmpstr.append(QString::number(tmp.toInt()).toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 5000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_check_wc_vacuumchuck_clicked(bool checked) {
    resCLEANflags();
    if (checked == 0)
        serialSendFeeder(vacoffCH4);
    else
        serialSendFeeder(vaconCH4); // chuck 4
}
void MainWindow::on_check_wc_vacuumright_clicked(bool checked) {
    resCLEANflags();
    if (checked == 0)
        serialSendFeeder(vacoffWC2);
    else
        serialSendFeeder(vaconWC2); // wc2
}
void MainWindow::on_check_wc_vacuumleft_clicked(bool checked) {
    resCLEANflags();
    if (checked == 0)
        serialSendFeeder(vacoffWC1);
    else
        serialSendFeeder(vaconWC1); // wc1
}
void MainWindow::on_check_preavac_2_clicked(bool checked) {
    resCLEANflags();
    if (checked == 0)
        serialSendFeeder(vacoffPA);
    else
        serialSendFeeder(vaconPA); // aligner
}
void MainWindow::wc_pos_chuckhgt() {
    tmpstr = 0;
    ui->line_wc_chuckheight->setInputMask("#99999");
    QString tmp = ui->line_wc_chuckheight->text();
    tmpstr.append(setpos);
    tmpstr.append("61="); // ID WC Height ist 61
    tmpstr.append(QString::number(tmp.toInt()).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::wc_pos_abovechuckhgt() {
    tmpstr = 0;
    ui->line_wc_abovechuckheight->setInputMask("#99999");
    QString tmp = ui->line_wc_abovechuckheight->text();
    tmpstr.append(setpos);
    tmpstr.append("61="); // ID WC Height ist 61
    tmpstr.append(QString::number(tmp.toInt()).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::wc_pos_middle() {
    tmpstr = 0;
    ui->line_wc_middlepos->setInputMask("#9999999");
    QString tmp = ui->line_wc_middlepos->text();
    tmpstr.append(setpos);
    tmpstr.append("62="); // ID WC Phi ist 62
    tmpstr.append(QString::number(tmp.toInt()).toLatin1());
    qDebug() << QString::number(tmp.toInt());
    tmpstr.append("\r\n");
    feedertimeout = 8000;
    serialSendFeeder(tmpstr);
}
void MainWindow::wc_pos_left() {
    tmpstr = 0;
    ui->line_wc_leftpos->setInputMask("#9999999");
    QString tmp = ui->line_wc_leftpos->text();
    tmpstr.append(setpos);
    tmpstr.append("62="); // ID WC Phi ist 62
    tmpstr.append(QString::number(tmp.toInt()).toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 8000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_wc_store_clicked() { STORE_FILE_partWC(); }
void MainWindow::on_check_WC_moveconst_stateChanged() // checkbox motor move
{
}
void MainWindow::on_p_WC_getheight_clicked()
{
    if (cmdfeeder == 0) {
        waitACTpos = getWC;
        serialSendFeeder("$X_2,0,0,5,1,0,0,0,3,3,\r\n"); // READ_POS WC Height
        ui->p_WC_getheight->setStyleSheet(backLightYello);
    }
}
void MainWindow::on_p_WC_getPhi_clicked()
{
    if (cmdfeeder == 0)
    {
        waitACTpos = getWCPhi;
        serialSendFeeder("$X_2,0,0,6,1,0,0,0,3,3,\r\n"); // READ_POS WC Phi
        ui->p_WC_getPhi->setStyleSheet(backLightYello);
    }
}
void MainWindow::on_p_wc_constpos_up_pressed() // WC height Node5 Motor3
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,2,3,255,255,216,240\r\n"); // WC height up -10000
    ui->p_wc_constpos_up->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_wc_constpos_up_released()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,2,3,0,0,0,0\r\n"); // WC height stop
    ui->p_wc_constpos_up->setStyleSheet(backDefault);
}
void MainWindow::on_p_wc_constpos_dwn_pressed()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,2,3,0,0,39,16\r\n"); // WC height down 10000
    ui->p_wc_constpos_dwn->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_wc_constpos_dwn_released()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,2,3,0,0,0,0\r\n"); // WC height stop
    ui->p_wc_constpos_dwn->setStyleSheet(backDefault);
}
void MainWindow::on_p_wc_constpos_phi_cw_pressed() // WC phi Node6 Motor3
{
    serialSendFeeder("$X_2,0,0,6,1,0,0,0,2,3,255,255,216,240\r\n"); // WC phi const cw -10000
    ui->p_wc_constpos_phi_cw->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_wc_constpos_phi_cw_released()
{
    serialSendFeeder("$X_2,0,0,6,1,0,0,0,2,3,0,0,0,0\r\n"); // WC phi stop
    ui->p_wc_constpos_phi_cw->setStyleSheet(backDefault);
}
void MainWindow::on_p_wc_constpos_phi_ccw_pressed()
{
    serialSendFeeder("$X_2,0,0,6,1,0,0,0,2,3,0,0,39,16\r\n"); // WC phi ccw 10000
    ui->p_wc_constpos_phi_ccw->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_wc_constpos_phi_ccw_released()
{
    serialSendFeeder("$X_2,0,0,6,1,0,0,0,2,3,0,0,0,0\r\n"); // WC phi stop
    ui->p_wc_constpos_phi_ccw->setStyleSheet(backDefault);
}
//------------------- Register LOADER --------------------
// void MainWindow::on_radio_loader_stepsmm_clicked(bool checked)
// {
// }
void MainWindow::LD_conv2mm()
{
    float height = 0.000000;
    float tmpReso = 0.000000;

    // Loader x - motor
    tmpReso = getResolution("Loader x - motor").toFloat();
    height = ui->line_loader_xlift1pos->text().toFloat(&ok);
    ui->line_loader_xlift1pos->setText(QString::number(height / tmpReso));
    height = ui->line_loader_xlift2pos->text().toFloat(&ok);
    ui->line_loader_xlift2pos->setText(QString::number((height / tmpReso)));
    height = ui->line_loader_xpreapos->text().toFloat(&ok);
    ui->line_loader_xpreapos->setText(QString::number((height / tmpReso)));
    height = ui->line_loader_xpreafreepos->text().toFloat(&ok);
    ui->line_loader_xpreafreepos->setText(QString::number((height / tmpReso)));

    height = ui->line_loader_xlift1pos_2->text().toFloat(&ok);
    ui->line_loader_xlift1pos_2->setText(QString::number(height / tmpReso));
    height = ui->line_loader_xlift2pos_2->text().toFloat(&ok);
    ui->line_loader_xlift2pos_2->setText(QString::number((height / tmpReso)));
    height = ui->line_loader_xpreapos_2->text().toFloat(&ok);
    ui->line_loader_xpreapos_2->setText(QString::number((height / tmpReso)));
    height = ui->line_loader_xpreafreepos_2->text().toFloat(&ok);
    ui->line_loader_xpreafreepos_2->setText(QString::number((height / tmpReso)));

    // Loader y - motor
    tmpReso = getResolution("Loader y - motor").toFloat();
    height = ui->line_loader_ylift1inpos->text().toFloat(&ok);
    ui->line_loader_ylift1inpos->setText(
                QString::number((height / tmpReso), 'f', 3));
    height = ui->line_loader_ylift2inpos->text().toFloat(&ok);
    ui->line_loader_ylift2inpos->setText(
                QString::number((height / tmpReso), 'f', 3));
    //    height = ui->line_loader_yliftdispl->text().toFloat(&ok);
    //    ui->line_loader_yliftdispl->setText(QString::number((height/tmpReso),'f',3));
    height = ui->line_loader_youtlift->text().toFloat(&ok);
    ui->line_loader_youtlift->setText(
                QString::number((height / tmpReso), 'f', 3));
    height = ui->line_loader_ypreapos->text().toFloat(&ok);
    ui->line_loader_ypreapos->setText(
                QString::number((height / tmpReso), 'f', 3));

    height = ui->line_loader_ylift1inpos_2->text().toFloat(&ok);
    ui->line_loader_ylift1inpos_2->setText(
                QString::number((height / tmpReso), 'f', 3));
    height = ui->line_loader_ylift2inpos_2->text().toFloat(&ok);
    ui->line_loader_ylift2inpos_2->setText(
                QString::number((height / tmpReso), 'f', 3));
    // height = ui->line_loader_yliftdispl_3->text().toFloat(&ok);
    // ui->line_loader_yliftdispl_3->setText(QString::number((height/tmpReso),'f',3));
    height = ui->line_loader_youtlift_2->text().toFloat(&ok);
    ui->line_loader_youtlift_2->setText(
                QString::number((height / tmpReso), 'f', 3));
    height = ui->line_loader_ypreapos_2->text().toFloat(&ok);
    ui->line_loader_ypreapos_2->setText(
                QString::number((height / tmpReso), 'f', 3));
}
void MainWindow::LD_conv2steps() {
    float height = 0.000000;
    float tmpReso = 0.000000;
    int val;

    tmpReso = getResolution("Loader x - motor").toFloat();
    height = ui->line_loader_xlift1pos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_xlift1pos->setText(QString::number((val)));
    height = ui->line_loader_xlift2pos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_xlift2pos->setText(QString::number((val)));
    height = ui->line_loader_xpreapos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_xpreapos->setText(QString::number((val)));
    height = ui->line_loader_xpreafreepos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_xpreafreepos->setText(QString::number((val)));

    height = ui->line_loader_xlift1pos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_xlift1pos_2->setText(QString::number((val)));
    height = ui->line_loader_xlift2pos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_xlift2pos_2->setText(QString::number((val)));
    height = ui->line_loader_xpreapos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_xpreapos_2->setText(QString::number((val)));
    height = ui->line_loader_xpreafreepos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_xpreafreepos_2->setText(QString::number((val)));

    // Loader y - motor
    tmpReso = getResolution("Loader y - motor").toFloat();
    height = ui->line_loader_ylift1inpos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_ylift1inpos->setText(QString::number((val)));
    height = ui->line_loader_ylift2inpos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_ylift2inpos->setText(QString::number((val)));
    //    height = ui->line_loader_yliftdispl->text().toFloat(&ok);
    //    val = qRound(height*tmpReso);
    //    ui->line_loader_yliftdispl->setText(QString::number((val)));
    height = ui->line_loader_youtlift->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_youtlift->setText(QString::number((val)));
    height = ui->line_loader_ypreapos->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_ypreapos->setText(QString::number((val)));

    height = ui->line_loader_ylift1inpos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_ylift1inpos_2->setText(QString::number((val)));
    height = ui->line_loader_ylift2inpos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_ylift2inpos_2->setText(QString::number((val)));
    // height = ui->line_loader_yliftdispl_3->text().toFloat(&ok);
    // val = qRound(height*tmpReso);
    // ui->line_loader_yliftdispl_3->setText(QString::number((val)));
    height = ui->line_loader_youtlift_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_youtlift_2->setText(QString::number((val)));
    height = ui->line_loader_ypreapos_2->text().toFloat(&ok);
    val = qRound(height * tmpReso);
    ui->line_loader_ypreapos_2->setText(QString::number((val)));
}
void MainWindow::on_p_loader_engine_clicked() { changeWidget("MOTOR"); }
void MainWindow::on_p_loader_initydrive_clicked() {
    feedertimeout = 20000;
    serialSendFeeder(RES_LDY); // LDY = INIT_0
}
void MainWindow::on_p_loader_initxdrive_clicked() {
    feedertimeout = 40000;
    serialSendFeeder(RES_LDX); // LDX = INIT_1
}
void MainWindow::on_push_loader_upload_clicked() {
    serialSendFeeder(EE_Loader);
}
void MainWindow::on_check_loader_releasemotoX_clicked(bool checked)
{
    if (checked) serialSendFeeder(releaseLDX);
    else serialSendFeeder(motparaLDX);
}
void MainWindow::on_check_loader_releasemotoY_clicked(bool checked) {
    if (checked)
        serialSendFeeder(releaseLDY);
    else
        serialSendFeeder(motparaLDY);
}
void MainWindow::on_check_loader_vacuum_clicked(bool checked) {
    resCLEANflags();
    if (checked == 0)
        serialSendFeeder(vacoffLD); // loader
    else
        serialSendFeeder(vaconLD);
}
void MainWindow::on_check_preavac_3_clicked(bool checked) {
    resCLEANflags();
    if (checked == 0)
        serialSendFeeder(vacoffPA);
    else
        serialSendFeeder(vaconPA); // aligner
}
void MainWindow::on_p_LD_Xlift1_clicked() {
    tmpstr = 0;
    ui->line_loader_xlift1pos->setInputMask("#99999");
    QString tmp = ui->line_loader_xlift1pos->text();
    tmpstr.append(setpos);
    tmpstr.append("54="); // ID Loader X ist 54
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 40000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_LD_Xlift2_clicked() {
    tmpstr = 0;
    ui->line_loader_xlift2pos->setInputMask("#99999");
    QString tmp = ui->line_loader_xlift2pos->text();
    tmpstr.append(setpos);
    tmpstr.append("54="); // ID Loader X ist 54
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 40000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_LD_XPA_clicked() {
    tmpstr = 0;
    ui->line_loader_xpreapos->setInputMask("#99999");
    QString tmp = ui->line_loader_xpreapos->text();
    tmpstr.append(setpos);
    tmpstr.append("54="); // ID Loader X ist 54
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 40000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_LD_PAfree_clicked() {
    tmpstr = 0;
    ui->line_loader_xpreafreepos->setInputMask("#99999");
    QString tmp = ui->line_loader_xpreafreepos->text();
    tmpstr.append(setpos);
    tmpstr.append("54="); // ID Loader X ist 54
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 40000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_LD_Yinlift1_clicked() {
    tmpstr = 0;
    ui->line_loader_ylift1inpos->setInputMask("#99999");
    QString tmp = ui->line_loader_ylift1inpos->text();
    tmpstr.append(setpos);
    tmpstr.append("55="); // ID Loader Y ist 55
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 35000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_LD_Yinlift2_clicked() {
    tmpstr = 0;
    ui->line_loader_ylift2inpos->setInputMask("#99999");
    QString tmp = ui->line_loader_ylift2inpos->text();
    tmpstr.append(setpos);
    tmpstr.append("55="); // ID Loader Y ist 55
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 35000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_LD_Yout_clicked()
{
    tmpstr = 0;
    ui->line_loader_youtlift->setInputMask("#99999");
    QString tmp = ui->line_loader_youtlift->text();
    tmpstr.append(setpos);
    tmpstr.append("55="); // ID Loader Y ist 55
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 35000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_LD_Ypapos_clicked() {
    tmpstr = 0;
    ui->line_loader_ypreapos->setInputMask("#99999");
    QString tmp = ui->line_loader_ypreapos->text();
    tmpstr.append(setpos);
    tmpstr.append("55="); // ID Loader Y ist 55
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 5000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_loader_store_clicked()
{
    STORE_FILE_partLOADER();
}
// void MainWindow::on_check_LD_moveconst_stateChanged()
// {
// }
void MainWindow::on_p_LD_getXpos_clicked()
{
    waitACTpos = getLoader_X;
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,3,1,\r\n"); // READ_POS LD-x
    ui->p_LD_getXpos->setStyleSheet(backLightYello);
}
void MainWindow::on_p_LD_getYpos_clicked()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,3,2,\r\n"); // READ_POS LD-Y

    ui->p_LD_getYpos->setStyleSheet(backLightYello);

    waitACTpos = getLoader_Y;
}
void MainWindow::on_p_ld_constpos_left_pressed() // Node5 Motor1
{
    serialSendFeeder(
                "$X_2,0,0,5,1,0,0,0,2,1,255,255,216,240\r\n"); // LD X left -10000
    ui->p_ld_constpos_left->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_ld_constpos_left_released()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,2,1,0,0,0,0\r\n"); // LD X stop
    ui->p_ld_constpos_left->setStyleSheet(backDefault);
}
void MainWindow::on_p_ld_constpos_right_pressed()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,2,1,0,0,39,16\r\n"); // LD X right 10000
    ui->p_ld_constpos_right->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_ld_constpos_right_released()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,2,1,0,0,0,0\r\n"); // LD X stop
    ui->p_ld_constpos_right->setStyleSheet(backDefault);
}
void MainWindow::on_p_ld_constpos_in_pressed() // Node5 Motor2
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,2,2,0,0,39,16\r\n"); // LD Y in 10000
    ui->p_ld_constpos_in->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_ld_constpos_in_released()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,2,2,0,0,0,0\r\n"); // LD Y in stop
    ui->p_ld_constpos_in->setStyleSheet(backDefault);
}
void MainWindow::on_p_ld_constpos_out_pressed()
{
    serialSendFeeder(
                "$X_2,0,0,5,1,0,0,0,2,2,255,255,216,240\r\n"); // LD Y in -10000
    ui->p_ld_constpos_out->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_ld_constpos_out_released()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,2,2,0,0,0,0\r\n"); // LD Y in stop
    ui->p_ld_constpos_out->setStyleSheet(backDefault);
}
//------------------- Register VAC -----------------------
void MainWindow::on_check_vac_loader_2_clicked(bool checked)
{
    static int vacsequ = 0;
    static int flagstore = 0;

    resCLEANflags();
    LDvac2 = 1;

    qDebug() << "LDvac2" << LDvac2 << "vacsequ" << vacsequ << "pollflagAV"
             << pollflagAV << "cmdfeeder" << cmdfeeder << "flagstore"
             << flagstore;

    switch (vacsequ)
    {
    case 0:
        if (pollflagAV == TRUE)
        {
            ui->check_vac_poll->setChecked(0);
            flagstore = 1;
        }
        vacsequ = 1;
    case 1:
        if (pollflagAV == FALSE)
        {
            if (cmdfeeder == 0)
            {
                if (checked == 0)
                {
                    serialSendFeeder(vacoffLD); // loader vac switch off
                }
                else serialSendFeeder(vaconLD);
                ui->check_vac_loader_2->setStyleSheet(backDefault);
                vacsequ = 2;
                if (polltimer->isActive() == FALSE) polltimer->start(100);
            }
            else if (polltimer->isActive() == FALSE) polltimer->start(100);
        }
        else if (polltimer->isActive() == FALSE) polltimer->start(100);
        break;
    case 2:
        if (cmdfeeder == 0)
        {
            tmpstr.clear();
            tmpstr = READ;
            tmpstr.append("63"); // VAC Loader
            // tmpstr.append("=");
            // tmpstr.append("1");
            tmpstr.append(CRLF);
            serialSendFeeder(tmpstr);
            vacsequ = 0;
            LDvac2 = 0;
            if (flagstore)
            {
                ui->check_vac_poll->setChecked(1);
                flagstore = 0;
            }
        }
        else if (polltimer->isActive() == FALSE) polltimer->start(100);
        break;
    }
    qDebug() << "polltimer->isActive()" << polltimer->isActive();
}
void MainWindow::on_check_vac_aligner_2_clicked(bool checked)
{
    static int vacsequ = 0;
    static int flagstore = 0;

    resCLEANflags();
    PAvac2 = 1;

    qDebug() << "checked" << checked << "PAvac2" << PAvac2 << "vacsequ" << vacsequ
             << "pollflagAV" << pollflagAV << "cmdfeeder" << cmdfeeder
             << "flagstore" << flagstore;

    switch (vacsequ)
    {
    case 0:
        if (pollflagAV == 1)
        {
            ui->check_vac_poll->setChecked(0);
            flagstore = 1;
        }
        vacsequ = 1;
    case 1:
        if (pollflagAV == 0)
        {
            qDebug() << "VACpa0";
            if (cmdfeeder == 0)
            {
                qDebug() << "VACpa1";
                if (checked == 0) serialSendFeeder(vacoffPA); // PA vac switch off
                else serialSendFeeder(vaconPA);
                ui->check_vac_aligner_2->setStyleSheet(backDefault);
                vacsequ = 2;
                if (polltimer->isActive() == FALSE) polltimer->start(100);
            }
            else if (polltimer->isActive() == FALSE) polltimer->start(100);
        }
        else if (polltimer->isActive() == FALSE) polltimer->start(100);
        break;
    case 2:
        if (cmdfeeder == 0)
        {
            tmpstr.clear();
            tmpstr = READ;
            tmpstr.append("64"); // VAC PA
            // tmpstr.append("=");
            // tmpstr.append("1");
            tmpstr.append(CRLF);
            serialSendFeeder(tmpstr);
            vacsequ = 0;
            PAvac2 = 0;
            if (flagstore)
            {
                ui->check_vac_poll->setChecked(1);
                flagstore = 0;
            }
        }
        else if (polltimer->isActive() == FALSE) polltimer->start(100);
        break;
    }
    qDebug() << "polltimer->isActive()" << polltimer->isActive();
}
void MainWindow::on_check_vac_wcright_2_clicked(bool checked)
{
    static int vacsequ = 0;
    static int flagstore = 0;

    WC2vac2 = 1;
    resCLEANflags();

    qDebug() << "WC2vac2" << WC2vac2 << "vacsequ" << vacsequ << "pollflagAV"
             << pollflagAV << "cmdfeeder" << cmdfeeder << "flagstore"
             << flagstore;

    switch (vacsequ) {
    case 0:
        if (pollflagAV == TRUE)
        {
            ui->check_vac_poll->setChecked(0);
            flagstore = 1;
        }
        vacsequ = 1;
    case 1:
        if (pollflagAV == FALSE)
        {
            if (cmdfeeder == 0)
            {
                if (checked == 0) serialSendFeeder(vacoffWC2); // WC2 vac switch off
                else serialSendFeeder(vaconWC2);
                ui->check_vac_wcright_2->setStyleSheet(backDefault);
                vacsequ = 2;
                if (polltimer->isActive() == FALSE) polltimer->start(100);
            }
            else if (polltimer->isActive() == FALSE) polltimer->start(100);
        }
        else if (polltimer->isActive() == FALSE) polltimer->start(100);
        break;
    case 2:
        if (cmdfeeder == 0)
        {
            tmpstr.clear();
            tmpstr = READ;
            tmpstr.append("66"); // VAC WC2
            // tmpstr.append("=");
            // tmpstr.append("1");
            tmpstr.append(CRLF);
            serialSendFeeder(tmpstr);
            vacsequ = 0;
            WC2vac2 = 0;
            if (flagstore)
            {
                ui->check_vac_poll->setChecked(1);
                flagstore = 0;
            }
        }
        else if (polltimer->isActive() == FALSE) polltimer->start(100);
        break;
    }
    qDebug() << "polltimer->isActive()" << polltimer->isActive();
}
void MainWindow::on_check_vac_wcleft_2_clicked(bool checked)
{
    static int vacsequ = 0;
    static int flagstore = 0;

    WC1vac2 = 1;
    resCLEANflags();

    qDebug() << "WC1vac2" << WC1vac2 << "vacsequ" << vacsequ << "pollflagAV"
             << pollflagAV << "cmdfeeder" << cmdfeeder << "flagstore"
             << flagstore;

    switch (vacsequ)
    {
    case 0:
        if (pollflagAV == TRUE)
        {
            ui->check_vac_poll->setChecked(0);
            flagstore = 1;
        }
        vacsequ = 1;
    case 1:
        if (pollflagAV == FALSE)
        {
            if (cmdfeeder == 0)
            {
                if (checked == 0) serialSendFeeder(vacoffWC1); // WC1 vac switch off
                else serialSendFeeder(vaconWC1);
                ui->check_vac_wcleft_2->setStyleSheet(backDefault);
                vacsequ = 2;
                if (polltimer->isActive() == FALSE) polltimer->start(100);
            }
            else if (polltimer->isActive() == FALSE) polltimer->start(100);
        }
        else if (polltimer->isActive() == FALSE) polltimer->start(100);
        break;
    case 2:
        if (cmdfeeder == 0)
        {
            tmpstr.clear();
            tmpstr = READ;
            tmpstr.append("65"); // VAC WC1
            // tmpstr.append("=");
            // tmpstr.append("1");
            tmpstr.append(CRLF);
            serialSendFeeder(tmpstr);
            vacsequ = 0;
            WC1vac2 = 0;
            if (flagstore)
            {
                ui->check_vac_poll->setChecked(1);
                flagstore = 0;
            }
        }
        else if (polltimer->isActive() == FALSE) polltimer->start(100);
        break;
    }
    qDebug() << "polltimer->isActive()" << polltimer->isActive();
}
void MainWindow::on_check_vac_chuck4_2_clicked(bool checked)
{
    static int vacsequ = 0;
    static int flagstore = 0;

    CH4vac2 = 1;
    resCLEANflags();

    qDebug() << "CH4vac2" << CH4vac2 << "vacsequ" << vacsequ << "pollflagAV"
             << pollflagAV << "cmdfeeder" << cmdfeeder << "flagstore"
             << flagstore;

    switch (vacsequ)
    {
    case 0:
        if (pollflagAV == TRUE)
        {
            ui->check_vac_poll->setChecked(0);
            flagstore = 1;
        }
        vacsequ = 1;
    case 1:
        if (pollflagAV == FALSE)
        {
            if (cmdfeeder == 0)
            {
                if (checked == 0) serialSendFeeder(vacoffCH4); // CH4 vac switch off
                else serialSendFeeder(vaconCH4);
                ui->check_vac_chuck4_2->setStyleSheet(backDefault);
                vacsequ = 2;
                if (polltimer->isActive() == FALSE) polltimer->start(100);
            }
            else if (polltimer->isActive() == FALSE) polltimer->start(100);
        }
        else if (polltimer->isActive() == FALSE) polltimer->start(100);
        break;
    case 2:
        if (cmdfeeder == 0)
        {
            tmpstr.clear();
            tmpstr = READ;
            tmpstr.append("67"); // VAC CH4
            // tmpstr.append("=");
            // tmpstr.append("1");
            tmpstr.append(CRLF);
            serialSendFeeder(tmpstr);
            vacsequ = 0;
            CH4vac2 = 0;
            if (flagstore)
            {
                ui->check_vac_poll->setChecked(1);
                flagstore = 0;
            }
        }
        else if (polltimer->isActive() == FALSE) polltimer->start(100);
        break;
    }
    qDebug() << "polltimer->isActive()" << polltimer->isActive();
}
void MainWindow::on_check_vac_chuck6_2_clicked(bool checked)
{
    static int vacsequ = 0;
    static int flagstore = 0;
    resCLEANflags();

    if (ui->check_vac_use6inch->isChecked())
    {
        CH6vac2 = 1;

        switch (vacsequ)
        {
        case 0:
            if (pollflagAV == TRUE)
            {
                ui->check_vac_poll->setChecked(0);
                flagstore = 1;
            }
            vacsequ = 1;
        case 1:
            if (pollflagAV == FALSE)
            {
                if (cmdfeeder == 0)
                {
                    if (checked == 0)
                    {
                        CheckCH6vac = 0; // Flag Checkbox nicht gechecked für Auswertung der Response
                        serialSendFeeder(vacoffCH6); // CH6 vac switch off
                    }
                    else
                    {
                        CheckCH6vac = 1; // Flag Checkbox gechecked für Auswertung der Response
                        serialSendFeeder(vaconCH6);
                    }
                    ui->check_vac_chuck6_2->setStyleSheet(backDefault);
                    vacsequ = 2;
                    if (polltimer->isActive() == FALSE) polltimer->start(100);
                }
                else if (polltimer->isActive() == FALSE) polltimer->start(100);
            }
            else if (polltimer->isActive() == FALSE) polltimer->start(100);
            break;
        case 2:
            if (cmdfeeder == 0)
            {
                vacsequ = 0;
                CH6vac2 = 0;
                if (flagstore)
                {
                    ui->check_vac_poll->setChecked(1);
                    flagstore = 0;
                }
            }
            else if (polltimer->isActive() == FALSE) polltimer->start(100);
            break;
        }
    }
    else
    {
        err_msgbox("valve not used");
        ui->check_vac_chuck6_2->setChecked(0);
    }
}
void MainWindow::on_check_vac_chuck8_2_clicked(bool checked) {
    static int vacsequ = 0;
    static int flagstore = 0;
    resCLEANflags();

    if (ui->check_vac_use8inch->isChecked()) {
        CH8vac2 = 1;

        switch (vacsequ) {
        case 0:
            if (pollflagAV == TRUE) {
                ui->check_vac_poll->setChecked(0);
                flagstore = 1;
            }
            vacsequ = 1;
        case 1:
            if (pollflagAV == FALSE) {
                if (cmdfeeder == 0) {
                    if (checked == 0) {
                        CheckCH8vac = 0;
                        serialSendFeeder(vacoffCH8); // CH8 vac switch off
                    } else {
                        CheckCH8vac = 1;
                        serialSendFeeder(vaconCH8);
                    }
                    ui->check_vac_chuck8_2->setStyleSheet(backDefault);
                    vacsequ = 2;
                    if (polltimer->isActive() == FALSE)
                        polltimer->start(100);
                } else if (polltimer->isActive() == FALSE)
                    polltimer->start(100);
            } else if (polltimer->isActive() == FALSE)
                polltimer->start(100);
            break;
        case 2:
            if (cmdfeeder == 0) {
                vacsequ = 0;
                CH8vac2 = 0;
                if (flagstore) {
                    ui->check_vac_poll->setChecked(1);
                    flagstore = 0;
                }
            } else if (polltimer->isActive() == FALSE)
                polltimer->start(100);
            break;
        }
    } else {
        err_msgbox("valve not used");
        ui->check_vac_chuck8_2->setChecked(0);
    }
}
void MainWindow::on_p_vac_download_clicked() {
    QByteArray vacbytes;
    vacbytes.clear();

    vacbytes.append(ui->line_vac_LD_puls->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_LD_timeout->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_LD_ThrsON->text().toLatin1()); // LD threshold ON
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_LD_ThrsOFF->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_WC1_puls->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_WC1_Timeout->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_WC1_ThrsON->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_WC1_ThrsOFF->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_WC2_puls->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_WC2_Timeout->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_WC2_ThrsON->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_WC2_ThrsOFF->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_PA_puls->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_PA_Timeout->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_PA_ThrsON->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_PA_ThrsOFF->text().toLatin1());
    vacbytes.append(",");
    waitACTpos = getVacParamLD; // Responsedaten neu einlesen
    setpara = 1; // nach Response Board 7 auch noch Board 8 Daten schreiben
    qDebug() << "vacbytes" << vacbytes;
    serialSendFeeder("&X0,0,7,1,0,0,0,6,88," + vacbytes +
                     "\r\n"); // Board 7 Vakuumdaten speichern
}
void MainWindow::f_setparam_board8() // Folgefunktion Board 8 SET Parameter
{
    QByteArray vacbytes;
    vacbytes.clear();

    vacbytes.append(ui->line_vac_CH4_puls->text().toLatin1()); // Unit 1
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_CH4_Timeout->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_CH4_ThrsON->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_CH4_ThrsOFF->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append("10"); // Unit 2
    vacbytes.append(",");
    vacbytes.append("100");
    vacbytes.append(",");
    vacbytes.append("90");
    vacbytes.append(",");
    vacbytes.append("90");
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_CH6_puls->text().toLatin1()); // Unit 3
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_CH6_Timeout->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append("0"); // ui->line_vac_CH6_ThrsON->text()
    vacbytes.append(",");
    vacbytes.append("0"); // ui->line_vac_CH6_ThrsOFF->text()
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_CH8_puls->text().toLatin1()); // Unit 4
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_CH8_Timeout->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append("0"); // ui->line_vac_CH8_ThrsON->text()
    vacbytes.append(",");
    vacbytes.append("0"); // ui->line_vac_CH8_ThrsOFF->text()
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_MainVac_puls->text().toLatin1()); // Unit 5
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_MainVac_Timeout->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_MainVac_ThrsON->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_vac_MainVac_ThrsOFF->text().toLatin1());
    vacbytes.append(",");
    waitACTpos = getVacParamPA; // Responsedaten neu einlesen
    setvacdata = 1;             // checkbox data ins INSBox EPROM schreiben
    serialSendFeeder("&X0,0,8,1,0,0,0,6,88," + vacbytes + "\r\n"); // Board 8 Vakuumdaten speichern
}
void MainWindow::on_p_vac_upload_clicked() // Daten von den Boards holen
{
    getpara = 1;
    serialSendFeeder(EE_VAC); // READ_6    // INSBox Vakuumdaten lesen
}
void MainWindow::f_getparam_board8() // Folgefunktion Board 8 GET Parameter
{
    waitACTpos = getVacParamPA;
    serialSendFeeder("$X_2,0,0,8,1,0,0,0,7,88,\r\n"); // GET_Param VACUUMGROUP Board 8
}
void MainWindow::on_check_vac_poll_stateChanged(int arg1)
{
    if (arg1) on_check_vac_clicked(1);
    else on_check_vac_clicked(0);
}
void MainWindow::on_check_vac_loader_4_clicked(bool checked)
{
    if (checked) on_check_vac_loader_2_clicked(1);
    else on_check_vac_loader_2_clicked(0);
}
void MainWindow::on_check_vac_aligner_4_clicked(bool checked)
{
    if (checked) on_check_vac_aligner_2_clicked(1);
    else on_check_vac_aligner_2_clicked(0);
}
void MainWindow::on_check_vac_wcleft_4_clicked(bool checked)
{
    if (checked) on_check_vac_wcleft_2_clicked(1);
    else on_check_vac_wcleft_2_clicked(0);
}
void MainWindow::on_check_vac_wcright_4_clicked(bool checked)
{
    if (checked) on_check_vac_wcright_2_clicked(1);
    else on_check_vac_wcright_2_clicked(0);
}
void MainWindow::on_check_vac_chuck4_4_clicked(bool checked)
{
    if (checked) on_check_vac_chuck4_2_clicked(1);
    else on_check_vac_chuck4_2_clicked(0);
}
void MainWindow::on_check_vac_chuck6_4_clicked(bool checked)
{
    if (checked) on_check_vac_chuck6_2_clicked(1);
    else on_check_vac_chuck6_2_clicked(0);
}
void MainWindow::on_check_vac_chuck8_4_clicked(bool checked)
{
    if (checked) on_check_vac_chuck8_2_clicked(1);
    else on_check_vac_chuck8_2_clicked(0);
}
//------------------- Register Clean ----------------------
void MainWindow::on_p_clean_waferdetection_clicked()
{
    if (ui->checkBox_warnlog->isChecked()) err_msgbox("switch off warnlog first");
    else if (ui->check_vac_checkvac->isChecked() == 0) err_msgbox("vacuum check is switched off -> wafer detection not possible");
    else
    {
        macroclean = 1;
        mstep = 0;
        cleansequenz = 0;
        feedertimeout = 6000;
        ui->frame_clean_wc->setDisabled(1);
        ui->frame_clean_setpos->setDisabled(1);
        ui->frame_clean_prea->setDisabled(1);
        serialSendFeeder(vacalloff); // $SETVAC_all=0
    }
    //   else serialSendFeeder("$GET_42=0\r\n");     // Foundwaf-Flags abrufen
}
void MainWindow::f_cleanmacro_vac()
{
    if (macroclean == 1)
    {
        switch (mstep)
        {
        case 0: // switch VAC LD On
            setSendTimer->stop();
            mstep = 1;
            serialSendFeeder(vaconLD);
            break;
        case 1:
            setSendTimer->stop();
            qDebug() << "LD checked" << ui->r_clean_vac_LD->isChecked();
            if (ui->r_clean_vac_LD->isChecked() == 1)
            {
                mstep = 3; // nächste Vac On
                serialSendFeeder(vaconPA);
            }
            else
            {
                mstep = 2; // sonst LD Vac Off
                serialSendFeeder(vacoffLD);
            }
            break;
        case 2:
            setSendTimer->stop();
            mstep = 3;
            serialSendFeeder(vaconPA);
            break;
        case 3:
            setSendTimer->stop();
            if (ui->r_clean_vac_PA->isChecked() == 1)
            {
                mstep = 5;
                serialSendFeeder(vaconWC1);
            }
            else
            {
                mstep = 4;
                serialSendFeeder(vacoffPA);
            }
            break;
        case 4:
            setSendTimer->stop();
            mstep = 5;
            serialSendFeeder(vaconWC1);
            break;
        case 5:
            setSendTimer->stop();
            if (ui->r_clean_vac_WC1->isChecked() == 1)
            {
                mstep = 7;
                serialSendFeeder(vaconWC2);
            }
            else
            {
                mstep = 6;
                serialSendFeeder(vacoffWC1);
            } // Timeout Vac Off
            break;
        case 6:
            setSendTimer->stop();
            mstep = 7;
            serialSendFeeder(vaconWC2);
            break;
        case 7:
            setSendTimer->stop();
            if (ui->r_clean_vac_WC2->isChecked() == 1)
            {
                mstep = 9;
                serialSendFeeder(vaconCH4);
            }
            else
            {
                mstep = 8;
                serialSendFeeder(vacoffWC2);
            }
            break;
        case 8:
            setSendTimer->stop();
            mstep = 9;
            serialSendFeeder(vaconCH4);
            break;
        case 9:
            setSendTimer->stop();
            if (ui->r_clean_vac_CH4->isChecked() == 1)
            {
                mstep = 10;
                f_cleanmacro_vac();
            }
            else
            {
                mstep = 10;
                serialSendFeeder(vacoffCH4);
            }
            break;
        case 10:
            setSendTimer->stop();
            macroclean = 0;
            mstep = 0;
            ui->plainText_clean_info2->setStyleSheet(backLightYello);
            if (ui->r_clean_vac_PA->isChecked() == 0 && //
                    ui->r_clean_vac_CH4->isChecked() == 0 &&
                    ui->r_clean_vac_LD->isChecked() == 0)
            {
                f_setsequence(0);
            }
            else if (ui->r_clean_vac_PA->isChecked() == 0 && //
                       ui->r_clean_vac_CH4->isChecked() == 1 &&
                       ui->r_clean_vac_LD->isChecked() == 0)
            {
                f_setsequence(1);
            }
            else if (ui->r_clean_vac_PA->isChecked() == 1 &&
                       ui->r_clean_vac_CH4->isChecked() == 0 &&
                       ui->r_clean_vac_LD->isChecked() == 0)
            {
                f_setsequence(2);
            }
            else if (ui->r_clean_vac_PA->isChecked() == 1 &&
                       ui->r_clean_vac_CH4->isChecked() == 1 &&
                       ui->r_clean_vac_LD->isChecked() == 0)
            {
                f_setsequence(3);
            }
            else if (ui->r_clean_vac_PA->isChecked() == 0 &&
                       ui->r_clean_vac_CH4->isChecked() == 0 &&
                       ui->r_clean_vac_LD->isChecked() == 1)
            {
                f_setsequence(4);
            }
            else if (ui->r_clean_vac_PA->isChecked() == 0 &&
                       ui->r_clean_vac_CH4->isChecked() == 1 &&
                       ui->r_clean_vac_LD->isChecked() == 1)
            {
                f_setsequence(5);
            }
            else if (ui->r_clean_vac_PA->isChecked() == 1 &&
                       ui->r_clean_vac_CH4->isChecked() == 0 &&
                       ui->r_clean_vac_LD->isChecked() == 1)
            {
                f_setsequence(6);
            }
            else if (ui->r_clean_vac_PA->isChecked() == 1 &&
                       ui->r_clean_vac_CH4->isChecked() == 1 &&
                       ui->r_clean_vac_LD->isChecked() == 1)
            {
                f_setsequence(7);
            }
            on_p_sys_VacRefresh_clicked(); // für oper: nach Wafer detection refresh
            // values aufrufen
            break;
        }
    }
}
void MainWindow::f_setsequence(int sequ)
{
    int getpos = 1;
    ui->plainText_clean_0->setStyleSheet(backLightGrey);
    ui->plainText_clean_1->setStyleSheet(backLightGrey);
    ui->plainText_clean_2->setStyleSheet(backLightGrey);
    ui->plainText_clean_3->setStyleSheet(backLightGrey);
    ui->plainText_clean_4->setStyleSheet(backLightGrey);
    ui->plainText_clean_5->setStyleSheet(backLightGrey);
    ui->plainText_clean_6->setStyleSheet(backLightGrey);
    ui->plainText_clean_7->setStyleSheet(backLightGrey);

    ui->p_clean_sequence1->setStyleSheet(backLightGrey);
    ui->p_clean_sequence2->setStyleSheet(backLightGrey);
    ui->p_clean_sequence3->setStyleSheet(backLightGrey);
    ui->p_clean_sequence4->setStyleSheet(backLightGrey);
    ui->p_clean_sequence5->setStyleSheet(backLightGrey);
    ui->p_clean_sequence6->setStyleSheet(backLightGrey);
    ui->p_clean_sequence7->setStyleSheet(backLightGrey);

    ui->p_clean_sequence1->setDisabled(1);
    ui->p_clean_sequence2->setDisabled(1);
    ui->p_clean_sequence3->setDisabled(1);
    ui->p_clean_sequence4->setDisabled(1);
    ui->p_clean_sequence5->setDisabled(1);
    ui->p_clean_sequence6->setDisabled(1);
    ui->p_clean_sequence7->setDisabled(1);
    switch (sequ)
    {
    case 0:
        ui->plainText_clean_0->setStyleSheet(backLightGreen);
        getpos = 0;
        break;
    case 1:
        ui->plainText_clean_1->setStyleSheet(backLightGreen);
        ui->p_clean_sequence1->setDisabled(0);
        break;
    case 2:
        ui->plainText_clean_2->setStyleSheet(backLightGreen);
        ui->p_clean_sequence2->setDisabled(0);
        break;
    case 3:
        ui->plainText_clean_3->setStyleSheet(backLightGreen);
        ui->p_clean_sequence3->setDisabled(0);
        break;
    case 4:
        ui->plainText_clean_4->setStyleSheet(backLightGreen);
        ui->p_clean_sequence4->setDisabled(0);
        break;
    case 5:
        ui->plainText_clean_5->setStyleSheet(backLightGreen);
        ui->p_clean_sequence5->setDisabled(0);
        break;
    case 6:
        ui->plainText_clean_6->setStyleSheet(backLightGreen);
        ui->p_clean_sequence6->setDisabled(0);
        break;
    case 7:
        ui->plainText_clean_7->setStyleSheet(backLightGreen);
        ui->p_clean_sequence7->setDisabled(0);
        break;
    case 20: // alles erledigt
        ui->label_clean_initok->setText("Feeder ready");
        ui->label_clean_initok->setStyleSheet(backLightGreen);
        getpos = 0;
        break;
    case 50:
        getpos = 0;
        break;
    }
    //    if(getpos) f_cleanGetPos();
    //    else ui->frame_clean_setpos->setDisabled(1);
}
void MainWindow::f_cleanGetPos()
{
    static int state = 0;

    qDebug() << "state" << state;
    cleangetpos = 1;
    if (cmdfeeder == 0)
    {
        switch (state)
        {
        case 0:
            cleanman = 1;
            on_p_LD_getXpos_clicked(); // Getpos LDX
            state = 1;
            break;
        case 1:
            cleanman = 1;
            on_p_PA_getheight_clicked(); // Getpos PAH
            state = 2;
            break;
        case 2:
            cleanman = 1;
            on_p_WC_getheight_clicked(); // Getpos WCH
            state = 3;
            break;
        case 3:
            cleanman = 1;
            on_p_WC_getPhi_clicked(); // Getpos WCP
            state = 4;
            break;
        case 4:
            state = 0;
            //            ui->frame_clean_setpos->setDisabled(0);
            break;
        }
    }
}
void MainWindow::clean_stagepos() // aktiviert Stage-Comm und schaltet Joystick ein
{
    serial_stage->setPortName("COM3");
    serial_stage->setBaudRate(9600);
    serial_stage->setDataBits(QSerialPort::Data8);
    serial_stage->setParity(QSerialPort::NoParity);
    serial_stage->setStopBits(QSerialPort::OneStop);
    serial_stage->setFlowControl(QSerialPort::NoFlowControl);
    serial_stage->open(QIODevice::ReadWrite);
    connect(serial_stage, SIGNAL(readyRead()), this, SLOT(serialReceived_stage()));
    stagetimer = 1;
    serialSendStage("1 j\r\n"); // Joystick aktivieren
}
void MainWindow::on_p_clean_completereset_2_clicked()
{
    cleansequenz = 0;
    cleanman = 1;
    feedertimeout = 20000; // 20s Timeout setzen
    serialSendFeeder("$INIT_30\r\n");
}
void MainWindow::f_clean_reset(int unit) {
    logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "f_clean_reset "
           << QString::number(unit) << "\n";
    switch (unit) {
    case 1:
        on_p_RES_LOADER_Y_clicked();
        break;
    case 2:
        on_p_RES_LOADER_X_clicked();
        break;
    case 3: // PAH
        on_p_RES_PREA_Height_clicked();
        break;
    case 4: // PAT
        on_p_RES_PREA_TILT_clicked();
        break;
    case 5: // PAR
        on_p_RES_PREA_ROTPOS_clicked();
        break;
    case 6: // WCH
        on_p_RES_WC_H_clicked();
        break;
    case 7: // WCP
        on_p_RES_WC_P_clicked();
        break;
    case 8:
        on_p_RES_L1_Height_clicked();
        break;
    case 9:
        on_p_RES_L1_Tilt_clicked();
        break;
    case 10:
        on_p_RES_L2_Height_clicked();
        break;
    case 11:
        on_p_RES_L2_Tilt_clicked();
        break;
    default:
        break;
    }
}
//------------------- Widget MOTORDATA ------------------
void MainWindow::on_combo_motorselect_currentTextChanged(const QString &arg1)
{
    //    qDebug()<<"gewählter motor:"<<arg1;
    setEngineValues(arg1);
    if (arg1 == "Prealigner phi motor")
    {
        ui->frame_motor_friction_maxdev->show();
        ui->frame_motor_friction_maxdev_2->show();
        serialSendFeeder("$GET_29=0\r\n");
    }
    else
    {
        ui->frame_motor_friction_maxdev->hide();
        ui->frame_motor_friction_maxdev_2->hide();
    }

    ui->line_velofull_2->clear();
    ui->line_accelfull_2->clear();
    ui->line_currfull_2->clear();
    ui->line_veloempty_2->clear();
    ui->line_accelempty_2->clear();
    ui->line_currempty_2->clear();
    ui->line_velomove_2->clear();
    ui->line_accelmove_2->clear();
    ui->line_currmove_2->clear();
    ui->line_veloinit_2->clear();
    ui->line_accelinit_2->clear();
    ui->line_currinit_2->clear();
    ui->line_fastdecel_2->clear();
    ui->line_stdbycurr_2->clear();
    ui->line_currrisetime_2->clear();
    ui->line_motresolution_2->clear();       // motor resolution
    ui->line_encresolution_2->clear();       // encoder resolution
    ui->line_gear1_2->clear();               // Gear 1
    ui->line_gear2_2->clear();               // Gear 2
    ui->line_lowsoftlimit_2->clear();        // lower limit
    ui->line_upsoftlimit_2->clear();         // upper limit
    ui->check_usesoftlimit_2->setChecked(0); // Use software limits
    ui->check_uselowsensor_2->setChecked(0); // Use lower limit sensor
    ui->check_useupsensor_2->setChecked(0);  // Use upper limit sensor
    //    ui->check_initbymove_2->setChecked(0);                  // Use init
    //    sensor
    ui->line_senspolar_2->clear();           // senor polarities
    ui->line_initdistance_2->clear();        // Initdistance
    ui->check_posencoder_2->setChecked(0);   // Encoder used
    ui->check_interpolator_2->setChecked(0); // Interpolator used
    ui->check_enconmotor_2->setChecked(0);   // Encoder on motor end
    ui->check_stopatmaxdev_2->setChecked(0); // Check encoder against motorsteps - stop at max deviation
    ui->check_closedloop_2->setChecked(0);   // Use closed loop
    ui->check_initbymove_2->setChecked(0);   // Init by moving
    ui->check_checkpos_2->setChecked(0);     // Check Positionvalues
    ui->check_checkmotvolt_2->setChecked(0); // Check Motor Voltage
    ui->line_maxdeviation_2->clear();        // max Deviation
    ui->line_posretrycount_2->clear();       // retry count
    ui->line_posdelay_2->clear();            // position delay
    ui->line_lincorr_2->clear();             // linear corr
    ui->line_ramptype_2->clear();            // Ramptype

    //    ui->p_INIT_saveMOT_2->show();
    //    ui->p_INIT_rewrite_motdata->show();
}
void MainWindow::setEngineValues(const QString &arg1) // liest Mot-INI Daten in Felder ein
{
    QFile f1(MFILE2OPEN);
    if (!f1.open(QIODevice::ReadOnly | QIODevice::Text))
        return;
    line.clear();
    QString tmp;
    QString trans;
    //   float flt;
    QString s;
    while (!f1.atEnd()) {
        line = f1.readLine();
        if (line.at(0) == '[') // alle Strings, die mit [ beginnen
        {
            if (line.mid(1, arg1.size()).toLower() == arg1.toLower()) {
                //    qDebug() << line;
                do {
                    if (!f1.atEnd())
                        line = f1.readLine();
                    else
                        break;
                    qDebug() << line;
                    if (line.mid(0, line.indexOf('=')).toLower() == "acceleration0") {
                        ui->line_accelfull->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "velocity0") {
                        ui->line_velofull->setText(QString::number(
                                                       line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                                       .toLong(&ok, 10) /
                                                       1000));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "current0") {
                        ui->line_currfull->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "acceleration1") {
                        ui->line_accelempty->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "velocity1") {
                        ui->line_veloempty->setText(QString::number(
                                                        line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                                        .toLong(&ok, 10) /
                                                        1000));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "current1") {
                        ui->line_currempty->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "acceleration2") {
                        ui->line_accelmove->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "velocity2") {
                        ui->line_velomove->setText(QString::number(
                                                       line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                                       .toLong(&ok, 10) /
                                                       1000));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "current2") {
                        ui->line_currmove->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "acceleration3") {
                        ui->line_accelinit->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "velocity3") {
                        ui->line_veloinit->setText(QString::number(
                                                       line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                                       .toLong(&ok, 10) /
                                                       1000));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "current3") {
                        ui->line_currinit->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "deceleration") {
                        ui->line_fastdecel->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "standby current") {
                        ui->line_stdbycurr->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "current risetime") {
                        ui->line_currrisetime->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "motor resolution") {
                        ui->line_motresolution->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "encoder resolution") {
                        ui->line_encresolution->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "transmisson") {
                        ui->line_transmission->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "gear1") {
                        ui->line_gear1->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "gear2") {
                        ui->line_gear2->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "lower softwarelimit") {
                        ui->line_lowsoftlimit->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "upper softwarelimit") {
                        ui->line_upsoftlimit->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "use software limits") {
                        ui->check_usesoftlimit->setChecked(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                    .toShort(&ok, 10));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "use lower limit sensor") {
                        ui->check_uselowsensor->setChecked(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                    .toShort(&ok, 10));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "use upper limit sensor") {
                        ui->check_useupsensor->setChecked(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                    .toShort(&ok, 10));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "sensor polarity") {
                        ui->line_senspolar->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "init distance") {
                        //   trans =
                        //   line.mid(line.indexOf("=")+1,line.indexOf("\n")).trimmed();
                        ui->line_initdistance->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "position by encoder") {
                        ui->check_posencoder->setChecked(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                    .toShort(&ok, 10));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "interpolator") {
                        ui->check_interpolator->setChecked(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                    .toShort(&ok, 10));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "encoder on motor-shaft") {
                        ui->check_enconmotor->setChecked(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                    .toShort(&ok, 10));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "stop on max deviation") {
                        ui->check_stopatmaxdev->setChecked(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                    .toShort(&ok, 10));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "use closed loop") {
                        ui->check_closedloop->setChecked(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                    .toShort(&ok, 10));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "maximum deviation") {
                        ui->line_maxdeviation->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "check position") {
                        ui->check_checkpos->setChecked(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                    .toShort(&ok, 10));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "init by moving") {
                        ui->check_initbymove->setChecked(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                    .toShort(&ok, 10));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "retrycount") {
                        ui->line_posretrycount->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "position delay") {
                        ui->line_posdelay->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "linear correction") {
                        ui->line_lincorr->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "resolution") {
                        ui->line_resolution->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                        //                        flt = trans.toInt(&ok, 10); // Berechnung
                        //                        der Transition erst nach Resolution
                        //                        möglich
                        //                        qDebug()<<"trans"<<trans<<"flt"<<flt;
                        //                        s =
                        //                        QString::number(flt/ui->line_resolution->text().toFloat(),10,2);
                        //                        ui->line_initdistance->setText(s);
                    } else if (line.mid(0, line.indexOf('=')).toLower() == "ramp type") {
                        ui->line_ramptype->setText(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n")));
                    } else if (line.mid(0, line.indexOf('=')).toLower() ==
                               "check voltage") {
                        ui->check_motvoltage->setChecked(
                                    line.mid(line.indexOf("=") + 1, line.indexOf("\n"))
                                    .toShort(&ok, 10));
                    }
                } while ((line.at(0) != ';' && line.at(0) != '['));
            }
        }
    }
}
void MainWindow::on_p_get_boardmotorparam_clicked()
{
    on_push_mot_readrac_clicked(); // GET_PARAM Parametersatz Teil 1
}
void MainWindow::on_push_mot_readrac_clicked() // GET_PARAM Parametersatz Teil 1
{
    switch (ui->combo_motorselect->currentIndex()) {
    case 1:
        serialSendFeeder("$X_1,0,0,3,1,0,0,0,7,1,1,\r\n"); // LIFT1 HEIGHT
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentIndex() << " "
                 << ui->combo_motorselect->currentText();
        break;
    case 2:
        serialSendFeeder("$X_1,0,0,3,1,0,0,0,7,2,1,\r\n"); // LIFT1 TILT
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentIndex() << " "
                 << ui->combo_motorselect->currentText();
        break;
    case 3:
        serialSendFeeder("$X_1,0,0,2,1,0,0,0,7,1,1,\r\n"); // LIFT2 HEIGHT
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentText();
        break;
    case 4:
        serialSendFeeder("$X_1,0,0,2,1,0,0,0,7,2,1,\r\n"); // LIFT2 TILT
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentText();
        break;
    case 5:
        serialSendFeeder("$X_1,0,0,5,1,0,0,0,7,1,1,\r\n"); // LOADER X
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentText();
        break;
    case 6:
        serialSendFeeder("$X_1,0,0,5,1,0,0,0,7,2,1,\r\n"); // LOADER Y
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentText();
        break;
    case 7:
        serialSendFeeder("$X_1,0,0,3,1,0,0,0,7,3,1,\r\n"); // PA HEIGHT
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentText();
        break;
    case 8:
        serialSendFeeder("$X_1,0,0,4,1,0,0,0,7,2,1,\r\n"); // PA PHI
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentText();
        break;
    case 9:
        serialSendFeeder("$X_1,0,0,4,1,0,0,0,7,1,1,\r\n"); // WO ROTPOS
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentText();
        break;
    case 10:
        serialSendFeeder("$X_1,0,0,4,1,0,0,0,7,3,1,\r\n"); // WO TILT
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentText();
        break;
    case 11:
        serialSendFeeder("$X_1,0,0,5,1,0,0,0,7,3,1,\r\n"); // WC HEIGHT
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentText();
        break;
    case 12:
        serialSendFeeder("$X_1,0,0,6,1,0,0,0,7,3,1,\r\n"); // WC PHI
        XRACmot = 1;
        XRACcmd = 1;
        qDebug() << ui->combo_motorselect->currentText();
        break;
        //    case 13:
        //        break;
        //    case 14:
        //        break;
    default:
        err_msgbox("please select motor");
    }
}
void MainWindow::on_push_mot_readrac_2_clicked() // GET_PARAM Parametersatz Teil 2
{
    switch (ui->combo_motorselect->currentIndex()) {
    XRACmot = 1;
    XRACcmd = 1;
    case 1:
        serialSendFeeder("$X_1,0,0,3,1,0,0,0,7,1,2,\r\n"); // LIFT1 HEIGHT
        //    qDebug()<<ui->combo_motorselect->currentIndex()<<"
        //    "<<ui->combo_motorselect->currentText();
        break;
    case 2:
        serialSendFeeder("$X_1,0,0,3,1,0,0,0,7,2,2,\r\n"); // LIFT1 TILT
        //    qDebug()<<ui->combo_motorselect->currentIndex()<<"
        //    "<<ui->combo_motorselect->currentText();
        break;
    case 3:
        serialSendFeeder("$X_1,0,0,2,1,0,0,0,7,1,2,\r\n"); // LIFT2 HEIGHT
        //    qDebug()<<ui->combo_motorselect->currentText();
        break;
    case 4:
        serialSendFeeder("$X_1,0,0,2,1,0,0,0,7,2,2,\r\n"); // LIFT2 TILT
        //    qDebug()<<ui->combo_motorselect->currentText();
        break;
    case 5:
        serialSendFeeder("$X_1,0,0,5,1,0,0,0,7,1,2,\r\n"); // LOADER X
        //    qDebug()<<ui->combo_motorselect->currentText();
        break;
    case 6:
        serialSendFeeder("$X_1,0,0,5,1,0,0,0,7,2,2,\r\n"); // LOADER Y
        //    qDebug()<<ui->combo_motorselect->currentText();
        break;
    case 7:
        serialSendFeeder("$X_1,0,0,3,1,0,0,0,7,3,2,\r\n"); // PA HEIGHT
        //    qDebug()<<ui->combo_motorselect->currentText();
        break;
    case 8:
        getparam2 = 1;
        serialSendFeeder("$X_1,0,0,4,1,0,0,0,7,2,2,\r\n"); // PA PHI
        //    qDebug()<<ui->combo_motorselect->currentText();
        break;
    case 9:
        serialSendFeeder("$X_1,0,0,4,1,0,0,0,7,1,2,\r\n"); // WO ROTPOS
        //    qDebug()<<ui->combo_motorselect->currentText();
        break;
    case 10:
        serialSendFeeder("$X_1,0,0,4,1,0,0,0,7,3,2,\r\n"); // WO TILT
        //    qDebug()<<ui->combo_motorselect->currentText();
        break;
    case 11:
        serialSendFeeder("$X_1,0,0,5,1,0,0,0,7,3,2,\r\n"); // WC HEIGHT
        //    qDebug()<<ui->combo_motorselect->currentText();
        break;
    case 12:
        serialSendFeeder("$X_1,0,0,6,1,0,0,0,7,3,2,\r\n"); // WC PHI
        //    qDebug()<<ui->combo_motorselect->currentText();
        break;
        // case 13:
        //     break;
    //    case 14:
    //        break;
    default:
        err_msgbox("please select motor");
        XRACmot = 0;
        XRACcmd = 0;
    }
}
void MainWindow::on_push_mot_try_clicked() // SET_PARAM set 1 Board
{
    // Motor1: Lift2Height(Node
    // 2);Lift1Height(3);PARotPos(4);Loader-X(5);Stage-X(6) Motor2:
    // Lift2Tilt(2);Lift1Tilt(3);PA-Phi(4);Loader-Y(5);Stage-Y(6) Motor3:
    // PA-Height(3);PA-Tilt(4);WC-Height(5);WC-PHI(6)

    /*  Index Combo Box
   *  1	// [Lift1 height ]  Node 3  Motor1
      2	// [Lift1 tilt ]    Node 3  Motor2
      3	// Lift2 height ]   Node 2  Motor1
      4	// [Lift2 tilt ]    Node 2  Motor2
      5	// [Loader x - ]    Node 5  Motor1
      6	// [Loader y - ]    Node 5  Motor2
      7	// [Prealigner H]   Node 3  Motor3
      8	// [Prealigner phi] Node 4  Motor2
      9	// [Wobbler rot]    Node 4  Motor1
      10	// [Wobbler tilt]   Node 4  Motor3
      11	// [WC height ]     Node 5  Motor3
      12	// [WC phi ]        Node 6  Motor3
   * */

    uint itmp;
    char node;
    char Fui = '0';
    char flag = '0';
    char Xmu = '0';
    char Xsu = '0';
    char elb3 = '0';
    len = "0";                 // Länge der Message wird erst in AVR berechnet
    QByteArray tmpstr = X2RAC; // &X

    switch (ui->combo_motorselect->currentIndex())
    {
    case 1:
        node = '3';
        Fui = '1';
        break;
    case 2:
        node = '3';
        Fui = '2';
        break;
    case 3:
        node = '2';
        Fui = '1';
        break;
    case 4:
        node = '2';
        Fui = '2';
        break;
    case 5:
        node = '5';
        Fui = '1';
        break;
    case 6:
        node = '5';
        Fui = '2';
        break;
    case 7:
        node = '3';
        Fui = '3';
        break;
    case 8:
        node = '4';
        Fui = '2';
        break;
    case 9:
        node = '4';
        Fui = '1';
        break;
    case 10:
        node = '4';
        Fui = '3';
        break;
    case 11:
        node = '5';
        Fui = '3';
        break;
    case 12:
        node = '6';
        Fui = '3';
        break;
    }

    tmpstr.append(len.toLatin1()); // len    1
    tmpstr.append(",");
    tmpstr.append(flag); // Flag   2
    tmpstr.append(",");
    tmpstr.append(node); // Node   3
    tmpstr.append(",");
    tmpstr.append('1'); // TASK   4
    tmpstr.append(",");
    tmpstr.append(Xmu); // mu     5
    tmpstr.append(",");
    tmpstr.append(Xsu); // su     6
    tmpstr.append(",");
    tmpstr.append(elb3); // elb3   7
    tmpstr.append(",");
    tmpstr.append(QString::number(SET_PARAMETER).toLatin1()); // CMD    8
    tmpstr.append(",");
    tmpstr.append(Fui); // FUI    9
    tmpstr.append(",");
    tmpstr.append('1'); //  Byte 1 	Parameterteil 1
    tmpstr.append(",");
    tmpstr.append('1'); //  Byte 2 1=Motor benutzt; 0=nicht benutzt
    tmpstr.append(",");
    itmp = ui->line_velofull->text().toUInt(&ok, 10) * 1000;
    ui->line_velofull->setText(QString::number(itmp));
    serializePosData(&bytedata1, ui->line_velofull);
    itmp = ui->line_velofull->text().toUInt(&ok, 10) / 1000;
    ui->line_velofull->setText(QString::number(itmp));
    tmpstr.append(bytedata1.trimmed()); // Byte 3-6  	Maxspeed0(Full)
    tmpstr.append(",");
    serializeWord(&bytedata1, ui->line_accelfull);
    tmpstr.append(bytedata1.trimmed()); // Byte 7-8  	Acceleration0
    tmpstr.append(",");
    tmpstr.append(ui->line_currfull->text().trimmed().toLatin1()); // Byte 9  	Current0
    tmpstr.append(",");
    itmp = ui->line_veloempty->text().toUInt(&ok, 10) * 1000;
    ui->line_veloempty->setText(QString::number(itmp));
    serializePosData(&bytedata1, ui->line_veloempty);
    itmp = ui->line_veloempty->text().toUInt(&ok, 10) / 1000;
    ui->line_veloempty->setText(QString::number(itmp));
    tmpstr.append(bytedata1.trimmed()); // Byte 10-13	Maxspeed1   (Empty)
    tmpstr.append(",");
    serializeWord(&bytedata1, ui->line_accelempty);
    tmpstr.append(bytedata1.trimmed()); // Byte 14-15	Acceleration1
    tmpstr.append(",");
    tmpstr.append(ui->line_currempty->text().trimmed().toLatin1()); // Byte 16	Current1
    tmpstr.append(",");
    itmp = ui->line_velomove->text().toUInt(&ok, 10) * 1000;
    ui->line_velomove->setText(QString::number(itmp));
    serializePosData(&bytedata1, ui->line_velomove);
    itmp = ui->line_velomove->text().toUInt(&ok, 10) / 1000;
    ui->line_velomove->setText(QString::number(itmp));
    tmpstr.append(bytedata1.trimmed()); // Byte 17-20  Maxspeed2(Move)
    tmpstr.append(",");
    serializeWord(&bytedata1, ui->line_accelmove);
    tmpstr.append(bytedata1.trimmed()); // Byte 21-22  Acceleration2
    tmpstr.append(",");
    tmpstr.append(ui->line_currmove->text().trimmed().toLatin1()); // Byte 23	Current2
    tmpstr.append(",");
    itmp = ui->line_veloinit->text().toUInt(&ok, 10) * 1000;
    ui->line_veloinit->setText(QString::number(itmp));
    serializePosData(&bytedata1, ui->line_veloinit);
    itmp = ui->line_veloinit->text().toUInt(&ok, 10) / 1000;
    ui->line_veloinit->setText(QString::number(itmp));
    tmpstr.append(bytedata1.trimmed()); // Byte 24..27 Maxspeed3(Init)
    tmpstr.append(",");
    serializeWord(&bytedata1, ui->line_accelinit);
    tmpstr.append(bytedata1.trimmed()); // Byte 28..29 Acceleration3
    tmpstr.append(",");
    tmpstr.append(ui->line_currinit->text().trimmed().toLatin1()); // Byte 30	Current3
    tmpstr.append(",");
    serializeWord(&bytedata1, ui->line_fastdecel); // Byte 31-32 Fast deceleration
    tmpstr.append(bytedata1.trimmed());
    tmpstr.append(",");
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
    XRACcmd = 1;
}
void MainWindow::on_push_mot_try_2_clicked() // SET_PARAM set 2 Board
{
    char node = '0';
    char Fui = '0';
    char flag = '0';
    char Xmu = '0';
    char Xsu = '0';
    char elb3 = '0';
    len = "0"; // Länge der Message wird erst in AVR berechnet
    QByteArray tmpstr = X2RAC;

    switch (ui->combo_motorselect->currentIndex()) {
    case 1:
        node = '3';
        Fui = '1';
        break;
    case 2:
        node = '3';
        Fui = '2';
        break;
    case 3:
        node = '2';
        Fui = '1';
        break;
    case 4:
        node = '2';
        Fui = '2';
        break;
    case 5:
        node = '5';
        Fui = '1';
        break;
    case 6:
        node = '5';
        Fui = '2';
        break;
    case 7:
        node = '3';
        Fui = '3';
        break;
    case 8:
        node = '4';
        Fui = '2';
        break;
    case 9:
        node = '4';
        Fui = '1';
        break;
    case 10:
        node = '4';
        Fui = '3';
        break;
    case 11:
        node = '5';
        Fui = '3';
        break;
    case 12:
        node = '6';
        Fui = '3';
        break;
    }

    tmpstr.append(len.toLatin1()); // len    1
    tmpstr.append(",");
    tmpstr.append(flag); // Flag   2
    tmpstr.append(",");
    tmpstr.append(node); // Node   3
    tmpstr.append(",");
    tmpstr.append('1'); // TASK   4
    tmpstr.append(",");
    tmpstr.append(Xmu); // mu     5
    tmpstr.append(",");
    tmpstr.append(Xsu); // su     6
    tmpstr.append(",");
    tmpstr.append(elb3); // elb3   7
    tmpstr.append(",");
    tmpstr.append(QString::number(SET_PARAMETER).toLatin1()); // CMD    8
    tmpstr.append(",");
    tmpstr.append(Fui); // FUI    9
    tmpstr.append(",");
    tmpstr.append('2'); //  Byte 1 	Parameterteil   2
    tmpstr.append(",");
    tmpstr.append(ui->line_stdbycurr->text().trimmed().toLatin1()); //  Byte 2    Lowcurrent      1
    tmpstr.append(",");
    tmpstr.append(ui->line_currrisetime->text().trimmed().toLatin1()); //  Byte 3    Currentdelay    1
    tmpstr.append(",");
    serializeWord(&bytedata1, ui->line_motresolution);
    tmpstr.append(bytedata1.trimmed()); // Byte 4-5  Motor resolution 2
    tmpstr.append(",");
    serializeWord(&bytedata1, ui->line_encresolution);
    tmpstr.append(bytedata1.trimmed()); // Byte 6-7 Encoder resolution 2
    tmpstr.append(",");
    tmpstr.append(ui->line_gear1->text().trimmed().toLatin1()); // Byte 8  Gear1 1
    tmpstr.append(",");
    tmpstr.append(ui->line_gear2->text().trimmed().toLatin1()); // Byte 9  Gear2 1
    tmpstr.append(",");
    serializePosData(&bytedata1, ui->line_lowsoftlimit);
    tmpstr.append(bytedata1.trimmed()); // Byte 10-13 Lower softwarelimit  4
    tmpstr.append(",");
    serializePosData(&bytedata1,
                     ui->line_upsoftlimit); // Byte 14-17 Upper softwarelimit  4
    tmpstr.append(bytedata1.trimmed());
    tmpstr.append(",");
    int actsen = ui->check_usesoftlimit->isChecked() << 2;
    actsen |= ui->check_uselowsensor->isChecked() << 3;
    actsen |= ui->check_useupsensor->isChecked() << 4;
    tmpstr.append(QString::number(actsen).trimmed().toLatin1()); // Byte 18  Active sensors 1
    tmpstr.append(",");
    tmpstr.append(ui->line_senspolar->text().trimmed().toLatin1()); // Byte 19 Sensor polarity    1
    tmpstr.append(",");
    // uttonfloat fltran = ui->line_initdistance->text().toFloat() /* *
    // ui->line_resolution->text().toFloat()*/;     // Umrechnen in steps
    // ui->line_initdistance->setText(QString::number(fltran));
    serializePosData(&bytedata1, ui->line_initdistance); //
    // fltran =
    // ui->line_initdistance->text().toFloat()/ui->line_resolution->text().toFloat();
    // // alten Wert wieder zur Anzeige bringen
    // ui->line_initdistance->setText(QString::number(fltran,10,2)); // zwei
    // Nachkommastellen
    tmpstr.append(bytedata1.trimmed()); //  Byte 20-23  Initdistance 4
    qDebug() << "init distance" << ui->line_initdistance->text() << "bytedata1"
             << bytedata1.trimmed();
    tmpstr.append(",");
    int moconf = ui->check_posencoder->isChecked();
    moconf |= ui->check_interpolator->isChecked() << 1;
    moconf |= ui->check_enconmotor->isChecked() << 2;
    moconf |= ui->check_stopatmaxdev->isChecked() << 3;
    moconf |= ui->check_closedloop->isChecked() << 4;
    moconf |= ui->check_initbymove->isChecked() << 5;
    moconf |= ui->check_checkpos->isChecked() << 6;
    moconf |= ui->check_checkmotvolt->isChecked() << 7;
    tmpstr.append(QString::number(moconf).toLatin1()); // Byte 24 Motionconfig (Counts are Encoder/Microsteps) 1
    tmpstr.append(",");
    tmpstr.append(ui->line_maxdeviation->text().trimmed().toLatin1()); // Byte 25 Position error 1
    tmpstr.append(",");
    tmpstr.append(ui->line_posretrycount->text().trimmed().toLatin1()); // Byte 26 Position retrycount             1
    tmpstr.append(",");
    tmpstr.append(ui->line_posdelay->text().trimmed().toLatin1()); // Byte 27 Position delay 1
    tmpstr.append(",");
    tmpstr.append('1'); // Byte 28 Interpolator-channel            1
    tmpstr.append(",");
    tmpstr.append(ui->line_lincorr->text().trimmed().toLatin1()); // Byte 29 Liner correction 0.01 % 1
    tmpstr.append(",");
    tmpstr.append(ui->line_ramptype->text().trimmed().toLatin1()); // Byte 30 Ramptype 1
    tmpstr.append(",");
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
    XRACcmd = 1;
}
void MainWindow::on_push_mot_store_clicked() {
    int motin = ui->combo_motorselect->currentIndex();
    //    qDebug()<<"motindex"<<motin;
    if (motin)
    {
        Store_File_Mot(ui->combo_motorselect->currentIndex()); // schreibt Daten in Motorini-File und
        // liest Inifile wieder aus
        //        on_p_INIT_saveMOT_2_clicked();                          //
        //        speichert Motordaten des ausgewählten Motors ins EEPROM
    }
    else err_msgbox("select motor");
}
void MainWindow::on_p_recalc_clicked()
{
    // Enc * 4 * G1/G2 * 1,25       Encoder on motor-shaft
    // Enc * 4 * G1 * G1 / trans    Position by encoder

    int encreso = ui->line_encresolution->text().toInt();
    int gear1 = ui->line_gear1->text().toInt();
    int gear2 = ui->line_gear2->text().toInt();
    float trans = ui->line_transmission->text().toFloat();
    int posenc = ui->check_posencoder->isChecked();
    int motshaft = ui->check_enconmotor->isChecked();
    if (posenc)
    {
        ui->line_resolution->setText(QString::number(encreso * 4 * gear1 * gear1 / trans));
    }
    else if (motshaft) ui->line_resolution->setText(QString::number(encreso * 4 * gear1 / gear2 * 1.25));
}
void MainWindow::data_SetMotPara() // MOT-Datensatz aus den XRAC Feldern (unbenutzt)
{
    bytedata1.clear();
    bytedata1.append(",");
    bytedata1.append(ui->line_data1->text().toLatin1());
    bytedata2.clear();
    bytedata2.append(",");
    bytedata2.append(ui->line_data2->text().toLatin1());
    if (ui->check_param1->isChecked())
    {
        bytedata3.clear();
        bytedata3.append(",");
        bytedata3.append(QString::number((ui->line_data3->text().toInt(&ok, 10) & 0xFF000000) >> 24).toLatin1());
        bytedata3.append(",");
        bytedata3.append(QString::number((ui->line_data3->text().toInt(&ok, 10) & 0xFF0000) >> 16).toLatin1());
        bytedata3.append(",");
        bytedata3.append(QString::number((ui->line_data3->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
        bytedata3.append(",");
        bytedata3.append(QString::number((ui->line_data3->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    }
    else if (ui->check_param2->isChecked())
    {
        bytedata3.clear();
        bytedata3.append(",");
        bytedata3.append(ui->line_data3->text().toLatin1());
    }
    bytedata4.clear();
    bytedata4.append(",");
    bytedata4.append(QString::number((ui->line_data4->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
    bytedata4.append(",");
    bytedata4.append(QString::number((ui->line_data4->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    qDebug() << "bytedata4 " << bytedata4;
    if (ui->check_param1->isChecked())
    {
        bytedata5.clear();
        bytedata5.append(",");
        bytedata5.append(ui->line_data5->text().toLatin1());
    }
    else if (ui->check_param2->isChecked())
    {
        bytedata5.clear();
        bytedata5.append(",");
        bytedata5.append(QString::number((ui->line_data5->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
        bytedata5.append(",");
        bytedata5.append(QString::number((ui->line_data5->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    }
    if (ui->check_param1->isChecked())
    {
        bytedata6.clear();
        bytedata6.append(",");
        bytedata6.append(QString::number((ui->line_data6->text().toInt(&ok, 10) & 0xFF000000) >> 24).toLatin1());
        bytedata6.append(",");
        bytedata6.append(QString::number((ui->line_data6->text().toInt(&ok, 10) & 0xFF0000) >> 16).toLatin1());
        bytedata6.append(",");
        bytedata6.append(QString::number((ui->line_data6->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
        bytedata6.append(",");
        bytedata6.append(QString::number((ui->line_data6->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    }
    else if (ui->check_param2->isChecked())
    {
        bytedata6.clear();
        bytedata6.append(",");
        bytedata6.append(ui->line_data6->text().toLatin1());
    }
    if (ui->check_param1->isChecked())
    {
        bytedata7.clear();
        bytedata7.append(",");
        bytedata7.append(QString::number((ui->line_data7->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
        bytedata7.append(",");
        bytedata7.append(QString::number((ui->line_data7->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    }
    else if (ui->check_param2->isChecked())
    {
        bytedata7.clear();
        bytedata7.append(",");
        bytedata7.append(ui->line_data7->text().toLatin1());
    }
    if (ui->check_param2->isChecked())
    {
        bytedata8.clear();
        bytedata8.append(",");
        bytedata8.append(QString::number((ui->line_data8->text().toInt(&ok, 10) & 0xFF000000) >> 24).toLatin1());
        bytedata8.append(",");
        bytedata8.append(QString::number((ui->line_data8->text().toInt(&ok, 10) & 0xFF0000) >> 16).toLatin1());
        bytedata8.append(",");
        bytedata8.append(QString::number((ui->line_data8->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
        bytedata8.append(",");
        bytedata8.append(QString::number((ui->line_data8->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    }
    else if (ui->check_param1->isChecked())
    {
        bytedata8.clear();
        bytedata8.append(",");
        bytedata8.append(ui->line_data8->text().toLatin1());
    }
    bytedata9.clear();
    bytedata9.append(",");
    bytedata9.append(QString::number((ui->line_data9->text().toInt(&ok, 10) & 0xFF000000) >> 24).toLatin1());
    bytedata9.append(",");
    bytedata9.append(QString::number((ui->line_data9->text().toInt(&ok, 10) & 0xFF0000) >> 16).toLatin1());
    bytedata9.append(",");
    bytedata9.append(QString::number((ui->line_data9->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
    bytedata9.append(",");
    bytedata9.append(QString::number((ui->line_data9->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    if (ui->check_param1->isChecked())
    {
        bytedata10.clear();
        bytedata10.append(",");
        bytedata10.append(QString::number((ui->line_data10->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
        bytedata10.append(",");
        bytedata10.append(QString::number((ui->line_data10->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    }
    else if (ui->check_param2->isChecked()) {
        bytedata10.clear();
        bytedata10.append(",");
        bytedata10.append(ui->line_data10->text().toLatin1());
    }
    bytedata11.clear();
    bytedata11.append(",");
    bytedata11.append(ui->line_data11->text().toLatin1());
    bytedata12.clear();
    bytedata12.append(",");
    bytedata12.append(QString::number((ui->line_data12->text().toInt(&ok, 10) & 0xFF000000) >> 24).toLatin1());
    bytedata12.append(",");
    bytedata12.append(QString::number((ui->line_data12->text().toInt(&ok, 10) & 0xFF0000) >> 16).toLatin1());
    bytedata12.append(",");
    bytedata12.append(QString::number((ui->line_data12->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
    bytedata12.append(",");
    bytedata12.append(QString::number((ui->line_data12->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    if (ui->check_param1->isChecked())
    {
        bytedata13.clear();
        bytedata13.append(",");
        bytedata13.append(QString::number((ui->line_data13->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
        bytedata13.append(",");
        bytedata13.append(QString::number((ui->line_data13->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    }
    else if (ui->check_param2->isChecked())
    {
        bytedata13.clear();
        bytedata13.append(",");
        bytedata13.append(ui->line_data13->text().toLatin1());
    }
    bytedata14.clear();
    bytedata14.append(",");
    bytedata14.append(ui->line_data14->text().toLatin1());
    if (ui->check_param1->isChecked())
    {
        bytedata15.clear();
        bytedata15.append(",");
        bytedata15.append(QString::number((ui->line_data15->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
        bytedata15.append(",");
        bytedata15.append(QString::number((ui->line_data15->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    }
    else if (ui->check_param2->isChecked())
    {
        bytedata15.clear();
        bytedata15.append(",");
        bytedata15.append(ui->line_data15->text().toLatin1());
    }
    bytedata16.clear();
    bytedata16.append(",");
    bytedata16.append(ui->line_data16->text().toLatin1());
    bytedata17.clear();
    bytedata17.append(",");
    bytedata17.append(ui->line_data17->text().toLatin1());
    bytedata18.clear();
    bytedata18.append(",");
    bytedata18.append(ui->line_data18->text().toLatin1());
    bytedata19.clear();
    bytedata19.append(",");
    bytedata19.append(ui->line_data19->text().toLatin1());
}
void MainWindow::on_p_motstat_LOADER_Y_clicked()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,3,2,\r\n"); // READ_POS LD-Y

    ui->p_motstat_LOADER_Y->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
void MainWindow::on_p_motstat_LOADER_X_clicked()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,3,1,\r\n"); // READ_POS LD-x

    ui->p_motstat_LOADER_X->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
void MainWindow::on_p_motstat_L1_Height_clicked()
{
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,1,\r\n"); // READ_POS Lift1 Height

    ui->p_motstat_L1_Height->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
void MainWindow::on_p_motstat_L1_Tilt_clicked()
{
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,2,\r\n"); // READ_POS Lift1 Tilt

    ui->p_motstat_L1_Tilt->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
void MainWindow::on_p_motstat_L2_Height_clicked()
{
    serialSendFeeder("$X_2,0,0,2,1,0,0,0,3,1,\r\n"); // READ_POS Lift2 Height

    ui->p_motstat_L2_Height->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
void MainWindow::on_p_motstat_L2_Tilt_clicked()
{
    serialSendFeeder("$X_2,0,0,2,1,0,0,0,3,2,\r\n"); // READ_POS Lift2 Tilt

    ui->p_motstat_L2_Tilt->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
void MainWindow::on_p_motstat_PREA_Height_clicked()
{
    serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,3,\r\n"); // READ_POS PA Height

    ui->p_motstat_PREA_Height->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
void MainWindow::on_p_motstat_PREA_PHI_clicked()
{
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,3,2,\r\n"); // READ_POS PA Phi

    ui->p_motstat_PREA_PHI->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
void MainWindow::on_p_motstat_PREA_TILT_clicked()
{
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,3,3,\r\n"); // READ_POS WO Tilt

    ui->p_motstat_PREA_TILT->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
void MainWindow::on_p_motstat_PREA_ROTPOS_clicked()
{
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,3,1,\r\n"); // READ_POS WO Rotpos

    ui->p_motstat_PREA_ROTPOS->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
void MainWindow::on_p_motstat_WCH_clicked()
{
    serialSendFeeder("$X_2,0,0,5,1,0,0,0,3,3,\r\n"); // READ_POS WC Height

    ui->p_motstat_WCH->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
void MainWindow::on_p_motstat_WCP_clicked()
{
    serialSendFeeder("$X_2,0,0,6,1,0,0,0,3,3,\r\n"); // READ_POS WC Phi

    ui->p_motstat_WCP->setStyleSheet(backLightYello);

    waitACTpos = readmotstat;
}
//------------------- Widget CASS ------------------------
void MainWindow::on_p_cass_getsize_clicked()
{
    if (ui->checkCass_lift1->isChecked())
        sendREAD("54");
    else if (ui->checkCass_lift2->isChecked())
        sendREAD("55");
}
void MainWindow::on_p_cass_firstslot_clicked() // write 1.Slot
{
    if (casslift)
    {
        tmpstr = 0;
        tmpstr.append(WRITE);
        tmpstr.append("56="); // WRITE 1. Slot
        tmpstr.append(QString::number(ui->spinCass_firstSlot->value()).toLatin1());
        tmpstr.append(",");
        if (ui->comboCass_Type->currentIndex() > 0) tmpstr.append(QString::number(ui->comboCass_Type->currentIndex()).toLatin1());
        else err_msgbox("Please select carrier type");
        tmpstr.append(",");
        if (ui->checkCass_lift1->isChecked()) tmpstr.append("1");
        else if (ui->checkCass_lift2->isChecked()) tmpstr.append("2");
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
    else err_msgbox("Please select Lift1 or Lift2");
}
void MainWindow::on_p_cass_distanz_clicked() // write Pitch
{
    if (casslift)
    {
        tmpstr = 0;
        tmpstr.append(WRITE);
        tmpstr.append("57="); // WRITE Slotpitch
        tmpstr.append(QString::number(ui->spinCass_SlotDist->value()).toLatin1());
        tmpstr.append(",");
        if (ui->comboCass_Type->currentIndex() > 0) tmpstr.append(QString::number(ui->comboCass_Type->currentIndex()).toLatin1());
        else err_msgbox("Please select carrier type");
        tmpstr.append(",");
        if (ui->checkCass_lift1->isChecked()) tmpstr.append("1");
        else if (ui->checkCass_lift2->isChecked()) tmpstr.append("2");
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
    else err_msgbox("Please select Lift1 or Lift2");
}
void MainWindow::on_p_cass_wafoffset_clicked()
{
    if (casslift)
    {
        tmpstr = 0;
        tmpstr.append(WRITE);
        tmpstr.append("60="); // WRITE Wafer Offset
        tmpstr.append(QString::number(ui->spinCass_WafheightOff->value()).toLatin1());
        tmpstr.append(",");
        if (ui->comboCass_Type->currentIndex() > 0) tmpstr.append(QString::number(ui->comboCass_Type->currentIndex()).toLatin1());
        else err_msgbox("Please select carrier type");
        tmpstr.append(",");
        if (ui->checkCass_lift1->isChecked()) tmpstr.append("1");
        else if (ui->checkCass_lift2->isChecked()) tmpstr.append("2");
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
    else err_msgbox("Please select Lift1 or Lift2");
}
void MainWindow::on_p_cass_fingeroffset_clicked()
{
    if (casslift)
    {
        tmpstr = 0;
        tmpstr.append(WRITE);
        tmpstr.append("61="); // WRITE Finger Offset
        tmpstr.append(QString::number(ui->spinCass_fingerHeightOff->value()).toLatin1());
        tmpstr.append(",");
        if (ui->comboCass_Type->currentIndex() > 0) tmpstr.append(QString::number(ui->comboCass_Type->currentIndex()).toLatin1());
        else err_msgbox("Please select carrier type");
        tmpstr.append(",");
        if (ui->checkCass_lift1->isChecked()) tmpstr.append("1");
        else if (ui->checkCass_lift2->isChecked()) tmpstr.append("2");
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
    else err_msgbox("Please select Lift1 or Lift2");
}
void MainWindow::on_p_cass_slotssize_clicked()
{
    if (casslift)
    {
        tmpstr = 0;
        tmpstr.append(WRITE);
        tmpstr.append("58="); // WRITE Slotsize Window
        tmpstr.append(QString::number(ui->spinCass_SlotWdw->value()).toLatin1());
        tmpstr.append(",");
        if (ui->comboCass_Type->currentIndex() > 0) tmpstr.append(QString::number(ui->comboCass_Type->currentIndex()).toLatin1());
        else err_msgbox("Please select carrier type");
        tmpstr.append(",");
        if (ui->checkCass_lift1->isChecked()) tmpstr.append("1");
        else if (ui->checkCass_lift2->isChecked()) tmpstr.append("2");
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
    else err_msgbox("Please select Lift1 or Lift2");
}
void MainWindow::on_p_cass_wafsize_clicked()
{
    if (casslift)
    {
        tmpstr = 0;
        tmpstr.append(WRITE);
        tmpstr.append("59="); // WRITE Wafersize Window
        tmpstr.append(QString::number(ui->spinCass_WafSizeWdw->value()).toLatin1());
        tmpstr.append(",");
        if (ui->comboCass_Type->currentIndex() > 0) tmpstr.append(QString::number(ui->comboCass_Type->currentIndex()).toLatin1());
        else err_msgbox("Please select carrier type");
        tmpstr.append(",");
        if (ui->checkCass_lift1->isChecked()) tmpstr.append("1");
        else if (ui->checkCass_lift2->isChecked()) tmpstr.append("2");
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
    else err_msgbox("Please select Lift1 or Lift2");
}
void MainWindow::on_p_cass_slottpos_clicked() // Lift fährt in die Finger- oder Waferposition
{
    if (casslift)
    {
        if (ui->checkCass_Lock->isChecked())
        {
            waitLDout = 1;
            on_p_LD_Yout_clicked();
        }
        else
        {
            loadcar = 1;
            on_push_wid_cass_load_clicked();
        }
    }
    else err_msgbox("Please select Lift1 or Lift2");
}
void MainWindow::on_spinCass_firstSlot_textChanged(const QString &arg1) // POS_ABS mit $SET_
{
    float flt = arg1.toUInt(&ok, 10);
    s = QString::number(flt / 360.00, 10, 4);
    ui->lineCass_firstSlot_3->setText(s);
    ui->spinCass_firstSlot->setStyleSheet(backYello);

    //    if(ui->checkCass_moveconst->isChecked())
    //    {
    //        if(ui->checkCass_lift1->isChecked())
    //        {
    //            int ldheight =
    //            ui->line_lift1_xyloader_height->text().toInt(&ok,10); int
    //            firstslot = ui->spinCass_firstSlot->value(); int posval =
    //            ldheight + firstslot;

    //            serialPosData(&bytedata1, posval);
    //            QByteArray xcmd = "&X0,0,3,1,0,0,0,1,1,"+bytedata1+",3,\r\n";
    //            serialSendFeeder(xcmd);
    //        }
    //        else if(ui->checkCass_lift2->isChecked())
    //        {
    //            int ldheight =
    //            ui->line_lift2_xyloader_height->text().toInt(&ok,10); int
    //            firstslot = ui->spinCass_firstSlot->value(); int posval =
    //            ldheight + firstslot;

    //            serialPosData(&bytedata1, posval);
    //            QByteArray xcmd = "&X0,0,2,1,0,0,0,1,1,"+bytedata1+",3,\r\n";
    //            serialSendFeeder(xcmd);
    //        }
    //        else err_msgbox("select Lift");
    //    }
}
void MainWindow::on_spinCass_SlotDist_textChanged(const QString &arg1) // Wert für Pitch
{
    float flt = arg1.toUInt(&ok, 10);
    s = QString::number(flt / 360.00, 10, 4);
    ui->lineCass_SlotDist_3->setText(s);
    ui->spinCass_SlotDist->setStyleSheet(backYello);
}
void MainWindow::on_spinCass_WafheightOff_textChanged(const QString &arg1) // Wert für
{
    float flt = arg1.toInt(&ok, 10);
    s = QString::number(flt / 360.00, 10, 4);
    ui->lineCass_WafheightOff_3->setText(s);
    ui->spinCass_WafheightOff->setStyleSheet(backYello);
}
void MainWindow::on_spinCass_fingerHeightOff_textChanged(const QString &arg1) // Wert für
{
    float flt = arg1.toInt(&ok, 10);
    s = QString::number(flt / 360.00, 10, 4);
    ui->lineCass_fingerHeightOff_3->setText(s);
    ui->spinCass_fingerHeightOff->setStyleSheet(backYello);
}
void MainWindow::on_spinCass_SlotWdw_textChanged(const QString &arg1) // Wert für
{
    float flt = arg1.toInt(&ok, 10);
    s = QString::number(flt / 360.00, 10, 4);
    ui->lineCass_SlotWdw_3->setText(s);
    ui->spinCass_SlotWdw->setStyleSheet(backYello);
}
void MainWindow::on_spinCass_WafSizeWdw_textChanged(const QString &arg1) // Wert für
{
    float flt = arg1.toInt(&ok, 10);
    s = QString::number(flt / 360.00, 10, 4);
    ui->lineCass_WafSizeWdw_3->setText(s);
    ui->spinCass_WafSizeWdw->setStyleSheet(backYello);
}
void MainWindow::on_spinCass_SlotPos_textChanged()
{
    ui->spinCass_SlotPos->setStyleSheet(backYello);
}
void MainWindow::on_checkCass_lift1_clicked(bool checked)
{
    qDebug() << "lift1" << checked;
    if (checked)
    {
        ui->checkCass_lift1->setStyleSheet("background: lightgreen");
        ui->checkCass_lift2->setStyleSheet("background: white");
        casslift = 1;
        ui->comboCass_Type->setCurrentIndex(0);
    }
}
void MainWindow::on_checkCass_lift2_clicked(bool checked)
{
    qDebug() << "lift2" << checked;
    if (checked)
    {
        ui->checkCass_lift2->setStyleSheet("background: lightgreen");
        ui->checkCass_lift1->setStyleSheet("background: white");
        casslift = 2;
        ui->comboCass_Type->setCurrentIndex(0);
    }
}
void MainWindow::on_comboCass_Type_activated(int index) // Carriertype select und Daten aus INI holen
{
    int check = 0;

    if (index < 5 && ui->radioCass_8inch->isChecked()) check = 1;
    else if (index < 9 && ui->radioCass_6inch->isChecked()) check = 1;
    else if (index < 13 && ui->radioCass_5inch->isChecked()) check = 1;
    else if (ui->radioCass_4inch->isChecked()) check = 1;

    if (check)
    {
        store = 0;
        ui->line_cassid->setText(QString::number(index));
        switch (index) {
        case 1:
            SETUP_FILE_partCASS(index); // liest CASS INI-Daten in die Maske ein
            if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x01)) ui->checkCass_friction->setChecked(1); // friction wafer bitcodiert in Lift1
            else ui->checkCass_friction->setChecked(0);
            break;
        case 2:
            SETUP_FILE_partCASS(index);
            if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x02)) ui->checkCass_friction->setChecked(1);
            else ui->checkCass_friction->setChecked(0);
            break;
        case 3:
            SETUP_FILE_partCASS(index);
            if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x04)) ui->checkCass_friction->setChecked(1);
            else ui->checkCass_friction->setChecked(0);
            break;
        case 4:
            SETUP_FILE_partCASS(index);
            if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x08))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 5:
            SETUP_FILE_partCASS(5);
            if ((ui->combo_6inchsel->currentText().toInt(&ok, 10) & 0x01))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 6:
            SETUP_FILE_partCASS(6);
            if ((ui->combo_6inchsel->currentText().toInt(&ok, 10) & 0x02))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 7:
            SETUP_FILE_partCASS(7);
            if ((ui->combo_6inchsel->currentText().toInt(&ok, 10) & 0x04))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 8:
            SETUP_FILE_partCASS(8);
            if ((ui->combo_6inchsel->currentText().toInt(&ok, 10) & 0x08))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 9:
            SETUP_FILE_partCASS(9);
            if ((ui->combo_5inchsel->currentText().toInt(&ok, 10) & 0x01))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 10:
            SETUP_FILE_partCASS(10);
            if ((ui->combo_5inchsel->currentText().toInt(&ok, 10) & 0x02))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 11:
            SETUP_FILE_partCASS(11);
            if ((ui->combo_5inchsel->currentText().toInt(&ok, 10) & 0x04))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 12:
            SETUP_FILE_partCASS(12);
            if ((ui->combo_5inchsel->currentText().toInt(&ok, 10) & 0x08))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 13:
            SETUP_FILE_partCASS(13);
            if ((ui->combo_4inchsel->currentText().toInt(&ok, 10) & 0x01))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 14:
            SETUP_FILE_partCASS(14);
            if ((ui->combo_4inchsel->currentText().toInt(&ok, 10) & 0x02))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 15:
            SETUP_FILE_partCASS(15);
            if ((ui->combo_4inchsel->currentText().toInt(&ok, 10) & 0x04))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        case 16:
            SETUP_FILE_partCASS(16);
            if ((ui->combo_4inchsel->currentText().toInt(&ok, 10) & 0x08))
                ui->checkCass_friction->setChecked(1);
            else
                ui->checkCass_friction->setChecked(0);
            break;
        }
        on_p_setboardParam_clicked();
        ui->comboCass_Type->setCurrentIndex(index);

     //   f_setSlidecolor();
    }
    else err_msgbox("selected carrier id does not match carrier size");
}
void MainWindow::read_workingcass_insbox(int index)
{
    QString id = QString::number(index + 6); // READ id für CASS ist von 7 bis 22

    tmpstr = 0;
    tmpstr.append(rRead); // holt EPROM Daten des Carriers aus INSBox
    tmpstr.append(id.toLatin1());    // READ_id für selected CASS id
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_push_wid_cass_Calib_clicked()
{
    err_msgbox("not in use");
}
void MainWindow::on_p_cass_constpos_pressed()
{
    //    waitaction = getCONSTPOS;           // Flag setzen
    //    on_p_cass_getheight_clicked();      // aktuelle Lift height pos abfragen

    if (ui->checkCass_lift1->isChecked())
    {
        if (ui->check_cass_constfast->isChecked())
        {
            serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,1,255,251,200,128\r\n"); // Fast
            ui->p_cass_constpos->setStyleSheet(backLightGreen);
        }
        else if (ui->check_cass_constslow->isChecked())
        {
            serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,1,255,255,10,128\r\n"); // Slow
            ui->p_cass_constpos->setStyleSheet(backLightGreen);
        }
        else err_msgbox("select speed first");
    }
    else if (ui->checkCass_lift2->isChecked())
    {
        if (ui->check_cass_constfast->isChecked())
        {
            serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,255,251,200,128\r\n"); // Fast
            ui->p_cass_constpos->setStyleSheet(backLightGreen);
        }
        else if (ui->check_cass_constslow->isChecked())
        {
            serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,255,255,10,128\r\n"); // Slow
            ui->p_cass_constpos->setStyleSheet(backLightGreen);
        }
        else err_msgbox("select speed first");
    }
    else err_msgbox("select lift first");
}
void MainWindow::on_p_cass_constpos_released()
{
    if (ui->checkCass_lift1->isChecked())
    {
        serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,1,0,0,0,0\r\n"); // Stop Lift 1
        ui->p_cass_constpos->setStyleSheet(backLightGrey);
    } else if (ui->checkCass_lift2->isChecked())
    {
        serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,0,0,0,0\r\n"); // Stop Lift 2
        ui->p_cass_constpos->setStyleSheet(backLightGrey);
    }
}
void MainWindow::on_p_cass_constpos_down_pressed()
{
    if (ui->checkCass_lift1->isChecked())
    {
        if (ui->check_cass_constfast_down->isChecked())
        {
            serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,1,0,4,200,128\r\n"); // Fast
            ui->p_cass_constpos_down->setStyleSheet(backLightGreen);
        }
        else if (ui->check_cass_constslow_down->isChecked())
        {
            serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,1,0,0,240,128\r\n"); // Slow
            ui->p_cass_constpos_down->setStyleSheet(backLightGreen);
        }
        else err_msgbox("select speed first");
    }
    else if (ui->checkCass_lift2->isChecked())
    {
        if (ui->check_cass_constfast_down->isChecked())
        {
            serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,0,4,200,128\r\n"); // Fast
            ui->p_cass_constpos_down->setStyleSheet(backLightGreen);
        }
        else if (ui->check_cass_constslow_down->isChecked())
        {
            serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,0,0,240,128\r\n"); // Slow
            ui->p_cass_constpos_down->setStyleSheet(backLightGreen);
        }
        else err_msgbox("select speed first");
    }
    else err_msgbox("select lift first");
}
void MainWindow::on_p_cass_constpos_down_released()
{
    if (ui->checkCass_lift1->isChecked())
    {
        serialSendFeeder("$X_2,0,0,3,1,0,0,0,2,1,0,0,0,0\r\n"); // Stop Lift 1
        ui->p_cass_constpos_down->setStyleSheet(backLightGrey);
    }
    else if (ui->checkCass_lift2->isChecked())
    {
        serialSendFeeder("$X_2,0,0,2,1,0,0,0,2,1,0,0,0,0\r\n"); // Stop Lift 2
        ui->p_cass_constpos_down->setStyleSheet(backLightGrey);
    }
}
void MainWindow::on_push_wid_cass_load_clicked()
{
    if (casslift != 0)
    {
        tmpstr = 0;
        tmpstr.append(setpos);
        tmpstr.append("41="); // Lift load
        tmpstr.append(QString::number(casslift).toLatin1());
        tmpstr.append("\r\n");
        feedertimeout = 10000;
        serialSendFeeder(tmpstr);
    }
}
void MainWindow::on_push_wid_cass_Unload_clicked()
{
    if (casslift != 0)
    {
        waitLDout = 3;
        on_p_LD_Yout_clicked();
    }
    else err_msgbox("select lift first");
}
void MainWindow::on_push_wid_cass_Store_clicked() // schreibt Daten ins EEPROM und in die INSsetup.ini
{
    int tmp = ui->comboCass_Type->currentIndex();
    bool fric = ui->checkCass_friction->isChecked();
    int fbit = 0;

    qDebug() << "cassID=" << tmp << "friction: " << fric;
    setfricbit = 1;

    if (tmp != 0) {
        if (tmp < 5) // 8inch
        {
            fbit = ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x0F;
            qDebug() << "fbit=" << fbit;
            if (fric) fbit |= (1 << (tmp - 1));
            else fbit &= ~(1 << (tmp - 1));
            ui->combo_8inchsel->setCurrentText(QString::number(fbit));
            qDebug() << "fbit=" << fbit << "friction: " << fric;
        }
        else if (tmp < 9) // 6 inch
        {
            fbit = ui->combo_6inchsel->currentText().toInt(&ok, 10) & 0x0F;
            qDebug() << "fbit=" << fbit;
            if (fric) fbit |= (1 << (tmp - 5));
            else fbit &= ~(1 << (tmp - 5));
            ui->combo_6inchsel->setCurrentText(QString::number(fbit));
            qDebug() << "fbit=" << fbit << "friction: " << fric;
        }
        else if (tmp < 13)
        {
            fbit = ui->combo_5inchsel->currentText().toInt(&ok, 10) & 0x0F;
            qDebug() << "fbit=" << fbit;
            if (fric) fbit |= (1 << (tmp - 9));
            else fbit &= ~(1 << (tmp - 9));
            ui->combo_5inchsel->setCurrentText(QString::number(fbit));
            qDebug() << "fbit=" << fbit << "friction: " << fric;
        }
        else if (tmp < 17)
        {
            fbit = ui->combo_4inchsel->currentText().toInt(&ok, 10) & 0x0F;
            qDebug() << "fbit=" << fbit;
            if (fric) fbit |= (1 << (tmp - 13));
            else fbit &= ~(1 << (tmp - 13));
            ui->combo_4inchsel->setCurrentText(QString::number(fbit));
            qDebug() << "fbit=" << fbit << "friction: " << fric;
        }

        STORE_FILE_partCASS(tmp);
    }
    else err_msgbox("select cassette first");
}
void MainWindow::on_p_cass_getheight_clicked()
{
    if (ui->checkCass_lift1->isChecked())
    {
        serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,1,\r\n"); // READ_POS Lift1
        waitACTpos = 3;
    } else if (ui->checkCass_lift2->isChecked())
    {
        serialSendFeeder("$X_2,0,0,2,1,0,0,0,3,1,\r\n"); // READ_POS Lift2
        waitACTpos = 4;
    }
    getliftpos2 = 0;
}
void MainWindow::on_p_cass_getheight_2_clicked()
{
    if (ui->checkCass_lift1->isChecked())
    {
        serialSendFeeder("$X_2,0,0,3,1,0,0,0,3,1,\r\n"); // READ_POS Lift1
        waitACTpos = 3;
    } else if (ui->checkCass_lift2->isChecked())
    {
        serialSendFeeder("$X_2,0,0,2,1,0,0,0,3,1,\r\n"); // READ_POS Lift2
        waitACTpos = 4;
    }
    getliftpos2 = 1;
}
void MainWindow::on_p_readCassParam_clicked() // Daten aus INI holen
{
    if (ui->comboCass_Type->currentIndex() > 0) read_workingcass_insbox(ui->comboCass_Type->currentIndex());
    else err_msgbox("Please select carrier type");
}
void MainWindow::on_p_copyCass_clicked()
{
    int source;
    int dest;

    source = ui->spinBox_sourcecass->text().toInt(&ok, 10);
    dest = ui->spinBox_destinationcass->text().toInt(&ok, 10);

    copy_FILE_partCASS(source, dest);
}
void MainWindow::on_p_setboardParam_clicked() // aktiviert Parameter der selektierten Kassette
{
    if (casslift != 0)
    {
        tmpstr = 0;
        tmpstr.append(setpos);
        if (casslift == 1) tmpstr.append("44="); // cass parameter load Lift1
        else if (casslift == 2) tmpstr.append("45="); // cass parameter load Lift2
        if (ui->radio_lift1_SMIF->isChecked()) tmpstr.append(QString::number(ui->comboCass_Type_smif->currentIndex()).toLatin1());
        else tmpstr.append(QString::number(ui->comboCass_Type->currentIndex()).toLatin1());
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
    else err_msgbox("please select lift");
}
void MainWindow::on_p_cass_setdefault_clicked()
{
    if (ui->comboCass_Type->currentIndex() < 5)
    {
        ui->lineCass_numbSlots->setText("25");
        ui->spinCass_firstSlot->setValue(9180);
        ui->spinCass_SlotDist->setValue(2268);
        ui->spinCass_WafheightOff->setValue(288);
        ui->spinCass_fingerHeightOff->setValue(-1080);
        ui->spinCass_SlotWdw->setValue(1800);
        ui->spinCass_WafSizeWdw->setValue(2160);
    }
    else
    {
        ui->lineCass_numbSlots->setText("25");
        ui->spinCass_firstSlot->setValue(5235);
        ui->spinCass_SlotDist->setValue(1714);
        ui->spinCass_WafheightOff->setValue(30);
        ui->spinCass_fingerHeightOff->setValue(-800);
        ui->spinCass_SlotWdw->setValue(1100);
        ui->spinCass_WafSizeWdw->setValue(1000);
    }
}
void MainWindow::on_checkCass_flat_clicked(bool checked)
{
    if (checked)
    {
    }
}
void MainWindow::on_checkCass_notch_clicked(bool checked)
{
    if (checked)
    {
    }
}
//------------------- Widget TESTPROGRAM -----------------
void MainWindow::on_p_L1H_start_clicked()
{
    serializePosData(&bytedata1, ui->lineMISC_L1_H_Start);
}
void MainWindow::on_p_pollPos_clicked() {}
//------------------- Widget LIFT LOCK -------------------
void MainWindow::on_p_lock_lock_clicked()
{
    tmpstr = 0;
    tmpstr.append(setpos); // $SET_
    tmpstr.append("48=");  // set Lock Lift1 ist 48
    tmpstr.append("1");    // Lock ON
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_lock_unlock_clicked()
{
    if (ui->radio_lift1_default->isChecked())
    {
        tmpstr = 0;
        tmpstr.append(setpos); // $SET_
        tmpstr.append("48=");  // set Lock Lift1 ist 48
        tmpstr.append("0");    // Lock OFF
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
    else if (ui->combo_lift1_SMIF_select->currentIndex() > 2)
    {
        tmpstr = 0;
        tmpstr.append(ISE_INIT); // "$SMIF_1="
        tmpstr.append("1");      // Lift 1
        tmpstr.append("\r\n");
        feedertimeout = 60000;
        serialSendFeeder(tmpstr);
    }
}
void MainWindow::on_p_lock_lock_2_clicked()
{
    tmpstr = 0;
    tmpstr.append(setpos); // $SET_
    tmpstr.append("49=");  // set Lock Lift2 ist 49
    tmpstr.append("1");    // Lock ON
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_lock_unlock_2_clicked()
{
    tmpstr = 0;
    tmpstr.append(setpos); // $SET_
    tmpstr.append("49=");  // set Lock Lift2 ist 49
    tmpstr.append("0");    // Lock OFF
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_lock_unlock_lift1_clicked() // Register oper Lift1
{
    waitLDout = 30;
    on_p_LD_Yout_clicked(); // LDYout position sicherstellen
}
void MainWindow::on_p_lock_unlock_lift2_clicked() // Register oper Lift2
{
    on_p_lock_unlock_2_clicked();
}
void MainWindow::on_p_lock_upload_clicked() {
    waitACTpos = getLock1Param;
    serialSendFeeder(
                "$X_2,0,0,7,1,0,0,0,7,74,\r\n"); // GET_Param LIFT_LOCK1 Board 7
}
void MainWindow::on_p_lock_download_clicked() {
    //   STORE_FILE_partLOCK(1);

    //    Byte 1      Delaytime
    //        Byte 2      Lockvoltage 1
    //        Byte 3      Lockvoltage 2
    //        Byte 4      Lockvoltage 3
    //        Byte 5      Lockvoltage 4
    //        Byte 6      Lockvoltage 5
    //        Byte 7      Unlockvoltage 1
    //        Byte 8      Unlockvoltage 2
    //        Byte 9      Unlockvoltage 3
    //        Byte 10    Unlockvoltage 4
    //        Byte 11    Unlockvoltage 5
    //        Byte 12    Vacummnummer

    QByteArray vacbytes;
    vacbytes.clear();

    vacbytes.append(ui->line_lock_delaytime->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_v1->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_v2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_v3->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_v4->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_v5->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_unlock_v1->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_unlock_v2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_unlock_v3->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_unlock_v4->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_unlock_v5->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_vacnumber->text().toLatin1());
    vacbytes.append(",");
    waitACTpos = getLock1Param; // Responsedaten neu einlesen
    setLock1data = 1;           // nach Response Board 7 auch auch ini schreiben
    serialSendFeeder("&X0,0,7,1,0,0,0,6,74," + vacbytes +
                     "\r\n"); // Board 7 lock1 data speichern
}
void MainWindow::on_p_lock_upload_2_clicked() {
    waitACTpos = getLock2Param;
    serialSendFeeder(
                "$X_2,0,0,7,1,0,0,0,7,75,\r\n"); // GET_Param LIFT_LOCK2 Board 7
}
void MainWindow::on_p_lock_download_2_clicked() {
  //  STORE_FILE_partLOCK(2);

    QByteArray vacbytes;
    vacbytes.clear();

    vacbytes.append(ui->line_lock_delaytime_2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_v1_2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_v2_2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_v3_2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_v4_2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_v5_2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_unlock_v1_2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_unlock_v2_2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_unlock_v3_2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_unlock_v4_2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_unlock_v5_2->text().toLatin1());
    vacbytes.append(",");
    vacbytes.append(ui->line_lock_vacnumber_2->text().toLatin1());
    vacbytes.append(",");
    waitACTpos = getLock2Param; // Responsedaten neu einlesen
    setLock2data = 1;           // nach Response Board 7 auch ini schreiben
    serialSendFeeder("&X0,0,7,1,0,0,0,6,75," + vacbytes +
                     "\r\n"); // Board 7 lock1 data speichern
}
//------------------- Widget RESET ----------------
void MainWindow::on_p_RES_L1_Height_2_clicked()
{
    on_push_lift1_init_height_clicked();
}
void MainWindow::on_p_RES_L1_Tilt_2_clicked()
{
    on_push_lift1_init_tilt_clicked();
}
void MainWindow::on_p_RES_L2_Height_2_clicked()
{
    on_p_lift2_init_height_clicked();
}
void MainWindow::on_p_RES_L2_Tilt_2_clicked()
{
    on_p_lift2_init_tilt_clicked();
}
void MainWindow::on_p_RES_LOADER_X_2_clicked()
{
    on_p_loader_initxdrive_clicked();
}
void MainWindow::on_p_RES_LOADER_Y_2_clicked()
{
    on_p_loader_initydrive_clicked();
}
void MainWindow::on_p_RES_PREA_Height_2_clicked()
{
    on_p_INIT_PA_Height_clicked();
}
void MainWindow::on_p_RES_PREA_PHI_2_clicked()
{ on_p_INIT_PA_Phi_clicked(); }
void MainWindow::on_p_RES_PREA_TILT_2_clicked()
{
    on_p_RES_PREA_TILT_clicked();
}
void MainWindow::on_p_RES_PREA_ROTPOS_2_clicked()
{
    on_p_INIT_PA_RotPos_clicked();
}
void MainWindow::on_p_RES_WC_H_2_clicked()
{ on_p_wc_initheight_clicked(); }
void MainWindow::on_p_RES_WC_P_2_clicked()
{ on_p_wc_initangle_clicked(); }
/* RESET über Widget System */
void MainWindow::on_p_RES_L1_Height_clicked()
{
    on_push_lift1_init_height_clicked();
}
void MainWindow::on_p_RES_L1_Tilt_clicked()
{
    on_push_lift1_init_tilt_clicked();
}
void MainWindow::on_p_RES_L2_Height_clicked()
{
    on_p_lift2_init_height_clicked();
}
void MainWindow::on_p_RES_L2_Tilt_clicked()
{ on_p_lift2_init_tilt_clicked(); }
void MainWindow::on_p_RES_LOADER_X_clicked()
{
    on_p_loader_initxdrive_clicked();
}
void MainWindow::on_p_RES_LOADER_Y_clicked()
{
    on_p_loader_initydrive_clicked();
}
void MainWindow::on_p_RES_PREA_Height_clicked()
{
    on_p_INIT_PA_Height_clicked();
}
void MainWindow::on_p_RES_PREA_PHI_clicked()
{ on_p_INIT_PA_Phi_clicked(); }
void MainWindow::on_p_RES_PREA_TILT_clicked()
{
    res2pos = 1;
    on_p_INIT_PA_Tilt_clicked();
}
void MainWindow::on_p_RES_PREA_ROTPOS_clicked()
{
    res2pos = 1;
    on_p_INIT_PA_RotPos_clicked();
}
void MainWindow::on_p_RES_WC_H_clicked()
{ on_p_wc_initheight_clicked(); }
void MainWindow::on_p_RES_WC_P_clicked()
{
    res2pos = 1;
    on_p_wc_initangle_clicked();
}
// _________________ Widget XRAC _____________________________
/* Auswahl der Node selektiert die Vorauswahl von CMD und FUI. Auswahl von CMD
 selektiert FUI und die Anzahl der Datenfelder. Die Datenfelder werden alle
 500ms auf Einträge überprüft. Fehlt ein Eintrag, wird der Send-Button
 deaktiviert. */
void MainWindow::hidedatabox()
{
    ui->p_xrac_send->setEnabled(0);
    ui->line_data1->hide();
    ui->label_data1->hide();
    ui->line_data2->hide();
    ui->label_data2->hide();
    ui->line_data3->hide();
    ui->label_data3->hide();
    ui->line_data4->hide();
    ui->label_data4->hide();
    ui->line_data5->hide();
    ui->label_data5->hide();
    ui->line_data6->hide();
    ui->label_data6->hide();
    ui->line_data7->hide();
    ui->label_data7->hide();
    ui->line_data8->hide();
    ui->label_data8->hide();
    ui->line_data9->hide();
    ui->label_data9->hide();
    ui->line_data10->hide();
    ui->label_data10->hide();
    ui->line_data11->hide();
    ui->label_data11->hide();
    ui->line_data12->hide();
    ui->label_data12->hide();
    ui->line_data13->hide();
    ui->label_data13->hide();
    ui->line_data14->hide();
    ui->label_data14->hide();
    ui->line_data15->hide();
    ui->label_data15->hide();
    ui->line_data16->hide();
    ui->label_data16->hide();
    ui->line_data17->hide();
    ui->label_data17->hide();
    ui->line_data18->hide();
    ui->label_data18->hide();
    ui->line_data19->hide();
    ui->label_data19->hide();
}
void MainWindow::on_combo_cmd_currentIndexChanged(const QString &arg1)
{
    qDebug() << "CMD text " << ui->combo_cmd->currentText() << "CMD index"
             << arg1;
    hidedatabox(); // alle Data-Felder ausblenden
    ui->check_param1->setAutoExclusive(0);
    ui->check_param2->setAutoExclusive(0);
    ui->check_param1->hide();
    ui->check_param1->setChecked(false);
    ui->check_param2->hide();
    ui->check_param2->setChecked(false);
    ui->check_param1->setAutoExclusive(1);
    ui->check_param2->setAutoExclusive(1);
    setfuicombo(arg1); // liest die zum CMD passenden FUIs aus einer Datei ein
}
void MainWindow::on_combo_node_currentIndexChanged(const QString &arg1)
{
    ui->check_param1->setAutoExclusive(0);
    ui->check_param2->setAutoExclusive(0);
    ui->check_param1->hide();
    ui->check_param1->setChecked(false);
    ui->check_param2->hide();
    ui->check_param2->setChecked(false);
    ui->check_param1->setAutoExclusive(1);
    ui->check_param2->setAutoExclusive(1);
    setfuicombo(arg1);
}
void MainWindow::on_combo_fui_currentIndexChanged(const QString &arg1)
{
    ui->check_param1->setAutoExclusive(0);
    ui->check_param2->setAutoExclusive(0);
    ui->check_param1->hide();
    ui->check_param1->setChecked(false);
    ui->check_param2->hide();
    ui->check_param2->setChecked(false);
    ui->check_param1->setAutoExclusive(1);
    ui->check_param2->setAutoExclusive(1);
    if (arg1 == "BOARD")
        FUI = "0";
    else if (arg1 == "MOTOR1")
        FUI = "1";
    else if (arg1 == "MOTOR2")
        FUI = "2";
    else if (arg1 == "MOTOR3")
        FUI = "3";
    else if (arg1 == "TEMPERATURE")
        FUI = "4";
    else if (arg1 == "VOLTAGE1")
        FUI = "5";
    else if (arg1 == "VOLTAGE2")
        FUI = "6";
    else if (arg1 == "VOLTAGE3")
        FUI = "7";
    else if (arg1 == "VOLTAGE4")
        FUI = "8";
    else if (arg1 == "INPORT1")
        FUI = "9";
    else if (arg1 == "INPORT2")
        FUI = "10";
    else if (arg1 == "OUTPORT")
        FUI = "11";
    else if (arg1 == "INBIT1")
        FUI = "12";
    else if (arg1 == "INBIT2")
        FUI = "13";
    else if (arg1 == "INBIT3")
        FUI = "14";
    else if (arg1 == "INBIT4")
        FUI = "15";
    else if (arg1 == "INBIT5")
        FUI = "16";
    else if (arg1 == "INBIT6")
        FUI = "17";
    else if (arg1 == "INBIT7")
        FUI = "18";
    else if (arg1 == "INBIT8")
        FUI = "19";
    else if (arg1 == "INBIT9")
        FUI = "20";
    else if (arg1 == "INBIT10")
        FUI = "21";
    else if (arg1 == "INBIT11")
        FUI = "22";
    else if (arg1 == "INBIT12")
        FUI = "23";
    else if (arg1 == "INBIT13")
        FUI = "24";
    else if (arg1 == "INBIT14")
        FUI = "25";
    else if (arg1 == "OUTBIT1")
        FUI = "26";
    else if (arg1 == "OUTBIT2")
        FUI = "27";
    else if (arg1 == "OUTBIT3")
        FUI = "28";
    else if (arg1 == "OUTBIT4")
        FUI = "29";
    else if (arg1 == "OUTBIT5")
        FUI = "30";
    else if (arg1 == "OUTBIT6")
        FUI = "31";
    else if (arg1 == "OUTBIT7")
        FUI = "32";
    else if (arg1 == "OUTBIT8")
        FUI = "33";
    else if (arg1 == "SWITCH1")
        FUI = "34";
    else if (arg1 == "SWITCH2")
        FUI = "35";
    else if (arg1 == "SWITCH3")
        FUI = "36";
    else if (arg1 == "SWITCH4")
        FUI = "37";
    else if (arg1 == "SWITCH5")
        FUI = "38";
    else if (arg1 == "SWITCH6")
        FUI = "39";
    else if (arg1 == "SWITCH7")
        FUI = "40";
    else if (arg1 == "SWITCH8")
        FUI = "41";
    else if (arg1 == "TOWERLP1")
        FUI = "42";
    else if (arg1 == "TOWERLP2")
        FUI = "43";
    else if (arg1 == "TOWERLP3")
        FUI = "44";
    else if (arg1 == "TOWERHN1")
        FUI = "45";
    else if (arg1 == "SWITCH13")
        FUI = "46";
    else if (arg1 == "SWITCH14")
        FUI = "47";
    else if (arg1 == "SWITCH15")
        FUI = "48";
    else if (arg1 == "SWITCH16")
        FUI = "49";
    else if (arg1 == "PWM_OUTPUT1")
        FUI = "50";
    else if (arg1 == "PWM_OUTPUT2")
        FUI = "51";
    else if (arg1 == "PWM_OUTPUT3")
        FUI = "52";
    else if (arg1 == "ANALOG_INPUT1")
        FUI = "53";
    else if (arg1 == "ANALOG_INPUT2")
        FUI = "54";
    else if (arg1 == "ANALOG_INPUT3")
        FUI = "55";
    else if (arg1 == "ANALOG_INPUT4")
        FUI = "56";
    else if (arg1 == "ANALOG_INPUT5")
        FUI = "57"; // Mainvacuum
    else if (arg1 == "ANALOG_INPUT6")
        FUI = "58";
    else if (arg1 == "ANALOG_INPUT7")
        FUI = "59";
    else if (arg1 == "VACUUMSWITCH1")
        FUI = "60";
    else if (arg1 == "VACUUMSWITCH2")
        FUI = "61";
    else if (arg1 == "VACUUMSWITCH3")
        FUI = "62";
    else if (arg1 == "VACUUMSWITCH4")
        FUI = "63";
    else if (arg1 == "VACUUMSWITCH5")
        FUI = "64";
    else if (arg1 == "VACUUMSWITCH6")
        FUI = "65";
    else if (arg1 == "VACUUMSWITCH7")
        FUI = "66";
    else if (arg1 == "VACUUMUNIT1")
        FUI = "67";
    else if (arg1 == "VACUUMUNIT2")
        FUI = "68";
    else if (arg1 == "VACUUMUNIT3")
        FUI = "69";
    else if (arg1 == "VACUUMUNIT4")
        FUI = "70";
    else if (arg1 == "VACUUMUNIT5")
        FUI = "71";
    else if (arg1 == "VACUUMUNIT6")
        FUI = "72";
    else if (arg1 == "VACUUMUNIT7")
        FUI = "73";
    else if (arg1 == "LIFT_LOCK1")
        FUI = "74";
    else if (arg1 == "LIFT_LOCK2")
        FUI = "75";
    else if (arg1 == "SENSOR_VALUE1")
        FUI = "76";
    else if (arg1 == "SENSOR_VALUE2")
        FUI = "77";
    else if (arg1 == "SENSOR_VALUE3")
        FUI = "78";
    else if (arg1 == "SENSOR_VALUE4")
        FUI = "79";
    else if (arg1 == "AMPL_SENSOR1")
        FUI = "80";
    else if (arg1 == "AMPL_SENSOR2")
        FUI = "81";
    else if (arg1 == "AMPL_SENSOR3")
        FUI = "82";
    else if (arg1 == "AMPL_SENSOR4")
        FUI = "83";
    else if (arg1 == "EXISTENCESENSOR1")
        FUI = "84";
    else if (arg1 == "EXISTENCESENSOR2")
        FUI = "85";
    else if (arg1 == "EXISTENCESENSOR3")
        FUI = "86";
    else if (arg1 == "EXISTENCESENSOR4")
        FUI = "87";
    else if (arg1 == "VACUUMGROUP")
        FUI = "88";
    else if (arg1 == "EMERGENCYSTOP")
        FUI = "89";
    else if (arg1 == "BOARD_REVISION")
        FUI = "90";
    else if (arg1 == "MEASUNIT")
        FUI = "92";
    else if (arg1 == "MEASTRANSMITTER")
        FUI = "93";
    else if (arg1 == "CHANGE_STATUS")
        FUI = "199";
    else if (arg1 == "POWER_FAIL")
        FUI = "200";
    else if (arg1 == "MOT_POWER_FAIL")
        FUI = "201";
    else if (arg1 == "DCDC_POWER_OK")
        FUI = "202";
    else if (arg1 == "LIFT")
        FUI = "210";
    else if (arg1 == "TASK_0")
        FUI = "250";
    else if (arg1 == "TASK_1")
        FUI = "251";
    else if (arg1 == "TASK_2")
        FUI = "252";
    showMessageData();
}
void MainWindow::on_p_break_clicked()
{
    if (ui->combo_node->currentText() == "") err_msgbox("no Node selected");
    else
    {
        char flag = '0';
        char elb3 = '0';
        len = "0"; // Länge der Message wird erst in AVR berechnet
        QByteArray tmpstr = XRAC;
        tmpstr.append("1"); // XRAC ID direkte RAC CMDs                 0
        tmpstr.append(",");
        tmpstr.append(len.toLatin1()); // len    1
        tmpstr.append(",");
        tmpstr.append(flag); // Flag   2
        tmpstr.append(",");
        tmpstr.append(ui->combo_node->currentText().toLatin1()); // Node   3
        tmpstr.append(",");
        if (ui->combo_fui->currentText() == "LIFT") tmpstr.append('2'); // TASK   4
        else tmpstr.append('1');
        tmpstr.append(",");
        if (mu == "") mu = "0";
        tmpstr.append(mu.toLatin1()); // mu     5
        tmpstr.append(",");
        if (su == "") su = "0";
        tmpstr.append(su.toLatin1()); // su     6
        tmpstr.append(",");
        tmpstr.append(elb3); // elb3   7
        tmpstr.append(",");
        tmpstr.append("10"); // FN_BREAK                                   // CMD 8
        tmpstr.append(",");
        tmpstr.append(FUI.toLatin1()); // FUI    9
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
}
void MainWindow::on_combo_mu_activated(int index)
{
    qDebug() << index;
    switch (index)
    {
    case 0:
        mu = "1";
        if (sufile1.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_su->clear();
            while (!sufile1.atEnd())
            {
                suline = sufile1.readLine();
                ui->combo_su->addItem(suline.trimmed());
            }
            sufile1.close();
        }
        break;
    case 1:
        mu = "2";
        if (sufile2.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_su->clear();
            while (!sufile2.atEnd())
            {
                suline = sufile2.readLine();
                ui->combo_su->addItem(suline.trimmed());
            }
            sufile2.close();
        }
        break;
    case 2:
        mu = "5";
        if (sufile5.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_su->clear();
            while (!sufile5.atEnd())
            {
                suline = sufile5.readLine();
                ui->combo_su->addItem(suline.trimmed());
            }
            sufile5.close();
        }
        break;
    case 3:
        mu = "6";
        if (sufile6.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_su->clear();
            while (!sufile6.atEnd())
            {
                suline = sufile6.readLine();
                ui->combo_su->addItem(suline.trimmed());
            }
            sufile6.close();
        }
        break;
    case 4:
        mu = "7";
        if (sufile7.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_su->clear();
            while (!sufile7.atEnd())
            {
                suline = sufile7.readLine();
                ui->combo_su->addItem(suline.trimmed());
            }
            sufile7.close();
        }
        break;
    case 5:
        mu = "8";
        if (sufile8.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_su->clear();
            while (!sufile8.atEnd())
            {
                suline = sufile8.readLine();
                ui->combo_su->addItem(suline.trimmed());
            }
            sufile8.close();
        }
        break;
    case 6:
        mu = "9";
        if (sufile9.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_su->clear();
            while (!sufile9.atEnd())
            {
                suline = sufile9.readLine();
                ui->combo_su->addItem(suline.trimmed());
            }
            sufile9.close();
        }
        break;
    }
    ui->combo_su->setCurrentIndex(-1);
}
void MainWindow::on_combo_su_activated(int index)
{
    qDebug() << index;
  su = QString::number(index + 1);
}
void MainWindow::on_p_xrac_send_clicked() // noch unvollständig
{
    char flag = '0';
    char elb3 = '0'; // Response komplett zurückgeben
    len = "0";       // Länge der Message wird erst in AVR berechnet
    QByteArray tmpstr = X2RAC;

    tmpstr.append(len.toLatin1()); // len    1
    tmpstr.append(",");
    tmpstr.append(flag); // Flag   2
    tmpstr.append(",");
    tmpstr.append(ui->combo_node->currentText().toLatin1()); // Node   3
    tmpstr.append(",");
    if (ui->combo_fui->currentText() == "LIFT") tmpstr.append('2'); // TASK   4
    else tmpstr.append('1');
    tmpstr.append(",");
    if (mu == "") mu = "0";
    tmpstr.append(mu.toLatin1()); // mu     5
    tmpstr.append(",");
    if (su == "") su = "0";
    tmpstr.append(su.toLatin1()); // su     6
    tmpstr.append(",");
    tmpstr.append(elb3); // elb3   7
    tmpstr.append(",");
    tmpstr.append(CMD.toLatin1()); // CMD    8
    tmpstr.append(",");
    tmpstr.append(FUI.toLatin1()); // FUI    9
    if ((!ui->check_param1->isHidden() || !ui->check_param2->isHidden()) && ui->combo_cmd->currentText() == "GET_PARAMETER") {
        tmpstr.append(",");
        tmpstr.append(bytedata1);
    }
    else if (!ui->line_data1->isHidden()) tmpstr.append(",");
    if (!ui->line_data1->isHidden())
        tmpstr.append(bytedata1);
    if (!ui->line_data2->isHidden())
        tmpstr.append(bytedata2);
    if (!ui->line_data3->isHidden())
        tmpstr.append(bytedata3);
    if (!ui->line_data4->isHidden())
        tmpstr.append(bytedata4);
    if (!ui->line_data5->isHidden())
        tmpstr.append(bytedata5);
    if (!ui->line_data6->isHidden())
        tmpstr.append(bytedata6);
    if (!ui->line_data7->isHidden())
        tmpstr.append(bytedata7);
    if (!ui->line_data8->isHidden())
        tmpstr.append(bytedata8);
    if (!ui->line_data9->isHidden())
        tmpstr.append(bytedata9);
    if (!ui->line_data10->isHidden())
        tmpstr.append(bytedata10);
    if (!ui->line_data11->isHidden())
        tmpstr.append(bytedata11);
    if (!ui->line_data12->isHidden())
        tmpstr.append(bytedata12);
    if (!ui->line_data13->isHidden())
        tmpstr.append(bytedata13);
    if (!ui->line_data14->isHidden())
        tmpstr.append(bytedata14);
    if (!ui->line_data15->isHidden())
        tmpstr.append(bytedata15);
    if (!ui->line_data16->isHidden())
        tmpstr.append(bytedata16);
    if (!ui->line_data17->isHidden())
        tmpstr.append(bytedata17);
    if (!ui->line_data18->isHidden())
        tmpstr.append(bytedata18);
    if (!ui->line_data19->isHidden())
        tmpstr.append(bytedata19);
    tmpstr.append(",");
    tmpstr.append("\r\n");
    lastxraccmd = tmpstr;
    XRACcmd = 1;
    serialSendFeeder(tmpstr);
}
void MainWindow::setfuicombo(QString cmd) // liest Files mit FUI-Namen ein
{
    qDebug() << cmd;
    if (cmd == "2" || cmd == "3" || cmd == "4" || cmd == "5" || cmd == "6")
    {
      //  qDebug() << "fuifile" << fuifile7 << "xcmdfile" << xcmdfile;
        if (fuifile7.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_cmd->clear();
            while (!fuifile7.atEnd())
            {
                fuiline = fuifile7.readLine();
                ui->combo_cmd->addItem(fuiline.trimmed());
            }
            fuifile7.close();
        }
    }
    else if (cmd == "7" || cmd == "8")
    {
        if (fuifile6.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_cmd->clear();
            while (!fuifile6.atEnd())
            {
                fuiline = fuifile6.readLine();
                ui->combo_cmd->addItem(fuiline.trimmed());
            }
            fuifile6.close();
        }
    }
    else if (cmd == "15")
    {
        if (fuifile8.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_cmd->clear();
            while (!fuifile8.atEnd())
            {
                fuiline = fuifile8.readLine();
                ui->combo_cmd->addItem(fuiline.trimmed());
            }
            fuifile8.close();
        }
    }
    else if (cmd == "POS_ABS")
    {
        if (fuifile1.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile1.atEnd())
            {
                fuiline = fuifile1.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile1.close();
        }
    }
    else if (cmd == "POS_CONST")
    {
        if (fuifile1.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile1.atEnd())
            {
                fuiline = fuifile1.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile1.close();
        }
    }
    else if (cmd == "READ_POS")
    {
        if (fuifile1.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile1.atEnd())
            {
                fuiline = fuifile1.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile1.close();
        }
    } else if (cmd == "SET_VALUE" &&
               ui->combo_node->currentText().toInt(&ok, 10) == 15)
    {
        if (fuifile11.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile11.atEnd())
            {
                fuiline = fuifile11.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile11.close();
        }
    } else if (cmd == "SET_VALUE" &&
               ui->combo_node->currentText().toInt(&ok, 10) > 6 &&
               ui->combo_node->currentText().toInt(&ok, 10) < 15)
    {
        if (fuifile9.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile9.atEnd())
            {
                fuiline = fuifile9.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile9.close();
        }
    } else if (cmd == "SET_VALUE" &&
               ui->combo_node->currentText().toInt(&ok, 10) < 7)
    {
        if (fuifile10.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile10.atEnd())
            {
                fuiline = fuifile10.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile10.close();
        }
    } else if (cmd == "GET_VALUE" &&
               ui->combo_node->currentText().toInt(&ok, 10) < 7)
    {
        if (fuifile4.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile4.atEnd())
            {
                fuiline = fuifile4.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile4.close();
        }
    } else if (cmd == "GET_VALUE" &&
               ui->combo_node->currentText().toInt(&ok, 10) == 15)
    {
        if (fuifile3.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile3.atEnd())
            {
                fuiline = fuifile3.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile3.close();
        }
    } else if (cmd == "GET_VALUE" &&
               ui->combo_node->currentText().toInt(&ok, 10) > 6 &&
               ui->combo_node->currentText().toInt(&ok, 10) < 15)
    {
        if (fuifile.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile.atEnd())
            {
                fuiline = fuifile.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile.close();
        }
    } else if (cmd == "RESET_UNIT" &&
               ui->combo_node->currentText().toInt(&ok, 10) < 7)
    {
        ui->combo_fui->clear();
        ui->combo_fui->addItem("BOARD");
        if (fuifile1.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            while (!fuifile1.atEnd())
            {
                fuiline = fuifile1.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile1.close();
        }
    } else if (cmd == "RESET_UNIT" &&
               ui->combo_node->currentText().toInt(&ok, 10) > 6 &&
               ui->combo_node->currentText().toInt(&ok, 10) < 15)
    {
        ui->combo_fui->clear();
        ui->combo_fui->addItem("BOARD");
        ui->combo_fui->addItem("EMERGENCYSTOP");
    } else if (cmd == "RESET_UNIT" &&
               ui->combo_node->currentText().toInt(&ok, 10) == 15)
    {
        ui->combo_fui->clear();
        ui->combo_fui->addItem("BOARD");
    } else if ((cmd == "SET_PARAMETER" || cmd == "GET_PARAMETER") &&
               ui->combo_node->currentText().toInt(&ok, 10) < 7) // Motorboards
    {
        if (fuifile12.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile12.atEnd())
            {
                fuiline = fuifile12.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile12.close();
        }
    } else if ((cmd == "SET_PARAMETER" || cmd == "GET_PARAMETER") &&
               ui->combo_node->currentText().toInt(&ok, 10) == 15) // Board 15
    {
        if (fuifile14.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile14.atEnd())
            {
                fuiline = fuifile14.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile14.close();
        }
    } else if ((cmd == "SET_PARAMETER" || cmd == "GET_PARAMETER") &&
               ui->combo_node->currentText().toInt(&ok, 10) > 6 &&
               ui->combo_node->currentText().toInt(&ok, 10) < 15) // Sensorboards
    {
        if (fuifile13.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile13.atEnd())
            {
                fuiline = fuifile13.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile13.close();
        }
    } else if (cmd == "CALIBRATE" &&
               ui->combo_node->currentText().toInt(&ok, 10) < 4)
    {
        if (fuifile15.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile15.atEnd())
            {
                fuiline = fuifile15.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile15.close();
        }
    }
    else if (cmd == "CALIBRATE" &&
               ui->combo_node->currentText().toInt(&ok, 10) > 3 &&
               ui->combo_node->currentText().toInt(&ok, 10) < 7)
    {
        ui->combo_fui->clear();
    }
    else if (cmd == "CALIBRATE" &&
               ui->combo_node->currentText().toInt(&ok, 10) > 6 &&
               ui->combo_node->currentText().toInt(&ok, 10) < 15)
    {
        if (fuifile16.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile16.atEnd())
            {
                fuiline = fuifile16.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile16.close();
        }
    }
    else if (cmd == "CALIBRATE" && ui->combo_node->currentText().toInt(&ok, 10) == 15)
    {
        if (fuifile17.open(QIODevice::ReadOnly | QIODevice::Text))
        {
            ui->combo_fui->clear();
            while (!fuifile17.atEnd())
            {
                fuiline = fuifile17.readLine();
                ui->combo_fui->addItem(fuiline.trimmed());
            }
            fuifile17.close();
        }
    }
    else if (cmd == "LIFT_POS" && ui->combo_node->currentText().toInt(&ok, 10) < 4)
    {
        ui->combo_fui->clear();
        ui->combo_fui->addItem("LIFT");
    }
    else if (cmd == "LIFT_INVENTORY")
    {
        ui->combo_fui->clear();
        ui->combo_fui->addItem("LIFT");
    }
}
void MainWindow::showMessageData()
{
    hidedatabox();
    qDebug() << "CMD " << ui->combo_cmd->currentText();
    if (ui->combo_cmd->currentText() == "POS_ABS")
    {
        CMD = "1";
        ui->line_data1->show();
        ui->label_data1->setText("AbsPOS");
        ui->label_data1->show();
        ui->line_data2->show();
        ui->label_data2->setText("MotParam");
        ui->label_data2->show();
    } else if (ui->combo_cmd->currentText() == "POS_CONST")
    {
        CMD = "2";
        ui->line_data1->show();
        ui->label_data1->setText("const speed");
        ui->label_data1->show();
    } else if (ui->combo_cmd->currentText() == "READ_POS")
    {
        CMD = "3";
        ui->p_xrac_send->setEnabled(1);
    } else if (ui->combo_cmd->currentText() == "SET_VALUE") {
        CMD = "4";
        ui->line_data1->show();
        ui->label_data1->setText("Value");
        ui->label_data1->show();
    } else if (ui->combo_cmd->currentText() == "GET_VALUE") {
        CMD = "5";
        ui->p_xrac_send->setEnabled(1);
    } else if (ui->combo_cmd->currentText() == "SET_PARAMETER") {
        CMD = "6";
        if (ui->combo_fui->currentText() == "LIFT") {
            ui->check_param1->show();
            ui->check_param2->show();
        } else if (ui->combo_fui->currentText().left(5) == "MOTOR") {
            ui->check_param1->show();
            ui->check_param2->show();
        }
    } else if (ui->combo_cmd->currentText() == "GET_PARAMETER") {
        CMD = "7";
        if (ui->combo_fui->currentText() == "LIFT") {
            ui->check_param1->show();
            ui->check_param2->show();
        } else if (ui->combo_fui->currentText().left(5) == "MOTOR") {
            ui->check_param1->show();
            ui->check_param2->show();
        }
        // ui->p_xrac_send->setEnabled(1);
    } else if (ui->combo_cmd->currentText() == "READ_INFO") {
        CMD = "8";
        ui->p_xrac_send->setEnabled(1);
    } else if (ui->combo_cmd->currentText() == "RESET_UNIT")
        CMD = "9";
    else if (ui->combo_cmd->currentText() == "FN_BREAK")
        CMD = "10";
    else if (ui->combo_cmd->currentText() == "WAIT_CHANGE")
        CMD = "11";
    else if (ui->combo_cmd->currentText() == "LOAD_MODE")
        CMD = "12";
    else if (ui->combo_cmd->currentText() == "DOWN_LOAD")
        CMD = "13";
    else if (ui->combo_cmd->currentText() == "UP_LOAD")
        CMD = "14";
    else if (ui->combo_cmd->currentText() == "READ_MEM")
        CMD = "15";
    else if (ui->combo_cmd->currentText() == "CLEAR_MSGS")
        CMD = "16";
    else if (ui->combo_cmd->currentText() == "CALIBRATE")
        CMD = "17";
    else if (ui->combo_cmd->currentText() == "LIFT_INVENTORY") {
        CMD = "18";
        ui->line_data1->show();
        ui->label_data1->setText("StartSlot");
        ui->label_data1->show();
        ui->line_data2->show();
        ui->label_data2->setText("StopSlot");
        ui->label_data2->show();
    } else if (ui->combo_cmd->currentText() == "LIFT_POS") {
        CMD = "19";
        ui->line_data1->show();
        ui->label_data1->setText("W/F height");
        ui->label_data1->show();
        ui->line_data2->show();
        ui->label_data2->setText("Slotnr.");
        ui->label_data2->show();
    }
}
void MainWindow::on_check_param2_stateChanged() // Datafelder Parameterset2 bereitstellen
{
    QString type = "2";
    hidedatabox();
    if (ui->combo_fui->currentText() == "LIFT" &&
            ui->combo_cmd->currentText() == "SET_PARAMETER") {
        ui->line_data1->show();
        ui->label_data1->setText("DataTyp");
        ui->label_data1->show();
        ui->line_data2->show();
        ui->label_data2->setText("Slots");
        ui->label_data2->show();
        ui->line_data3->show();
        ui->label_data3->setText("1.Slot Pos");
        ui->label_data3->show();
        ui->line_data4->show();
        ui->label_data4->setText("Slot dist.");
        ui->label_data4->show();
        ui->line_data5->show();
        ui->label_data5->setText("Slot wdw.");
        ui->label_data5->show();
        ui->line_data6->show();
        ui->label_data6->setText("Waf.wdw.");
        ui->label_data6->show();
        ui->line_data7->show();
        ui->label_data7->setText("W.offset");
        ui->label_data7->show();
        ui->line_data8->show();
        ui->label_data8->setText("F.offset");
        ui->label_data8->show();
    } else if (ui->combo_fui->currentText().left(5) == "MOTOR" &&
               ui->combo_cmd->currentText() == "SET_PARAMETER") {
        ui->label_data1->show();
        ui->line_data1->show();
        ui->label_data1->setText("DataTyp");
        ui->line_data2->show();
        ui->label_data2->setText("low curr");
        ui->label_data2->show();
        ui->line_data3->show();
        ui->label_data3->setText("curr. delay");
        ui->label_data3->show();
        ui->line_data4->show();
        ui->label_data4->setText("mot res");
        ui->label_data4->show();
        ui->line_data5->show();
        ui->label_data5->setText("enc res");
        ui->label_data5->show();
        ui->line_data6->show();
        ui->label_data6->setText("gear1");
        ui->label_data6->show();
        ui->line_data7->show();
        ui->label_data7->setText("gear2");
        ui->label_data7->show();
        ui->line_data8->show();
        ui->label_data8->setText("softlim low");
        ui->label_data8->show();
        ui->line_data9->show();
        ui->label_data9->setText("softlim up");
        ui->label_data9->show();
        ui->line_data10->show();
        ui->label_data10->setText("active sens");
        ui->label_data10->show();
        ui->line_data11->show();
        ui->label_data11->setText("sens pol");
        ui->label_data11->show();
        ui->line_data12->show();
        ui->label_data12->setText("init dist");
        ui->label_data12->show();
        ui->line_data13->show();
        ui->label_data13->setText("motion conf");
        ui->label_data13->show();
        ui->line_data14->show();
        ui->label_data14->setText("pos error");
        ui->label_data14->show();
        ui->line_data15->show();
        ui->label_data15->setText("cnt pos retry");
        ui->label_data15->show();
        ui->line_data16->show();
        ui->label_data16->setText("pos delay");
        ui->label_data16->show();
        ui->line_data17->show();
        ui->label_data17->setText("interpol ch");
        ui->label_data17->show();
        ui->line_data18->show();
        ui->label_data18->setText("lin corr");
        ui->label_data18->show();
        ui->line_data19->show();
        ui->label_data19->setText("ramp type");
        ui->label_data19->show();
    } else if (ui->combo_fui->currentText().left(5) == "LIFT" &&
               ui->combo_cmd->currentText() == "GET_PARAMETER") {
        bytedata1.clear();
        bytedata1.append("2");
    } else if (ui->combo_fui->currentText().left(5) == "MOTOR" &&
               ui->combo_cmd->currentText() == "GET_PARAMETER") {
        bytedata1.clear();
        bytedata1.append("2");
    }
}
void MainWindow::on_check_param1_clicked() // Datafelder Parameterset1 bereitstellen
{
    QString type = "1";
    hidedatabox();
    if (ui->combo_fui->currentText() == "LIFT" &&
            ui->combo_cmd->currentText() == "SET_PARAMETER") {
        ui->line_data1->show();
        ui->label_data1->setText("DataTyp");
        ui->label_data1->show();
        ui->line_data2->show();
        ui->label_data2->setText("Mot nr.");
        ui->label_data2->show();
        ui->line_data3->show();
        ui->label_data3->setText("sens count");
        ui->label_data3->show();
        ui->line_data4->show();
        ui->label_data4->setText("param set");
        ui->label_data4->show();
        ui->line_data5->show();
        ui->label_data5->setText("sens1 hght");
        ui->label_data5->show();
        ui->line_data6->show();
        ui->label_data6->setText("sens2 hght");
        ui->label_data6->show();
        ui->line_data7->show();
        ui->label_data7->setText("LD hght");
        ui->label_data7->show();
        ui->line_data8->show();
        ui->label_data8->setText("unload hght");
        ui->label_data8->show();
    } else if (ui->combo_fui->currentText().left(5) == "MOTOR" &&
               ui->combo_cmd->currentText() == "SET_PARAMETER") {
        ui->label_data1->show();
        ui->line_data1->show();
        ui->label_data1->setText("DataTyp");
        ui->line_data2->show();
        ui->label_data2->setText("Mot. use");
        ui->label_data2->show();
        ui->line_data3->show();
        ui->label_data3->setText("speed full");
        ui->label_data3->show();
        ui->line_data4->show();
        ui->label_data4->setText("acc. full");
        ui->label_data4->show();
        ui->line_data5->show();
        ui->label_data5->setText("curr. full");
        ui->label_data5->show();
        ui->line_data6->show();
        ui->label_data6->setText("speed empty");
        ui->label_data6->show();
        ui->line_data7->show();
        ui->label_data7->setText("acc. empty");
        ui->label_data7->show();
        ui->line_data8->show();
        ui->label_data8->setText("curr. empty");
        ui->label_data8->show();
        ui->line_data9->show();
        ui->label_data9->setText("speed mov");
        ui->label_data9->show();
        ui->line_data10->show();
        ui->label_data10->setText("acc. mov");
        ui->label_data10->show();
        ui->line_data11->show();
        ui->label_data11->setText("curr. mov");
        ui->label_data11->show();
        ui->line_data12->show();
        ui->label_data12->setText("speed init");
        ui->label_data12->show();
        ui->line_data13->show();
        ui->label_data13->setText("acc. init");
        ui->label_data13->show();
        ui->line_data14->show();
        ui->label_data14->setText("curr. init");
        ui->label_data14->show();
        ui->line_data15->show();
        ui->label_data15->setText("fast dec.");
        ui->label_data15->show();
    } else if (ui->combo_fui->currentText().left(5) == "LIFT" &&
               ui->combo_cmd->currentText() == "GET_PARAMETER") {
        bytedata1.clear();
        bytedata1.append("1");
    } else if (ui->combo_fui->currentText().left(5) == "MOTOR" &&
               ui->combo_cmd->currentText() == "GET_PARAMETER") {
        bytedata1.clear();
        bytedata1.append("1");
    }
}
void MainWindow::on_line_data1_editingFinished()
{
    if (ui->combo_cmd->currentText() == "POS_ABS")
    {
        serializePosData(&bytedata1, ui->line_data1);
        qDebug() << bytedata1;
    } else if (ui->combo_cmd->currentText() == "POS_CONST")
    {
        serializePosData(&bytedata1, ui->line_data1);
    } else if (ui->combo_cmd->currentText() == "LIFT_POS")
    {
        bytedata1.clear();
        bytedata1.append(",");
        bytedata1.append(ui->line_data1->text().toLatin1());
    } else if (ui->combo_cmd->currentText() == "SET_VALUE")
    {
        bytedata1.clear();
        bytedata1.append(",");
        bytedata1.append(ui->line_data1->text().toLatin1());
    } else if (ui->combo_cmd->currentText() == "LIFT_INVENTORY")
    {
        bytedata1.clear();
        bytedata1.append(",");
        bytedata1.append(ui->line_data1->text().toLatin1());
    } else if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        bytedata1.clear();
        bytedata1.append(",");
        bytedata1.append(ui->line_data1->text().toLatin1());
    }
}
void MainWindow::on_line_data2_editingFinished()
{
    if (ui->combo_cmd->currentText() == "POS_ABS")
    {
        bytedata2.clear();
        bytedata2.append(",");
        bytedata2.append(ui->line_data2->text().toLatin1());
    } else if (ui->combo_cmd->currentText() == "LIFT_POS") {
        bytedata2.clear();
        bytedata2.append(",");
        bytedata2.append(ui->line_data2->text().toLatin1());
    } else if (ui->combo_cmd->currentText() == "LIFT_INVENTORY") {
        bytedata2.clear();
        bytedata2.append(",");
        bytedata2.append(ui->line_data2->text().toLatin1());
    } else if (ui->combo_cmd->currentText() == "SET_PARAMETER") {
        bytedata2.clear();
        bytedata2.append(",");
        bytedata2.append(ui->line_data2->text().toLatin1());
    }
}
void MainWindow::on_line_data3_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText() == "LIFT")
        {
            if (ui->check_param1->isChecked())
            {
                bytedata3.clear();
                bytedata3.append(",");
                bytedata3.append(ui->line_data3->text().toLatin1());
            } else if (ui->check_param2->isChecked()) {
                serializePosData(&bytedata3, ui->line_data3);
            }
        } else if (ui->combo_fui->currentText().left(5) == "MOTOR") {
            if (ui->check_param1->isChecked()) {
                serializePosData(&bytedata3, ui->line_data3);
            } else if (ui->check_param2->isChecked()) {
                bytedata3.clear();
                bytedata3.append(",");
                bytedata3.append(ui->line_data3->text().toLatin1());
            }
        }
    }
}
void MainWindow::on_line_data4_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText() == "LIFT")
        {
            if (ui->check_param1->isChecked())
            {
                bytedata4.clear();
                bytedata4.append(",");
                bytedata4.append(ui->line_data4->text().toLatin1());
            } else if (ui->check_param2->isChecked()) {
                serializePosData(&bytedata4, ui->line_data4);
            }
        }
        else if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            bytedata4.clear();
            bytedata4.append(",");
            bytedata4.append(QString::number((ui->line_data4->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
            bytedata4.append(",");
            bytedata4.append(QString::number((ui->line_data4->text().toInt(&ok, 10) & 0xFF)).toLatin1());
            qDebug() << "bytedata4 " << bytedata4;
        }
    }
}
void MainWindow::on_line_data5_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText() == "LIFT")
        {
            serializePosData(&bytedata5, ui->line_data5);
        }
        else if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            if (ui->check_param1->isChecked())
            {
                bytedata5.clear();
                bytedata5.append(",");
                bytedata5.append(ui->line_data5->text().toLatin1());
            }
            else if (ui->check_param2->isChecked())
            {
                bytedata5.clear();
                bytedata5.append(",");
                bytedata5.append(QString::number((ui->line_data5->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
                bytedata5.append(",");
                bytedata5.append(QString::number((ui->line_data5->text().toInt(&ok, 10) & 0xFF)).toLatin1());
            }
        }
    }
}
void MainWindow::on_line_data6_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText() == "LIFT")
        {
            serializePosData(&bytedata6, ui->line_data6);
        }
        else if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            if (ui->check_param1->isChecked())
            {
                bytedata6.clear();
                bytedata6.append(",");
                bytedata6.append(QString::number((ui->line_data6->text().toInt(&ok, 10) & 0xFF000000) >> 24).toLatin1());
                bytedata6.append(",");
                bytedata6.append(QString::number((ui->line_data6->text().toInt(&ok, 10) & 0xFF0000) >> 16).toLatin1());
                bytedata6.append(",");
                bytedata6.append(QString::number((ui->line_data6->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
                bytedata6.append(",");
                bytedata6.append(QString::number((ui->line_data6->text().toInt(&ok, 10) & 0xFF)).toLatin1());
            }
            else if (ui->check_param2->isChecked())
            {
                bytedata6.clear();
                bytedata6.append(",");
                bytedata6.append(ui->line_data6->text().toLatin1());
            }
        }
    }
}
void MainWindow::on_line_data7_editingFinished() {
    if (ui->combo_cmd->currentText() == "SET_PARAMETER") {
        if (ui->combo_fui->currentText() == "LIFT") {
            serializePosData(&bytedata7, ui->line_data7);
        } else if (ui->combo_fui->currentText().left(5) == "MOTOR") {
            if (ui->check_param1->isChecked()) {
                bytedata7.clear();
                bytedata7.append(",");
                bytedata7.append(QString::number((ui->line_data7->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
                bytedata7.append(",");
                bytedata7.append(QString::number((ui->line_data7->text().toInt(&ok, 10) & 0xFF)).toLatin1());
            } else if (ui->check_param2->isChecked()) {
                bytedata7.clear();
                bytedata7.append(",");
                bytedata7.append(ui->line_data7->text().toLatin1());
            }
        }
    }
}
void MainWindow::on_line_data8_editingFinished() {
    if (ui->combo_cmd->currentText() == "SET_PARAMETER") {
        if (ui->combo_fui->currentText() == "LIFT") {
            serializePosData(&bytedata8, ui->line_data8);
        } else if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            qDebug() << ui->check_param2->isChecked();
            qDebug() << ui->check_param1->isChecked();
            if (ui->check_param2->isChecked()) {
                bytedata8.clear();
                bytedata8.append(",");
                bytedata8.append(QString::number((ui->line_data8->text().toInt(&ok, 10) & 0xFF000000) >> 24).toLatin1());
                bytedata8.append(",");
                bytedata8.append(QString::number((ui->line_data8->text().toInt(&ok, 10) & 0xFF0000) >> 16).toLatin1());
                bytedata8.append(",");
                bytedata8.append(QString::number((ui->line_data8->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
                bytedata8.append(",");
                bytedata8.append(QString::number((ui->line_data8->text().toInt(&ok, 10) & 0xFF)).toLatin1());
            }
            else if (ui->check_param1->isChecked())
            {
                bytedata8.clear();
                bytedata8.append(",");
                bytedata8.append(ui->line_data8->text().toLatin1());
            }
        }
    }
}
void MainWindow::on_line_data9_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            serializePosData(&bytedata9, ui->line_data9);
        }
    }
}
void MainWindow::on_line_data10_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            if (ui->check_param1->isChecked())
            {
                bytedata10.clear();
                bytedata10.append(",");
                bytedata10.append(QString::number((ui->line_data10->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
                bytedata10.append(",");
                bytedata10.append(QString::number((ui->line_data10->text().toInt(&ok, 10) & 0xFF)).toLatin1());
            }
            else if (ui->check_param2->isChecked())
            {
                bytedata10.clear();
                bytedata10.append(",");
                bytedata10.append(ui->line_data10->text().toLatin1());
            }
        }
    }
}
void MainWindow::on_line_data11_editingFinished() {
    if (ui->combo_cmd->currentText() == "SET_PARAMETER") {
        if (ui->combo_fui->currentText().left(5) == "MOTOR") {
            bytedata11.clear();
            bytedata11.append(",");
            bytedata11.append(ui->line_data11->text().toLatin1());
        }
    }
}
void MainWindow::on_line_data12_editingFinished() {
    if (ui->combo_cmd->currentText() == "SET_PARAMETER") {
        if (ui->combo_fui->currentText().left(5) == "MOTOR") {
            serializePosData(&bytedata12, ui->line_data12);
        }
    }
}
void MainWindow::on_line_data13_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            if (ui->check_param1->isChecked())
            {
                bytedata13.clear();
                bytedata13.append(",");
                bytedata13.append(QString::number((ui->line_data13->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
                bytedata13.append(",");
                bytedata13.append(QString::number((ui->line_data13->text().toInt(&ok, 10) & 0xFF)).toLatin1());
            }
            else if (ui->check_param2->isChecked())
            {
                bytedata13.clear();
                bytedata13.append(",");
                bytedata13.append(ui->line_data13->text().toLatin1());
            }
        }
    }
}
void MainWindow::on_line_data14_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            bytedata14.clear();
            bytedata14.append(",");
            bytedata14.append(ui->line_data14->text().toLatin1());
        }
    }
}
void MainWindow::on_line_data15_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            if (ui->check_param1->isChecked()) {
                bytedata15.clear();
                bytedata15.append(",");
                bytedata15.append(QString::number((ui->line_data15->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
                bytedata15.append(",");
                bytedata15.append(QString::number((ui->line_data15->text().toInt(&ok, 10) & 0xFF)).toLatin1());
            }
            else if (ui->check_param2->isChecked())
            {
                bytedata15.clear();
                bytedata15.append(",");
                bytedata15.append(ui->line_data15->text().toLatin1());
            }
        }
    }
}
void MainWindow::on_line_data16_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            bytedata16.clear();
            bytedata16.append(",");
            bytedata16.append(ui->line_data16->text().toLatin1());
        }
    }
}
void MainWindow::on_line_data17_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            bytedata17.clear();
            bytedata17.append(",");
            bytedata17.append(ui->line_data17->text().toLatin1());
        }
    }
}
void MainWindow::on_line_data18_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            bytedata18.clear();
            bytedata18.append(",");
            bytedata18.append(ui->line_data18->text().toLatin1());
        }
    }
}
void MainWindow::on_line_data19_editingFinished()
{
    if (ui->combo_cmd->currentText() == "SET_PARAMETER")
    {
        if (ui->combo_fui->currentText().left(5) == "MOTOR")
        {
            bytedata19.clear();
            bytedata19.append(",");
            bytedata19.append(ui->line_data19->text().toLatin1());
        }
    }
}
void MainWindow::setSend() // setzt nach Dateneingabe Button "send" enable
{
    int fill = 0;
    if ((ui->check_param1->isVisible() || ui->check_param2->isVisible()) &&
            (ui->check_param1->isChecked() || ui->check_param2->isChecked()) &&
            ui->combo_cmd->currentText() == "GET_PARAMETER") {
        fill = 1;
        qDebug() << "1 " << fill;
    } else {
        if (ui->line_data1->isVisible()) {
            if (ui->line_data1->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data2->isVisible()) {
            if (ui->line_data2->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data3->isVisible()) {
            if (ui->line_data3->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data4->isVisible()) {
            if (ui->line_data4->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data5->isVisible()) {
            if (ui->line_data5->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data6->isVisible()) {
            if (ui->line_data6->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data7->isVisible()) {
            if (ui->line_data7->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data8->isVisible()) {
            if (ui->line_data8->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data9->isVisible()) {
            if (ui->line_data9->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data10->isVisible()) {
            if (ui->line_data10->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data11->isVisible()) {
            if (ui->line_data11->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data12->isVisible()) {
            if (ui->line_data12->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data13->isVisible()) {
            if (ui->line_data13->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data14->isVisible()) {
            if (ui->line_data14->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data15->isVisible()) {
            if (ui->line_data15->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data16->isVisible()) {
            if (ui->line_data16->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data17->isVisible()) {
            if (ui->line_data17->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data18->isVisible()) {
            if (ui->line_data18->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (ui->line_data19->isVisible()) {
            if (ui->line_data19->text() == "")
                fill = 0;
            else
                fill = 1;
        }
        if (!ui->line_data1->isVisible())
            fill = 1;
    }
    if (fill == 1)
        ui->p_xrac_send->setEnabled(1);
    else
        ui->p_xrac_send->setEnabled(0);
    qDebug() << "OUT " << fill;
}
void MainWindow::on_push_clear_clicked() // löscht alle Datenfelder
{
    ui->line_data1->clear();
    ui->line_data2->clear();
    ui->line_data3->clear();
    ui->line_data4->clear();
    ui->line_data5->clear();
    ui->line_data6->clear();
    ui->line_data7->clear();
    ui->line_data8->clear();
    ui->line_data9->clear();
    ui->line_data10->clear();
    ui->line_data11->clear();
    ui->line_data12->clear();
    ui->line_data13->clear();
    ui->line_data14->clear();
    ui->line_data15->clear();
    ui->line_data16->clear();
    ui->line_data17->clear();
    ui->line_data18->clear();
    ui->line_data19->clear();
}
// ------------------ Widget Aligner ---------------------------
void MainWindow::on_check_align_dataon_clicked() {
    if (serial_due->isOpen()) {
        if (macro_profil == 1)
            serialSendDUE("$ad=2=1\r"); // bei macro_profil immer Daten abholen
        else if (ui->check_align_dataon->isChecked())
            serialSendDUE("$ad=2=1\r");
        else
            serialSendDUE("$ad=2=0\r");
        svc9 = 1;
    } else {
        err_msgbox("COM5 not open");
        ui->check_align_dataon->setChecked(0);
    }
}
void MainWindow::on_p_align_cal_clicked() {
    feedertimeout = 20000;
    serialSendFeeder("$X_2,0,0,15,1,0,0,2,17,92\r\n");
    //    cmdid = 1;
}
void MainWindow::on_p_align_analogval_clicked() {
    serialSendFeeder("$X_2,0,0,15,1,0,0,2,5,53\r\n");
    rXcmd = MeasAnalog;
}
void MainWindow::on_check_repeat_2_stateChanged(int arg1) {
    if (arg1)
        xrepeat = 1;
    else {
        xrepeat = 0;
        rXcmd = 0;
    }
}
void MainWindow::on_p_align_amplif_clicked()
{
    serialSendFeeder("$X_2,0,0,15,1,0,0,2,5,80\r\n");
    rXcmd = MeasAmplif;
}
void MainWindow::on_p_align_transmitstart_clicked()
{
    cmdid = 2; // Response in f_receiveX2() ruft macroProfil(true) auf, wenn Flag
    // macro_profil=1 ist
    serialSendFeeder("$X_2,0,0,15,1,0,0,2,4,92,0,1\r\n");
}
void MainWindow::on_p_align_setamplif_clicked()
{
    bytedata1.clear();
    bytedata2.clear();
    bytedata1.append(QString::number(ui->line_align_setamplifi->text().toInt(&ok, 10) / 256).toLatin1());
    bytedata2.append(QString::number((ui->line_align_setamplifi->text().toInt(&ok, 10)) - (ui->line_align_setamplifi->text().toInt(&ok, 10) / 256) * 256).toLatin1());
    // qDebug()<<bytedata1 << " byte2 "<<bytedata2;
    QByteArray tmpstr = "$X_2,0,0,15,1,0,0,2,4,80,";
    tmpstr.append(bytedata1);
    tmpstr.append(",");
    tmpstr.append(bytedata2);
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
    XRACcmd = 1;
}
void MainWindow::on_p_align_resphi_clicked() { serialSendFeeder(RES_PAP); }
void MainWindow::on_p_align_getpos_clicked() {
    serialSendFeeder("$X_2,0,0,4,1,0,0,2,3,2\r\n");
    rXcmd = getPreaPhi;
}
void MainWindow::on_p_pa_vac_clicked() {
    if (toggle == 1) {
        serialSendFeeder(vacoffPA);
        toggle = 0;
    } else if (toggle == 0) {
        serialSendFeeder(vaconPA); // aligner
        toggle = 1;
    }
}
void MainWindow::on_p_align_setpos_clicked(bool ext)
{
    cmdid = 3;

    int tmppos;
    bytedata1.clear();
    bytedata2.clear();
    bytedata3.clear();
    bytedata4.clear();
    bytedata5.clear();
    if (ext == false) tmppos = ui->line_align_setpos->text().toInt(&ok, 10);
    else tmppos = 9246; // Drehwinkel Winkel 540°
    bytedata1.append(QString::number(tmppos >> 24 & 0xff).toLatin1()); // MSB
    bytedata2.append(QString::number(tmppos >> 16 & 0xff).toLatin1());
    bytedata3.append(QString::number(tmppos >> 8 & 0xff).toLatin1());
    bytedata4.append(QString::number(tmppos & 0xff).toLatin1()); // LSB

    bytedata5.append(ui->spinBox_alignerservice_motpara->text().toLatin1()); // Motorparameter

    feedertimeout = 65000;

    QByteArray tmpstr = "$X_2,0,0,4,1,0,0,2,1,2,";
    tmpstr.append(bytedata1);
    tmpstr.append(",");
    tmpstr.append(bytedata2);
    tmpstr.append(",");
    tmpstr.append(bytedata3);
    tmpstr.append(",");
    tmpstr.append(bytedata4);
    tmpstr.append(",");
    tmpstr.append(bytedata5);
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::showspline()
{
    ui->widget_spline->clearGraphs();

    ui->widget_spline->addGraph();
    ui->widget_spline->graph(0)->setScatterStyle(QCPScatterStyle::ssNone);
    ui->widget_spline->graph(0)->setLineStyle(QCPGraph::lsLine);
    if (graphcol == 1) ui->widget_spline->graph(0)->setPen(QPen(Qt::red)); // line color red for second graph
    else if (graphcol == 0) ui->widget_spline->graph(0)->setPen(QPen(Qt::black)); // line color black for second graph
    ui->widget_spline->addGraph();
    ui->widget_spline->graph(1)->setPen(QPen(Qt::red)); // line color red for second graph
    ui->widget_spline->graph(1)->setScatterStyle(QCPScatterStyle::ssNone);
    ui->widget_spline->graph(1)->setLineStyle(QCPGraph::lsLine);

    newCurve->setPen(QPen(Qt::red)); // line color red for graph
    newCurve->setScatterStyle(QCPScatterStyle::ssNone);
    newCurve->setLineStyle(QCPCurve::lsLine);
    if (clear == 1) clear = 0;
    graphcol = 0;
    plot();
}
void MainWindow::showspline_2() {
    ui->widget_spline_2->clearGraphs();

    ui->widget_spline_2->addGraph();
    ui->widget_spline_2->graph(0)->setScatterStyle(QCPScatterStyle::ssNone);
    ui->widget_spline_2->graph(0)->setLineStyle(QCPGraph::lsLine);
    if (graphcol_2 == 1)
        ui->widget_spline_2->graph(0)->setPen(
                    QPen(Qt::red)); // line color red for second graph
    else if (graphcol_2 == 0)
        ui->widget_spline_2->graph(0)->setPen(
                    QPen(Qt::black)); // line color black for second graph
    ui->widget_spline_2->addGraph();
    ui->widget_spline_2->graph(1)->setPen(
                QPen(Qt::red)); // line color red for second graph
    ui->widget_spline_2->graph(1)->setScatterStyle(QCPScatterStyle::ssNone);
    ui->widget_spline_2->graph(1)->setLineStyle(QCPGraph::lsLine);

    newCurve_2->setPen(QPen(Qt::red)); // line color red for graph
    newCurve_2->setScatterStyle(QCPScatterStyle::ssNone);
    newCurve_2->setLineStyle(QCPCurve::lsLine);
    if (clear_2 == 1)
        clear_2 = 0;
    graphcol_2 = 0;
    plot_2();
}
void MainWindow::addPoint(double x, double y) {
    qv_x.append(x);
    qv_y.append(y);
}
void MainWindow::addPoint2(double y) { qv_y1.append(y); }
void MainWindow::addXYPoint(double x, double y) {
    qv_x2.append(x);
    qv_y2.append(y);
}
void MainWindow::clearData() {
    qv_x.clear();
    qv_y.clear();
    qv_x1.clear();
    qv_y1.clear();
    qv_x2.clear();
    qv_y2.clear();

    clear = 1;
}
void MainWindow::plot()
{
    double maxval;

    if (ui->check_testdata_xychart->isChecked())
    {
        newCurve->setData(qv_x2, qv_y2);

        //        double minvalx = *std::min_element(qv_x2.constBegin(),
        //        qv_x2.constEnd()); double minvaly =
        //        *std::min_element(qv_y2.constBegin(), qv_y2.constEnd()); double
        //        maxvalx = *std::max_element(qv_x2.constBegin(), qv_x2.constEnd());
        //        double maxvaly = *std::max_element(qv_y2.constBegin(),
        //        qv_y2.constEnd());

        newCurve->rescaleAxes();
    }
    else
    {
        if (xyplot)
        {
            newCurve->~QCPCurve();
            xyplot = 0;
        }
        ui->widget_spline->graph(0)->setData(qv_x, qv_y);
        ui->widget_spline->graph(1)->setData(qv_x, qv_y1);

        ui->widget_spline->xAxis->setRange(0, 6164);
        maxval = *std::max_element(qv_y.constBegin(), qv_y.constEnd());
        ui->widget_spline->yAxis->setRange(0, maxval);
        ui->widget_spline->rescaleAxes();

        ui->widget_spline->clearItems();
        if (chart == 1 && ui->check_switch5->isChecked())
        {
            if (plotsqr) // quadrierte Sensordaten
            {
                QCPItemText *phaseTracerText_sqr1 = new QCPItemText(ui->widget_spline);
                phaseTracerText_sqr1->position->setType(QCPItemPosition::ptAxisRectRatio);
                phaseTracerText_sqr1->setPositionAlignment(Qt::AlignRight | Qt::AlignBottom);
                phaseTracerText_sqr1->position->setCoords(0.9, 0.82); // upper left corner of axis rect
                phaseTracerText_sqr1->setText("peak0: " + ui->line_flat_1->text());
                phaseTracerText_sqr1->setTextAlignment(Qt::AlignLeft);
                phaseTracerText_sqr1->setFont(QFont(font().family(), 9));
                phaseTracerText_sqr1->setPadding(QMargins(8, 0, 0, 0));

                QCPItemText *phaseTracerText_sqr2 = new QCPItemText(ui->widget_spline);
                phaseTracerText_sqr2->position->setType(QCPItemPosition::ptAxisRectRatio);
                phaseTracerText_sqr2->setPositionAlignment(Qt::AlignRight | Qt::AlignBottom);
                phaseTracerText_sqr2->position->setCoords(0.9, 0.80); // upper left corner of axis rect
                phaseTracerText_sqr2->setText("peak1: " + ui->line_flat_2->text());
                phaseTracerText_sqr2->setTextAlignment(Qt::AlignLeft);
                phaseTracerText_sqr2->setFont(QFont(font().family(), 9));
                phaseTracerText_sqr2->setPadding(QMargins(8, 0, 0, 0));

                QCPItemText *textLabel_sqr1 = new QCPItemText(ui->widget_spline);
                textLabel_sqr1->setPositionAlignment(Qt::AlignBottom | Qt::AlignHCenter);
                textLabel_sqr1->position->setType(QCPItemPosition::ptAxisRectRatio);
                textLabel_sqr1->position->setCoords(0.2, 0.85); // place position at center/top of axis rect
                textLabel_sqr1->setText("peak0: " + ui->line_flat_1->text());
                textLabel_sqr1->setFont(QFont(font().family(), 10));       // make font a bit larger
                textLabel_sqr1->setPen(QPen(Qt::red)); // show black border around text

                QCPItemLine *arrow_sqr1 = new QCPItemLine(ui->widget_spline);
                arrow_sqr1->start->setParentAnchor(textLabel_sqr1->bottom);
                arrow_sqr1->end->setCoords(ui->line_flat_1->text().toInt(&ok, 10), 0); // point to (x, y) in x-y-plot coordinates
                arrow_sqr1->setHead(QCPLineEnding::esNone);
                arrow_sqr1->setPen(QPen(Qt::red));

                QCPItemText *textLabel_sqr2 = new QCPItemText(ui->widget_spline);
                textLabel_sqr2->setPositionAlignment(Qt::AlignBottom | Qt::AlignHCenter);
                textLabel_sqr2->position->setType(QCPItemPosition::ptAxisRectRatio);
                textLabel_sqr2->position->setCoords(0.6, 0.85); // place position at center/top of axis rect
                textLabel_sqr2->setText("peak1: " + ui->line_flat_2->text());
                textLabel_sqr2->setFont(QFont(font().family(), 10));       // make font a bit larger
                textLabel_sqr2->setPen(QPen(Qt::red)); // show black border around text

                QCPItemLine *arrow_sqr2 = new QCPItemLine(ui->widget_spline);
                arrow_sqr2->start->setParentAnchor(textLabel_sqr2->bottom);
                arrow_sqr2->end->setCoords(ui->line_flat_2->text().toInt(&ok, 10), 0); // point to (x, y) in x-y-plot coordinates
                arrow_sqr2->setHead(QCPLineEnding::esNone);
                arrow_sqr2->setPen(QPen(Qt::red));
            }
            else // Standard Sensordaten
            {
                QCPItemTracer *phaseTracer = new QCPItemTracer(ui->widget_spline); // Canvas
                phaseTracer->setGraph(0);
                phaseTracer->setGraphKey(maxval);
                phaseTracer->setInterpolating(true);
                phaseTracer->setStyle(QCPItemTracer::tsCircle);
                phaseTracer->setPen(QPen(Qt::red));
                phaseTracer->setBrush(Qt::red);
                phaseTracer->setSize(7);

                QCPItemText *phaseTracerText = new QCPItemText(ui->widget_spline); // textbox X-Offset
                phaseTracerText->position->setType(QCPItemPosition::ptAxisRectRatio);
                phaseTracerText->setPositionAlignment(Qt::AlignRight | Qt::AlignBottom);
                phaseTracerText->position->setCoords(0.2, 0.90); // lower right corner of axis rect
                phaseTracerText->setText("x offset: " + ui->line_prea_6->text());
                phaseTracerText->setTextAlignment(Qt::AlignLeft);
                phaseTracerText->setFont(QFont(font().family(), 9));
                phaseTracerText->setPadding(QMargins(8, 0, 0, 0));

                QCPItemText *phaseTracerText2 = new QCPItemText(ui->widget_spline); // Textbox Y-Offset
                phaseTracerText2->position->setType(QCPItemPosition::ptAxisRectRatio);
                phaseTracerText2->setPositionAlignment(Qt::AlignRight | Qt::AlignBottom);
                phaseTracerText2->position->setCoords(0.2, 0.92);
                phaseTracerText2->setText("y offset: " + ui->line_prea_5->text());
                phaseTracerText2->setTextAlignment(Qt::AlignLeft);
                phaseTracerText2->setFont(QFont(font().family(), 9));
                phaseTracerText2->setPadding(QMargins(8, 0, 0, 0));

/*
    QCPStatisticalBox *statistical = new QCPStatisticalBox(customPlot->xAxis,
    customPlot->yAxis); QBrush boxBrush(QColor(60, 60, 255, 100));
    boxBrush.setStyle(Qt::Dense6Pattern); // make it look oldschool
    statistical->setBrush(boxBrush);

    // specify data:
    statistical->addData(1, 1.1, 1.9, 2.25, 2.7, 4.2);
    statistical->addData(2, 0.8, 1.6, 2.2, 3.2, 4.9, QVector<double>() << 0.7 <<
    0.34 << 0.45 << 6.2 << 5.84); // provide some outliers as QVector
    statistical->addData(3, 0.2, 0.7, 1.1, 1.6, 2.9);

    // prepare manual x axis labels:
    customPlot->xAxis->setSubTicks(false);
    customPlot->xAxis->setTickLength(0, 4);
    customPlot->xAxis->setTickLabelRotation(20);
    QSharedPointer<QCPAxisTickerText> textTicker(new QCPAxisTickerText);
    textTicker->addTick(1, "Sample 1");
    textTicker->addTick(2, "Sample 2");
    textTicker->addTick(3, "Control Group");
    customPlot->xAxis->setTicker(textTicker);

    // prepare axes:
    customPlot->yAxis->setLabel(QString::fromUtf8("O₂ Absorption [mg]"));
    customPlot->rescaleAxes();
    customPlot->xAxis->scaleRange(1.7, customPlot->xAxis->range().center());
    customPlot->yAxis->setRange(0, 7);
    customPlot->setInteractions(QCP::iRangeDrag | QCP::iRangeZoom);
*/
                // text label: F/N
                QCPItemText *textLabel = new QCPItemText(ui->widget_spline);
                textLabel->setPositionAlignment(Qt::AlignTop | Qt::AlignHCenter);
                textLabel->position->setType(QCPItemPosition::ptAxisRectRatio);
                textLabel->position->setCoords(0.4, 0.85); // place position at center/top of axis rect
                textLabel->setText("F/N id: " + ui->line_flat_5->text() + '\n' + "F/N val: " + ui->line_flat_4->text());
                textLabel->setFont(QFont(font().family(), 10));  // make font a bit larger
                textLabel->setPen(QPen(Qt::red)); // show red border around text

                // arrow: F/N
                QCPItemLine *arrow = new QCPItemLine(ui->widget_spline);
                arrow->start->setParentAnchor(textLabel->top);
                arrow->end->setCoords(ui->line_flat_5->text().toInt(&ok, 10), ui->line_flat_4->text().toInt(&ok, 10)); // point to (x, y) in x-y-plot coordinates
                arrow->setHead(QCPLineEnding::esNone);
                arrow->setPen(QPen(Qt::red));

                // text label: displPos
                QCPItemText *textLabel2 = new QCPItemText(ui->widget_spline);
                textLabel2->setPositionAlignment(Qt::AlignTop | Qt::AlignHCenter);
                textLabel2->position->setType(QCPItemPosition::ptAxisRectRatio);
                textLabel2->position->setCoords(0.4, 0.1); // place position at center/top of axis rect
                textLabel2->setText("dspPos: " + ui->line_over_13->text());
                textLabel2->setFont(QFont(font().family(), 10)); // make font a bit larger
                //  textLabel2->setPen(QPen(Qt::green));

                // arrow: displPos
                QCPItemLine *arrow2 = new QCPItemLine(ui->widget_spline);
                arrow2->start->setParentAnchor(textLabel2->top);
                arrow2->end->setCoords(ui->line_over_13->text().toInt(&ok, 10), ui->line_over_14->text().toInt(&ok, 10)); // point to (x, y) in x-y-plot coordinates
                arrow2->setHead(QCPLineEnding::esNone);
                arrow2->setPen(QPen(Qt::green));

                // text label maxid
                QCPItemText *textLabel3 = new QCPItemText(ui->widget_spline);
                textLabel3->setPositionAlignment(Qt::AlignTop | Qt::AlignHCenter);
                textLabel3->position->setType(QCPItemPosition::ptAxisRectRatio);
                textLabel3->position->setCoords(0.65, 0.75); // place position at center/top of axis rect
                textLabel3->setText("max id: " + ui->line_flat_12->text() + '\n' + "max val: " + ui->line_prea_psmax->text());
                textLabel3->setFont(QFont(font().family(), 10));
                textLabel3->setPen(QPen(Qt::blue));

                // arrow: maxid
                QCPItemLine *arrow3 = new QCPItemLine(ui->widget_spline);
                arrow3->start->setParentAnchor(textLabel3->top);
                arrow3->end->setCoords(ui->line_flat_12->text().toInt(&ok, 10), ui->line_prea_psmax->text().toInt(&ok, 10)); // point to (x, y) in x-y-plot coordinates
                arrow3->setHead(QCPLineEnding::esNone);
                arrow3->setPen(QPen(Qt::blue));

                // text label sinmax: für Pfeil:
                QCPItemText *textLabel5 = new QCPItemText(ui->widget_spline);
                textLabel5->setPositionAlignment(Qt::AlignTop | Qt::AlignHCenter);
                textLabel5->position->setType(QCPItemPosition::ptAxisRectRatio);
                textLabel5->position->setCoords(0.4, 0.75); // place position at center/top of axis rect
                textLabel5->setText("fitmax id: " + ui->line_fit_maxid->text() + '\n' + "fitmax val: " + ui->line_over_19->text());
                textLabel5->setFont(QFont(font().family(), 10));
                textLabel5->setPen(QPen(Qt::black));

                // arrow: sinmax
                QCPItemLine *arrow5 = new QCPItemLine(ui->widget_spline);
                arrow5->start->setParentAnchor(textLabel5->top);
                arrow5->end->setCoords(ui->line_fit_maxid->text().toInt(&ok, 10), ui->line_over_19->text().toInt(&ok, 10)); // point to (x, y) in x-y-plot coordinates
                arrow5->setHead(QCPLineEnding::esNone);
                arrow5->setPen(QPen(Qt::black));

                // text label sinmin
                QCPItemText *textLabel6 = new QCPItemText(ui->widget_spline);
                textLabel6->setPositionAlignment(Qt::AlignTop | Qt::AlignHCenter);
                textLabel6->position->setType(QCPItemPosition::ptAxisRectRatio);
                textLabel6->position->setCoords(0.85, 0.75); // place position
                textLabel6->setText("fitmin id: " + ui->line_fit_minid->text());
                textLabel6->setFont(QFont(font().family(), 10));     // make font a bit larger
                textLabel6->setPen(QPen(Qt::black)); // show black border around text

                // arrow: F/N
                // Due Berechnungen
                // fit.sinmaxid = p.smaxid - fit.bestid;
                // uint16_t tmpamp = (p.smax + fit.zoffset - p.normincorr)/2;
                // uint16_t tmpslp = (p.smax + fit.zoffset + p.normincorr)/2;
                // fit.sinmax = sin(0.5 * PI) * tmpamp + tmpslp;
                // fit.sinmin = sin(0.5 * PI + 3082) * tmpamp + tmpslp;
                // fit.sinvec = (fit.sinmax - fit.sinmin)/2;

                QCPItemLine *arrow6 = new QCPItemLine(ui->widget_spline);
                arrow6->start->setParentAnchor(textLabel6->top);
                arrow6->end->setCoords(ui->line_fit_minid->text().toInt(&ok, 10), ui->line_fit_minid_val->text().toInt(&ok, 10)); // point to (x, y) in x-y-plot coordinates
                arrow6->setHead(QCPLineEnding::esNone);
                arrow6->setPen(QPen(Qt::red));
            }
        }
        chart = 0;
    }

    ui->widget_spline->replot();
    if (xyplot) newCurve->rescaleAxes();

    if (ui->check_savepng->isChecked() && clear == 0)
    {
        QString plotnr = QDate::currentDate().toString("yy-mm-dd_") + QTime::currentTime().toString("hh-mm-ss") + QString::number(cyclecount);
        QString plotname = plotnr + ".png";
        QFile plotfile(outputDir + "/" + plotname);
        if (!plotfile.open(QIODevice::WriteOnly | QFile::WriteOnly))
        {
            QMessageBox::warning(0, "Could not create Project File",QObject::tr("\n Could not create Project File on disk"));
        }
        else
        {
            ui->widget_spline->savePng(outputDir + "/" + plotnr + ".png", 0, 0, 1.0, -1);
            plotfile.close();
            clear = 0;
            cyclecount++;
        }
    }
}
void MainWindow::addPoint_2(double x, double y) {
    qv_x_2.append(x);
    qv_y_2.append(y);
}
void MainWindow::addPoint2_2(double y) { qv_y1_2.append(y); }
void MainWindow::addXYPoint_2(double x, double y) {
    qv_x2.append(x);
    qv_y2.append(y);
}
void MainWindow::clearData_2() {
    qv_x_2.clear();
    qv_y_2.clear();
    qv_x1_2.clear();
    qv_y1_2.clear();
    qv_x2_2.clear();
    qv_y2_2.clear();

    clear_2 = 1;
}
void MainWindow::plot_2() {
    double maxval;

  ui->widget_spline_2->graph(0)->setData(qv_x_2, qv_y_2);
  ui->widget_spline_2->graph(1)->setData(qv_x_2, qv_y1_2);

  ui->widget_spline_2->xAxis->setRange(0, 6164);
  maxval = *std::max_element(qv_y_2.constBegin(), qv_y_2.constEnd());
  ui->widget_spline_2->yAxis->setRange(0, maxval);
  ui->widget_spline_2->rescaleAxes();

  ui->widget_spline_2->clearItems();

  QCPItemTracer *phaseTracer = new QCPItemTracer(ui->widget_spline_2);
  phaseTracer->setGraph(0);
  phaseTracer->setGraphKey(maxval);
  phaseTracer->setInterpolating(true);
  phaseTracer->setStyle(QCPItemTracer::tsCircle);
  phaseTracer->setPen(QPen(Qt::red));
  phaseTracer->setBrush(Qt::red);
  phaseTracer->setSize(7);

  QCPItemText *phaseTracerText = new QCPItemText(ui->widget_spline_2);
  phaseTracerText->position->setType(QCPItemPosition::ptAxisRectRatio);
  phaseTracerText->setPositionAlignment(Qt::AlignRight | Qt::AlignBottom);
  phaseTracerText->position->setCoords(0.2,
                                       0.90); // lower right corner of axis rect
  phaseTracerText->setText("offset: ");
  phaseTracerText->setTextAlignment(Qt::AlignLeft);
  phaseTracerText->setFont(QFont(font().family(), 9));
  phaseTracerText->setPadding(QMargins(8, 0, 0, 0));

  // text label:
  QCPItemText *textLabel = new QCPItemText(ui->widget_spline_2);
  textLabel->setPositionAlignment(Qt::AlignTop | Qt::AlignHCenter);
  textLabel->position->setType(QCPItemPosition::ptAxisRectRatio);
  textLabel->position->setCoords(
              0.4, 0.85); // place position at center/top of axis rect
  textLabel->setText("id: ");
  textLabel->setFont(QFont(font().family(), 10)); // make font a bit larger
  textLabel->setPen(QPen(Qt::red)); // show black border around text

  // arrow: F/N
  QCPItemLine *arrow = new QCPItemLine(ui->widget_spline_2);
  arrow->start->setParentAnchor(textLabel->top);
  arrow->end->setCoords(0, 100); // point to (x, y) in x-y-plot coordinates
  arrow->setHead(QCPLineEnding::esNone);
  arrow->setPen(QPen(Qt::red));

  ui->widget_spline_2->replot();
}
void MainWindow::testchart() {
    // add two new graphs and set their look:
    ui->widget_spline->addGraph();
    ui->widget_spline->graph(0)->setPen(
                QPen(Qt::blue)); // line color blue for first graph
    ui->widget_spline->graph(0)->setBrush(QBrush(QColor(
                                                     0, 0, 255, 20))); // first graph will be filled with translucent blue
    ui->widget_spline->addGraph();
    ui->widget_spline->graph(1)->setPen(
                QPen(Qt::red)); // line color red for second graph
    // generate some points of data (y0 for first, y1 for second graph):
    QVector<double> x(251), y0(251), y1(251);
    for (int i = 0; i < 251; ++i) {
        x[i] = i;
        y0[i] = qExp(-i / 150.0) * qCos(i / 10.0); // exponentially decaying cosine
        y1[i] = qExp(-i / 150.0);                  // exponential envelope
    }
    // configure right and top axis to show ticks but no labels:
    // (see QCPAxisRect::setupFullAxesBox for a quicker method to do this)
    ui->widget_spline->xAxis2->setVisible(true);
    ui->widget_spline->xAxis2->setTickLabels(false);
    ui->widget_spline->yAxis2->setVisible(true);
    ui->widget_spline->yAxis2->setTickLabels(false);
    // make left and bottom axes always transfer their ranges to right and top
    // axes:
    connect(ui->widget_spline->xAxis, SIGNAL(rangeChanged(QCPRange)),
            ui->widget_spline->xAxis2, SLOT(setRange(QCPRange)));
    connect(ui->widget_spline->yAxis, SIGNAL(rangeChanged(QCPRange)),
            ui->widget_spline->yAxis2, SLOT(setRange(QCPRange)));
    // pass data points to graphs:
    ui->widget_spline->graph(0)->setData(x, y0);
    ui->widget_spline->graph(1)->setData(x, y1);
    // let the ranges scale themselves so graph 0 fits perfectly in the visible
    // area:
    //    ui->widget_spline->graph(0)->rescaleAxes();
    //    // same thing for graph 1, but only enlarge ranges (in case graph 1 is
    //    smaller than graph 0): ui->widget_spline->graph(1)->rescaleAxes(true);
    ui->widget_spline->rescaleAxes();
    // Note: we could have also just called ui->widget_spline->rescaleAxes();
    // instead Allow user to drag axis ranges with mouse, zoom with mouse wheel
    // and select graphs by clicking:
    ui->widget_spline->setInteractions(QCP::iRangeDrag | QCP::iRangeZoom |
                                       QCP::iSelectPlottables);
}
void MainWindow::on_p_angle2encsteps_clicked() {
    float angle = ui->line_align_setpos_degree->text().toFloat();
    float enc = ui->line_preacount->text().toFloat();
    int val = angle * (enc / 360);
    ui->line_align_setpos->setText(QString::number(val));
}
void MainWindow::on_check_align_constpos_2_stateChanged() {
    ui->check_align_constpos_2->setAutoExclusive(true);
    ui->check_align_constpos_3->setAutoExclusive(true);
    ui->check_align_constpos_4->setAutoExclusive(true);
    ui->line_align_setconst->clear();
}
void MainWindow::on_check_align_constpos_4_stateChanged() {
    ui->check_align_constpos_2->setAutoExclusive(true);
    ui->check_align_constpos_3->setAutoExclusive(true);
    ui->check_align_constpos_4->setAutoExclusive(true);
    ui->line_align_setconst->clear();
}
void MainWindow::on_check_align_constpos_3_stateChanged() {
    ui->check_align_constpos_2->setAutoExclusive(true);
    ui->check_align_constpos_3->setAutoExclusive(true);
    ui->check_align_constpos_4->setAutoExclusive(true);
    ui->line_align_setconst->clear();
}
void MainWindow::on_check_align_rawdata_clicked() {
    if (serial_due->isOpen()) {
        if (ui->check_align_rawdata->isChecked())
            serialSendDUE("$ad=5=1\r"); // Sensordaten ohne Auswertung direkt über die
        // serielle Schnittstelle DUE senden
        else
            serialSendDUE("$ad=5=0\r");
        svcid = 1;
    } else {
        err_msgbox("COM5 not open");
        ui->check_align_rawdata->setChecked(0);
    }
}
void MainWindow::on_line_align_setconst_cursorPositionChanged(int arg1,int arg2) {
    QString tmp = ui->line_align_setconst->text();
    if (arg2 > 0) {
        ui->check_align_constpos_2->setAutoExclusive(false);
        ui->check_align_constpos_3->setAutoExclusive(false);
        ui->check_align_constpos_4->setAutoExclusive(false);
        ui->check_align_constpos_2->setChecked(false);
        ui->check_align_constpos_3->setChecked(false);
        ui->check_align_constpos_4->setChecked(false);
        ui->line_align_setconst->setText(tmp);
    }
}
void MainWindow::on_p_align_getwafsize_clicked() {
    serialSendDUE("$ws=?\r");
    svc2 = TRUE;
}
void MainWindow::on_p_align_setwafsize_clicked() {
    QByteArray tmpstr = "$ws=";
    tmpstr.append(ui->line_align_wafsize->text().toLatin1());
    tmpstr.append("\r");
    serialSendDUE(tmpstr);
    svc2 = TRUE;
}
void MainWindow::on_p_align_setflatlen_clicked() {
    QByteArray tmpstr = "$fl=";
    float flen = ui->line_align_flatlen->text().toFloat();
    QString len = QString::number(flen * 10.0);
    tmpstr.append(len.toLatin1());
    tmpstr.append("\r");
    serialSendDUE(tmpstr);
    svc1 = TRUE;
}
void MainWindow::on_p_align_getflatlen_clicked() {
    serialSendDUE("$fl=?\r");
    svc1 = TRUE;
}
void MainWindow::on_p_angle_zeropos_clicked() {
    ui->line_align_setpos->setText("0");
}
void MainWindow::on_p_align_getslitlen_clicked() {
    serialSendDUE("$ts=?=1\r");
    svc4 = TRUE;
}
void MainWindow::on_p_align_setslitlen_clicked() {
    QByteArray tmpstr = "$ts=1="; // $ts=1=973267
    QString len = QString::number(ui->line_align_slitlen->text().toInt(&ok, 10));
    tmpstr.append(len.toLatin1());
    tmpstr.append("\r");
    serialSendDUE(tmpstr);
    svc4 = TRUE;
}
void MainWindow::on_p_align_getdispl_clicked() {
    tmpstr = 0;
    tmpstr.append(rGET); // $GET_
    tmpstr.append("24"); // get Displacement
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_align_setdispl_clicked() {
    if (macro_profil == 0)
        ui->p_align_setdispl->setStyleSheet(backLightYello);
    tmpstr = setpos;      // $SET_
    tmpstr.append("24="); // set Displacement
    if (macro_profil == 1) tmpstr.append("0"); // Flag PREAS->PA_profilecalibration setzen
    else tmpstr.append(ui->line_align_displ->text().toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_align_displpos_clicked() {
    int tmppos;
    bytedata1.clear();
    bytedata2.clear();
    bytedata3.clear();
    bytedata4.clear();
    bytedata5.clear();
    tmppos = ui->line_over_13->text().toInt(&ok, 10);
    bytedata1.append(QString::number(tmppos >> 24 & 0xff).toLatin1()); // MSB
    bytedata2.append(QString::number(tmppos >> 16 & 0xff).toLatin1());
    bytedata3.append(QString::number(tmppos >> 8 & 0xff).toLatin1());
    bytedata4.append(QString::number(tmppos & 0xff).toLatin1()); // LSB
    bytedata5 = "0";                                  // Motorparameter

    QByteArray tmpstr = "$X_2,0,0,4,1,0,0,2,1,2,";
    tmpstr.append(bytedata1);
    tmpstr.append(",");
    tmpstr.append(bytedata2);
    tmpstr.append(",");
    tmpstr.append(bytedata3);
    tmpstr.append(",");
    tmpstr.append(bytedata4);
    tmpstr.append(",");
    tmpstr.append(bytedata5);
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);

    cmdid = 4;
}
void MainWindow::on_p_align_getsetupdispl_clicked() {
    serialSendDUE("$ts=?=3\r");
    svc5 = TRUE;
}
void MainWindow::on_p_align_setsetupdispl_clicked() {
    QByteArray tmpstr = "$ts=3=";
    QString len =
            QString::number(ui->line_align_setupdispl->text().toInt(&ok, 10));
    tmpstr.append(len.toLatin1());
    tmpstr.append("\r");
    serialSendDUE(tmpstr);
    svc5 = TRUE;
}
void MainWindow::on_p_align_profile_clicked() {
    if (serial_api->isOpen()) {
        if (macro_profil == 0) {
            API_LOOP = 0; // Sicherheitshalber alle störenden Flags ausschalten
            assistant_wc = 0;

            macro_profil = 1;

            ui->p_align_profile->setText("wait..");
            macroProfil(true);
        } else {
            err_msgbox("profile assistent already running");
            // macro_profil = 0;
            // ui->p_align_profile->setText("start");
            // macroProfil(false);
        }
    } else
        err_msgbox("COM3 not open");
}
void MainWindow::on_p_align_runmacro_clicked() {
    if (macro_anglecheck == 0) {
        mstep = 0;
        macro_anglecheck = 1;
        anglestep = ui->line_macro_anglestep->text(); // Startwert Winkel
        macrostep(mstep);
    } else if (macro_anglecheck == 1) {
        macro_anglecheck = 0;
        mstep = 0;
    }
}
void MainWindow::on_p_align_runmacro_lddispl_clicked() {
    ui->plainText_sendlog->appendPlainText(
                "mstep: " + QString::number(mstep) +
                ", macro ld: " + QString::number(macroaktiv_ld)); // DEBUG

    if (macroaktiv_ld == 0) {
        mstep = 0;
        macroaktiv_ld = 1;
        ui->p_align_runmacro_lddispl->setStyleSheet(backLightGreen);
        macrostep_lddispl(mstep);
    } else if (macroaktiv_ld == 1) {
        macroaktiv_ld = 0;
        mstep = 0;
        ui->p_align_runmacro_lddispl->setStyleSheet(backGrey);
    }
}
void MainWindow::on_p_align_runmacro_decenter_clicked() {
    if (macro_decenter == 0) {
        mstep = 0;
        macro_decenter = 1;
        ui->p_align_runmacro_decenter->setStyleSheet(backLightGreen);
        macrostep_lddispl(mstep);
    } else if (macro_decenter == 1) {
        macro_decenter = 0;
        mstep = 0;
        ui->p_align_runmacro_decenter->setStyleSheet(backGrey);
    }
}
void MainWindow::macrostep(uint8_t step)
{

   // API ALIGN mit anglestep

    if (macro_anglecheck == 1)
    {
        switch (step)
        {
        case 0:
            //
            //            ui->line_align_setpos->setText(anglestep);
            //            on_p_align_setpos_clicked();
            break;
            //            case 1:
            //            mstep = 2;
            //            //on_p_align_resphi_clicked();
            //            //break;
            //            case 2:
            //            on_p_align_transmitstart_clicked();
            //            break;
            //            case 3:
            //            ui->line_align_setpos->setText("8218");
            //            on_p_align_setpos_clicked();
            //            f_ALdat = 0;
            //            if(angle < 6164) angle += 171;
            //            else macroaktiv = 0;
            //            break;
            //            case 4:
            //   ui->line_align_setpos->setText(posphiFN);
            //   on_p_align_setpos_clicked();
            //   break;
        case 5:

            break;
        }
    }
}
void MainWindow::macro_partAlign() {
    serialSendFeeder(vaconPA); // PA vac on
}
void MainWindow::macrostep_lddispl(uint8_t step) // Assistant Wafer center with Loader Displacement
{
    ui->plainText_sendlog->appendPlainText(
                "step: " + QString::number(step) +
                ", macro ld: " + QString::number(macroaktiv_ld)); // DEBUG

    if (macroaktiv_ld || macro_decenter) {
        QString tmp;
        int displ = 0;
        double ldxval = 0;
        double rest = 0;
        switch (step) {
        case 0: // PA Phi auf Displacementpos drehen
            tmpstr = 0;
            tmp = ui->line_over_13->text(); // get displPos
            tmpstr.append(setpos);
            tmpstr.append("59="); // ID PA Phi ist 59
            tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
            tmpstr.append("\r\n");
            serialSendFeeder(tmpstr);
            qDebug() << "tmpstr" << tmpstr;
            mstep = 1;
            break;
        case 1:
            on_p_PA_abovLDhgt_clicked(); // PA over LD
            mstep = 2;
            break;
        case 2:
            on_p_LD_XPA_clicked(); // LD PA pos
            mstep = 3;
            break;
        case 3:
            on_p_PA_LDhgt_clicked(); // PA LD-Height pos
            mstep = 4;
            break;
        case 4:
            serialSendFeeder(vaconLD); // Loader vac on
            mstep = 5;
            break;
        case 5:
            serialSendFeeder(vacoffPA); // PA vac off
            mstep = 6;
            break;
        case 6:
            on_p_PA_belowLDhgt_clicked(); // PA below LD
            mstep = 7;
            break;
        case 7: // LD Displacement
            tmpstr = 0;
            tmp = ui->line_loader_xpreapos->text();
            if (macroaktiv_ld) // Seite API
            {
                ldxval = (ui->line_over_12->text().toFloat() / 1000.0) * 17.7778;
            } else if (macro_decenter) // Seite Aligner
            {
                if (macro_profil)
                    ldxval = ui->line_over_12->text().toFloat() / 1000.0 * 17.7778 +
                            ui->line_align_decenter_2->text().toFloat() * 17.7778;
                else
                    ldxval = ui->line_over_12->text().toFloat() / 1000.0 * 17.7778 +
                            ui->line_align_decenter->text().toFloat() * 17.7778;
            }
            displ = (int)ldxval;
            rest = ldxval - displ;
            rest *= 10.000;
            if ((int)rest > 5)
                displ += 1;
            qDebug() << "ldxval" << ldxval << "displ" << displ;
            ui->plainText_sendlog->appendPlainText(
                        "ldxval " + QString::number(ldxval) + " displLDX " +
                        QString::number(displ));
            tmpstr.append(setpos);
            tmpstr.append("54="); // ID Loader X ist 54
            tmpstr.append(QString::number(tmp.toInt(&ok, 10) - displ).toLatin1());
            tmpstr.append("\r\n");
            serialSendFeeder(tmpstr); //
            mstep = 8;
            break;
        case 8:
            on_p_PA_LDhgt_clicked(); // PA LD height
            mstep = 9;
            break;
        case 9:
            serialSendFeeder(vaconPA); // PA vac on
            mstep = 10;
            break;
        case 10:
            serialSendFeeder(vacoffLD); // Loader vac off
            mstep = 11;
            break;
        case 11:
            on_p_PA_abovLDhgt_clicked(); // PA over LD
            mstep = 12;
            break;
        case 12:
            on_p_LD_PAfree_clicked(); // LD PA free pos
            mstep = 13;
            break;
        case 13:
            on_p_PA_hgt_clicked(); // PA mess height
            mstep = 14;
            break;
        case 14:
            macroaktiv_ld = 0;
            macro_decenter = 0;
            if (macro_profil)
                macroProfil(true);
            break;
        }
    }
}
void MainWindow::macroProfil(bool state) {
    static int profilstep = 0;

    ui->plainText_sendlog->appendPlainText("macro profilstep: " +
                                           QString::number(profilstep)); // DEBUG

    if (state == false)
        profilstep = 0;
    else if (macro_profil) {
        switch (profilstep) {
        case 0:
            profilstep++;
            assistant_API_LOAD(); // 8" carrier wird geladen
            break;
        case 1:
            profilstep++;
            assistant_API_setcar(); // Parameter für carrier id=1 werden geladen
            break;
        case 2:
            profilstep++;
            assistant_API_getwafer(); // 8" Wafer aus Slot1 wird direkt mit PUT auf
            // den Aligner gelegt
            break;
        case 3:
            err_msgbox("profilstep " +
                       QString::number(profilstep)); // ## nur für Entwicklungszwecke
            profilstep++;
            on_check_align_dataon_clicked(); // Data von DUE empfangen einschalten
            break;
        case 4:
            err_msgbox("profilstep " +
                       QString::number(profilstep)); // ## nur für Entwicklungszwecke
            profilstep++;
            on_p_align_setdispl_clicked(); // temporär Profilecalibration = 1 setzen
            break;
        case 5:
            err_msgbox("profilstep " +
                       QString::number(profilstep)); // ## nur für Entwicklungszwecke
            profilstep++;
            assistant_API_Align(); // LD Displacement und Wafer auf 90° alignen
            break;
        case 6:
            err_msgbox("profilstep " +
                       QString::number(profilstep)); // ## nur für Entwicklungszwecke
            profilstep++;
            profilstep++;                // direkt mit case 8 weiter
            on_p_align_resphi_clicked(); // PA PHI reset
            break;
        case 7:
            err_msgbox("profilstep " +
                       QString::number(profilstep)); // ## nur für Entwicklungszwecke
            profilstep++;
            serialSendFeeder(
                        "$SET_59=4623\r\n"); // PA PHI um 270° drehen (Notch links)
            break;
        case 8:
            err_msgbox("profilstep " + QString::number(profilstep));
            profilstep++; // Verzweigt in Loader Displacement Decenter
            mstep = 1;
            macro_decenter = 1;
            macrostep_lddispl(mstep);
            break;
        case 9:
            err_msgbox("profilstep " + QString::number(profilstep));
            profilstep++;
            serialSendFeeder(
                        "$SET_59=1541\r\n"); // PA PHI auf 90° drehen (Notch unten)
            break;
        case 10:
            err_msgbox("profilstep " + QString::number(profilstep));
            profilstep++;
            on_p_align_resphi_clicked(); // PA PHI reset
            break;
        case 11:
            err_msgbox("profilstep " + QString::number(profilstep));
            profilstep++;
            on_p_align_transmitstart_clicked(); // MEAS on
            break;
        case 12:
            err_msgbox("profilstep " + QString::number(profilstep));
            profilstep++;
            serialSendFeeder("$SET_59=9246\r\n"); // PA Phi 9246 steps drehen (540°)
            //    on_p_align_setpos_clicked(true);
            break;
        case 13: // Auswertung noch nicht fertig entwickelt
            err_msgbox("Entgegen LD drehen: profilstep " +
                       QString::number(profilstep));
            err_msgbox("COM 5 Daten auswerten. Wafer zurück");
            profilstep++;
            profilstep++;                         // direkt auf case 15
            serialSendFeeder("$SET_59=1541\r\n"); // PA Phi entgegen LD drehen

            // Werte zwischen if 1541 und 3082 extrahieren
            // (min (0) -> max (16384), max -> min) detektieren
            // Anzahl der Werte unter dem linearen Verkauf entspricht Anzahl der
            // Winkelschritte (
            break;
        case 14:
            err_msgbox("Entgegen LD drehen: profilstep " +
                       QString::number(profilstep));
            profilstep++;
            serialSendFeeder("$SET_59=1541\r\n"); // PA Phi entgegen LD drehen
            break;
        case 15:
            err_msgbox("Displacement aufheben: profilstep " +
                       QString::number(profilstep));
            profilstep++;
            mstep = 1;
            macro_decenter = 1;
            macrostep_lddispl(mstep);
            break;
        case 16:
            err_msgbox("Wafer abholen: profilstep " + QString::number(profilstep));
            profilstep++;
            on_p_API_getaligner_clicked(); // Wafer vom Aligner abholen
            break;
        case 17:
            err_msgbox("profilstep " + QString::number(profilstep));
            profilstep++;
            APIcmdtimeout = 10000;
            if (APIid == none) {
                APIactive = 1;
                APIid = cPUT;
                serialSendAPI("@PUT_S=1,SL=1\r\n");
            }
            break;
        case 18:
            err_msgbox("profilstep " + QString::number(profilstep));
            profilstep++;
            APIcmdtimeout = 10000;

            if (APIid == none) {
                APIactive = 1;
                APIid = cUNLOAD;
                serialSendAPI("@UNLOAD_L=1\r\n");
            }
            break;
        case 19:
            ui->p_align_profile->setText("start");
            profilstep = 0;
            macro_profil = 0;
            mstep = 0;
            macro_decenter = 0;
            break;
        }
    }
}
void MainWindow::on_p_align_getwafangle_clicked() {
    serialSendDUE("$ts=?=4\r");
    svc11 = TRUE;
}
void MainWindow::on_p_align_setwafangle_clicked() {
    QByteArray tmpstr = "$ts=4=";
    QString len =
            QString::number(ui->line_align_setwafangle->text().toInt(&ok, 10));
    tmpstr.append(len.toLatin1());
    tmpstr.append("\r");
    serialSendDUE(tmpstr);
    svc11 = TRUE;
}
void MainWindow::on_p_align_getfilter_clicked() {
    serialSendDUE("$ts=?=5\r");
    svc12 = TRUE;
}
void MainWindow::on_p_align_setfilter_clicked() {
    QByteArray tmpstr = "$ts=5=";
    QString len =
            QString::number(ui->line_align_matchfilter->text().toInt(&ok, 10));
    tmpstr.append(len.toLatin1());
    tmpstr.append("\r");
    serialSendDUE(tmpstr);
    svc12 = TRUE;
}
void MainWindow::on_p_align_getfnidcorr_clicked() {
    serialSendDUE("$ts=?=6\r");
    svc13 = TRUE;
}
void MainWindow::on_p_align_setfnidcorr_clicked() {
    QByteArray tmpstr = "$ts=6=";
    QString len = QString::number(ui->line_align_fnidcorr->text().toInt(&ok, 10));
    tmpstr.append(len.toLatin1());
    tmpstr.append("\r");
    serialSendDUE(tmpstr);
    svc13 = TRUE;
}
void MainWindow::on_p_align_getpaangle_clicked() {
    serialSendDUE("$ts=?=2\r");
    svc14 = TRUE;
}
void MainWindow::on_p_align_setpaangle_clicked() {
    QByteArray tmpstr = "$ts=2=";
    QString len = QString::number(ui->line_align_paangle->text().toInt(&ok, 10));
    tmpstr.append(len.toLatin1());
    tmpstr.append("\r");
    serialSendDUE(tmpstr);
    svc14 = TRUE;
}
void MainWindow::on_p_align_waferchange_clicked() {
    feedertimeout = 8000;
    tmpstr = setpos;       // $SET_
    tmpstr.append("14=1"); // Waferchange
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_check_wc_multi_stateChanged(int arg1) {
    if (arg1)
        multiwc = 1;
    else
        multiwc = 0;
}
void MainWindow::on_p_start_assistant_wc_clicked()
{
    if (serial_api->isOpen())
    {
        if (!assistant_wc)
        {
            int ret = err_msgboxTransferOK(
                        "Stage and mic z-drive must be in transfer position. \nIf stage is "
                        "not in transfer position press CANCEL. \nPut Carrier with Wafer in "
                        "Slot 1 on Lift. \nPress OK");
            if (ret == 0) // Stage in Transfer position
            {
                API_LOOP = 0; // Sicherheitshalber alle störenden Flags ausschalten
                macro_profil = 0;

                assistant_wc = 1; // Flag für Assistent wafer changer
                assistant_loop(assistant_wc);
            }
        }
        else err_msgbox("Assistant is already running");
    }
    else err_msgbox("COM3 not open");
}
void MainWindow::assistant_API_LOAD() // carrier laden
{

    APIcmdtimeout = 10000;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1; // Flag API CMDtype active
        APIid = cLOAD; // Enumerartion cLOAD aktiv

        tmpstr = API_LOAD;
        if (ui->groupBox_Lift1->isChecked())
            tmpstr.append("1"); // Lift1 load
        else if (ui->groupBox_Lift2->isChecked())
            tmpstr.append("2"); // Lift2 load
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::assistant_API_getwafer() {
    APIcmdtimeout = 10000;
    tmpstr = 0;

    if (APIid == none) // Enumeration
    {
        APIactive = 1;
        APIid = cGETL;

        tmpstr = API_GET_L; // @GET_S
        if (ui->groupBox_Lift1->isChecked() == 1)
            tmpstr.append("1");
        else if (ui->groupBox_Lift2->isChecked() == 1)
            tmpstr.append("2");
        tmpstr.append(API_GET_SL); // ",SL=" Slot
        tmpstr.append("1");        // Wafer muss in Slot 1 msein
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::assistant_API_setcar() {
    QString cartype;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cSETCAR;

        tmpstr = API_SETCAR;
        tmpstr.append("1"); // cartype carrier 8 inch -> id1
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    } else
        err_msgbox("wait for cmd response");
}
void MainWindow::assistant_API_Align() {
    APIcmdtimeout = 40000;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cALIGN;

        tmpstr = API_ALIGN; // @ALIGN_A=
        tmpstr.append("9000");
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::assistant_API_putwafer() {
    APIcmdtimeout = 10000;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cPUT;

        tmpstr = API_PUT_L; // @PUT_S=
        if (ui->groupBox_Lift1->isChecked() == 1)
            tmpstr.append("1");
        else if (ui->groupBox_Lift2->isChecked() == 1)
            tmpstr.append("2");
        tmpstr.append(API_GET_SL); // ",SL=" Slot
        tmpstr.append("1");        // Slot 1
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::assistant_loop(int loop) // Assistent für wafer changer setup
{
    int ret;

    static int cycle = 0; // switch-Variable
    static int i = 0;     // Anzahl Alignments
    static float off_x0 = 0;
    static float off_y0 = 0;
    static float off_0 = 0;
    static float corrwc[3] = {0};

    float off_x1;
    float off_y1;
    float off_1;
    float reso;
    float off_d; // Ergebnisspeicher für Mittelwertbildung
    float corrmiddle;

    // assistant_loop() wird von f_APIid() gestartet
    if (loop) {
        switch (cycle) {
        case 0:
            assistant_API_LOAD(); // 8" carrier wird geladen
            cycle = 1;
            break;
        case 1:
            assistant_API_setcar(); // Parameter für carrier id=1 werden geladen
            cycle = 2;
            break;
        case 2:
            assistant_API_getwafer(); // 8" Wafer aus Slot1 wird direkt mit PUT auf
            // den Aligner gelegt
            cycle = 3;
            break;
        case 3:
            assistant_API_Align(); // Wafer auf 90° alignen
            cycle = 4;
            break;
        case 4:
            on_p_API_GetFNres_clicked(); // Offset values einlesen
            cycle = 5;
            break;
        case 5:
            off_x0 = ui->line_api_getfnres_x->text().toInt(&ok, 10);
            off_y0 = ui->line_api_getfnres_y->text().toInt(&ok, 10);
            off_0 = qSqrt((off_x0 * off_x0) + (off_y0 * off_y0));
            on_p_API_PREWC_clicked(); // Wafer auf den Chuck legen
            cycle = 6;
            break;
        case 6:
            on_p_API_PREWC_clicked(); // Wafer zurück auf den Aligner legen
            cycle = 7;
            break;
        case 7:
            assistant_API_Align(); // Wafer auf 90° alignen
            cycle = 8;
            break;
        case 8:
            on_p_API_GetFNres_clicked(); // Offset values einlesen
            cycle = 9;
            break;
        case 9:
            off_x1 = ui->line_api_getfnres_x->text().toInt(&ok, 10);
            off_y1 = ui->line_api_getfnres_y->text().toInt(&ok, 10);
            off_1 = qSqrt((off_x1 * off_x1) + (off_y1 * off_y1));
            off_d = off_0 - off_1;
            reso = getResolution("Waferchanger phi motor").toFloat(&ok);
            off_d /= 2;                      // Vektor halbieren
            corrwc[i] = reso * off_d / 1000; // in mm
            qDebug() << "reso" << reso << "corrwc" << corrwc[i];
            if (i < 2) // insgesamt drei Wiederholungen ausführen
            {
                i++;
                cycle = 6;
                off_x0 = ui->line_api_getfnres_x->text().toInt(
                            &ok, 10); // aktuellen Offset-Wert als Startwert kopieren
                off_y0 = ui->line_api_getfnres_y->text().toInt(&ok, 10);
                off_0 = qSqrt(
                            (off_x0 * off_x0) +
                            (off_y0 * off_y0));   // aktuellen Vektor zu Startvektor kopieren
                on_p_API_PREWC_clicked(); // Wafer auf den Chuck legen
                break;
            } else {
                i = 0;
                corrmiddle = (corrwc[0] + corrwc[1] + corrwc[2]) /
                        3; // Mittelwert aus drei Alignments bilden
                ui->plainTextEdit_API_logerr->appendPlainText(
                            "correction value (mean value): " + QString::number(corrmiddle));
                corrmiddle += ui->line_wc_leftpos->text().toInt(&ok, 10);
                ui->plainTextEdit_API_logerr->appendPlainText(
                            "new wafer changer phi left value: " + QString::number(corrmiddle));
                ret = err_msgboxTransferOK(
                            "correction value: " +
                            QString::number(corrmiddle -
                                            ui->line_wc_leftpos->text().toInt(&ok, 10)) +
                            " new value leftpos: " + QString::number(corrmiddle) +
                            ". Press OK to store");
                if (ret == 0) {
                    ui->line_wc_leftpos->setText(
                                QString::number(corrmiddle)); // neuer Wert für WC Phi Left
                } else {
                    ret = err_msgboxTransferOK("Press OK to Repeat or CANCEL to finish");
                    if (ret == 0) {
                        cycle = 6;
                        off_x0 = ui->line_api_getfnres_x->text().toInt(
                                    &ok, 10); // aktuellen Offset-Wert als Startwert kopieren
                        off_y0 = ui->line_api_getfnres_y->text().toInt(&ok, 10);
                        off_0 = qSqrt(
                                    (off_x0 * off_x0) +
                                    (off_y0 * off_y0)); // aktuellen Vektor zu Startvektor kopieren
                        on_p_API_PREWC_clicked(); // Wafer auf den Chuck legen
                        break;
                    }
                }
            }
        case 10:
            off_x0 = 0;
            off_y0 = 0;
            off_0 = 0;
            on_p_API_getaligner_clicked();
            cycle = 11;
            break;
        case 11:
            assistant_API_putwafer();
            cycle = 12;
            break;
        case 12:
            on_p_API_UNLOAD_clicked();
            cycle = 13;
            break;
        case 13:
            assistant_wc = 0;
            cycle = 0;
            err_msgbox("The new value is entered in the field 'left position' on the "
                       "page 'Changer'. Please check the value and save it with the "
                       "Button 'Store'");
            break;
        }
    } else
        cycle = 0;
}
// ---------------- Transfer Pos --------------------------------
void MainWindow::on_p_ldx_constpos_clicked() {
    dev_posconst("$X_2,0,0,5,1,0,1,1,2,1,"); // $X_2 CMDs POS_CONST
}
void MainWindow::on_p_ldy_constpos_clicked() {
    dev_posconst("$X_2,0,0,5,1,0,2,1,2,2,"); // $X_2 CMDs POS_CONST
}
void MainWindow::on_p_l1h_constpos_clicked() {
    dev_posconst("$X_2,0,0,3,1,0,7,1,2,1,"); // $X_2 CMDs POS_CONST
}
void MainWindow::on_p_l1t_constpos_clicked() {
    dev_posconst("$X_2,0,0,3,1,0,4,1,2,2,"); // $X_2 CMDs POS_CONST
}
void MainWindow::on_p_l2h_constpos_clicked() {
    dev_posconst("$X_2,0,0,2,1,0,7,1,2,1,"); // $X_2 CMDs POS_CONST
}
void MainWindow::on_p_l2t_constpos_clicked() {
    dev_posconst("$X_2,0,0,2,1,0,4,1,2,2,"); // $X_2 CMDs POS_CONST
}
void MainWindow::on_p_pah_constpos_clicked() {
    dev_posconst("$X_2,0,0,3,1,0,1,1,2,3,"); // $X_2 CMDs POS_CONST
}
void MainWindow::on_p_pap_constpos_clicked() {
    dev_posconst("$X_2,0,0,4,1,0,2,1,2,2,"); // $X_2 CMDs POS_CONST
}
void MainWindow::on_p_pat_constpos_clicked() {
    dev_posconst("$X_2,0,0,4,1,0,3,1,2,3,"); // $X_2 CMDs POS_CONST
}
void MainWindow::on_p_par_constpos_clicked() {
    dev_posconst("$X_2,0,0,4,1,0,4,1,2,1,"); // $X_2 CMDs POS_CONST
}
void MainWindow::on_p_wch_constpos_clicked() {
    dev_posconst("$X_2,0,0,5,1,0,1,1,2,3,"); // $X_2 CMDs POS_CONST
}
void MainWindow::on_p_wcp_constpos_clicked() {
    dev_posconst("$X_2,0,0,6,1,0,2,1,2,3,"); // $X_2 CMDs POS_CONST
}
void MainWindow::dev_posconst(QByteArray constpos) {
    bytedata1.clear();
    bytedata2.clear();
    bytedata3.clear();
    bytedata4.clear();
    int tmpconst = ui->line_pos_setconst->text().toInt(&ok, 10);
    bytedata1.append(QString::number((tmpconst & 0xff000000) >> 24).toLatin1());
    bytedata2.append(QString::number((tmpconst & 0xff0000) >> 16).toLatin1());
    bytedata3.append(QString::number((tmpconst & 0xff00) >> 8).toLatin1());
    bytedata4.append(QString::number(tmpconst & 0xff).toLatin1());

  //  qDebug()<<" byte1 "<<bytedata1 << " byte2 "<<bytedata2<< " byte3
    //  "<<bytedata3;
    constpos.append(bytedata1);
    constpos.append(",");
    constpos.append(bytedata2);
    constpos.append(",");
    constpos.append(bytedata3);
    constpos.append(",");
    constpos.append(bytedata4);
    constpos.append("\r\n");

    XRACcmd = 1;
    serialSendFeeder(constpos); // pos const
}
void MainWindow::on_p_constpos_stop_clicked() {
    ui->line_pos_setconst->setText("0");
}
void MainWindow::on_check_pospositiv_stateChanged() {}
void MainWindow::on_p_dev_sync_clicked() {
    int node = ui->spin_dev_nodesync->value();
    tmpstr = callsync; // $SET_
    tmpstr.append(QString::number(node).toLatin1());
    tmpstr.append(CRLF);
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_dev_pinc_clicked() {
    serialSendFeeder(
                svcget50); // PC1 für DUE TWI INIT, PC2 für Aligner Setupdaten
}
void MainWindow::on_p_dev_ddrc_clicked() { serialSendFeeder(svcget51); }
void MainWindow::on_p_dev_portc_clicked() { serialSendFeeder(svcget52); }
void MainWindow::on_p_align_constpos_clicked() {
    if (ui->check_align_constpos_2->isChecked())
        serialSendFeeder("&X0,0,4,1,0,0,2,2,2,0,1,56,128,\r\n"); // Fast
    else if (ui->check_align_constpos_3->isChecked())
        serialSendFeeder("&X0,0,4,1,0,0,2,2,2,0,0,0,0,\r\n"); // Stop
    else if (ui->check_align_constpos_4->isChecked())
        serialSendFeeder("&X0,0,4,1,0,0,2,2,2,0,0,39,128,\r\n"); // Slow
    else {
        bytedata1.clear();
        bytedata2.clear();
        bytedata3.clear();
        bytedata4.clear();
        int tmpconst = ui->line_align_setconst->text().toInt(&ok, 10);
        bytedata1.append(QString::number((tmpconst & 0xff000000) >> 24).toLatin1());
        bytedata2.append(QString::number((tmpconst & 0xff0000) >> 16).toLatin1());
        bytedata3.append(QString::number((tmpconst & 0xff00) >> 8).toLatin1());
        bytedata4.append(QString::number(tmpconst & 0xff).toLatin1());
        qDebug() << " byte1 " << bytedata1 << " byte2 " << bytedata2 << " byte3 "
                 << bytedata3;
        QByteArray tmpstr = "$X_2,0,0,4,1,0,0,2,2,2,";
        tmpstr.append(bytedata1);
        tmpstr.append(",");
        tmpstr.append(bytedata2);
        tmpstr.append(",");
        tmpstr.append(bytedata3);
        tmpstr.append(",");
        tmpstr.append(bytedata4);
        tmpstr.append("\r\n");
        serialSendFeeder(tmpstr);
    }
    XRACcmd = 1;
}
void MainWindow::on_p_dev_pospositiv_clicked() {
    int tmpconst = ui->line_pos_setconst->text().toInt(&ok, 10);
    tmpconst = tmpconst * -1;
    ui->line_pos_setconst->setText(QString::number(tmpconst));
}
void MainWindow::on_p_transfer_stage_calib_clicked() {
    STAGECAL = 1; // Flag für Stagekalibrierung
    stageCAL->start(50000);
    stagecmdtimeout = 10000;
    serialSendStage(mtcalib);
}
void MainWindow::on_p_transfer_store_clicked()
{
    MTFILE2OPEN = DEFAULTMTFILE;
    //    qDebug()<<MTFILE2OPEN<<tmpMTFILE;
    QFile f(MTFILE2OPEN); // Daten aus Trandferpos.INI einlesen
    QFile f2(tmpMTFILE);
    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
    if (!f2.open(QIODevice::ReadWrite | QIODevice::Text)) return;
    QTextStream datain(&f);
    QTextStream dataout(&f2);

    QString mtline = datain.readLine();
    qDebug() << "mtline" << mtline;
    if (mtline.size() != 0)
    {
        if (mtline.at(0) == '[') // all Strings, die mit [ beginnen
        {
            dataout << mtline.append('\n');
            do
            {
                mtline = datain.readLine();
                if (mtline.length() > 0)
                {
                    if (mtline.mid(0, mtline.indexOf('=')).toLower() == "xpos")
                    {
                        QString tVAL = mtline.mid(0, mtline.indexOf("=") + 1)
                                .append(ui->line_stage_actualposx->text())
                                .trimmed();
                        // qDebug()<<tVAL;
                        dataout << tVAL.append('\n');
                    }
                    else if (mtline.mid(0, mtline.indexOf('=')).toLower() == "ypos")
                    {
                        QString tVAL = mtline.mid(0, mtline.indexOf("=") + 1)
                                .append(ui->line_stage_actualposy->text())
                                .trimmed();
                        //   qDebug()<<"slots "<<tVAL;
                        dataout << tVAL.append('\n');
                    }
                    else dataout << mtline.append('\n');
                }
                else
                {
                    dataout << mtline.append('\n');
                    mtline = '0';
                }
            }
            while (mtline.at(0) != ';');
            dataout << mtline.append('\n');
        }
        if (QFile::exists(renameMTFILE)) QFile::remove(renameMTFILE); // letztes Transferpos.0 wird entfernt
        if (!f.rename(renameMTFILE)) fehler = 2;
        if (!f2.rename(DEFAULTMTFILE)) fehler = 2;
        if (f2.exists()) f2.close();
        if (f.exists()) f.close();
        if (fehler) err_lineinput(fehler);
    }
}
void MainWindow::on_p_WC_CHhgt_2_clicked() {
    tmpstr = 0;
    ui->line_wc_chuckheight_2->setInputMask("#99999");
    QString tmp = ui->line_wc_chuckheight_2->text();
    tmpstr.append(setpos);
    tmpstr.append("61="); // ID WC Height ist 61
    tmpstr.append(QString::number(tmp.toShort(), 10).toUpper().right(8).toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_WC_left_2_clicked() { wc_pos_left(); }
void MainWindow::on_p_WC_middle_2_clicked() { wc_pos_middle(); }
void MainWindow::on_p_WC_abovCHhgt_2_clicked() { wc_pos_abovechuckhgt(); }
void MainWindow::on_p_pos_stage_transfer_clicked() {
    QString xpos = ui->line_Transfer_x->text();
    QString ypos = ui->line_Transfer_y->text();
    QString zpos = ui->line_Transfer_z->text();

    if (STAGEid == nc) {
        STAGEid = cSTATUS;
        QByteArray mtgotrans = 0;
        mtgotrans.append(xpos.toLatin1() + " " + ypos.toLatin1() + " " + "m" + ' ' + "st\r\n");
        serialSendStage(mtgotrans);
    }
    if (MICid == ncmic) {
        MICid = mSETPOSZ;
    }
}
void MainWindow::on_p_stage_getpos_clicked() {
    if (STAGEid == nc) {
        STAGEid = cPOS;
        serialSendStage(mtgetpos);
    }
}
void MainWindow::on_check_stage_joystick_clicked(bool checked) {
    stagetimer = 1;
    if (checked) {
        serialSendStage("1 j\r\n");
        ui->check_stage_joystick->setChecked(1);
    } else {
        serialSendStage("0 j\r\n");
        ui->check_stage_joystick->setChecked(0);
    }
}
void MainWindow::on_p_stage_doxoff_clicked() {
    double xoff = ui->line_stage_xoff->text().toFloat(&ok) / 1000.0;
    double xpos = ui->line_stage_actualposx->text().toFloat(&ok);
    QString ypos = ui->line_stage_actualposy->text();
    QString xnewpos = QString::number(xpos + xoff);

    STAGEid = cSTATUS;
    QByteArray mtgotrans = 0;
    mtgotrans.append(xnewpos.toLatin1() + ' ' + ypos.toLatin1() + ' ' + "m" + ' ' + "st\r\n");
    qDebug() << mtgotrans;
    serialSendStage(mtgotrans);
}
void MainWindow::on_p_stage_doyoff_clicked()
{
    double yoff = ui->line_stage_yoff->text().toFloat(&ok) / 1000.0;
    QString xpos = ui->line_stage_actualposx->text();
    double ypos = ui->line_stage_actualposy->text().toFloat(&ok);
    QString ynewpos = QString::number(ypos + yoff);

    STAGEid = cSTATUS;
    QByteArray mtgotrans = 0;
    mtgotrans.append(xpos.toLatin1() + ' ' + ynewpos.toLatin1() + ' ' + "m" + ' ' + "st\r\n");
    qDebug() << mtgotrans;
    serialSendStage(mtgotrans);
}
void MainWindow::on_p_stage_logerr_clear_clicked()
{
    ui->plainTextEdit_stage_loger->clear();
}
void MainWindow::on_p_transfer_stage_status_clicked()
{
    if (STAGEid == nc)
    {
        STAGEid = cSTATUS;
        serialSendStage(mtstatus);
        if (STAGECAL == 0)
        {
            if (stageSTA->isActive()) stageSTA->stop();
        }
    }
}
void MainWindow::on_p_reset_microscope_clicked()
{
    QByteArray micARR;

    if (MICid == ncmic)
    {
        MICid = mRESET;
        micARR[0] = ENQ;
        serialSendMic(micARR);
    }
}
void MainWindow::on_p_mic_getpos_clicked()
{
    QByteArray micARR;

    if (MICid == ncmic)
    {
        MICid = mGETPOS;
        micARR[0] = ENQ;
        serialSendMic(micARR);
    }
}
void MainWindow::on_p_mic_logerr_clear_clicked()
{
    ui->plainTextEdit_mic_loger->clear();
}
// ---------------- LOG -----------------------------------------
void MainWindow::on_checkBox_errorlog_clicked(bool checked)
{
    if (checked == TRUE)
    {
        serialSendFeeder(errorlogon); // $SET_9
        errlog = 1;
        svclog = 1;
    }
    else
    {
        errlog = 0;
        svclog = 0;
        serialSendFeeder(errorlogoff);
    }
}
void MainWindow::on_checkBox_errorlog_2_clicked(bool checked)
{
    if (checked == TRUE)
    {
        ui->checkBox_errorlog_2->setChecked(1); // checkbox errorlog LOGIN-Fenster
        on_checkBox_errorlog_clicked(1);
        ui->checkBox_errorlog->setChecked(1); // checkbox errorlog LOGIN-Fenster
    }
    else
    {
        ui->checkBox_errorlog_2->setChecked(0);
        on_checkBox_errorlog_clicked(0);
        ui->checkBox_errorlog->setChecked(0); // checkbox errorlog LOGIN-Fenster
    }
}
void MainWindow::on_checkBox_warnlog_clicked(bool checked)
{
    if (ui->p_log_servicemode->isChecked())
    {
        err_msgbox("Buslog is active. Deactivate buslog first.");
        ui->checkBox_warnlog->setChecked(0);
    }
    else
    {
        if (checked == TRUE)
        {
            serialSendFeeder(warnlogon); // $SET_8
            errlog = 1;
        }
        else
        {
            errlog = 0;
            serialSendFeeder(warnlogoff);
        }
    }
}
void MainWindow::on_checkBox_debuglog_clicked(bool checked) // derzeit: liest Tilt posdiff-error bei pos_const
{
    if (checked == TRUE) {
        serialSendFeeder(debuglogon); // $SET_7
        errlog = 1;
    } else {
        errlog = 0;
        serialSendFeeder(debuglogoff);
    }
}
void MainWindow::on_p_log_servicemode_clicked(bool checked) // $SET_6 (BitBus Log)
{
    if (ui->checkBox_warnlog->isChecked())
    {
        err_msgbox("Errorlog is active. Deactivate errorlog first.");
        ui->p_log_servicemode->setChecked(0);
    }
    else
    {
        if (checked)
        {
            svclog = 1;                // Bitbus log aktiv
            if (buslogfile.isOpen())
            {
                buslogout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "<-" << "Buslock opened" << '\n';
            }
            else if (!buslogfile.open(QIODevice::Append | QIODevice::Text)) err_msgbox("Bus-LOG-File not open");
            else buslogout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "<-" << "Buslock opened" << '\n';
            serialSendFeeder(svcmode); // $SET_6=1 Servicemode aktivieren
        }
        else
        {
            svclog = 0;                   // Bitbus log deaktiv
            if (buslogfile.isOpen())
            {
                buslogout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "<-" << "Buslock closed" << '\n';
                buslogfile.close();
            }
            serialSendFeeder(svcmodeOff); // $SET_6=0
        }
    }
}
void MainWindow::on_p_log_servicemode_simple_clicked(bool checked)
{
    if (ui->p_log_servicemode->isChecked())
    {
        err_msgbox("Buslog is active. Deactivate first.");
        ui->p_log_servicemode_simple->setChecked(0);
    }
    else if (checked) serialSendFeeder("$SET_97=1\r\n"); // simple mode aktivieren (keine GET_VALUE cmds)
    else serialSendFeeder("$SET_97=0\r\n");
}
void MainWindow::on_checkBox_simucount_clicked(bool checked) // Debug: Testcounter für @IN und @GETOUT
{
    if (checked == TRUE)
        serialSendFeeder(simucnton); // $SET_15
    else
        serialSendFeeder(simucntoff);
}
void MainWindow::on_checkBox_mainvacoff_stateChanged(int arg1) // Debug: setzt mainvac-flag bei mainvac=0
{
    if (arg1)
        serialSendFeeder(mainvacflagon); // $SET_16
    else
        serialSendFeeder(mainvacflagoff);
}
void MainWindow::on_p_log_fifo_clicked() // $SET_98
{
    static int p = 0;

    if (p == 0) {
        serialSendFeeder(fifologon);
        p = 1;
    } else if (p == 1) {
        serialSendFeeder(fifologoff);
        p = 0;
    }
}
void MainWindow::on_checkBox_simulation_stateChanged(int arg1) // Simulation aktivieren/deaktivieren
{
    if (arg1 == 2)
        serialSendFeeder(simulON); // $SET_5
    if (arg1 == 0)
        serialSendFeeder(simulOFF);
}
void MainWindow::on_radio_LOG_eeflag_clicked() {
    serialSendFeeder("$READ_68=0\r\n");
}
void MainWindow::on_radio_log_errorstop1_clicked() {
    tmpstr = 0;
    tmpstr.append(READ); // $READ_69=0  errstop.level1 lesen
    tmpstr.append("69");
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_radio_LOG_errstop_reset_clicked() {
    tmpstr = 0;
    tmpstr.append(rSET); // $SET_69=1 errstop.level1 resetten
    tmpstr.append("69=1");
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_XRAC_clear_clicked() {
    ui->plainTextEdit_data_XRAC->clear();
}
void MainWindow::on_p_INIT_logclear_debug_clicked() {
    ui->plainTextEdit_LOG_debug->clear();
}
void MainWindow::on_p_INIT_logclear_warn_clicked() {
    ui->plainTextEdit_LOGwarn->clear();
}
void MainWindow::on_p_log_feederlist_clicked() {
    serialSendFeeder("$GET_45=0\r\n"); // "$GET_45=0\r\n"
}
void MainWindow::on_p_LOG_clear_feederlist_clicked() {
    set_feederliste("clear");
}
void MainWindow::logswitch(int state) {
    if (state == 0) {
        qDebug() << "logswitch 0";
        if (ui->checkBox_debuglog->isChecked())
        {
            on_checkBox_debuglog_clicked(0); // Debug log ausschalten
            r_debuglog = 1;
            qDebug() << "r_debuglog";
        }
        else if (ui->checkBox_warnlog->isChecked())
        {
            on_checkBox_warnlog_clicked(0); // Warn log ausschalten
            r_warnlog = 1;
            qDebug() << "r_warnlog";
        }
        else if (ui->checkBox_errorlog->isChecked())
        {
            on_checkBox_errorlog_clicked(0); // Error log ausschalten
            r_errlog = 1;
            qDebug() << "r_errorlog";
        }
        else if (ui->p_log_servicemode->isChecked())
        {
            on_p_log_servicemode_clicked(0); // Bitbus log ausschalten
            r_buslog = 1;
            qDebug() << "r_buslog";
        }
        else if (ui->check_vac_poll->isChecked())
        {
            on_check_vac_clicked(0); // Vakuum polling ausschalten
            qDebug() << "vac poll";
        }
        else serialSendFeeder(senddata);
    }
    else
    {
        qDebug() << "logswitch 1";
        if (r_debuglog)
        {
            on_checkBox_debuglog_clicked(1); // Debug log ausschalten
            r_debuglog = 0;
        }
        else if (r_warnlog)
        {
            on_checkBox_warnlog_clicked(1); // Warn log ausschalten
            r_warnlog = 0;
        }
        else if (r_errlog)
        {
            on_checkBox_errorlog_clicked(1); // Error log ausschalten
            r_errlog = 0;
        }
        else if (r_buslog)
        {
            on_p_log_servicemode_clicked(1); // Bitbus log ausschalten
            r_buslog = 0;
        }
    }
}
//----------------- dev  ---------------------------------------------
void MainWindow::on_checkBox_dev_WOBjoystick_clicked(bool checked) {
    // stagetimer = 1;
    // serialSendStage("0 j\r\n");
    // ui->check_stage_joystick->setChecked(0);

    if (checked) {
        // if(stagecmd != 0)
        serialSendFeeder("$GET_25=1\r\n");
        // else err_msgbox("Stage COM port noct availible. Switch off MCS
        // Software.");
    } else {
        serialSendFeeder("$GET_25=0\r\n");
    }
}
void MainWindow::on_p_joy_store_clicked()
{
    STORE_FILE_partWOBJOY();
}
void MainWindow::on_p_joy_getvalues_clicked() {
    serialSendFeeder("$READ_26=0\r\n");
}
void MainWindow::on_p_align_constpos_rot_cw_2_pressed()
{
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,1,0,0,58,152\r\n"); // PA rotpos cw 15000
    ui->p_align_constpos_rot_cw_2->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_align_constpos_rot_cw_2_released()
{
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,1,0,0,0,0\r\n"); // PA phi stop
    ui->p_align_constpos_rot_cw_2->setStyleSheet(backDefault);
}
void MainWindow::on_p_align_constpos_rot_ccw_2_pressed()
{
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,1,255,255,197,104\r\n"); // PA rotpos ccw -15000
    ui->p_align_constpos_rot_ccw_2->setStyleSheet(backLightGreen);
}
void MainWindow::on_p_align_constpos_rot_ccw_2_released()
{
    serialSendFeeder("$X_2,0,0,4,1,0,0,0,2,1,0,0,0,0\r\n"); // PA phi stop
    ui->p_align_constpos_rot_ccw_2->setStyleSheet(backDefault);
}
void MainWindow::on_p_PA_getRot_2_clicked()
{
    on_p_PA_getRot_clicked();
}
// ---------------- Hilfsfunktionen -------------------------------
void MainWindow::serializePosData(QByteArray *arr, QLineEdit *line)
{
    arr->clear();
    arr->append(QString::number((line->text().toInt(&ok, 10) & 0xFF000000) >> 24).toLatin1());
    arr->append(",");
    arr->append(QString::number((line->text().toInt(&ok, 10) & 0xFF0000) >> 16).toLatin1());
    arr->append(",");
    arr->append(QString::number((line->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
    arr->append(",");
    arr->append(QString::number((line->text().toInt(&ok, 10) & 0xFF)).toLatin1());
}
void MainWindow::serialPosData(QByteArray *arr, int val) {
    arr->clear();
    arr->append(QString::number((val & 0xFF000000) >> 24).toLatin1());
    arr->append(",");
    arr->append(QString::number((val & 0xFF0000) >> 16).toLatin1());
    arr->append(",");
    arr->append(QString::number((val & 0xFF00) >> 8).toLatin1());
    arr->append(",");
    arr->append(QString::number(val & 0xFF).toLatin1());
}
void MainWindow::serializeWord(QByteArray *arr, QLineEdit *line) {
    arr->clear();
  //  arr->append(",");
    arr->append(QString::number((line->text().toInt(&ok, 10) & 0xFF00) >> 8).toLatin1());
    arr->append(",");
    arr->append(QString::number((line->text().toInt(&ok, 10) & 0xFF)).toLatin1());
    //   qDebug()<<arr;
}
int *MainWindow::dez2byte(int tmpval, int arr[])
{
    int mod1 = tmpval % 16;
    int tupel1 = tmpval / 16;

    int mod2 = tupel1 % 16;
    int tupel2 = tupel1 / 16;

    int mod3 = tupel2 % 16;
    int tupel3 = tupel2 / 16;

    int mod4 = tupel3 % 16;
    int tupel4 = tupel3 / 16;

    int mod5 = tupel4 % 16;
    int tupel5 = tupel4 / 16;

    int mod6 = tupel5 % 16;
    int tupel6 = tupel5 / 16;

    int mod7 = tupel6 % 16;
    int tupel7 = tupel6 / 16;

    int mod8 = tupel7 % 16;

    if (tmpval >= 0) {
        arr[3] = mod8 * 16 + mod7;
        arr[2] = mod6 * 16 + mod5;
        arr[1] = mod4 * 16 + mod3;
        arr[0] = mod2 * 16 + mod1;
    } else {
        arr[3] = 255 + (mod8 * 16 + mod7);
        arr[2] = 255 + (mod6 * 16 + mod5);
        arr[1] = 255 + (mod4 * 16 + mod3);
        arr[0] = 256 + (mod2 * 16 + mod1);
    }

    qDebug() << "tmpval" << tmpval << "byte4" << arr[3] << "byte3" << arr[2]
                << "byte2" << arr[1] << "byte1" << arr[0];

    return arr;
}
QString MainWindow::f_asc2num(QString asc) {
    QString num = asc;
    if (asc == ":")
        num = "10";
    else if (asc == ";")
        num = "11";
    else if (asc == "<")
        num = "12";
    else if (asc == "=")
        num = "13";
    else if (asc == ">")
        num = "14";
    else if (asc == "?")
        num = "15";
    else if (asc == "@")
        num = "16";
    else if (asc == "A")
        num = "17";
    else if (asc == "B")
        num = "18";
    else if (asc == "C")
        num = "19";
    else if (asc == "D")
        num = "20";
    else if (asc == "E")
        num = "21";
    else if (asc == "F")
        num = "22";
    else if (asc == "G")
        num = "23";
    else if (asc == "H")
        num = "24";
    else if (asc == "I")
        num = "25";
    return num;
}
void MainWindow::err_msgbox(QString box) {
    QMessageBox msgBox;
    msgBox.setWindowTitle("INSBox messagebox");
    msgBox.setText(box);
    msgBox.exec();
}
int MainWindow::msgboxOK(QString box) // Default Messagebox mit OK und CANCEL
{
    int state = 1;
    QMessageBox msgBox;

    msgBox.setInformativeText(box);
    msgBox.setStandardButtons(QMessageBox::Ok | QMessageBox::Cancel);
    msgBox.setDefaultButton(QMessageBox::Ok);
    int ret = msgBox.exec();

    switch (ret) {
    case QMessageBox::Ok:
        state = 0;
        break;
    case QMessageBox::Cancel:
        state = 1;
        break;
    default:
        state = 1;
        break;
    }
    return state;
}
void MainWindow::err_msgboxplus(QString box) {
    QMessageBox msgBox;
    msgBox.setWindowTitle("INSBox messagebox");
    msgBox.setText(box);

    msgBox.setInformativeText("next step?");
    msgBox.setStandardButtons(QMessageBox::Save | QMessageBox::Discard |
                              QMessageBox::Cancel);
    QPushButton *connectButton =
            msgBox.addButton(tr("Connect"), QMessageBox::ActionRole);
    QPushButton *abortButton = msgBox.addButton(QMessageBox::Abort);
    msgBox.setDefaultButton(QMessageBox::Save);
    int ret = msgBox.exec();

    switch (ret) {
    case QMessageBox::Save:
        // Save was clicked
        break;
    case QMessageBox::Discard:
        // Don't Save was clicked
        break;
    case QMessageBox::Cancel:
        // Cancel was clicked
        break;
    default:
        // should never be reached
        break;
    }
    if (msgBox.clickedButton() == connectButton) {
        // connect
    } else if (msgBox.clickedButton() == abortButton) {
        // abort
    }
}
void MainWindow::err_msgboxplusOK(QString box) {
    QMessageBox msgBox;
    //   msgBox.setText(box);

    msgBox.setInformativeText(box);
    msgBox.setStandardButtons(QMessageBox::Ok | QMessageBox::Cancel);
    msgBox.setDefaultButton(QMessageBox::Ok);
    int ret = msgBox.exec();

    switch (ret) {
    case QMessageBox::Ok:
        if (macromacro == 1) {
            mstep2 = 0;
            macromacro = 0;
            on_p_macros_runmacro_clicked();
        }

        break;
    case QMessageBox::Cancel:
        // Cancel was clicked
        break;
    default:
        // should never be reached
        break;
    }
}
int MainWindow::err_msgboxTransferOK(QString box) {
    int state = 1;
    QMessageBox msgBox;

    msgBox.setInformativeText(box);
    msgBox.setStandardButtons(QMessageBox::Ok | QMessageBox::Cancel);
    msgBox.setDefaultButton(QMessageBox::Ok);
    int ret = msgBox.exec();

    switch (ret) {
    case QMessageBox::Ok:
        state = 0;
        break;
    case QMessageBox::Cancel:
        state = 1;
        break;
    default:
        state = 1;
        break;
    }
    return state;
}
void MainWindow::err_msgboxSensorHeightLift1(QString box) {
    QMessageBox msgBox;

    msgBox.setInformativeText(box);
    msgBox.setStandardButtons(QMessageBox::Ok | QMessageBox::Cancel);
    msgBox.setDefaultButton(QMessageBox::Ok);
    int ret = msgBox.exec();

    switch (ret) {
    case QMessageBox::Ok:
        calSensHeight = 1;
        break;
    case QMessageBox::Cancel:
        calSensHeight = 0;
        break;
    default:
        calSensHeight = 0;
        break;
    }
}
void MainWindow::err_msgboxSensorHeightLift2(QString box) {
    QMessageBox msgBox;

    msgBox.setInformativeText(box);
    msgBox.setStandardButtons(QMessageBox::Ok | QMessageBox::Cancel);
    msgBox.setDefaultButton(QMessageBox::Ok);
    int ret = msgBox.exec();

    switch (ret) {
    case QMessageBox::Ok:
        calSensHeight2 = 1;
        break;
    case QMessageBox::Cancel:
        calSensHeight2 = 0;
        break;
    default:
        calSensHeight2 = 0;
        break;
    }
}
void MainWindow::err_msgboxSysSenscalOK(QString box)
{
    QMessageBox msgBox;

    msgBox.setInformativeText(box);
    msgBox.setStandardButtons(QMessageBox::Cancel);
    QPushButton *lift1Button = msgBox.addButton(tr("lift1"), QMessageBox::ActionRole);
    QPushButton *lift2Button = msgBox.addButton(tr("lift2"), QMessageBox::ActionRole);
    msgBox.setDefaultButton(QMessageBox::Ok);
    int ret = msgBox.exec();

    switch (ret)
    {
    case QMessageBox::Cancel:
        calsens = 0;
        calsens2 = 0;
        break;
    default:
        calsens = 0;
        calsens2 = 0;
        break;
    }

    if (msgBox.clickedButton() == lift1Button)
    {
        calsens = 1;
    }
    else if (msgBox.clickedButton() == lift2Button)
    {
        calsens2 = 1;
    }
}
void MainWindow::err_lineinput(int err)
{
    switch (err)
    {
    case 0:
    break;
    case 1:
        errmess = errmess1;
    break;
    case 2:
        errmess = errmess2;
    break;
    case 3:
        errmess = errmess3;
    break;
    case 4:
        errmess = errmess4;
    break;
    case 5:
        errmess = errmess5;
    break;
    case 6:
        errmess = "check 0 or 1";
        break;
    }
    err_msgbox(errmess);
    fehler = 0;
}
void MainWindow::setRadioCass(int size)
{
    switch (size)
    {
    case 0:
        ui->radioCass_8inch->setChecked(0);
        ui->radioCass_6inch->setChecked(0);
        ui->radioCass_5inch->setChecked(0);
        ui->radioCass_4inch->setChecked(0);
        break;
    case 1:
        ui->radioCass_8inch->setChecked(0);
        ui->radioCass_6inch->setChecked(0);
        ui->radioCass_5inch->setChecked(0);
        ui->radioCass_4inch->setChecked(1);
        break;
    case 2:
        ui->radioCass_8inch->setChecked(0);
        ui->radioCass_6inch->setChecked(0);
        ui->radioCass_5inch->setChecked(1);
        ui->radioCass_4inch->setChecked(0);
        break;
    case 4:
        ui->radioCass_8inch->setChecked(0);
        ui->radioCass_6inch->setChecked(1);
        ui->radioCass_5inch->setChecked(0);
        ui->radioCass_4inch->setChecked(0);
        break;
    case 8:
        ui->radioCass_8inch->setChecked(1);
        ui->radioCass_6inch->setChecked(0);
        ui->radioCass_5inch->setChecked(0);
        ui->radioCass_4inch->setChecked(0);
        break;
    }
}
void MainWindow::sendREAD(QString nr)
{
    tmpstr = 0;
    tmpstr.append(rRead); // "$READ_"
    tmpstr.append(nr.toLatin1());    //
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
bool MainWindow::eventFilter(QObject *object, QEvent *event) {

    if (event->type() == QEvent::FocusIn)
    {
        if (object == ui->line_lift1_xyloader_height) f_lineFocusOut(ui->line_lift1_xyloader_height);
        if (object == ui->line_lift1_wafersensor_height) f_lineFocusOut(ui->line_lift1_wafersensor_height);
        if (object == ui->line_lift1_unload_height) f_lineFocusOut(ui->line_lift1_unload_height);
        if (object == ui->line_lift1_tiltactpos) f_lineFocusOut(ui->line_lift1_tiltactpos);
        if (object == ui->line_lift1_tiltinactpos) f_lineFocusOut(ui->line_lift1_tiltinactpos);

        if (object == ui->line_lift2_xyloader_height) f_lineFocusOut(ui->line_lift2_xyloader_height);
        if (object == ui->line_lift2_wafersensor_height) f_lineFocusOut(ui->line_lift2_wafersensor_height);
        if (object == ui->line_lift2_unload_height) f_lineFocusOut(ui->line_lift2_unload_height);
        if (object == ui->line_lift2_tiltactpos) f_lineFocusOut(ui->line_lift2_tiltactpos);
        if (object == ui->line_lift2_tiltinactpos) f_lineFocusOut(ui->line_lift2_tiltinactpos);

        if (object == ui->line_loader_xlift1pos) f_lineFocusOut(ui->line_loader_xlift1pos);
        if (object == ui->line_loader_xlift2pos) f_lineFocusOut(ui->line_loader_xlift2pos);
        if (object == ui->line_loader_xpreapos) f_lineFocusOut(ui->line_loader_xpreapos);
        if (object == ui->line_loader_xpreafreepos) f_lineFocusOut(ui->line_loader_xpreafreepos);
        if (object == ui->line_loader_ylift1inpos) f_lineFocusOut(ui->line_loader_ylift1inpos);
        if (object == ui->line_loader_ylift2inpos) f_lineFocusOut(ui->line_loader_ylift2inpos);
        //        if(object == ui->line_loader_yliftdispl)
        //        f_lineFocusOut(ui->line_loader_yliftdispl);
        if (object == ui->line_loader_youtlift) f_lineFocusOut(ui->line_loader_youtlift);
        if (object == ui->line_loader_ypreapos) f_lineFocusOut(ui->line_loader_ypreapos);

        if (object == ui->line_aboveloader) f_lineFocusOut(ui->line_aboveloader);
        if (object == ui->line_loaderheight) f_lineFocusOut(ui->line_loaderheight);
        if (object == ui->line_belowloader) f_lineFocusOut(ui->line_belowloader);
        if (object == ui->line_chuckheight) f_lineFocusOut(ui->line_chuckheight);
        if (object == ui->line_preaheight) f_lineFocusOut(ui->line_preaheight);
        if (object == ui->line_preasensangle) f_lineFocusOut(ui->line_preasensangle);
        if (object == ui->line_wobphispeed) f_lineFocusOut(ui->line_wobphispeed);
        if (object == ui->line_wobbtiltangle) f_lineFocusOut(ui->line_wobbtiltangle);
        if (object == ui->line_wobrotpos) f_lineFocusOut(ui->line_wobrotpos);

        if (object == ui->line_wc_abovechuckheight) f_lineFocusOut(ui->line_wc_abovechuckheight);
        if (object == ui->line_wc_chuckheight) f_lineFocusOut(ui->line_wc_chuckheight);
        if (object == ui->line_wc_belowchuckheight) f_lineFocusOut(ui->line_wc_belowchuckheight);
        //        if(object == ui->line_wc_chuckfreeheight)
        //        f_lineFocusOut(ui->line_wc_chuckfreeheight);
        if (object == ui->line_wc_leftpos) f_lineFocusOut(ui->line_wc_leftpos);
        if (object == ui->line_wc_middlepos) f_lineFocusOut(ui->line_wc_middlepos);
        if (object == ui->line_wc_rightpos) f_lineFocusOut(ui->line_wc_rightpos);
        //        if(object == ui->line_wc_loheight)
        //        f_lineFocusOut(ui->line_wc_loheight);
    }
    return false;
}
void MainWindow::f_lineFocusOut(QLineEdit *line)
{
    if (line == ui->line_loader_xlift1pos) ui->line_loader_xlift1pos->setStyleSheet(backYello);
    else ui->line_loader_xlift1pos->setStyleSheet(backWhite);
    if (line == ui->line_loader_xlift2pos) ui->line_loader_xlift2pos->setStyleSheet(backYello);
    else ui->line_loader_xlift2pos->setStyleSheet(backWhite);
    if (line == ui->line_loader_xpreapos) ui->line_loader_xpreapos->setStyleSheet(backYello);
    else ui->line_loader_xpreapos->setStyleSheet(backWhite);
    if (line == ui->line_loader_xpreafreepos) ui->line_loader_xpreafreepos->setStyleSheet(backYello);
    else ui->line_loader_xpreafreepos->setStyleSheet(backWhite);
    if (line == ui->line_loader_ylift1inpos) ui->line_loader_ylift1inpos->setStyleSheet(backYello);
    else ui->line_loader_ylift1inpos->setStyleSheet(backWhite);
    if (line == ui->line_loader_ylift2inpos) ui->line_loader_ylift2inpos->setStyleSheet(backYello);
    else ui->line_loader_ylift2inpos->setStyleSheet(backWhite);
    if (line == ui->line_loader_youtlift) ui->line_loader_youtlift->setStyleSheet(backYello);
    else ui->line_loader_youtlift->setStyleSheet(backWhite);
    if (line == ui->line_loader_ypreapos) ui->line_loader_ypreapos->setStyleSheet(backYello);
    else ui->line_loader_ypreapos->setStyleSheet(backWhite);

    if (line == ui->line_lift1_xyloader_height) ui->line_lift1_xyloader_height->setStyleSheet(backYello);
    else ui->line_lift1_xyloader_height->setStyleSheet(backWhite);
    if (line == ui->line_lift1_wafersensor_height) ui->line_lift1_wafersensor_height->setStyleSheet(backYello);
    else ui->line_lift1_wafersensor_height->setStyleSheet(backWhite);
    if (line == ui->line_lift1_unload_height) ui->line_lift1_unload_height->setStyleSheet(backYello);
    else ui->line_lift1_unload_height->setStyleSheet(backWhite);
    if (line == ui->line_lift1_tiltactpos) ui->line_lift1_tiltactpos->setStyleSheet(backYello);
    else ui->line_lift1_tiltactpos->setStyleSheet(backWhite);
    if (line == ui->line_lift1_tiltinactpos) ui->line_lift1_tiltinactpos->setStyleSheet(backYello);
    else ui->line_lift1_tiltinactpos->setStyleSheet(backWhite);

    if (line == ui->line_lift2_xyloader_height) ui->line_lift2_xyloader_height->setStyleSheet(backYello);
    else ui->line_lift2_xyloader_height->setStyleSheet(backWhite);
    if (line == ui->line_lift2_wafersensor_height) ui->line_lift2_wafersensor_height->setStyleSheet(backYello);
    else ui->line_lift2_wafersensor_height->setStyleSheet(backWhite);
    if (line == ui->line_lift2_unload_height) ui->line_lift2_unload_height->setStyleSheet(backYello);
    else ui->line_lift2_unload_height->setStyleSheet(backWhite);
    if (line == ui->line_lift2_tiltactpos) ui->line_lift2_tiltactpos->setStyleSheet(backYello);
    else ui->line_lift2_tiltactpos->setStyleSheet(backWhite);
    if (line == ui->line_lift2_tiltinactpos) ui->line_lift2_tiltinactpos->setStyleSheet(backYello);
    else ui->line_lift2_tiltinactpos->setStyleSheet(backWhite);

    if (line == ui->line_aboveloader) ui->line_aboveloader->setStyleSheet(backYello);
    else ui->line_aboveloader->setStyleSheet(backWhite);
    if (line == ui->line_loaderheight) ui->line_loaderheight->setStyleSheet(backYello);
    else ui->line_loaderheight->setStyleSheet(backWhite);
    if (line == ui->line_belowloader) ui->line_belowloader->setStyleSheet(backYello);
    else ui->line_belowloader->setStyleSheet(backWhite);
    if (line == ui->line_chuckheight) ui->line_chuckheight->setStyleSheet(backYello);
    else ui->line_chuckheight->setStyleSheet(backWhite);
    if (line == ui->line_preaheight) ui->line_preaheight->setStyleSheet(backYello);
    else ui->line_preaheight->setStyleSheet(backWhite);
    if (line == ui->line_preasensangle) ui->line_preasensangle->setStyleSheet(backYello);
    else ui->line_preasensangle->setStyleSheet(backWhite);
    if (line == ui->line_wobphispeed) ui->line_wobphispeed->setStyleSheet(backYello);
    else ui->line_wobphispeed->setStyleSheet(backWhite);
    if (line == ui->line_wobbtiltangle) ui->line_wobbtiltangle->setStyleSheet(backYello);
    else ui->line_wobbtiltangle->setStyleSheet(backWhite);
    if (line == ui->line_wobrotpos) ui->line_wobrotpos->setStyleSheet(backYello);
    else ui->line_wobrotpos->setStyleSheet(backWhite);

    if (line == ui->line_wc_abovechuckheight) ui->line_wc_abovechuckheight->setStyleSheet(backYello);
    else ui->line_wc_abovechuckheight->setStyleSheet(backWhite);
    if (line == ui->line_wc_chuckheight) ui->line_wc_chuckheight->setStyleSheet(backYello);
    else ui->line_wc_chuckheight->setStyleSheet(backWhite);
    if (line == ui->line_wc_belowchuckheight) ui->line_wc_belowchuckheight->setStyleSheet(backYello);
    else ui->line_wc_belowchuckheight->setStyleSheet(backWhite);
    if (line == ui->line_wc_leftpos) ui->line_wc_leftpos->setStyleSheet(backYello);
    else ui->line_wc_leftpos->setStyleSheet(backWhite);
    if (line == ui->line_wc_middlepos) ui->line_wc_middlepos->setStyleSheet(backYello);
    else ui->line_wc_middlepos->setStyleSheet(backWhite);
    if (line == ui->line_wc_rightpos) ui->line_wc_rightpos->setStyleSheet(backYello);
    else ui->line_wc_rightpos->setStyleSheet(backWhite);
}
void MainWindow::resCLEANflags()
{
    cleansequenz = 0;
    macroclean = 0;
    mstep = 0;
    ui->frame_clean_wc->setDisabled(1);
    setSendTimer->stop();
}
void MainWindow::on_p_INIT_resetcmdfeeder_clicked()
{
    qDebug() << "resetcmdfeeder";
    cmdfeeder = 0; // Flag offenes Service CMD löschen
    waitlog = 0;
    r_logon = 0;
    setpara = 0;
    getpara = 0;
    res2pos = 0;
    cleanman = 0;
    cmdapiflag = 0;
    macroclean = 0;
    macromacro = 0;
    makrostringstep = 0;
    makrostring = 0;
    PAHmakrostring = 0;
    PAPmakrostring = 0;
    PARmakrostring = 0;
    PATmakrostring = 0;
    PAHmakrostring = 0;
    WCHmakrostring = 0;
    WCPmakrostring = 0;
    LDXmakrostring = 0;
    LDYmakrostring = 0;
    L1Hmakrostring = 0;
    L1Tmakrostring = 0;
    L2Hmakrostring = 0;
    L2Tmakrostring = 0;
    cmdAPI = 0; // Flag offenes API CMD löschen
    calSensHeight = 0;
    calSensHeight2 = 0;
    APIid = none;
    f_lift1xyhgt = 0; // Flags für LDY out zurücksetzen
    f_lift2xyhgt = 0;
    f_lift1operhgt = 0;
    f_lift2operhgt = 0;
    f_lift1senshgt = 0;
    f_lift2senshgt = 0;
    if (cmdtimeout->isActive())
    {
        cmdtimeout->stop();
        err_msgbox("Service command timeout: no response");
    }
    if (apitimeout->isActive())
    {
        apitimeout->stop();
        err_msgbox("API command timeout: no response");
    }
    if (macrotest->isActive())
    {
        macrotest->stop();
    }
    logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "-> timeout\n";
}
void MainWindow::resetapicmd_clicked() // wird von apitimeout aufgerufen
{
    cmdapiflag = 0;
    cmdAPI = 0;
    APIid = none;
    assistant_wc = 0;             // Flag für Asisstent WC deaktivieren
    assistant_loop(assistant_wc); // Assistenten WC resetten

    if (apitimeout->isActive())
    {
        apitimeout->stop();
        if (apireset)
        {
            serial_api->close();
            qDebug() << "Status serial_api error timeout" << (serial_api->error());
            ui->combo_portlist_api->setStyleSheet(backLightGrey);
            ui->p_INIT_boxreset_setup->setStyleSheet(backLightGreen);
            serialapi = 0;
            apireset = 0;
            ui->API->setDisabled(true);
            ui->b_connect_api->setText("connect");
            err_msgbox("API Reset ok");
        }
        else err_msgbox("API CMD timeout: no response");
    }
    APIcmdtimeout = 2000;
}
void MainWindow::resetstagecmd() {
    stagecmd = 0;
    STAGEid = nc;
    if (stagetimeout->isActive()) {
        stagetimeout->stop();
        err_msgbox("timeout: no response");
    }
}
QString MainWindow::binList(int tmpdata) {
    QString data;

    switch (tmpdata) {
    case 0:
        data = "0000 0000";
        break;
    case 1:
        data = "0000 0001";
        break;
    case 2:
        data = "0000 0010";
        break;
    case 3:
        data = "0000 0011";
        break;
    case 4:
        data = "0000 0100";
        break;
    case 5:
        data = "0000 0101";
        break;
    case 6:
        data = "0000 0110";
        break;
    case 7:
        data = "0000 0111";
        break;
    case 8:
        data = "0000 1000";
        break;
    case 9:
        data = "0000 1001";
        break;
    case 10:
        data = "0000 1010";
        break;
    case 11:
        data = "0000 1011";
        break;
    case 12:
        data = "0000 1100";
        break;
    case 13:
        data = "0000 1101";
        break;
    case 14:
        data = "0000 1110";
        break;
    case 15:
        data = "0000 1111";
        break;
    case 16:
        data = "0001 0000";
        break;
    case 17:
        data = "0001 0001";
        break;
    case 18:
        data = "0001 0010";
        break;
    case 19:
        data = "0001 0011";
        break;
    case 20:
        data = "0001 0100";
        break;
    case 21:
        data = "0001 0101";
        break;
    case 22:
        data = "0001 0110";
        break;
    case 23:
        data = "0001 0111";
        break;
    case 24:
        data = "0001 1000";
        break;
    case 25:
        data = "0001 1001";
        break;
    case 26:
        data = "0001 1010";
        break;
    case 27:
        data = "0001 1011";
        break;
    case 28:
        data = "0001 1100";
        break;
    case 29:
        data = "0001 1101";
        break;
    case 30:
        data = "0001 1110";
        break;
    case 31:
        data = "0001 1111";
        break;
    }
    return data;
}
void MainWindow::on_p_LOGIN_clicked()
{
    if (serialapi)
    {
        serial_api->close();
        ui->combo_portlist_api->setStyleSheet(backLightGrey);
        serialapi = 0;
    }

    QByteArray arus;
    QByteArray arpw;
    QString pw;
    int userflag = 0;
    userindex = 0;

    //    resetpw = 1;

    removetab();

    if (ui->check_resetPW->isChecked())
    {
        if (loguser.contains("UserAdmin/login") == FALSE) // miraFW:2418
        {
            loguser.setValue("UserAdmin/login", ui->line_USER->text().toUtf8().toBase64());
            loguser.setValue("UserAdmin/password", ui->line_PW->text().toUtf8().toBase64());
            qDebug() << "Admin" << loguser.allKeys();
        }
        else if (loguser.contains("UserService/login") == FALSE) // service:service
        {
            loguser.setValue("UserService/login", ui->line_USER->text().toUtf8().toBase64());
            loguser.setValue("UserService/password", ui->line_PW->text().toUtf8().toBase64());
            qDebug() << "service" << loguser.value("UserService/login");
        }
        else if (loguser.contains("UserDevel/login") == FALSE) // dev:racer
        {
            loguser.setValue("UserDevel/login", ui->line_USER->text().toUtf8().toBase64());
            loguser.setValue("UserDevel/password", ui->line_PW->text().toUtf8().toBase64());
            qDebug() << "devel" << loguser.value("UserDevel/login");

        }
        else if (loguser.contains("UserSetup/login") == FALSE) // setup:system
        {
            loguser.setValue("UserSetup/login", ui->line_USER->text().toUtf8().toBase64());
            loguser.setValue("UserSetup/password", ui->line_PW->text().toUtf8().toBase64());
            qDebug() << "setup" << loguser.value("UserSetup/login");

        }
        else if (loguser.contains("UserBootloader/login") == FALSE) // prog:hex
        {
            loguser.setValue("UserBootloader/login", ui->line_USER->text().toUtf8().toBase64());
            loguser.setValue("UserBootloader/password", ui->line_PW->text().toUtf8().toBase64());
            qDebug() << "Bootloader" << loguser.value("UserBootloader/login");

        }
        else
        {
            loguser.setValue("UserDefault/login", ui->line_USER->text().toUtf8().toBase64());
            loguser.setValue("UserDefault/password", ui->line_PW->text().toUtf8().toBase64());
            qDebug() << "default" << loguser.value("UserDefault/login");
        }
    }

    //    qDebug()<<"line user"<<ui->line_USER->text();
    //    arus.clear();
    //    qDebug()<<"UserAdmin"<<QByteArray::fromBase64(arus.append(loguser.value("UserAdmin/login").toString()));
    //    arus.clear();
    //    qDebug()<<"UserService"<<QByteArray::fromBase64(arus.append(loguser.value("UserService/login").toString()));
    //    arus.clear();
    //    qDebug()<<"UserDevel"<<QByteArray::fromBase64(arus.append(loguser.value("UserDevel/login").toString()));
    //    arus.clear();
    //    qDebug()<<"UserSetup"<<QByteArray::fromBase64(arus.append(loguser.value("UserSetup/login").toString()));
    //    arus.clear();
    //    qDebug()<<"UserBootloader"<<QByteArray::fromBase64(arus.append(loguser.value("UserBootloader/login").toString()));

    arus.clear();
    if (userflag == 0) // service
    {
        arus.clear();
        user = QByteArray::fromBase64(arus.append(loguser.value("UserService/login").toString().toLatin1()));
        if (user == ui->line_USER->text())
        {
            arpw.clear();
            pw = QByteArray::fromBase64(arpw.append(loguser.value("UserService/password").toString().toLatin1()));
            if (pw == ui->line_PW->text())
            {
                userindex = 2;
                ui->p_LOGIN->setStyleSheet(backLightYello);
                ui->label_user->setText("User service");

                on_b_connect_feeder_clicked();
                if (serial_feeder->isOpen()) // Feeder Com-Port ist geschlossen
                {
                    setusertab(userindex);
                    userflag = 1;
                }
                else userflag = 2;
            }
            else ui->p_LOGIN->setStyleSheet(backRed);
        }
    }
    if (userflag == 0) // dev
    {
        arus.clear();
        user = QByteArray::fromBase64(arus.append(loguser.value("UserDevel/login").toString().toLatin1()));
        if (user == ui->line_USER->text())
        {
            arpw.clear();
            pw = QByteArray::fromBase64(arpw.append(loguser.value("UserDevel/password").toString().toLatin1()));

            if (pw == ui->line_PW->text())
            {
                userindex = 1;
                ui->p_LOGIN->setStyleSheet(backLightBlue);
                ui->label_user->setText("User dev");

                on_b_connect_feeder_clicked();
                if (serial_feeder->isOpen()) // Feeder Com-Port ist geschlossen
                {
                    setusertab(userindex);
                    userflag = 1;
                }
                else userflag = 2;
            }
            else ui->p_LOGIN->setStyleSheet(backRed);
        }
    }
    if (userflag == 0) // Setup
    {
        arus.clear();
        user = QByteArray::fromBase64(arus.append(loguser.value("UserSetup/login").toString().toLatin1()));
        if (user == ui->line_USER->text()) {
            arpw.clear();
            pw = QByteArray::fromBase64(arpw.append(loguser.value("UserSetup/password").toString().toLatin1()));
            ;
            if (pw == ui->line_PW->text()) {
                userindex = 3;
                ui->p_LOGIN->setStyleSheet(backLightGreen);
                ui->label_user->setText("User setup");

                on_b_connect_feeder_clicked();
                if (serial_feeder->isOpen()) // Feeder Com-Port ist geschlossen
                {
                    setusertab(userindex);
                    userflag = 1;
                } else
                    userflag = 2;
            } else
                ui->p_LOGIN->setStyleSheet(backRed);
        }
    }
    if (userflag == 0) // prog
    {
        arus.clear();
        user = QByteArray::fromBase64(arus.append(loguser.value("UserBootloader/login").toString().toLatin1()));
        if (user.length() > 0)
        {
            if (user == ui->line_USER->text())
            {
                arpw.clear();
                pw = QByteArray::fromBase64(arpw.append(loguser.value("UserBootloader/password").toString().toLatin1()));
                if (pw == ui->line_PW->text())
                {
                    userindex = 4;
                    ui->p_LOGIN->setStyleSheet(backLightGreen);
                    ui->label_user->setText("User prog");

                    setusertab(userindex);
                    userflag = 1;
                }
                else ui->p_LOGIN->setStyleSheet(backRed);
            }
        }
        else err_msgbox("unkown user or pw");
    }
    if (userflag == 0) // oper without password
    {
        userindex = 5;
        ui->line_USER->setText("oper");
        ui->line_PW->setText("oper");
        on_b_connect_feeder_clicked();
        if (serial_feeder->isOpen()) // Feeder Com-Port ist geschlossen
        {
            getAVoper = 1; // Flag zum einmaligen Auslesen der analogen Vakuumwerte
            resetFlags();
            setFlags(3);
            userflag = 1;
        }
        else userflag = 2;
    }

    if (userflag == 1)
    {
    //    centerAndResize();
        MainWindow::setMaximumSize(1900, 1150);
        MainWindow::resize(1900, 1150);
        logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "->" << "User login: " << userindex << "\n";
        if (userindex < 5) ui->tabWidget_2->setTabText(0, "COM");
    }
    else if (userflag == 2)
    {
        MainWindow::resize(200, 200);
        MainWindow::setMaximumSize(200, 200);
        logout << QTime::currentTime().toString("hh:mm:ss.zzz' '") << "->" << "User logout: " << userindex << "\n";
    //    centerAndResize();
        removetab();
    }
    else
    {
        MainWindow::resize(200, 200);
        MainWindow::setMaximumSize(200, 200);

        ui->p_LOGIN->setStyleSheet(backGrey);
        ui->label_user->setText("User login");
        err_msgbox("unkown user or pw");
    }
}
void MainWindow::setusertab(int idx)
{
    if (serial_feeder->isOpen() == 0) // Feeder Com-Port ist geschlossen
    {
        removetab();
        //       ui->frame_COMPORTS->show();
        switch (idx)
        {
        case 0: // kein User angemeldet
            removetab();
            break;
        case 1: // User dev
            ui->p_LOGIN->setText("login");
            ui->label_initok->setStyleSheet(backLightGrey);
            ui->check_resetPW->show();
            ui->frame_setup_files->show();
            ui->frame_COMPORTS->show();
            ui->frame_inifiles->hide();
            ui->frame_port_service->show();
            ui->frame_port_API->show();
            ui->API->setDisabled(true);
            ui->frame_port_MEAS->show();
            ui->frame_port_micro->show();
            ui->frame_port_stage->show();
            ui->frame_log_servicedata->show();
            ui->frame_setup_first->show();
            ui->frame_setup_service->show();
            ui->frame_clean_resetall_2->show();
            ui->frame_oper_wcflag->show();
            ui->p_help->show();
            ui->frame_setup_sync->hide();
            ui->frame_setup_pin->hide();
            ui->frame_mic_limitswitch->hide();
            ui->p_loadinssetupini->setEnabled(false);
            ui->p_loadinsmotorini->setEnabled(false);
            ui->lineEdit_activeIniFile->clear();
            ui->lineEdit_activemotorFile->clear();
            break;
        case 2: // User service
            ui->p_LOGIN->setText("login");
            ui->frame_COMPORTS->show();
            ui->frame_port_service->show();
            ui->frame_port_API->show();
            ui->API->setDisabled(true);
            ui->frame_port_stage->show();
            ui->frame_inifiles->hide();
            ui->frame_log_servicedata->show();
            ui->frame_clean_resetall_2->show();
            ui->frame_oper_wcflag->show();
            ui->p_help->show();
            break;
        case 3: // User setup
            ui->p_LOGIN->setText("login");
            ui->label_initok->setStyleSheet(backLightGrey);
            ui->check_resetPW->show();
            //            ui->frame_setup_files->setDisabled(true);
            ui->frame_COMPORTS->show();
            ui->frame_inifiles->hide();
            ui->frame_port_service->show();
            ui->frame_log_servicedata->show();
            ui->frame_setup_first->show();
            //            ui->frame_setup_service->show();
            ui->p_help->show();
            ui->p_loadinssetupini->setEnabled(false);
            ui->p_loadinsmotorini->setEnabled(false);
            ui->lineEdit_activeIniFile->clear();
            ui->lineEdit_activemotorFile->clear();
            break;
        case 4: // User prog
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->prog), ui->prog, "FW");
            break;
        case 5:
            ui->p_LOGIN->setText("login");
            ui->line_USER->setText("oper");
            ui->line_PW->setText("oper");
            break;
        }
    }
    else // Feeder COM ist geöffnet
    {
        switch (idx)
        {
        case 0: // kein User angemeldet
            removetab();
            break;
        case 1: // User dev
            ui->p_LOGIN->setText("logout");
            ui->label_initok->setStyleSheet("background-color: red");
            ui->check_resetPW->show();
            //            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->XCMD),ui->XCMD,"XCMD");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->SYSTEM), ui->SYSTEM, "Systemdata");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->MOTOR), ui->MOTOR, "MOTOR");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->CASS), ui->CASS, "CASS");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->LOCK), ui->LOCK, "LOCK");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->VAC), ui->VAC, "VAC");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->POS), ui->POS, "POS");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->ALIGNER), ui->ALIGNER, "Aligner");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->API), ui->API, "API");
            ui->API->setDisabled(true);
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->cycle), ui->cycle, "macro");
            if (ui->check_wob_deactiv->isChecked()) ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->dev), ui->dev, "Joy");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->smif), ui->smif, "SMIF");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->asyst), ui->asyst, "ASYST");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->prog), ui->prog, "FW");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->tab_mic), ui->tab_mic, "MIC");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_setup), ui->tab_setup, "setup");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_lift1), ui->tab_lift1, "Lift1");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_lift2), ui->tab_lift2, "Lift2");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_loader), ui->tab_loader, "Loader");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_aligner), ui->tab_aligner, "Aligner");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_wc), ui->tab_wc, "Changer");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_clean), ui->tab_clean, "Clean");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_log), ui->tab_log, "feed");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_transferpos), ui->tab_transferpos, "Stage");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_dbg), ui->tab_dbg, "PA_MEAS");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->data), ui->data, "data");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_err), ui->tab_err, "BUSlog");
            ui->frame_COMPORTS->show();
            ui->frame_port_service->show();
            ui->frame_port_API->show();
            ui->frame_port_MEAS->show();
            ui->frame_port_micro->show();
            ui->frame_port_stage->show();
            ui->check_api_pollingtest1->show();
            ui->frame_inifiles->show();
            ui->frame_setup_log->show();
            ui->frame_getmode->show();
            ui->frame_log_servicedata->show();
            ui->frame_log_dev->show();
            ui->frame_clean_resetall_2->show();
            ui->frame_oper_wcflag->show();
            ui->frame_FIFO->show();
            ui->frame_movemotor_wc->show();
            ui->checkBox_simucount->show();
            ui->checkBox_mainvacoff->show();
            ui->frame_setup_first->show();
            ui->frame_setup_service->show();
            ui->frame_debug->show();
            ui->p_help->show();
            ui->frame_setup_sync->show();
            ui->frame_setup_pin->show();
            ui->frame_clean_WCmiddle->show();
            ui->frame_mic_limitswitch->show();
            ui->frame_twidelay->show();
            ui->frame_getstate->show();
            ui->frame_CLEAN_moves->show();
            ui->frame_vac_switchtest->show();
            ui->groupBox_SMIF_service->show();
            ui->toolBox_macro->show();
            ui->check_align_rawdata->show();
            ui->p_align_displpos->show();
            ui->label_vac_valvetest->show();
            ui->p_INIT_saveEPROM->setDisabled(0);
            ui->p_INIT_saveEPROM->setStyleSheet(backRed);
            ui->p_INIT_save_allmot_EPROM->setDisabled(0);
            ui->p_INIT_save_allmot_EPROM->setStyleSheet(backRed);
            ui->p_INIT_save_allmot_boards->setDisabled(0);
            ui->p_INIT_save_allmot_boards->setStyleSheet(backRed);
            ui->p_loadinssetupini->setEnabled(true);
            ui->p_loadinsmotorini->setEnabled(true);
            ui->frame_smif_map->setDisabled(0);
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->oper), ui->oper, "oper");
            ui->p_INIT_resetcmdfeeder->show();
            ui->p_LDcenter->show();
            ui->p_LDcenter_2->show();
            ui->check_API_activate_assistant->show();
            SETUP_FILE("1"); // default INI-Files laden
            break;
        case 2:            // User service
            SETUP_FILE("1"); // default INI-Files laden
            ui->p_LOGIN->setText("logout");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->SYSTEM), ui->SYSTEM, "Systemdata");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->MOTOR), ui->MOTOR, "MOTOR");
            if (ui->radio_lift1_SMIF->isChecked() == FALSE)
            {
                ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->LOCK), ui->LOCK, "LOCK");
                ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->CASS), ui->CASS, "CASS");
            }
            else if (ui->combo_lift1_SMIF_select->currentText().left(3) == "ISE")
            {
                ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->smif), ui->smif, "SMIF");
                ui->frame_smif_map->setDisabled(0);
            }
            else if (ui->combo_lift1_SMIF_select->currentText().left(3) == "ASY")
            {
                ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->asyst), ui->asyst, "ASYST");
                ui->frame_ASYST_map->setDisabled(0);
            }
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->VAC), ui->VAC, "VAC");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->ALIGNER), ui->ALIGNER, "Aligner");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->API), ui->API, "API");
            ui->API->setDisabled(true);
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->cycle), ui->cycle, "macro");
            if (ui->check_wob_deactiv->isChecked()) ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->dev), ui->dev, "Joy");
            // ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->MIC),ui->MIC,"MIC");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_setup), ui->tab_setup, "setup");
            ui->frame_setup_first->show();
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_lift1), ui->tab_lift1, "Lift1");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_lift2), ui->tab_lift2, "Lift2");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_loader), ui->tab_loader, "Loader");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_aligner), ui->tab_aligner, "Aligner");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_wc), ui->tab_wc, "Changer");
            // ui->tabWidget_main->insertTab(ui->tabWidget_main->indexOf(ui->tab_clean),ui->tab_clean,"Clean");
           // ui->tabWidget_main->insertTab(ui->tabWidget_main->indexOf(ui->tab_log), ui->tab_log, "feed");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_transferpos), ui->tab_transferpos, "Stage");
            // ui->tabWidget_main->insertTab(ui->tabWidget_main->indexOf(ui->tab_dbg),ui->tab_dbg,"PA_MEAS");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_err), ui->tab_err, "BUSlog");
            ui->frame_COMPORTS->show();
            ui->frame_port_service->show();
            ui->frame_port_API->show();
            ui->frame_port_MEAS->show();
            ui->frame_port_stage->show();
            ui->frame_inifiles->show();
            ui->frame_setup_log->show();
            ui->frame_log_servicedata->show();
            ui->frame_log_dev->hide();
            ui->check_API_activate_assistant->show();
            ui->check_setup_lzam->hide();
            ui->p_help->show();
            ui->p_loadinssetupini->setEnabled(false);
            ui->p_loadinsmotorini->setEnabled(false);
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->oper), ui->oper, "oper");
            ui->p_INIT_resetcmdfeeder->show();
            ui->p_INIT_saveEPROM->setDisabled(0);
            ui->p_INIT_saveEPROM->setStyleSheet(backRed);
            ui->p_INIT_save_allmot_EPROM->setDisabled(0);
            ui->p_INIT_save_allmot_EPROM->setStyleSheet(backRed);
            ui->p_loadinssetupini->setEnabled(true);
            ui->p_loadinsmotorini->setEnabled(true);
            //  SETUP_FILE("1");                // default INI-Files laden
            break;
        case 3: // User setup
            ui->label_initok->setStyleSheet("background-color: red");
            ui->check_resetPW->show();
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_setup), ui->tab_setup, "setup");
            ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_log));
            //            ui->tabWidget_main->currentWidget()->setStyleSheet(backRed);
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_lift1), ui->tab_lift1, "Lift1");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_lift2), ui->tab_lift2, "Lift2");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_loader), ui->tab_loader, "Loader");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_aligner), ui->tab_aligner, "Aligner");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_wc), ui->tab_wc, "Changer");
            ui->tabWidget_2->insertTab(ui->tabWidget_2->indexOf(ui->tab_err), ui->tab_err, "BUSlog");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->SYSTEM), ui->SYSTEM, "Systemdata");
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->MOTOR), ui->MOTOR, "MOTOR");
            if (ui->radio_lift1_SMIF->isChecked() == FALSE)
            {
                ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->LOCK), ui->LOCK, "LOCK");
                ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->CASS), ui->CASS, "CASS");
            }
            else if (ui->combo_lift1_SMIF_select->currentText().left(3) == "ISE")
            {
                ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->smif), ui->smif, "SMIF");
                ui->frame_smif_map->setDisabled(0);
            }
            else if (ui->combo_lift1_SMIF_select->currentText().left(3) == "ASY")
            {
                ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->asyst), ui->asyst, "ASYST");
                ui->frame_ASYST_map->setDisabled(0);
            }
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->VAC), ui->VAC, "VAC");

            /* frames Startseite */
            ui->frame_COMPORTS->show();
            ui->frame_port_service->show();
            ui->frame_inifiles->show();
            ui->frame_setup_log->show();
            ui->frame_log_servicedata->show();
            ui->frame_setup_first->show();
            ui->frame_setup_service->show();
            ui->tab_log->show();

            ui->p_INIT_saveEPROM->setDisabled(0);
            ui->p_INIT_saveEPROM->setStyleSheet(backRed);
            ui->p_INIT_save_allmot_EPROM->setDisabled(0);
            ui->p_INIT_save_allmot_EPROM->setStyleSheet(backRed);
            ui->p_INIT_save_allmot_boards->setDisabled(0);
            ui->p_INIT_save_allmot_boards->setStyleSheet(backRed);
            ui->p_loadinssetupini->setEnabled(true);
            ui->p_loadinsmotorini->setEnabled(true);

            SETUP_FILE("1");
            break;
        case 4: // User prog
            ui->p_INIT_refreshports->hide();
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->prog), ui->prog, "FW");
            break;
        case 5: // user oper
            ui->tabWidget->insertTab(ui->tabWidget->indexOf(ui->oper), ui->oper, "oper");
            ui->p_LOGIN->setText("logout");
            SETUP_FILE("1"); // default INI-Files laden
            ui->frame_log_servicedata->show();
            if (ui->radio_lift2_notinstalled->isChecked()) ui->p_lock_unlock_lift2->hide();
            else ui->p_lock_unlock_lift2->show();
            break;
        }
    }
}
void MainWindow::removetab()
{
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->XCMD));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->SYSTEM));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->MOTOR));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->CASS));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->LOCK));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->VAC));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->ALIGNER));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->API));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->cycle));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->dev));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->POS));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->prog));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->smif));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->asyst));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->tab_mic));
    ui->tabWidget->removeTab(ui->tabWidget->indexOf(ui->oper));

    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_lift1));
    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_lift2));
    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_loader));
    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_wc));
    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_aligner));
    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_clean));
    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_log));
    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_transferpos));
    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_dbg));
    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->data));
    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_setup));
    ui->tabWidget_2->removeTab(ui->tabWidget_2->indexOf(ui->tab_err));
    ui->frame_setup_sync->hide();
    ui->frame_setup_pin->hide();
    ui->frame_mic_limitswitch->hide();
    ui->p_SET_EE_STR->hide();
    ui->check_resetPW->hide();
    ui->frame_inifiles->hide();
    ui->frame_setup_log->hide();
    ui->frame_setup_first->hide();
    ui->frame_setup_service->hide();
    ui->frame_COMPORTS->hide();
    ui->frame_port_service->hide();
    ui->frame_port_API->hide();
    ui->frame_port_MEAS->hide();
    ui->frame_port_micro->hide();
    ui->frame_port_stage->hide();
    ui->frame_log_servicedata->hide();
    ui->frame_twidelay->hide();
    ui->frame_getstate->hide();
    ui->frame_clean_resetall_2->hide();
    ui->frame_oper_wcflag->hide();
    ui->frame_debug->hide();
    ui->frame_CLEAN_moves->hide();
    ui->frame_clean_WCmiddle->hide();
    ui->frame_motor_friction_maxdev->hide();
    ui->frame_motor_friction_maxdev_2->hide();
    ui->frame_vac_switchtest->hide();
    ui->frame_FIFO->hide();
    ui->frame_movemotor_wc->hide();
    ui->groupBox_SMIF_service->hide();
    ui->label_vac_valvetest->hide();
    ui->toolBox_macro->hide();
    ui->p_INIT_resetcmdfeeder->hide();
    ui->checkBox_mainvacoff->hide();
    ui->checkBox_simucount->hide();
    ui->check_api_pollingtest1->hide();
    ui->frame_sys_diagpins->hide();
    ui->check_align_rawdata->hide();
    ui->p_align_displpos->hide();
    ui->p_help->hide();
    ui->p_LDcenter->hide();
    ui->p_LDcenter_2->hide();
    ui->label_prog_ok->setText("");
    ui->push_lift1_store_2->setEnabled(0);
    ui->push_lift2_store_2->setEnabled(0);
    ui->frame_smif_map->setDisabled(1);
    ui->p_INIT_save_allmot_EPROM->setDisabled(1);
    ui->p_INIT_save_allmot_EPROM->setStyleSheet(backLightGrey);
    ui->p_INIT_save_allmot_boards->setDisabled(1);
    ui->p_INIT_save_allmot_boards->setStyleSheet(backLightGrey);
    ui->label_INIT_store_ok->setStyleSheet(styleSheet());
    ui->combo_portlist_feeder->setStyleSheet(backLightGrey);
    ui->frame_getmode->hide();
    ui->radio_lift1_addtohgt->setChecked(0);
    ui->radio_lift2_addtohgt->setChecked(0);

    ui->check_WC_moveconst->setChecked(0);
    ui->p_smif_getpconf4->setDisabled(1);
    ui->p_smif_getpconf6->setDisabled(1);
    ui->line_vac_MainVac_Timeout->hide();
    ui->line_vac_MainVac_puls->hide();
    ui->line_vac_default_ThrsON->hide();
    ui->line_vac_default_ThrsOFF->hide();
    ui->line_vac_default_Timeout->hide();
    ui->line_vac_default_puls->hide();
    ui->check_API_activate_assistant->hide();
    ui->line_vac_CH6_ThrsON->hide();
    ui->line_vac_CH8_ThrsON->hide();
    ui->line_vac_CH6_ThrsOFF->hide();
    ui->line_vac_CH8_ThrsOFF->hide();
    ui->line_vac_CH6_actVal->hide();
    ui->line_vac_CH8_actVal->hide();

    ui->radio_API_OUT_LD_2->setStyleSheet(styleSheet());
    ui->radio_API_OUT_PA_2->setStyleSheet(styleSheet());
    ui->radio_API_OUT_WC1_2->setStyleSheet(styleSheet());
    ui->radio_API_OUT_WC2_2->setStyleSheet(styleSheet());
    ui->radio_API_OUT_CH4_2->setStyleSheet(styleSheet());
    ui->radio_API_OUT_CH6_2->setStyleSheet(styleSheet());
    ui->radio_API_OUT_CH8_2->setStyleSheet(styleSheet());
}
void MainWindow::on_p_writeHexfile_clicked()
{
    if (ui->p_selectHexPA->styleSheet() == "background-color: rgb(100,251,100)") progEnd->start(45000);
    else progEnd->start(85000);
    ui->label_prog_ok->setText(".... please wait ");
    f_openbatch(HEXFILEOPEN, ui->line_changehexfile->text(), ui->line_changehexfile_2->text());
}
void MainWindow::on_check_switch1_clicked()
{
    if (serial_due->isOpen())
    {
        if (ui->check_switch1->isChecked()) serialSendDUE("$ad=4=1\r"); // x/y stage offset deaktiviert
        else serialSendDUE("$ad=4=0\r");
    }
    else
    {
        err_msgbox("COM5 not open");
        ui->check_switch1->setChecked(0);
    }
}
void MainWindow::on_p_selectHexPA_clicked()
{
    ui->p_selectHexPA->setStyleSheet("background-color: rgb(100,251,100)");
    ui->p_selectHexAPI->setStyleSheet(backDefault);
    ui->p_selectHexRAC->setStyleSheet(backDefault);
    ui->line_changehexfile->clear();
    HEXFILEOPEN = hexDir + "/progPA.bat";
    ui->line_hexfile->setText(HEXFILEOPEN);
    ui->p_FW_changeFile->setEnabled(1);
    ui->line_changehexfile->setEnabled(1);
    ui->p_FW_changeFile_2->setEnabled(0);
    ui->line_changehexfile_2->setEnabled(0);
    ui->p_FW_changeFile->setText("select new PA file");
    ui->p_FW_changeFile_2->setText("-");
    ui->line_changehexfile_2->setText("-");
}
void MainWindow::on_p_selectHexAPI_clicked()
{
    ui->p_selectHexPA->setStyleSheet(backDefault);
    ui->p_selectHexAPI->setStyleSheet("background-color: rgb(100,251,100)");
    ui->p_selectHexRAC->setStyleSheet(backDefault);
    ui->line_changehexfile->clear();
    HEXFILEOPEN = hexDir + "/progAPI.bat";
    ui->line_hexfile->setText(HEXFILEOPEN);
    ui->p_FW_changeFile_2->setEnabled(0);
    ui->line_changehexfile_2->setEnabled(0);
    ui->p_FW_changeFile->setEnabled(1);
    ui->line_changehexfile->setEnabled(1);
    ui->p_FW_changeFile_2->setText("-");
    ui->line_changehexfile_2->setText("-");
    ui->p_FW_changeFile->setText("select new API file");
}
void MainWindow::on_p_selectHexRAC_clicked()
{
    ui->p_selectHexPA->setStyleSheet(backDefault);
    ui->p_selectHexAPI->setStyleSheet(backDefault);
    ui->p_selectHexRAC->setStyleSheet("background-color: rgb(100,251,100)");
    ui->line_changehexfile->clear();
    HEXFILEOPEN = hexDir + "/progRAC.bat";
    ui->line_hexfile->setText(HEXFILEOPEN);
    ui->p_FW_changeFile->setEnabled(1);
    ui->line_changehexfile->setEnabled(1);
    ui->p_FW_changeFile_2->setEnabled(1);
    ui->line_changehexfile_2->setEnabled(1);
    ui->p_FW_changeFile->setText("select new RAC file");
    ui->p_FW_changeFile_2->setText("select new API file");
}
void MainWindow::on_p_prog_reset_clicked()
{

    if (on_p_INIT_boxreset_setup_clicked() == 0)
    {
        ui->p_prog_reset->setStyleSheet(backLightGreen);
        err_msgbox("Service tool is now closed. If necessary, start the service tool again");
        close();
    }
    else
    {
        ui->p_prog_reset->setStyleSheet(backLightGrey);
        ui->label_prog_ok->setText("please close API ComPort");
    }
}
void MainWindow::progTimer()
{
    //   ui->label_progpcok->setText("OK. Please close CMD \nwindows and reset
    //   INSBox");
    on_p_prog_reset_clicked();
}
void MainWindow::on_p_FW_changeFile_clicked()
{
    QString hexfile;
    hexfile = QFileDialog::getOpenFileName(this, tr("Open *.hex *.bin"), hexDir2, tr("hexfile (*.hex *.bin);;All Files (*)"));
    ui->line_changehexfile->setText(hexfile);
    if (HEXFILEOPEN.contains("progPA.bat"))
    {
        if (!hexfile.contains("_PA"))
        {
            err_msgbox("selected file does not match selected script");
            ui->line_changehexfile->clear();
        }
    }
    else if (HEXFILEOPEN.contains("progAPI.bat"))
    {
        if (!hexfile.contains("_API"))
        {
            err_msgbox("selected file does not match selected script");
            ui->line_changehexfile->clear();
        }
    }
    else if (HEXFILEOPEN.contains("progRAC.bat"))
    {
        if (!hexfile.contains("_RAC"))
        {
            err_msgbox("selected file does not match selected script");
            ui->line_changehexfile->clear();
        }
    }
}
void MainWindow::on_p_FW_changeFile_2_clicked()
{
    QString hexfile;
    hexfile = QFileDialog::getOpenFileName(this, tr("Open *.hex *.bin"), hexDir2,
                                         tr("hexfile (*.hex *.bin);;All Files (*)"));
    ui->line_changehexfile_2->setText(hexfile);
    if (HEXFILEOPEN.contains("progRAC.bat"))
    {
        if (!hexfile.contains("_API"))
        {
            err_msgbox("selected file does not match selected script");
            ui->line_changehexfile_2->clear();
        }
    }
}
void MainWindow::f_openbatch(QString script, QString file, QString file2)
{
    if (QFile::exists("C:/INSBox/Service/scripts/open.bat")) QFile::remove("C:/INSBox/Service/scripts/open.bat");
    QFile f("C:/INSBox/Service/scripts/open.bat");
    QString path = "C:/INSBox/Service/scripts/";
    if (!f.open(QIODevice::WriteOnly | QIODevice::Text)) err_msgbox("can't open INIfile");
    else
    {
        QTextStream stream(&f);
        if (file2 == "-") stream << script << " " << file << '\n';
        else stream << script << " " << file << " " << file2 << '\n';

        f.close();
        QDesktopServices::openUrl(QUrl("file:///C:/INSBox/Service/scripts/open.bat", QUrl::TolerantMode));
        //        QFile::remove("C:/INSBox/Service/scripts/open.bat");
    }
}
void MainWindow::on_p_help_clicked()
{
    f_searchPage("Service Login");
}
void MainWindow::on_p_help_feed_clicked()
{
    f_searchPage("Statusabfrage und Fehlerlog (feed)");
}
void MainWindow::on_p_help_lift1_clicked()
{
    f_searchPage("Setup Lift1/Lift2");
}
void MainWindow::on_p_help_lift2_clicked()
{
    f_searchPage("Setup Lift1/Lift2");
}
void MainWindow::on_p_help_loader_clicked()
{
    f_searchPage("Setup Loader");
}
void MainWindow::on_p_help_aligner_clicked()
{
    f_searchPage("Setup Prealigner");
}
void MainWindow::on_p_help_changer_clicked()
{
    f_searchPage("Setup Wafer Changer");
}
void MainWindow::on_p_help_cass_clicked()
{
    f_searchPage("Setup CASS");
}
void MainWindow::on_p_help_clean_clicked()
{
    f_searchPage("Clean Assistent");
}
void MainWindow::on_p_help_engine_clicked()
{
    f_searchPage("Setup MOTOR");
}
void MainWindow::on_p_help_vac_clicked()
{
    f_searchPage("Setup VAC");
}
void MainWindow::on_p_help_api_clicked()
{
    f_searchPage("Diagnosetool API");
}
void MainWindow::on_p_help_macro_clicked()
{
    f_searchPage("Diagnosetool macro");
}
void MainWindow::on_p_help_lock_clicked()
{
    f_searchPage("Setup LOCK");
}
void MainWindow::on_p_help_systemdata_clicked()
{
    f_searchPage("Diagnosetool Systemdata");
}
void MainWindow::on_p_help_buslog_2_clicked()
{
    f_searchPage("Diagnosetool BUSlog");
}
void MainWindow::on_p_help_prog_clicked()
{
    f_searchPage("Firmware UpDate");
}
void MainWindow::on_p_help_SMIF_clicked()
{
    f_searchPage("Lifttyp SMIF Brooks ISE");
}
void MainWindow::f_searchPage(QString part)
{
    int page = 1;
    QString line;

    if (QFile::exists(helpfile))
    {
        QFile f(helpfile); // Daten aus helpcontent.txt einlesen
        if (f.open(QIODevice::ReadOnly | QIODevice::Text)) {
            line.clear();
            QString tmpline;
            tmpline.clear();

            while (!f.atEnd())
            {
                line = f.readLine();
                if (line.contains(part)) // String suchen
                {
                    page = line.right(3).trimmed().toInt(&ok, 10);
                    qDebug() << "page" << page;
                }
            }
            f.close();
            //     QDesktopServices::openUrl(QUrl("file:///C:/Program Files/Tracker
            //     Software/PDF Viewer/PDFXCview.exe", QUrl::TolerantMode));

            QDesktopServices::openUrl(QUrl("file:///C:/INSBox/Servicetool/Files/""pdfviewer_portable/PDFXCview.exe", QUrl::TolerantMode));
            svc10 = 1;
            delay->start(5000); // Startzeit des PDF Viewers
            while (svc10)
            {};
        }
        f_openHelp(page);
    }
}
void MainWindow::f_openHelp(int page)
{
    QString argum = "page=";
    argum.append(QString::number(page));
    //   process.start("C:/Program Files/Tracker Software/PDF
    //   Viewer/PDFXCview.exe", QStringList() << "/A" << argum <<
    //   "C:/INSBox/Servicetool/Files/INSBox Servicetool Manual.pdf");
    process.start("C:/INSBox/Servicetool/Files/pdfviewer_portable/PDFXCview.exe", QStringList() << "/A" << argum << "C:/INSBox/Servicetool/Files/INSBox Servicetool Manual.pdf");
    process.waitForFinished();
    qDebug() << "finished";
}
void MainWindow::on_p_set_INITflag_clicked()
{
    serialSendFeeder("$SET_99=1\r\n");
}
// ---------------- API CMDs --------------------------------------
void MainWindow::on_p_API_VER_clicked() {
    if (APIid == none) {
        APIpassive = 1;
        APIid = cVER;
        serialSendAPI(API_VER);
    }
}
void MainWindow::on_pINIT_clicked()
{
    int param = 0;
    APIcmdtimeout = 60000;

    APIactive = 1;
    APIid = cINIT;
    if (ui->groupBox_Lift1->isChecked()) deletslots(1);
    else if (ui->groupBox_Lift2->isChecked()) deletslots(2);

    if (ui->check_API_initpara_LD->isChecked()) param |= 1;
    if (ui->check_API_initpara_PA->isChecked()) param |= 2;
    if (ui->check_API_initpara_CH->isChecked()) param |= 4;
    if (ui->check_API_initpara_WC1->isChecked()) param |= 8;
    if (ui->check_API_initpara_WC2->isChecked()) param |= 16;

    QByteArray tmp = API_INIT;
    tmp.append(QString::number(param, 16).toLatin1()); // hex
    tmp.append("\r\n");
    serialSendAPI(tmp);
    deletslots(1);
    deletslots(2);
    deselslot();
}
void MainWindow::on_groupBox_Lift1_clicked() {
    casslift = 1;

    qDebug() << ui->combo_8inchsel_api->isHidden();
    if (ui->groupBox_Lift1->isChecked()) {
        ui->groupBox_Lift2->setChecked(0);
        if (ui->line_sensorlift1->text().left(1) == "8")
            ui->combo_8inchsel_api->show();
        else
            ui->combo_8inchsel_api->hide();
        if (ui->line_sensorlift1->text().left(1) == "6")
            ui->combo_6inchsel_api->show();
        else
            ui->combo_6inchsel_api->hide();
        if (ui->line_sensorlift1->text().left(1) == "5")
            ui->combo_5inchsel_api->show();
        else
            ui->combo_5inchsel_api->hide();
        if (ui->line_sensorlift1->text().left(1) == "4")
            ui->combo_4inchsel_api->show();
        else
            ui->combo_4inchsel_api->hide();
    } else {
        ui->combo_8inchsel_api->hide();
        ui->combo_6inchsel_api->hide();
        ui->combo_5inchsel_api->hide();
        ui->combo_4inchsel_api->hide();
    }
}
void MainWindow::on_groupBox_Lift2_clicked() {
    casslift = 2;

    if (ui->groupBox_Lift2->isChecked()) {
        ui->groupBox_Lift1->setChecked(0);
        if (ui->line_sensorlift2->text().left(1) == "8")
            ui->combo_8inchsel_api->show();
        else
            ui->combo_8inchsel_api->hide();
        if (ui->line_sensorlift2->text().left(1) == "6")
            ui->combo_6inchsel_api->show();
        else
            ui->combo_6inchsel_api->hide();
        if (ui->line_sensorlift2->text().left(1) == "5")
            ui->combo_5inchsel_api->show();
        else
            ui->combo_5inchsel_api->hide();
        if (ui->line_sensorlift2->text().left(1) == "4")
            ui->combo_4inchsel_api->show();
        else
            ui->combo_4inchsel_api->hide();
    } else {
        ui->combo_8inchsel_api->hide();
        ui->combo_6inchsel_api->hide();
        ui->combo_5inchsel_api->hide();
        ui->combo_4inchsel_api->hide();
    }
    ui->p_API_Get_2->setEnabled(true);
    ui->p_API_Put_2->setEnabled(true);
    ui->p_selectall2->setEnabled(true);
}
void MainWindow::on_p_API_Stat_clicked() {
    if (APIid == none) {
        APIsta = 1;
        serialSendAPI(API_STAT);
    } else
        err_msgbox("wait for cmd response");
}
void MainWindow::on_p_API_IN_clicked() {
    qDebug() << "IN APIid" << APIid;

    if (APIid == none) {
        APIpassive = 1;
        APIid = cIN;
        serialSendAPI(API_IN);
    }
}
void MainWindow::on_check_sensor_loop_stateChanged() {
    if (poll_IN->isActive() == 0) {
        poll_IN->start(ui->line_polltime_in->text().toInt(&ok, 10));
        ui->p_API_IN->setStyleSheet(backLightGreen);
    } else {
        poll_IN->stop();
        ui->p_API_IN->setStyleSheet(backLightGrey);
    }
}
void MainWindow::on_p_api_setcar_clicked() {
    QString cartype;
    tmpstr = 0;

    if (APIid == none)
    {
        int indic = 1;
        int size = 0;

        if(ui->groupBox_Lift1->isChecked()) size = ui->line_sensorlift1->text().left(1).toInt(&ok, 10);
        else if(ui->groupBox_Lift2->isChecked()) size = ui->line_sensorlift2->text().left(1).toInt(&ok, 10);

        if (size == 8)
        {
            if (ui->combo_8inchsel_api->isHidden() == false) cartype.append(ui->combo_8inchsel_api->currentText());

            else if (ui->combo_5inchsel_api->isHidden() == false) cartype.append(ui->combo_5inchsel_api->currentText());
            else if (ui->combo_4inchsel_api->isHidden() == false) cartype.append(ui->combo_4inchsel_api->currentText());
        }
        else if(size == 6)
        {
            if (ui->combo_6inchsel_api->isHidden() == false) cartype.append(ui->combo_6inchsel_api->currentText());
        }
        else if(size == 5)
        {
            if (ui->combo_5inchsel_api->isHidden() == false) cartype.append(ui->combo_5inchsel_api->currentText());
        }
        else if(size == 4)
        {
            if (ui->combo_4inchsel_api->isHidden() == false) cartype.append(ui->combo_4inchsel_api->currentText());
        }
        else
        {
            err_msgbox("no carrier selected");
            indic = 0;
        }
        if (indic)
        {
            APIactive = 1;
            APIid = cSETCAR;

            tmpstr = API_SETCAR;
            tmpstr.append(cartype.toLatin1());
            tmpstr.append("\r\n");
            serialSendAPI(tmpstr);
        }
    }
    else err_msgbox("wait for cmd response");
}
void MainWindow::on_p_Invent_Lift2_clicked() {
    APIcmdtimeout = 30000;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cMAP;

        tmpstr = API_MAP_L; // "@MAP_L="
        tmpstr.append("2");
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_Invent_Lift1_clicked() {
    APIcmdtimeout = 30000;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cMAP;

        tmpstr = API_MAP_L; // "@MAP_L="
        tmpstr.append("1");
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_API_OUT_clicked() {
    tmpstr = 0;
    uint8_t vac = 0;
    int vacLD = ui->radio_API_OUT_LD->isChecked();
    int vacPA = ui->radio_API_OUT_PA->isChecked();
    int vacWC1 = ui->radio_API_OUT_WC1->isChecked();
    int vacWC2 = ui->radio_API_OUT_WC2->isChecked();
    int vacCH4 = ui->radio_API_OUT_CH4->isChecked();
    //    int vacCH6 = ui->radio_API_OUT_CH6->isChecked();
    //    int vacCH8 = ui->radio_API_OUT_CH8->isChecked();

    /*   apistat.vacstatlist -> Vakuumstatus
          #define swLDVAC		0   -   1
          #define swPAVAC		1   -   2
          #define swCHVAC		2   -   4
          #define swWC1VAC	3   -   8
          #define swWC2VAC 	4	-   10 hex
          #define swAX1VAC 	5   -   20 hex
          #define swAX2VAC	6   -   40 hex
   * */
    vac = (vacLD << 0 | vacPA << 1 | vacCH4 << 2 | vacWC1 << 3 | vacWC2 << 4);
    qDebug() << vac;

    if (APIid == none) {
        APIactive = 1;
        APIid = cSETOUT;

        QByteArray tmp = API_SETOUT;
        tmp.append(QString::number(vac, 16).toUpper().toLatin1()); // hex
        tmp.append("\r\n");
        serialSendAPI(tmp);
    }
}
void MainWindow::on_p_API_GETOUT_clicked() {
    if (APIid == none) {
        APIpassive = 1;
        APIid = cGETOUT;

        serialSendAPI(API_GETOUT);
    }
}
void MainWindow::on_p_API_Get_clicked() {
    APIcmdtimeout = 20000;               // für LD-Korrektur längere Timeoutzeit
    if (ui->groupBox_Lift1->isChecked()) // Lift1 ausgewählt -> Lift2 deaktivieren
    {
        if (ui->check_lift2_deactivate->text() == "set deactive")
            ui->groupBox_Lift2->setEnabled(false);
    } else if (ui->groupBox_Lift2->isChecked())
        ui->groupBox_Lift1->setEnabled(false);
    if (listselwafer() == 0) {
        err_msgbox("please select slot"); // alle selektierten Wafer auflisten
        apitimeout->stop();
        API_LOOP = 0;
    } else
        API_getwafer();
}
void MainWindow::on_p_API_Get_2_clicked() { on_p_API_Get_clicked(); }
void MainWindow::API_getwafer() {
    static int flag = 0;

    if (APIcmdtimeout < 10000)
        APIcmdtimeout = 10000;
    tmpstr = 0;

    if (APIid == none) // Enumeration
    {
        APIactive = 1;
        APIid = cGETL;

        tmpstr = API_GET_L; // @GET_S
        if (ui->groupBox_Lift1->isChecked() == 1)
            tmpstr.append("1");
        else if (ui->groupBox_Lift2->isChecked() == 1)
            tmpstr.append("2");
        tmpstr.append(API_GET_SL); // ",SL=" Slot
        if (ui->groupBox_Lift1->isChecked()) {
            idxloop1 = VECselslots1.indexOf(
                        1, idxloop1); // wenn 1.Slot ausgewählt ist, dann ist idxloop1=0
            qDebug() << "2: idxloop1 getwafer" << idxloop1 << "idxwaf" << idxwaf;
            if (idxloop1 == -1 /*&& idxwaf != 0*/) {
                flag = 0;
                qDebug() << "3: idxloop1==-1" << idxloop1 << "idxwaf" << idxwaf;
                idxloop1 = 0;
                idxloop1 = VECselslots1.indexOf(
                            1, idxloop1); // index zeigt auf den nächsten selektierten slot
                qDebug() << "4: idxloop1==-1" << idxloop1 << "idxwaf" << idxwaf;
            }
            if (idxloop1 != -1) // weiterer Wafer ausgewählt
            {
                flag = 0;
                tmpstr.append(QString::number(VECselslots1.indexOf(1, idxloop1) + 1).toLatin1());
                if ((VECselslots1.indexOf(1, idxloop1) + 1))
                    actslot(VECselslots1.indexOf(1, idxloop1) + 1); // Slot sperren
                idxwaf = idxloop1; // Index des GET Wafers
                if (idxloop1 <= 24)
                    idxloop1++; // Index erhöhen für den nächsten selektierten Slot
                else
                    idxloop1 = 0;
                qDebug() << "5: idxloop1!=-1" << idxloop1 << "idxwaf" << idxwaf;
            } else
                flag = 1; // 0=kein Slot ausgewählt
        } else if (ui->groupBox_Lift2->isChecked()) {
            idxloop2 = VECselslots2.indexOf(1, idxloop2);
            if (idxloop2 == -1 && idxwaf != 0) {
                idxloop2 = 0;
                idxloop2 = VECselslots2.indexOf(
                            1, idxloop2); // index zeigt auf den nächsten selektierten slot
            }
            if (idxloop2 != -1) {
                tmpstr.append(QString::number(VECselslots2.indexOf(1, idxloop2) + 1).toLatin1());
                actslot(VECselslots2.indexOf(1, idxloop2) + 1);
                idxwaf = idxloop2; // Index des GET Wafers
                if (idxloop2 <= 24)
                    idxloop2++;
                else
                    idxloop2 = 0;
            } else
                flag = 1; // 0=kein Slot ausgewählt
        }
        tmpstr.append("\r\n");
        if (flag) {
            err_msgbox("no slot selected");
            flag = 0;
            APIid = none;
        } else
            serialSendAPI(tmpstr);
    } else
        err_msgbox("APIid is active" + QString::number(APIid)); //
}
void MainWindow::on_p_API_putaligner_clicked() {
    APIcmdtimeout = 10000;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cPUT;

        tmpstr = API_PUT_L;        // @PUT_S=
        tmpstr.append("0");        // Station 0 = Aligner
        tmpstr.append(API_PUT_SL); // ",SL="
        tmpstr.append("0");
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_API_Align_clicked() {
    APIcmdtimeout = 40000;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cALIGN;

        tmpstr = API_ALIGN; // @ALIGN_A=
        tmpstr.append(ui->line_api_wafangle->text().toLatin1());
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_API_ALROT_clicked() {
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cSETALROT;

        QString angle = ui->spinAPI_alrot->text();
        tmpstr = API_ALROT;
        tmpstr.append(angle.toLatin1());
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_API_PREWC_clicked() {
    APIcmdtimeout = 10000;
    tmpstr = 0;

    if (APIid == none)
    {
        APIactive = 1;
        APIid = cPREWCup;

        tmpstr.append(API_PREWC);
        tmpstr.append("1");
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_API_PREWC_down_clicked() // nicht aktiv
{
    APIcmdtimeout = 10000;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cPREWCdown;

        tmpstr.append(API_PREWC);
        tmpstr.append("0");
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::doAPI_WC()
{
    if (APIid == none)
    {
        APIactive = 1;
        APIid = cWC;

        serialSendAPI(API_WC);
    }
}
void MainWindow::on_p_API_getaligner_clicked() {
    APIcmdtimeout = 10000;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cGETA;

        tmpstr = API_GET_L;
        tmpstr.append("0"); // Station 0 ist Aligner
        tmpstr.append(API_GET_SL);
        tmpstr.append("0");
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_API_Put_clicked() // indirekt aufgerufen (kein Button)
{
    if (ui->groupBox_Lift1->isChecked()) {
        if (ui->check_lift2_deactivate->text() == "set deactive")
            ui->groupBox_Lift2->setEnabled(false);
    } else if (ui->groupBox_Lift2->isChecked())
        ui->groupBox_Lift1->setEnabled(false);

    listselwafer(); // alle selektierten Wafer auflisten
    //   qDebug()<< "VECselslots1.indexOf(1)"<< VECselslots1.indexOf(1);
    //   qDebug()<< "VECselslots2.indexOf(1)"<< VECselslots2.indexOf(1);
    //   qDebug()<< "VECselslots1.indexOf(idxloop1)"<<
    //   VECselslots1.indexOf(idxloop1); qDebug()<< "idxloop1"<< idxloop1;

    API_putwafer();
}
void MainWindow::on_p_API_Put_2_clicked() // Lift2 Button
{
    on_p_API_getaligner_clicked();
}
void MainWindow::API_putwafer() {
    APIcmdtimeout = 10000;
    tmpstr = 0;

    qDebug() << "idxwaf" << idxwaf << "idxwaf1" << idxwaf1 << "idxwaf2" << idxwaf2
             << "PAwaf" << PAwaf << "CHwaf" << CHwaf;

    if (APIid == none) {
        APIactive = 1;
        APIid = cPUT;

        tmpstr = API_PUT_L; // @PUT_S=
        if (ui->groupBox_Lift1->isChecked() == 1)
            tmpstr.append("1");
        else if (ui->groupBox_Lift2->isChecked() == 1)
            tmpstr.append("2");
        tmpstr.append(API_GET_SL); // ",SL=" Slot
        if (ui->groupBox_Lift1->isChecked()) {
            tmpstr.append(QString::number(PAwaf + 1).toLatin1()); // index zeigt auf Slot waf1
            deactslot(VECselslots1.indexOf(1, PAwaf) + 1); // Slot wieder freigeben
            PAwaf = 99;
        } else if (ui->groupBox_Lift2->isChecked()) {
            tmpstr.append(QString::number(PAwaf + 1).toLatin1());
            deactslot(VECselslots2.indexOf(1, PAwaf) + 1);
            PAwaf = 99;
        } else
            tmpstr.append("0"); // kein gültiger Slot
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_API_UNLOAD_clicked() {
    APIcmdtimeout = 10000;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cUNLOAD;

        tmpstr = API_UNLOAD;
        if (ui->groupBox_Lift1->isChecked())
            tmpstr.append("1"); // Lift1 unload
        else if (ui->groupBox_Lift2->isChecked())
            tmpstr.append("2"); // Lift2 unload
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_API_LOAD_clicked() {

    APIcmdtimeout = 10000;
    tmpstr = 0;

    if (APIid == none) {
        APIactive = 1;
        APIid = cLOAD;

        tmpstr = API_LOAD;
        if (ui->groupBox_Lift1->isChecked())
            tmpstr.append("1"); // Lift1 load
        else if (ui->groupBox_Lift2->isChecked())
            tmpstr.append("2"); // Lift2 load
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_API_Getalrot_clicked() {
    if (APIid == none) {
        APIpassive = 1;
        APIid = cGETALROT;

        serialSendAPI(API_GETALROT);
    }
}
void MainWindow::on_p_Invent_GETMAP_clicked() {
    tmpstr = 0;

    if (APIid == none) {
        APIpassive = 1;
        APIid = cGETMAP;

        tmpstr = API_GETMAP; // "@GETMAP_L="
        if (ui->groupBox_Lift1->isChecked())
            tmpstr.append("1");
        else if (ui->groupBox_Lift2->isChecked())
            tmpstr.append("2");
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_Invent_GETMAP_2_clicked()
{
    on_p_Invent_GETMAP_clicked();
}
void MainWindow::on_p_selectall1_toggled(bool checked)
{
    if (checked) {
        for (int i = 0; i < 25; i++) {
            switch (i) {
            case 0:
                if (VECslot1[i] == 1)
                    ui->check_slot1->setChecked(1);
                break;
            case 1:
                if (VECslot1[i] == 1)
                    ui->check_slot2->setChecked(1);
                break;
            case 2:
                if (VECslot1[i] == 1)
                    ui->check_slot3->setChecked(1);
                break;
            case 3:
                if (VECslot1[i] == 1)
                    ui->check_slot4->setChecked(1);
                break;
            case 4:
                if (VECslot1[i] == 1)
                    ui->check_slot5->setChecked(1);
                break;
            case 5:
                if (VECslot1[i] == 1)
                    ui->check_slot6->setChecked(1);
                break;
            case 6:
                if (VECslot1[i] == 1)
                    ui->check_slot7->setChecked(1);
                break;
            case 7:
                if (VECslot1[i] == 1)
                    ui->check_slot8->setChecked(1);
                break;
            case 8:
                if (VECslot1[i] == 1)
                    ui->check_slot9->setChecked(1);
                break;
            case 9:
                if (VECslot1[i] == 1)
                    ui->check_slot10->setChecked(1);
                break;
            case 10:
                if (VECslot1[i] == 1)
                    ui->check_slot11->setChecked(1);
                break;
            case 11:
                if (VECslot1[i] == 1)
                    ui->check_slot12->setChecked(1);
                break;
            case 12:
                if (VECslot1[i] == 1)
                    ui->check_slot13->setChecked(1);
                break;
            case 13:
                if (VECslot1[i] == 1)
                    ui->check_slot14->setChecked(1);
                break;
            case 14:
                if (VECslot1[i] == 1)
                    ui->check_slot15->setChecked(1);
                break;
            case 15:
                if (VECslot1[i] == 1)
                    ui->check_slot16->setChecked(1);
                break;
            case 16:
                if (VECslot1[i] == 1)
                    ui->check_slot17->setChecked(1);
                break;
            case 17:
                if (VECslot1[i] == 1)
                    ui->check_slot18->setChecked(1);
                break;
            case 18:
                if (VECslot1[i] == 1)
                    ui->check_slot19->setChecked(1);
                break;
            case 19:
                if (VECslot1[i] == 1)
                    ui->check_slot20->setChecked(1);
                break;
            case 20:
                if (VECslot1[i] == 1)
                    ui->check_slot21->setChecked(1);
                break;
            case 21:
                if (VECslot1[i] == 1)
                    ui->check_slot22->setChecked(1);
                break;
            case 22:
                if (VECslot1[i] == 1)
                    ui->check_slot23->setChecked(1);
                break;
            case 23:
                if (VECslot1[i] == 1)
                    ui->check_slot24->setChecked(1);
                break;
            case 24:
                if (VECslot1[i] == 1)
                    ui->check_slot25->setChecked(1);
                break;
            }
        }
        ui->p_selectall1->setText("deselect all");
    } else {
        for (int i = 0; i < 25; i++) {
            switch (i) {
            case 0:
                if (VECslot1[i] == 1)
                    ui->check_slot1->setChecked(0);
                break;
            case 1:
                if (VECslot1[i] == 1)
                    ui->check_slot2->setChecked(0);
                break;
            case 2:
                if (VECslot1[i] == 1)
                    ui->check_slot3->setChecked(0);
                break;
            case 3:
                if (VECslot1[i] == 1)
                    ui->check_slot4->setChecked(0);
                break;
            case 4:
                if (VECslot1[i] == 1)
                    ui->check_slot5->setChecked(0);
                break;
            case 5:
                if (VECslot1[i] == 1)
                    ui->check_slot6->setChecked(0);
                break;
            case 6:
                if (VECslot1[i] == 1)
                    ui->check_slot7->setChecked(0);
                break;
            case 7:
                if (VECslot1[i] == 1)
                    ui->check_slot8->setChecked(1);
                break;
            case 8:
                if (VECslot1[i] == 1)
                    ui->check_slot9->setChecked(0);
                break;
            case 9:
                if (VECslot1[i] == 1)
                    ui->check_slot10->setChecked(0);
                break;
            case 10:
                if (VECslot1[i] == 1)
                    ui->check_slot11->setChecked(0);
                break;
            case 11:
                if (VECslot1[i] == 1)
                    ui->check_slot12->setChecked(0);
                break;
            case 12:
                if (VECslot1[i] == 1)
                    ui->check_slot13->setChecked(0);
                break;
            case 13:
                if (VECslot1[i] == 1)
                    ui->check_slot14->setChecked(0);
                break;
            case 14:
                if (VECslot1[i] == 1)
                    ui->check_slot15->setChecked(0);
                break;
            case 15:
                if (VECslot1[i] == 1)
                    ui->check_slot16->setChecked(0);
                break;
            case 16:
                if (VECslot1[i] == 1)
                    ui->check_slot17->setChecked(0);
                break;
            case 17:
                if (VECslot1[i] == 1)
                    ui->check_slot18->setChecked(0);
                break;
            case 18:
                if (VECslot1[i] == 1)
                    ui->check_slot19->setChecked(0);
                break;
            case 19:
                if (VECslot1[i] == 1)
                    ui->check_slot20->setChecked(0);
                break;
            case 20:
                if (VECslot1[i] == 1)
                    ui->check_slot21->setChecked(0);
                break;
            case 21:
                if (VECslot1[i] == 1)
                    ui->check_slot22->setChecked(0);
                break;
            case 22:
                if (VECslot1[i] == 1)
                    ui->check_slot23->setChecked(0);
                break;
            case 23:
                if (VECslot1[i] == 1)
                    ui->check_slot24->setChecked(0);
                break;
            case 24:
                if (VECslot1[i] == 1)
                    ui->check_slot25->setChecked(0);
                break;
            }
        }
        ui->p_selectall1->setText("select all");
    }
}
void MainWindow::on_p_selectall2_toggled(bool checked)
{
    if (checked)
    {
        for (int i = 0; i < 25; i++)
        {
            switch (i)
            {
            case 0:
                if (VECslot2[i] == 1) ui->check_slot1_2->setChecked(1);
                break;
            case 1:
                if (VECslot2[i] == 1) ui->check_slot2_2->setChecked(1);
                break;
            case 2:
                if (VECslot2[i] == 1) ui->check_slot3_2->setChecked(1);
                break;
            case 3:
                if (VECslot2[i] == 1) ui->check_slot4_2->setChecked(1);
                break;
            case 4:
                if (VECslot2[i] == 1) ui->check_slot5_2->setChecked(1);
                break;
            case 5:
                if (VECslot2[i] == 1) ui->check_slot6_2->setChecked(1);
                break;
            case 6:
                if (VECslot2[i] == 1) ui->check_slot7_2->setChecked(1);
                break;
            case 7:
                if (VECslot2[i] == 1) ui->check_slot8_2->setChecked(1);
                break;
            case 8:
                if (VECslot2[i] == 1) ui->check_slot9_2->setChecked(1);
                break;
            case 9:
                if (VECslot2[i] == 1) ui->check_slot10_2->setChecked(1);
                break;
            case 10:
                if (VECslot2[i] == 1) ui->check_slot11_2->setChecked(1);
                break;
            case 11:
                if (VECslot2[i] == 1) ui->check_slot12_2->setChecked(1);
                break;
            case 12:
                if (VECslot2[i] == 1) ui->check_slot13_2->setChecked(1);
                break;
            case 13:
                if (VECslot2[i] == 1) ui->check_slot14_2->setChecked(1);
                break;
            case 14:
                if (VECslot2[i] == 1) ui->check_slot15_2->setChecked(1);
                break;
            case 15:
                if (VECslot2[i] == 1) ui->check_slot16_2->setChecked(1);
                break;
            case 16:
                if (VECslot2[i] == 1) ui->check_slot17_2->setChecked(1);
                break;
            case 17:
                if (VECslot2[i] == 1) ui->check_slot18_2->setChecked(1);
                break;
            case 18:
                if (VECslot2[i] == 1) ui->check_slot19_2->setChecked(1);
                break;
            case 19:
                if (VECslot2[i] == 1) ui->check_slot20_2->setChecked(1);
                break;
            case 20:
                if (VECslot2[i] == 1) ui->check_slot21_2->setChecked(1);
                break;
            case 21:
                if (VECslot2[i] == 1) ui->check_slot22_2->setChecked(1);
                break;
            case 22:
                if (VECslot2[i] == 1) ui->check_slot23_2->setChecked(1);
                break;
            case 23:
                if (VECslot2[i] == 1) ui->check_slot24_2->setChecked(1);
                break;
            case 24:
                if (VECslot2[i] == 1) ui->check_slot25_2->setChecked(1);
                break;
            }
        }
        ui->p_selectall2->setText("deselect all");
    }
    else
    {
        for (int i = 0; i < 25; i++)
        {
            switch (i)
            {
            case 0:
                if (VECslot2[i] == 1)
                    ui->check_slot1_2->setChecked(0);
                break;
            case 1:
                if (VECslot2[i] == 1)
                    ui->check_slot2_2->setChecked(0);
                break;
            case 2:
                if (VECslot2[i] == 1)
                    ui->check_slot3_2->setChecked(0);
                break;
            case 3:
                if (VECslot2[i] == 1)
                    ui->check_slot4_2->setChecked(0);
                break;
            case 4:
                if (VECslot2[i] == 1)
                    ui->check_slot5_2->setChecked(0);
                break;
            case 5:
                if (VECslot2[i] == 1)
                    ui->check_slot6_2->setChecked(0);
                break;
            case 6:
                if (VECslot2[i] == 1)
                    ui->check_slot7_2->setChecked(0);
                break;
            case 7:
                if (VECslot2[i] == 1)
                    ui->check_slot8_2->setChecked(0);
                break;
            case 8:
                if (VECslot2[i] == 1)
                    ui->check_slot9_2->setChecked(0);
                break;
            case 9:
                if (VECslot2[i] == 1)
                    ui->check_slot10_2->setChecked(0);
                break;
            case 10:
                if (VECslot2[i] == 1)
                    ui->check_slot11_2->setChecked(0);
                break;
            case 11:
                if (VECslot2[i] == 1)
                    ui->check_slot12_2->setChecked(0);
                break;
            case 12:
                if (VECslot2[i] == 1)
                    ui->check_slot13_2->setChecked(0);
                break;
            case 13:
                if (VECslot2[i] == 1)
                    ui->check_slot14_2->setChecked(0);
                break;
            case 14:
                if (VECslot2[i] == 1)
                    ui->check_slot15_2->setChecked(0);
                break;
            case 15:
                if (VECslot2[i] == 1)
                    ui->check_slot16_2->setChecked(0);
                break;
            case 16:
                if (VECslot2[i] == 1)
                    ui->check_slot17_2->setChecked(0);
                break;
            case 17:
                if (VECslot2[i] == 1)
                    ui->check_slot18_2->setChecked(0);
                break;
            case 18:
                if (VECslot2[i] == 1)
                    ui->check_slot19_2->setChecked(0);
                break;
            case 19:
                if (VECslot2[i] == 1)
                    ui->check_slot20_2->setChecked(0);
                break;
            case 20:
                if (VECslot2[i] == 1)
                    ui->check_slot21_2->setChecked(0);
                break;
            case 21:
                if (VECslot2[i] == 1)
                    ui->check_slot22_2->setChecked(0);
                break;
            case 22:
                if (VECslot2[i] == 1)
                    ui->check_slot23_2->setChecked(0);
                break;
            case 23:
                if (VECslot2[i] == 1)
                    ui->check_slot24_2->setChecked(0);
                break;
            case 24:
                if (VECslot2[i] == 1)
                    ui->check_slot25_2->setChecked(0);
                break;
            }
        }
        ui->p_selectall2->setText("select all");
    }
}
void MainWindow::deletslots(int liftnr) // Wafermap löschen
{
    if (liftnr == 1) {
        ui->lineEdit_L1S1->setStyleSheet("background-color: white");
        ui->check_slot1->hide();

        ui->lineEdit_L1S2->setStyleSheet("background-color: white");
        ui->check_slot2->hide();

        ui->lineEdit_L1S3->setStyleSheet("background-color: white");
        ui->check_slot3->hide();

        ui->lineEdit_L1S4->setStyleSheet("background-color: white");
        ui->check_slot4->hide();

        ui->lineEdit_L1S5->setStyleSheet("background-color: white");
        ui->check_slot5->hide();

        ui->lineEdit_L1S6->setStyleSheet("background-color: white");
        ui->check_slot6->hide();

        ui->lineEdit_L1S7->setStyleSheet("background-color: white");
        ui->check_slot7->hide();

        ui->lineEdit_L1S8->setStyleSheet("background-color: white");
        ui->check_slot8->hide();

        ui->lineEdit_L1S9->setStyleSheet("background-color: white");
        ui->check_slot9->hide();

        ui->lineEdit_L1S10->setStyleSheet("background-color: white");
        ui->check_slot10->hide();

        ui->lineEdit_L1S11->setStyleSheet("background-color: white");
        ui->check_slot11->hide();

        ui->lineEdit_L1S12->setStyleSheet("background-color: white");
        ui->check_slot12->hide();

        ui->lineEdit_L1S13->setStyleSheet("background-color: white");
        ui->check_slot13->hide();

        ui->lineEdit_L1S14->setStyleSheet("background-color: white");
        ui->check_slot14->hide();

        ui->lineEdit_L1S15->setStyleSheet("background-color: white");
        ui->check_slot15->hide();

        ui->lineEdit_L1S16->setStyleSheet("background-color: white");
        ui->check_slot16->hide();

        ui->lineEdit_L1S17->setStyleSheet("background-color: white");
        ui->check_slot17->hide();

        ui->lineEdit_L1S18->setStyleSheet("background-color: white");
        ui->check_slot18->hide();

        ui->lineEdit_L1S19->setStyleSheet("background-color: white");
        ui->check_slot19->hide();

        ui->lineEdit_L1S20->setStyleSheet("background-color: white");
        ui->check_slot20->hide();

        ui->lineEdit_L1S21->setStyleSheet("background-color: white");
        ui->check_slot21->hide();

        ui->lineEdit_L1S22->setStyleSheet("background-color: white");
        ui->check_slot22->hide();

        ui->lineEdit_L1S23->setStyleSheet("background-color: white");
        ui->check_slot23->hide();

        ui->lineEdit_L1S24->setStyleSheet("background-color: white");
        ui->check_slot24->hide();

        ui->lineEdit_L1S25->setStyleSheet("background-color: white");
        ui->check_slot25->hide();
    } else if (liftnr == 2) {
        ui->lineEdit_L2S1->setStyleSheet("background-color: white");
        ui->check_slot1_2->hide();

        ui->lineEdit_L2S2->setStyleSheet("background-color: white");
        ui->check_slot2_2->hide();

        ui->lineEdit_L2S3->setStyleSheet("background-color: white");
        ui->check_slot3_2->hide();

        ui->lineEdit_L2S4->setStyleSheet("background-color: white");
        ui->check_slot4_2->hide();

        ui->lineEdit_L2S5->setStyleSheet("background-color: white");
        ui->check_slot5_2->hide();

        ui->lineEdit_L2S6->setStyleSheet("background-color: white");
        ui->check_slot6_2->hide();

        ui->lineEdit_L2S7->setStyleSheet("background-color: white");
        ui->check_slot7_2->hide();

        ui->lineEdit_L2S8->setStyleSheet("background-color: white");
        ui->check_slot8_2->hide();

        ui->lineEdit_L2S9->setStyleSheet("background-color: white");
        ui->check_slot9_2->hide();

        ui->lineEdit_L2S10->setStyleSheet("background-color: white");
        ui->check_slot10_2->hide();

        ui->lineEdit_L2S11->setStyleSheet("background-color: white");
        ui->check_slot11_2->hide();

        ui->lineEdit_L2S12->setStyleSheet("background-color: white");
        ui->check_slot12_2->hide();

        ui->lineEdit_L2S13->setStyleSheet("background-color: white");
        ui->check_slot13_2->hide();

        ui->lineEdit_L2S14->setStyleSheet("background-color: white");
        ui->check_slot14_2->hide();

        ui->lineEdit_L2S15->setStyleSheet("background-color: white");
        ui->check_slot15_2->hide();

        ui->lineEdit_L2S16->setStyleSheet("background-color: white");
        ui->check_slot16_2->hide();

        ui->lineEdit_L2S17->setStyleSheet("background-color: white");
        ui->check_slot17_2->hide();

        ui->lineEdit_L2S18->setStyleSheet("background-color: white");
        ui->check_slot18_2->hide();

        ui->lineEdit_L2S19->setStyleSheet("background-color: white");
        ui->check_slot19_2->hide();

        ui->lineEdit_L2S20->setStyleSheet("background-color: white");
        ui->check_slot20_2->hide();

        ui->lineEdit_L2S21->setStyleSheet("background-color: white");
        ui->check_slot21_2->hide();

        ui->lineEdit_L2S22->setStyleSheet("background-color: white");
        ui->check_slot22_2->hide();

        ui->lineEdit_L2S23->setStyleSheet("background-color: white");
        ui->check_slot23_2->hide();

        ui->lineEdit_L2S24->setStyleSheet("background-color: white");
        ui->check_slot24_2->hide();

        ui->lineEdit_L2S25->setStyleSheet("background-color: white");
        ui->check_slot25_2->hide();
    }
}
void MainWindow::deselslot() // Slotauswahlboxen einblenden
{
    if (ui->groupBox_Lift1->isChecked()) {
        ui->check_slot1->setEnabled(true);
        ui->check_slot2->setEnabled(true);
        ui->check_slot3->setEnabled(true);
        ui->check_slot4->setEnabled(true);
        ui->check_slot5->setEnabled(true);
        ui->check_slot6->setEnabled(true);
        ui->check_slot7->setEnabled(true);
        ui->check_slot8->setEnabled(true);
        ui->check_slot9->setEnabled(true);
        ui->check_slot10->setEnabled(true);
        ui->check_slot11->setEnabled(true);
        ui->check_slot12->setEnabled(true);
        ui->check_slot13->setEnabled(true);
        ui->check_slot14->setEnabled(true);
        ui->check_slot15->setEnabled(true);
        ui->check_slot16->setEnabled(true);
        ui->check_slot17->setEnabled(true);
        ui->check_slot18->setEnabled(true);
        ui->check_slot19->setEnabled(true);
        ui->check_slot20->setEnabled(true);
        ui->check_slot21->setEnabled(true);
        ui->check_slot22->setEnabled(true);
        ui->check_slot23->setEnabled(true);
        ui->check_slot24->setEnabled(true);
        ui->check_slot25->setEnabled(true);
    } else {
        ui->check_slot1_2->setEnabled(true);
        ui->check_slot2_2->setEnabled(true);
        ui->check_slot3_2->setEnabled(true);
        ui->check_slot4_2->setEnabled(true);
        ui->check_slot5_2->setEnabled(true);
        ui->check_slot6_2->setEnabled(true);
        ui->check_slot7_2->setEnabled(true);
        ui->check_slot8_2->setEnabled(true);
        ui->check_slot9_2->setEnabled(true);
        ui->check_slot10_2->setEnabled(true);
        ui->check_slot11_2->setEnabled(true);
        ui->check_slot12_2->setEnabled(true);
        ui->check_slot13_2->setEnabled(true);
        ui->check_slot14_2->setEnabled(true);
        ui->check_slot15_2->setEnabled(true);
        ui->check_slot16_2->setEnabled(true);
        ui->check_slot17_2->setEnabled(true);
        ui->check_slot18_2->setEnabled(true);
        ui->check_slot19_2->setEnabled(true);
        ui->check_slot20_2->setEnabled(true);
        ui->check_slot21_2->setEnabled(true);
        ui->check_slot22_2->setEnabled(true);
        ui->check_slot23_2->setEnabled(true);
        ui->check_slot24_2->setEnabled(true);
        ui->check_slot25_2->setEnabled(true);
    }
}
int MainWindow::listselwafer() // Slotliste wird aktualisiert
{
    int ret = 1;
    VECselslots1.clear();
    VECselslots2.clear();
    for (int i = 0; i < 25;
         i++) // size von QVector<int> muss initialisiert werden
    {
        VECselslots1.append(0);
        VECselslots2.append(0);
    }
    qDebug() << "listselwafer() -> VECselslots1.size()" << VECselslots1.size();

    if (ui->groupBox_Lift1->isChecked()) {
        if (ui->check_slot1->isChecked())
            VECselslots1[0] = 1; // alle selektierten Wafer listen
        else
            VECselslots1[0] = 0;
        if (ui->check_slot2->isChecked())
            VECselslots1[1] = 1;
        else
            VECselslots1[1] = 0;
        if (ui->check_slot3->isChecked())
            VECselslots1[2] = 1;
        else
            VECselslots1[2] = 0;
        if (ui->check_slot4->isChecked())
            VECselslots1[3] = 1;
        else
            VECselslots1[3] = 0;
        if (ui->check_slot5->isChecked())
            VECselslots1[4] = 1;
        else
            VECselslots1[4] = 0;
        if (ui->check_slot6->isChecked())
            VECselslots1[5] = 1;
        else
            VECselslots1[5] = 0;
        if (ui->check_slot7->isChecked())
            VECselslots1[6] = 1;
        else
            VECselslots1[6] = 0;
        if (ui->check_slot8->isChecked())
            VECselslots1[7] = 1;
        else
            VECselslots1[7] = 0;
        if (ui->check_slot9->isChecked())
            VECselslots1[8] = 1;
        else
            VECselslots1[8] = 0;
        if (ui->check_slot10->isChecked())
            VECselslots1[9] = 1;
        else
            VECselslots1[9] = 0;
        if (ui->check_slot11->isChecked())
            VECselslots1[10] = 1;
        else
            VECselslots1[10] = 0;
        if (ui->check_slot12->isChecked())
            VECselslots1[11] = 1;
        else
            VECselslots1[11] = 0;
        if (ui->check_slot13->isChecked())
            VECselslots1[12] = 1;
        else
            VECselslots1[12] = 0;
        if (ui->check_slot14->isChecked())
            VECselslots1[13] = 1;
        else
            VECselslots1[13] = 0;
        if (ui->check_slot15->isChecked())
            VECselslots1[14] = 1;
        else
            VECselslots1[14] = 0;
        if (ui->check_slot16->isChecked())
            VECselslots1[15] = 1;
        else
            VECselslots1[15] = 0;
        if (ui->check_slot17->isChecked())
            VECselslots1[16] = 1;
        else
            VECselslots1[16] = 0;
        if (ui->check_slot18->isChecked())
            VECselslots1[17] = 1;
        else
            VECselslots1[17] = 0;
        if (ui->check_slot19->isChecked())
            VECselslots1[18] = 1;
        else
            VECselslots1[18] = 0;
        if (ui->check_slot20->isChecked())
            VECselslots1[19] = 1;
        else
            VECselslots1[19] = 0;
        if (ui->check_slot21->isChecked())
            VECselslots1[20] = 1;
        else
            VECselslots1[20] = 0;
        if (ui->check_slot22->isChecked())
            VECselslots1[21] = 1;
        else
            VECselslots1[21] = 0;
        if (ui->check_slot23->isChecked())
            VECselslots1[22] = 1;
        else
            VECselslots1[22] = 0;
        if (ui->check_slot24->isChecked())
            VECselslots1[23] = 1;
        else
            VECselslots1[23] = 0;
        if (ui->check_slot25->isChecked())
            VECselslots1[24] = 1;
        else
            VECselslots1[24] = 0;
        qDebug() << "VECselslots1 count" << VECselslots1.count(1);
        qDebug() << "VECselslots1 size" << VECselslots1.size();
        if (VECselslots1.contains(1) == false)
            ret = 0;
    } else if (ui->groupBox_Lift2->isChecked()) {
        if (ui->check_slot1_2->isChecked())
            VECselslots2[0] = 1;
        else
            VECselslots2[0] = 0;
        if (ui->check_slot2_2->isChecked())
            VECselslots2[1] = 1;
        else
            VECselslots2[1] = 0;
        if (ui->check_slot3_2->isChecked())
            VECselslots2[2] = 1;
        else
            VECselslots2[2] = 0;
        if (ui->check_slot4_2->isChecked())
            VECselslots2[3] = 1;
        else
            VECselslots2[3] = 0;
        if (ui->check_slot5_2->isChecked())
            VECselslots2[4] = 1;
        else
            VECselslots2[4] = 0;
        if (ui->check_slot6_2->isChecked())
            VECselslots2[5] = 1;
        else
            VECselslots2[5] = 0;
        if (ui->check_slot7_2->isChecked())
            VECselslots2[6] = 1;
        else
            VECselslots2[6] = 0;
        if (ui->check_slot8_2->isChecked())
            VECselslots2[7] = 1;
        else
            VECselslots2[7] = 0;
        if (ui->check_slot9_2->isChecked())
            VECselslots2[8] = 1;
        else
            VECselslots2[8] = 0;
        if (ui->check_slot10_2->isChecked())
            VECselslots2[9] = 1;
        else
            VECselslots2[9] = 0;
        if (ui->check_slot11_2->isChecked())
            VECselslots2[10] = 1;
        else
            VECselslots2[10] = 0;
        if (ui->check_slot12_2->isChecked())
            VECselslots2[11] = 1;
        else
            VECselslots2[11] = 0;
        if (ui->check_slot13_2->isChecked())
            VECselslots2[12] = 1;
        else
            VECselslots2[12] = 0;
        if (ui->check_slot14_2->isChecked())
            VECselslots2[13] = 1;
        else
            VECselslots2[13] = 0;
        if (ui->check_slot15_2->isChecked())
            VECselslots2[14] = 1;
        else
            VECselslots2[14] = 0;
        if (ui->check_slot16_2->isChecked())
            VECselslots2[15] = 1;
        else
            VECselslots2[15] = 0;
        if (ui->check_slot17_2->isChecked())
            VECselslots2[16] = 1;
        else
            VECselslots2[16] = 0;
        if (ui->check_slot18_2->isChecked())
            VECselslots2[17] = 1;
        else
            VECselslots2[17] = 0;
        if (ui->check_slot19_2->isChecked())
            VECselslots2[18] = 1;
        else
            VECselslots2[18] = 0;
        if (ui->check_slot20_2->isChecked())
            VECselslots2[19] = 1;
        else
            VECselslots2[19] = 0;
        if (ui->check_slot21_2->isChecked())
            VECselslots2[20] = 1;
        else
            VECselslots2[20] = 0;
        if (ui->check_slot22_2->isChecked())
            VECselslots2[21] = 1;
        else
            VECselslots2[21] = 0;
        if (ui->check_slot23_2->isChecked())
            VECselslots2[22] = 1;
        else
            VECselslots2[22] = 0;
        if (ui->check_slot24_2->isChecked())
            VECselslots2[23] = 1;
        else
            VECselslots2[23] = 0;
        if (ui->check_slot25_2->isChecked())
            VECselslots2[24] = 1;
        else
            VECselslots2[24] = 0;

        if (VECselslots2.contains(1) == false)
            ret = 0;
    }

    return ret;
}
void MainWindow::actslot(int slot) // disabled slotnr während des Handlings des Wafers
{
    deselslot();
    slot = 1; // derzeit nur 1 Slot auswählbar -> alle werden gesperrt
    switch (slot) {
    case 1:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot1->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot1_2->setEnabled(false);
        // break;
        // case 2:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot2->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot2_2->setEnabled(false);
        // break;
        // case 3:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot3->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot3_2->setEnabled(false);
        // break;
        // case 4:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot4->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot4_2->setEnabled(false);
        // break;
        // case 5:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot5->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot5_2->setEnabled(false);
        // break;
        // case 6:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot6->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot6_2->setEnabled(false);
        // break;
        // case 7:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot7->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot7_2->setEnabled(false);
        // break;
        // case 8:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot8->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot8_2->setEnabled(false);
        // break;
        // case 9:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot9->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot9_2->setEnabled(false);
        // break;
        // case 10:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot10->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot10_2->setEnabled(false);
        // break;
        // case 11:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot11->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot11_2->setEnabled(false);
        // break;
        // case 12:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot12->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot12_2->setEnabled(false);
        // break;
        // case 13:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot13->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot13_2->setEnabled(false);
        // break;
        // case 14:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot14->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot14_2->setEnabled(false);
        // break;
        // case 15:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot15->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot15_2->setEnabled(false);
        // break;
        // case 16:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot16->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot16_2->setEnabled(false);
        // break;
        // case 17:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot17->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot17_2->setEnabled(false);
        // break;
        // case 18:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot18->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot18_2->setEnabled(false);
        // break;
        // case 19:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot19->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot19_2->setEnabled(false);
        // break;
        // case 20:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot20->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot20_2->setEnabled(false);
        // break;
        // case 21:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot21->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot21_2->setEnabled(false);
        // break;
        // case 22:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot22->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot22_2->setEnabled(false);
        // break;
        // case 23:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot23->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot23_2->setEnabled(false);
        // break;
        // case 24:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot24->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot24_2->setEnabled(false);
        // break;
        // case 25:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot25->setEnabled(false);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot25_2->setEnabled(false);
        break;
    }
}
void MainWindow::deactslot(int slot) // disabled slotnr während des Handlings des Wafers
{
    deselslot();
    slot = 1;
    switch (slot) {
    case 1:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot1->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot1_2->setEnabled(true);
        break;
    case 2:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot2->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot2_2->setEnabled(true);
        break;
    case 3:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot3->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot3_2->setEnabled(true);
        break;
    case 4:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot4->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot4_2->setEnabled(true);
        break;
    case 5:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot5->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot5_2->setEnabled(true);
        break;
    case 6:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot6->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot6_2->setEnabled(true);
        break;
    case 7:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot7->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot7_2->setEnabled(true);
        break;
    case 8:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot8->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot8_2->setEnabled(true);
        break;
    case 9:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot9->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot9_2->setEnabled(true);
        break;
    case 10:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot10->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot10_2->setEnabled(true);
        break;
    case 11:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot11->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot11_2->setEnabled(true);
        break;
    case 12:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot12->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot12_2->setEnabled(true);
        break;
    case 13:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot13->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot13_2->setEnabled(true);
        break;
    case 14:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot14->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot14_2->setEnabled(true);
        break;
    case 15:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot15->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot15_2->setEnabled(true);
        break;
    case 16:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot16->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot16_2->setEnabled(true);
        break;
    case 17:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot17->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot17_2->setEnabled(true);
        break;
    case 18:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot18->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot18_2->setEnabled(true);
        break;
    case 19:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot19->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot19_2->setEnabled(true);
        break;
    case 20:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot20->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot20_2->setEnabled(true);
        break;
    case 21:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot21->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot21_2->setEnabled(true);
        break;
    case 22:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot22->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot22_2->setEnabled(true);
        break;
    case 23:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot23->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot23_2->setEnabled(true);
        break;
    case 24:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot24->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot24_2->setEnabled(true);
        break;
    case 25:
        if (ui->groupBox_Lift1->isChecked())
            ui->check_slot25->setEnabled(true);
        else if (ui->groupBox_Lift2->isChecked())
            ui->check_slot25_2->setEnabled(true);
        break;
    }
}
void MainWindow::on_p_API_logerr_clear_clicked()
{
    ui->plainTextEdit_API_logerr->clear();
}
void MainWindow::on_p_API_logerr_clear_2_clicked()
{
    ui->plainTextEdit_API_logerr_2->clear();
}
void MainWindow::on_p_LDcenter_clicked()
{
    macroaktiv_ld = 0;
    on_p_align_runmacro_lddispl_clicked();
}
void MainWindow::on_p_API_SETMACRO_clicked()
{
    QString speed;
    QString tilt;
    QString rotate;

    tmpstr.clear();

    APIactive = 1;
    APIid = cSTARTMACRO;

    speed = ui->spinAPI_wobtime->text();
    tilt = ui->spinAPI_wobtilt->text();
    rotate = ui->spinAPI_wobtilt->text();

    tmpstr = API_WOSTART; // @STARTMACRO_S=
    tmpstr.append(speed.toLatin1() + ",T=");
    tmpstr.append(tilt.toLatin1() + ",R=");
    tmpstr.append(rotate.toLatin1() + "\r\n");
    serialSendAPI(tmpstr);
}
void MainWindow::on_p_API_UPDATEMACRO_clicked() {
    QString speed;
    QString tilt;
    QString stop;
    QString rotate;

    tmpstr.clear();

    APIactive = 1;

    speed = ui->spinAPI_wobtime->text();
    tilt = ui->spinAPI_wobtilt->text();
    rotate = ui->spinAPI_wobtilt->text();
 //   stop = QString::number(ui->check_wob_repeat->isChecked());

    tmpstr = API_WOUPDATE; // @UPDATEMACRO_S=
    tmpstr.append(speed.toLatin1() + ",T=");
    tmpstr.append(tilt.toLatin1() + ",R=");
    tmpstr.append(rotate.toLatin1() + "\r\n");
    serialSendAPI(tmpstr);
}
void MainWindow::on_p_API_Getwobbler_clicked() {
    if (APIid == none) {
        APIpassive = 1;
        APIid = cGETWOBB;
    }

    serialSendAPI(API_WOGET); // @GETWOBBLER\r\n
}
void MainWindow::on_p_API_STOPMACRO_clicked() {
    tmpstr.clear();

    if (APIid == none) {
        APIactive = 1;
        APIid = cSTOPMACRO;

        tmpstr = API_WOSTOP;
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_API_setWOLMP_clicked() {
    tmpstr.clear();

    APIactive = 1;

    QString intensity = ui->line_api_wolampintensity->text();
    tmpstr = API_WOBLMP;
    tmpstr.append(intensity.toLatin1());
    tmpstr.append("\r\n");
    serialSendAPI(tmpstr);
}
void MainWindow::on_verticalSlider_API_WOBlamp_valueChanged(int value) {
    ui->line_api_wolampintensity->setText(QString::number(value));
}
void MainWindow::on_p_API_GetFNres_clicked() {
    if (APIid == none) {
        APIpassive = 1;
        APIid = cGETFNRES;

        serialSendAPI(API_GETFNRES);
    }
}
void MainWindow::on_p_API_START_clicked(bool checked) {
    qDebug() << "checked" << checked;

    if (checked) {
        ui->p_API_START->setText("STOP");
        ui->p_API_START->setStyleSheet(backYello);
        int ret = msgboxOK("Press OK to start or press CANCEL");
        if (ret == 0) {
            API_LOOP = 1;
            macro_profil = 0; // Sicherheitshalber alle störenden Flags ausschalten
            assistant_wc = 0;
            loopoff = 0;
            api_loop();
        } else
            on_p_API_START_clicked(0);
    } else {
        ui->p_API_START->setText("START");
        ui->p_API_START->setChecked(0);
        ui->p_API_START->setStyleSheet(col_greywhite);
        loopoff = 1;
        if (APIid == none && API_LOOP == 1)
            api_loop();
    }
}
void MainWindow::api_loop() // Feederloop ohne MIC und Stage
{
    static int cycle = 0;
    static bool transfer = 0; // 1=Transferposition ok

  /*  manuell vorab INIT - IN - SETCAR - MAP Lift -> select Waferslots
   *  Ablauf: GET Wafer aus ersten selektierten Slot -> PUT Wafer auf Aligner
   *  bei Option Stage wird Wafer1 auf Stage gelegt und Wafer2 aus Slot auf
   *  Aligner gebracht (Route=2) ohne Option Stage wird Wafer1 zurück in den Slot
   *  gebracht (Route=1) API_LOOP Flag 1=Loop aktiv loopoff 1=Loop beenden (wird
   *  von Button Stop gesetzt) Chwaf   99=Initialisierung idxwaf  Index des GET
   *  Wafers idxloop1 Index auf selektierte Slotnr Lift1 Mini-Materialmanagement:
   *  idxwaf->PAwaf
   *  CHwaf
   *  Wafer auf Stage wird
   */
    qDebug() << "idxwaf" << idxwaf << "PAwaf" << PAwaf << "CHwaf" << CHwaf
             << "cycle" << cycle;

    //    int counter = 1;
    //    while(counter < 50000000) counter++;

    switch (cycle)
    {
    case 0:             // Wafer1 aus Slot Wafer1
        if (loopoff == 0) // loopoff=1 -> Loop beenden
        {
            on_p_API_Get_clicked(); // GET Lift -> Put Aligner
            cycle = 1;
        }
        else if (CHwaf == 99) // Abbruch: kein Wafer auf der Stage
        {
            API_LOOP = 0;
            if (APIlooptimer->isActive()) APIlooptimer->stop();
        }
        else
        {
            on_p_API_PREWC_clicked(); // Abbruch: Wafer von der Stage holen
            cycle = 10;
        }
        break;
    case 1:                                      // Wafer1 auf Aligner
        PAwaf = idxwaf;                            // wafSlotnr auf Aligner
        if (ui->check_API_loop_align->isChecked()) // Option Wafer aligen
        {
            on_p_API_Align_clicked();
            cycle = 2;
            break;
        }
    case 2:
        if (ui->check_API_loop_macro->isChecked()) // Option Macro
        {
            on_p_API_SETMACRO_clicked();
            cycle = 30;
            break;
        }
    case 4:
        if (ui->check_API_loop_stage->isChecked())
        {
            if (transfer == 0)
            {
                int ret = msgboxOK("Transferposition ok? Press CANCEL if not okay");
                if (ret == 0)
                {
                    on_p_API_PREWC_clicked(); // Wafer auf den Chuck legen
                    transfer = 1;
                    cycle = 10;
                    break;
                } else // bei Abbruch Wafer wieder entladen
                {
                    on_p_API_getaligner_clicked();
                    cycle = 20; // Carrier entladen
                    break;
                }
            }
            else
            {
                on_p_API_PREWC_clicked(); // Wafer auf den Chuck legen
                cycle = 10;
                break;
            }
        }
    case 5:
        on_p_API_getaligner_clicked(); // GET Aligner PUT_Slot idxwaf
        cycle = 0;                     // neuer Zyklus
        break;
        // -------- Option Stage ------------------
    case 10:
        if (PAwaf == 99) // kein Wafer auf dem Aligner
        {
            on_p_API_Get_clicked(); // nächsten Wafer holen
            cycle = 1;              // zweiter Wafer im Loop
        }
        else
        {
            on_p_API_getaligner_clicked(); // Wafer zurück in den Slot PAwaf
            qDebug() << "PAwaf" << PAwaf;
            cycle = 0;
        }
        break;
    case 20:
        on_p_API_UNLOAD_clicked();
        cycle = 21;
        break;
    case 21:
        assistant_wc = 0;
        transfer = 0;
        cycle = 0;
        break;
        // timeout für Macrodauer
    case 30:
        APIlooptimer->start(ui->line_API_macro_time->text().toInt(&ok, 10) * 1000);
        cycle = 31;
        break;
    case 31:
        if (APIlooptimer->isActive()) APIlooptimer->stop();
        on_p_API_STOPMACRO_clicked();
        cycle = 4;
    }
}
void MainWindow::on_check_API_servicemode_stateChanged(int arg1) {
    APIcmdtimeout = 2000;
    tmpstr = 0;

    if (APIid == none) {
        APIpassive = 1;
        APIid = cSERVICE;
        if (arg1 == 2)
            tmpstr = API_SERVICE1; // @SERVICE_M=1
        else
            tmpstr = API_SERVICE0; // @SERVICE_M=0
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_check_API_servicefriction_stateChanged(int arg1) {
    tmpstr = 0;
    tmpstr.append("$SET_27="); // options.friction setzen
    if (arg1 == 2)
        tmpstr.append("1");
    else
        tmpstr.append("0");
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_check_api_pollingtest1_stateChanged(int arg1) {
    if (arg1) {
        API_POLLTEST = 1;
        api_poll();
    } else
        API_POLLTEST = 0;
}
void MainWindow::api_poll() {
    static int cycle = 0;

    qDebug() << "poll cycle" << cycle;

    if (cycle < 4) {
        cycle++;
        on_p_API_IN_clicked();
    } else {
        cycle = 0;
        on_p_API_GETOUT_clicked();
    }
}
void MainWindow::on_p_API_twidelay_clicked() {
    if (APIid == none) {
        APIcmdtimeout = 2000;
        tmpstr = 0;

        ui->p_API_twidelay->setStyleSheet(backLightGrey);

        APIpassive = 1;
        APIid = cTWI;
        tmpstr = API_TWIdelay;
        tmpstr.append(ui->line_twidelay->text().toLatin1());
        tmpstr.append("\r\n");
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_API_getstate_clicked() {
    if (APIid == none) {
        APIcmdtimeout = 2000;
        tmpstr = 0;

        ui->p_API_getstate->setStyleSheet(backLightGrey);

        APIpassive = 1;
        APIid = cGETSTATE;
        tmpstr = API_GETSTATE;
        serialSendAPI(tmpstr);
    }
}
void MainWindow::on_p_start_assistant_wc_2_clicked() {
    on_p_start_assistant_wc_clicked();
}
void MainWindow::on_check_API_activate_assistant_stateChanged(int arg1) {
    if (arg1) {
        ui->frame_API_assistant->show();
    //    ui->check_API_activate_assistant->setText("deactivate\nsetup\nassistant");
    } else {
        ui->frame_API_assistant->hide();
    //    ui->check_API_activate_assistant->setText("activate\nsetup\nassistant");
    }
}
// ---------------- macros -----------------------------
void MainWindow::on_p_macros_openmacro_clicked() {
    QString dir;
    if (QFileInfo::exists(macrofile))
        dir = macrofile;
    else
        err_msgbox("Can not open. Check path to macro files");
    DATA2OPEN = QFileDialog::getOpenFileName(
                this, tr("Open *.mcf"), dir, tr("inifile (*.mcf);;All Files (*)"));

    QFile mf(DATA2OPEN); // Macro einlesen
    if (!mf.open(QIODevice::ReadOnly | QIODevice::Text))
        return;
    ui->line_macros_selectedfile->setText(mf.fileName());
    line.clear();
    ui->plainTextEdit_macroviewer->clear();
    while (!mf.atEnd()) {
        line = mf.readLine();
        ui->plainTextEdit_macroviewer->appendPlainText(line.trimmed());
    }
    mf.close();
}
void MainWindow::on_combo_cmd_2_currentTextChanged(const QString &arg1) {
    qDebug() << "CMD text" << arg1;
    setfuicombo_2(arg1);
}
void MainWindow::on_combo_node_2_currentTextChanged(const QString &arg1) {
    if (arg1 == "2")
        ui->combo_node_2->setToolTip(
                    "Cass4 Sensor-2\nCass5 Sensor-2\nCass6 Sensor-2\nCass8 "
                    "Sensor-2\nLift2TiltEndPos\nLift2TiltEndNeg\nLift2-Height "
                    "MOTOR1\nLift2-Tilt MOTOR2");
    if (arg1 == "3")
        ui->combo_node_2->setToolTip(
                    "Cass4 Sensor-1\nCass5 Sensor-1\nCass6 Sensor-1\nCass8 "
                    "Sensor-1\nLift1TiltEndPos\nLift1TiltEndNeg\nLift1-Height "
                    "MOTOR1\nLift1-Tilt MOTOR2\nPA-HEIGHT MOTOR3");
    if (arg1 == "4")
        ui->combo_node_2->setToolTip(
                    "Wafer4 Sensor\nWafer5 Sensor-2\nWafer6 Sensor-2\nWafer8 "
                    "Sensor-2\nLift2TiltEndPos\nLift2TiltEndNeg\nPA-RotPos MOTOR1\nPA-Phi "
                    "MOTOR2\nPA-WOTilt MOTOR3");
    if (arg1 == "5")
        ui->combo_node_2->setToolTip("LD-X MOTOR1\nLD-Y MOTOR2\nWC-Height MOTOR3");
    if (arg1 == "6")
        ui->combo_node_2->setToolTip("WC-Phi MOTOR3");
    if (arg1 == "7")
        ui->combo_node_2->setToolTip(
                    "Lift1Lock\nLift2Lock\nWobbleLampIntensity\nWobbleLamp 2\nAC Relais "
                    "1\nVacuumgroup\nLD-Vacuum\nWC1-Vacuum\nWC2-Vacuum\nPA-Vacuum");
    if (arg1 == "8")
        ui->combo_node_2->setToolTip(
                    "MainVacuum\nMicroscopeLampMonitor\nExistencesensor3\nWobbleLamp\nTower"
                    "Lamp1\nTowerLamp2\nTowerLamp3\nTowerHorn\nTowerSpare\nVacuumgroup\nChu"
                    "ck4-Vacuum\nChuck6-Vakuum\nChuck8-Vacuum");
    if (arg1 == "15")
        ui->combo_node_2->setToolTip("PA-Measunit");

    setfuicombo_2(arg1);
}
void MainWindow::on_combo_fui_2_currentTextChanged(const QString &arg1)
{
    qDebug() << "FUI text " << arg1;

    if (arg1 == "BOARD") FUI = "0";
    else if (arg1 == "MOTOR1") FUI = "1";
    else if (arg1 == "MOTOR2") FUI = "2";
    else if (arg1 == "MOTOR3") FUI = "3";
    else if (arg1 == "TEMPERATURE") FUI = "4";
    else if (arg1 == "VOLTAGE1") FUI = "5";
    else if (arg1 == "VOLTAGE2") FUI = "6";
    else if (arg1 == "VOLTAGE3") FUI = "7";
    else if (arg1 == "VOLTAGE4") FUI = "8";
    else if (arg1 == "INPORT1") FUI = "9";
    else if (arg1 == "INPORT2") FUI = "10";
    else if (arg1 == "OUTPORT") FUI = "11";
    else if (arg1 == "INBIT1") FUI = "12";
    else if (arg1 == "INBIT2") FUI = "13";
    else if (arg1 == "INBIT3") FUI = "14";
    else if (arg1 == "INBIT4") FUI = "15";
    else if (arg1 == "INBIT5") FUI = "16";
    else if (arg1 == "INBIT6") FUI = "17";
    else if (arg1 == "INBIT7") FUI = "18";
    else if (arg1 == "INBIT8") FUI = "19";
    else if (arg1 == "INBIT9") FUI = "20";
    else if (arg1 == "INBIT10") FUI = "21";
    else if (arg1 == "INBIT11") FUI = "22";
    else if (arg1 == "INBIT12") FUI = "23";
    else if (arg1 == "INBIT13") FUI = "24";
    else if (arg1 == "INBIT14") FUI = "25";
    else if (arg1 == "OUTBIT1") FUI = "26";
    else if (arg1 == "OUTBIT2") FUI = "27";
    else if (arg1 == "OUTBIT3") FUI = "28";
    else if (arg1 == "OUTBIT4") FUI = "29";
    else if (arg1 == "OUTBIT5") FUI = "30";
    else if (arg1 == "OUTBIT6") FUI = "31";
    else if (arg1 == "OUTBIT7") FUI = "32";
    else if (arg1 == "OUTBIT8") FUI = "33";
    else if (arg1 == "SWITCH1") FUI = "34";
    else if (arg1 == "SWITCH2") FUI = "35";
    else if (arg1 == "SWITCH3") FUI = "36";
    else if (arg1 == "SWITCH4") FUI = "37";
    else if (arg1 == "SWITCH5") FUI = "38";
    else if (arg1 == "SWITCH6") FUI = "39";
    else if (arg1 == "SWITCH7") FUI = "40";
    else if (arg1 == "SWITCH8") FUI = "41";
    else if (arg1 == "TOWERLP1" || arg1 == "TowerLamp1") FUI = "42";
    else if (arg1 == "TOWERLP2" || arg1 == "TowerLamp2") FUI = "43";
    else if (arg1 == "TOWERLP3" || arg1 == "TowerLamp3") FUI = "44";
    else if (arg1 == "TOWERHN1" || arg1 == "TowerHorn") FUI = "45";
    else if (arg1 == "SWITCH13") FUI = "46";
    else if (arg1 == "SWITCH14") FUI = "47";
    else if (arg1 == "SWITCH15") FUI = "48";
    else if (arg1 == "SWITCH16") FUI = "49";
    else if (arg1 == "PWM_OUTPUT1") FUI = "50";
    else if (arg1 == "PWM_OUTPUT2" || arg1 == "WobbleLamp") FUI = "51";
    else if (arg1 == "PWM_OUTPUT3") FUI = "52";
    else if (arg1 == "ANALOG_INPUT1") FUI = "53";
    else if (arg1 == "ANALOG_INPUT2") FUI = "54";
    else if (arg1 == "ANALOG_INPUT3") FUI = "55";
    else if (arg1 == "ANALOG_INPUT4") FUI = "56";
    else if (arg1 == "ANALOG_INPUT5") FUI = "57"; // Mainvacuum
    else if (arg1 == "ANALOG_INPUT6") FUI = "58";
    else if (arg1 == "ANALOG_INPUT7") FUI = "59";
    else if (arg1 == "VACUUMSWITCH1" || arg1 == "vacSwitchChuck4") FUI = "60";
    else if (arg1 == "VACUUMSWITCH2" || arg1 == "vacSwitchChuck5") FUI = "61";
    else if (arg1 == "VACUUMSWITCH3" || arg1 == "vacSwitchChuck6") FUI = "62";
    else if (arg1 == "VACUUMSWITCH4" || arg1 == "vacSwitchChuck8") FUI = "63";
    else if (arg1 == "VACUUMSWITCH5") FUI = "64";
    else if (arg1 == "VACUUMSWITCH6") FUI = "65";
    else if (arg1 == "VACUUMSWITCH7") FUI = "66";
    else if (arg1 == "VACUUMUNIT1" || arg1 == "vacUnitChuck4") FUI = "67";
    else if (arg1 == "VACUUMUNIT2") FUI = "68";
    else if (arg1 == "VACUUMUNIT3") FUI = "69";
    else if (arg1 == "VACUUMUNIT4") FUI = "70";
    else if (arg1 == "VACUUMUNIT5") FUI = "71";
    else if (arg1 == "VACUUMUNIT6") FUI = "72";
    else if (arg1 == "VACUUMUNIT7") FUI = "73";
    else if (arg1 == "LIFT_LOCK1") FUI = "74";
    else if (arg1 == "LIFT_LOCK2") FUI = "75";
    else if (arg1 == "SENSOR_VALUE1") FUI = "76";
    else if (arg1 == "SENSOR_VALUE2") FUI = "77";
    else if (arg1 == "SENSOR_VALUE3") FUI = "78";
    else if (arg1 == "SENSOR_VALUE4") FUI = "79";
    else if (arg1 == "AMPL_SENSOR1") FUI = "80";
    else if (arg1 == "AMPL_SENSOR2") FUI = "81";
    else if (arg1 == "AMPL_SENSOR3") FUI = "82";
    else if (arg1 == "AMPL_SENSOR4") FUI = "83";
    else if (arg1 == "EXISTENCESENSOR1") FUI = "84";
    else if (arg1 == "EXISTENCESENSOR2") FUI = "85";
    else if (arg1 == "EXISTENCESENSOR3") FUI = "86";
    else if (arg1 == "EXISTENCESENSOR4") FUI = "87";
    else if (arg1 == "VACUUMGROUP") FUI = "88";
    else if (arg1 == "EMERGENCYSTOP") FUI = "89";
    else if (arg1 == "BOARD_REVISION") FUI = "90";
    else if (arg1 == "MEASUNIT") FUI = "92";
    else if (arg1 == "MEASTRANSMITTER") FUI = "93";
    else if (arg1 == "CHANGE_STATUS") FUI = "199";
    else if (arg1 == "POWER_FAIL") FUI = "200";
    else if (arg1 == "MOT_POWER_FAIL") FUI = "201";
    else if (arg1 == "DCDC_POWER_OK") FUI = "202";
    else if (arg1 == "LIFT") FUI = "210";
    else if (arg1 == "TASK_0") FUI = "250";
    else if (arg1 == "TASK_1") FUI = "251";
    else if (arg1 == "TASK_2") FUI = "252";

    showMessageData_2();
}
void MainWindow::setfuicombo_2(QString cmd) // liest Files mit FUI-Namen ein
{

    qDebug() << cmd;
    if (cmd == "2" || cmd == "3" || cmd == "4" || cmd == "5" || cmd == "6") {
      //  qDebug() << "fuifile" << fuifile7 << "xcmdfile" << xcmdfile;
        if (fuifile7.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_cmd_2->clear();
            while (!fuifile7.atEnd()) {
                fuiline = fuifile7.readLine();
                ui->combo_cmd_2->addItem(fuiline.trimmed());
            }
            fuifile7.close();
        }
    } else if (cmd == "7" || cmd == "8") {
        if (fuifile6.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_cmd_2->clear();
            while (!fuifile6.atEnd()) {
                fuiline = fuifile6.readLine();
                ui->combo_cmd_2->addItem(fuiline.trimmed());
            }
            fuifile6.close();
        }
    } else if (cmd == "15") {
        if (fuifile8.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_cmd_2->clear();
            while (!fuifile8.atEnd()) {
                fuiline = fuifile8.readLine();
                ui->combo_cmd_2->addItem(fuiline.trimmed());
            }
            fuifile8.close();
        }
    } else if (cmd == "POS_ABS") {
        if (fuifile1.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile1.atEnd()) {
                fuiline = fuifile1.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile1.close();
        }
        //        ui->label_posconst->show();
        //        ui->line_macros_posconst1->show();
        //        ui->line_macros_posconst2->show();
        //        ui->line_macros_posconst3->show();
        //        ui->line_macros_posconst4->show();
    } else if (cmd == "POS_CONST") {
        if (fuifile1.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile1.atEnd()) {
                fuiline = fuifile1.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile1.close();
        }
        //        ui->label_posconst->show();
        //        ui->line_macros_posconst1->show();
        //        ui->line_macros_posconst2->show();
        //        ui->line_macros_posconst3->show();
        //        ui->line_macros_posconst4->show();
    } else if (cmd == "READ_POS") {
        if (fuifile1.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile1.atEnd()) {
                fuiline = fuifile1.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile1.close();
        }
    } else if (cmd == "SET_VALUE" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) == 15) {
        if (fuifile11.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile11.atEnd()) {
                fuiline = fuifile11.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile11.close();
        }
    } else if (cmd == "SET_VALUE" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) == 7) {
        if (fuifile9.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile9.atEnd()) {
                fuiline = fuifile9.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile9.close();
        }
    } else if (cmd == "SET_VALUE" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) == 8) {
        if (fuifile9_2.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile9_2.atEnd()) {
                fuiline = fuifile9_2.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile9_2.close();
        }
    } else if (cmd == "SET_VALUE" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) < 7) {
        if (fuifile10.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile10.atEnd()) {
                fuiline = fuifile10.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile10.close();
        }
    } else if (cmd == "GET_VALUE" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) < 7) {
        if (fuifile4.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile4.atEnd()) {
                fuiline = fuifile4.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile4.close();
        }
    } else if (cmd == "GET_VALUE" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) == 15) {
        if (fuifile3.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile3.atEnd()) {
                fuiline = fuifile3.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile3.close();
        }
    } else if (cmd == "GET_VALUE" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) > 6 &&
               ui->combo_node_2->currentText().toInt(&ok, 10) < 15) {
        if (fuifilemacro.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifilemacro.atEnd()) {
                fuiline = fuifilemacro.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifilemacro.close();
        }
    } else if (cmd == "RESET_UNIT" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) < 7) {
        ui->combo_fui_2->clear();
        ui->combo_fui_2->addItem("BOARD");
        if (fuifile1.open(QIODevice::ReadOnly | QIODevice::Text)) {
            while (!fuifile1.atEnd()) {
                fuiline = fuifile1.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile1.close();
        }
    } else if (cmd == "RESET_UNIT" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) > 6 &&
               ui->combo_node_2->currentText().toInt(&ok, 10) < 15) {
        ui->combo_fui_2->clear();
        ui->combo_fui_2->addItem("BOARD");
        ui->combo_fui_2->addItem("EMERGENCYSTOP");
    } else if (cmd == "RESET_UNIT" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) == 15) {
        ui->combo_fui_2->clear();
        ui->combo_fui_2->addItem("BOARD");
    } else if ((cmd == "SET_PARAMETER" || cmd == "GET_PARAMETER") &&
               ui->combo_node_2->currentText().toInt(&ok, 10) < 7) // Motorboards
    {
        if (fuifile12.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile12.atEnd()) {
                fuiline = fuifile12.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile12.close();
        }
    } else if ((cmd == "SET_PARAMETER" || cmd == "GET_PARAMETER") &&
               ui->combo_node_2->currentText().toInt(&ok, 10) == 15) // Board 15
    {
        if (fuifile14.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile14.atEnd()) {
                fuiline = fuifile14.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile14.close();
        }
    } else if ((cmd == "SET_PARAMETER" || cmd == "GET_PARAMETER") &&
               ui->combo_node_2->currentText().toInt(&ok, 10) > 6 &&
               ui->combo_node_2->currentText().toInt(&ok, 10) <
               15) // Sensorboards
    {
        if (fuifile13.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile13.atEnd()) {
                fuiline = fuifile13.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile13.close();
        }
    } else if (cmd == "CALIBRATE" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) < 4) {
        if (fuifile15.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile15.atEnd()) {
                fuiline = fuifile15.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile15.close();
        }
    } else if (cmd == "CALIBRATE" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) > 3 &&
               ui->combo_node_2->currentText().toInt(&ok, 10) < 7) {
        ui->combo_fui_2->clear();
    } else if (cmd == "CALIBRATE" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) > 6 &&
               ui->combo_node_2->currentText().toInt(&ok, 10) < 15) {
        if (fuifile16.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile16.atEnd()) {
                fuiline = fuifile16.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile16.close();
        }
    } else if (cmd == "CALIBRATE" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) == 15) {
        if (fuifile17.open(QIODevice::ReadOnly | QIODevice::Text)) {
            ui->combo_fui_2->clear();
            while (!fuifile17.atEnd()) {
                fuiline = fuifile17.readLine();
                ui->combo_fui_2->addItem(fuiline.trimmed());
            }
            fuifile17.close();
        }
    } else if (cmd == "LIFT_POS" &&
               ui->combo_node_2->currentText().toInt(&ok, 10) < 4) {
        ui->combo_fui_2->clear();
        ui->combo_fui_2->addItem("LIFT");
    } else if (cmd == "LIFT_INVENTORY") {
        ui->combo_fui_2->clear();
        ui->combo_fui_2->addItem("LIFT");
    }
}
void MainWindow::showMessageData_2() {
    //    hidedatabox();
    qDebug() << "CMD " << ui->combo_cmd_2->currentText();
    if (ui->combo_cmd_2->currentText() == "POS_ABS") {
        CMD = "1";
        //        ui->line_data1->show();
        //        ui->label_data1->setText("AbsPOS");
        //        ui->label_data1->show();
        //        ui->line_data2->show();
        //        ui->label_data2->setText("MotParam");
        //        ui->label_data2->show();
    } else if (ui->combo_cmd_2->currentText() == "POS_CONST") {
        CMD = "2";
        //        ui->line_data1->show();
        //        ui->label_data1->setText("const speed");
        //        ui->label_data1->show();
    } else if (ui->combo_cmd_2->currentText() == "READ_POS") {
        CMD = "3";
        //        ui->p_xrac_send->setEnabled(1);
    } else if (ui->combo_cmd_2->currentText() == "SET_VALUE") {
        CMD = "4";
        //        ui->line_data1->show();
        //        ui->label_data1->setText("Value");
        //        ui->label_data1->show();
    } else if (ui->combo_cmd_2->currentText() == "GET_VALUE") {
        CMD = "5";
        //        ui->p_xrac_send->setEnabled(1);
    } else if (ui->combo_cmd_2->currentText() == "SET_PARAMETER") {
        CMD = "6";
        //        if(ui->combo_fui->currentText() == "LIFT")
        //        {
        //            ui->check_param1->show();
        //            ui->check_param2->show();
        //        }
        //        else if(ui->combo_fui->currentText().left(5) == "MOTOR")
        //        {
        //            ui->check_param1->show();
        //            ui->check_param2->show();
        //        }
    } else if (ui->combo_cmd_2->currentText() == "GET_PARAMETER") {
        CMD = "7";
        //        if(ui->combo_fui->currentText() == "LIFT")
        //        {
        //            ui->check_param1->show();
        //            ui->check_param2->show();
        //        }
        //        else if(ui->combo_fui->currentText().left(5) == "MOTOR")
        //        {
        //            ui->check_param1->show();
        //            ui->check_param2->show();
        //        }
        // ui->p_xrac_send->setEnabled(1);
    } else if (ui->combo_cmd_2->currentText() == "READ_INFO") {
        CMD = "8";
        //        ui->p_xrac_send->setEnabled(1);
    } else if (ui->combo_cmd_2->currentText() == "RESET_UNIT")
        CMD = "9";
    else if (ui->combo_cmd_2->currentText() == "FN_BREAK")
        CMD = "10";
    else if (ui->combo_cmd_2->currentText() == "WAIT_CHANGE")
        CMD = "11";
    else if (ui->combo_cmd_2->currentText() == "LOAD_MODE")
        CMD = "12";
    else if (ui->combo_cmd_2->currentText() == "DOWN_LOAD")
        CMD = "13";
    else if (ui->combo_cmd_2->currentText() == "UP_LOAD")
        CMD = "14";
    else if (ui->combo_cmd_2->currentText() == "READ_MEM")
        CMD = "15";
    else if (ui->combo_cmd_2->currentText() == "CLEAR_MSGS")
        CMD = "16";
    else if (ui->combo_cmd_2->currentText() == "CALIBRATE")
        CMD = "17";
    else if (ui->combo_cmd_2->currentText() == "LIFT_INVENTORY") {
        CMD = "18";
        //        ui->line_data1->show();
        //        ui->label_data1->setText("StartSlot");
        //        ui->label_data1->show();
        //        ui->line_data2->show();
        //        ui->label_data2->setText("StopSlot");
        //        ui->label_data2->show();
    } else if (ui->combo_cmd_2->currentText() == "LIFT_POS") {
        CMD = "19";
        //        ui->line_data1->show();
        //        ui->label_data1->setText("W/F height");
        //        ui->label_data1->show();
        //        ui->line_data2->show();
        //        ui->label_data2->setText("Slotnr.");
        //        ui->label_data2->show();
    }
}
void MainWindow::on_p_macros_addcmd_clicked()
{
    qDebug() << "CMD add" << CMD;
    int tmpval;
    int arr[4];
    QString task = "0";
    QString vnode = ui->combo_node_2->currentText();
    QString vcmd = ui->combo_cmd_2->currentText();
    QString vfui = ui->combo_fui_2->currentText();

    tmpval = ui->line_macros_possteps->text().toInt(&ok, 10);

    int *byte = dez2byte(tmpval, arr);

    if (CMD == "2" || CMD == "1") tmpval = byte[3] + byte[2] + byte[1] + byte[0];
    else tmpval = ui->line_macros_MSB->text().toUInt(&ok, 10) * 256 + ui->line_macros_LSB->text().toUInt(&ok, 10);
    QString vvalue = QString::number(tmpval);

    //    qDebug()<<"tmpval"<<tmpval<<"vvalue"<<vvalue;

    if (vfui != "LIFT") task = "1";
    else task = "2";
    tmpstr = "&X0,0,";
    tmpstr.append(vnode.toLatin1());
    tmpstr.append(",");
    tmpstr.append(task.toLatin1());
    tmpstr.append(",0,0,0,");
    tmpstr.append(CMD.toLatin1());
    tmpstr.append(",");
    tmpstr.append(FUI.toLatin1());
    if (CMD > "3" && CMD != "5" && CMD != "8") // 3=READ_POS, 5=GET_VALUE, 8=READ_INFO
    {
        tmpstr.append(",");
        tmpstr.append(ui->line_macros_MSB->text().toLatin1());
        tmpstr.append(",");
        tmpstr.append(ui->line_macros_LSB->text().toLatin1());
    }
    else if (CMD == "2" || CMD == "1") // 1=POS-ABS und 2=POS CONST
    {
        tmpstr.append(",");
        tmpstr.append(QString::number(byte[3]).toLatin1());
        tmpstr.append(",");
        tmpstr.append(QString::number(byte[2]).toLatin1());
        tmpstr.append(",");
        tmpstr.append(QString::number(byte[1]).toLatin1());
        tmpstr.append(",");
        tmpstr.append(QString::number(byte[0]).toLatin1());
        tmpstr.append(",");
        tmpstr.append(ui->spinBox_macro_motpara->text().toLatin1());
    }
    //   tmpstr.append("\r");

    if (CMD > "3" && CMD != "5" && CMD != "8") ui->plainTextEdit_macroviewer->appendPlainText("node" + vnode + " " + vcmd + " " + vfui + " " + vvalue + " -> " + tmpstr);
    else if (CMD == "2" || CMD == "1") ui->plainTextEdit_macroviewer->appendPlainText("node" + vnode + " " + vcmd + " " + vfui + " " + vvalue + " -> " + tmpstr);
    else ui->plainTextEdit_macroviewer->appendPlainText("node" + vnode + " " + vcmd + " " + vfui + " " + " -> " + tmpstr);
}
void MainWindow::on_p_macros_save_clicked()
{
    QString dir;
    if (QFileInfo::exists(macrofile)) dir = macrofile;
    else err_msgbox("Can not open. Check path to macro files");

    QString fileName = QFileDialog::getSaveFileName(this, tr("Save File"), dir + "untitled.mcf", tr("macro (*.mcf)"));
    if (fileName.isEmpty()) return;
    else
    {
        QFile file(fileName);
        if (!file.open(QFile::WriteOnly | QFile::Text))
        {
            QMessageBox::information(this, tr("Unable to open file"),file.errorString());
            return;
        }
        QTextStream out(&file);
        auto parts = ui->plainTextEdit_macroviewer->toPlainText().split(QRegularExpression("[\n]"), Qt::SkipEmptyParts);
        countmacro = parts.count();
        qDebug() << "countmacro" << countmacro;
        for (int i = 0; i < countmacro; ++i)
        {
            qDebug() << "cline" << parts[i];
            out << parts[i];
            out << "\r\n";
        }
        file.close();
    }
}
void MainWindow::on_p_macros_adddelay_clicked()
{
    QString delay;
    int sec;
    int ms;
    sec = ui->line_macro_delays->text().toInt(&ok, 10);
    ms = ui->line_macro_delayms->text().toInt(&ok, 10);
    if (sec) sec *= 1000;
    delay = QString::number(sec + ms);
    ui->plainTextEdit_macroviewer->appendPlainText("delay " + delay + "ms");
}
void MainWindow::on_p_macros_runmacro_clicked()
{
    if (macromacro == 0)
    {
        macromacro = 1;
        mstep2 = 0;
        auto parts = ui->plainTextEdit_macroviewer->toPlainText().split(QRegularExpression("[\n]"), Qt::SkipEmptyParts);
        countmacro = parts.count();
        qDebug() << "countmacro" << countmacro;
        if (countmacro > 25)
        {
            err_msgbox("macro exceeds max. lines (25)");
            countmacro = 0;
        }
        else
        {
            for (int i = 0; i < countmacro; i++)
            {
                if (parts[i].left(5) == "delay")
                {
                    mmaker[i] = parts[i].left(parts[i].length() - 2).mid(parts[i].indexOf("y") + 2);
                }
                else mmaker[i] = parts[i].mid(parts[i].indexOf("&"));
            }
            f_macromaker();
        }
    }
    else err_msgboxplusOK("macro is already running. Restart?");
}
void MainWindow::f_macrocheck() // nach delay Macro beenden oder weiter
{
    qDebug() << "macromacro:" << macromacro << "countmacro:" << countmacro
             << "in mstep2:" << mstep2;
    if (countmacro >= (mstep2 + 2))
        ++mstep2;
    else if (ui->check_ma_loop->isChecked())
        mstep2 = 0;
    else
        macromacro = 0;
  //  err_msgbox("countmacro: "+QString::number(countmacro)+" mstep2:
    //  "+QString::number(mstep2));
    qDebug() << "macromacro:" << macromacro << "countmacro:" << countmacro
             << "out mstep2:" << mstep2;
    f_macromaker();
}
void MainWindow::f_macromaker()
{
    QByteArray send;

    feedertimeout = 60000;

    if (macromaker->isActive()) macromaker->stop();

    //    qDebug()<<"out mstep2"<<mstep2<<"timer stop"<<macromaker->isActive();

    if (macromaker->isActive() == 0)
    {
        send.clear();
        if (macromacro) {
            ui->p_macros_runmacro->setStyleSheet(backLightGreen);
            switch (mstep2) {
            case 0:
                if (mmaker[0].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[0].toLatin1() + ",\r\n"));
                else
                    macromaker->start(mmaker[0].toInt(&ok, 10));
                break;
            case 1:
                if (mmaker[1].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[1].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[1].toInt(&ok, 10));
                }
                break;
            case 2:
                if (mmaker[2].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[2].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[2].toInt(&ok, 10));
                }
                break;
            case 3:
                if (mmaker[3].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[3].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[3].toInt(&ok, 10));
                }
                break;
            case 4:
                if (mmaker[4].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[4].toLatin1() + ",\r\n"));
                else if (mmaker[4].left(5) == "delay")
                {
                    macromaker->start(mmaker[4].toInt(&ok, 10));
                }
                break;
            case 5:
                if (mmaker[5].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[5].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[5].toInt(&ok, 10));
                }
                break;
            case 6:
                if (mmaker[6].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[6].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[6].toInt(&ok, 10));
                }
                break;
            case 7:
                if (mmaker[7].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[7].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[7].toInt(&ok, 10));
                }
                break;
            case 8:
                if (mmaker[8].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[8].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[8].toInt(&ok, 10));
                }
                break;
            case 9:
                if (mmaker[9].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[9].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[9].toInt(&ok, 10));
                }
                break;
            case 10:
                if (mmaker[10].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[10].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[10].toInt(&ok, 10));
                }
                break;
            case 11:
                if (mmaker[11].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[11].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[11].toInt(&ok, 10));
                }
                break;
            case 12:
                if (mmaker[12].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[12].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[12].toInt(&ok, 10));
                }
                break;
            case 13:
                if (mmaker[13].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[13].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[13].toInt(&ok, 10));
                }
                break;
            case 14:
                if (mmaker[14].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[14].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[14].toInt(&ok, 10));
                }
                break;
            case 15:
                if (mmaker[15].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[15].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[15].toInt(&ok, 10));
                }
                break;
            case 16:
                if (mmaker[16].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[16].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[16].toInt(&ok, 10));
                }
                break;
            case 17:
                if (mmaker[17].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[17].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[17].toInt(&ok, 10));
                }
                break;
            case 18:
                if (mmaker[18].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[18].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[18].toInt(&ok, 10));
                }
                break;
            case 19:
                if (mmaker[19].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[19].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[19].toInt(&ok, 10));
                }
                break;
            case 20:
                if (mmaker[20].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[20].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[20].toInt(&ok, 10));
                }
                break;
            case 21:
                if (mmaker[21].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[21].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[21].toInt(&ok, 10));
                }
                break;
            case 22:
                if (mmaker[22].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[22].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[22].toInt(&ok, 10));
                }
                break;
            case 23:
                if (mmaker[23].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[23].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[23].toInt(&ok, 10));
                }
                break;
            case 24:
                if (mmaker[24].left(1) == "&")
                    serialSendFeeder(send.append(mmaker[24].toLatin1() + ",\r\n"));
                else {
                    macromaker->start(mmaker[24].toInt(&ok, 10));
                }
                break;
            default:
                macromacro = 0;
            }
        }
        else
        {
            ui->p_macros_runmacro->setStyleSheet(col_greywhite);
            mstep2 = 0;
        }
    }
}
void MainWindow::on_p_macros_clear_clicked()
{
    ui->plainTextEdit_macroviewer->clear();
}
void MainWindow::on_p_macros_clearresponse_clicked()
{
    ui->plainTextEdit_macroresponse_setget->clear();
}
void MainWindow::on_p_macros_clearresponse_posconst_clicked()
{
    ui->plainTextEdit_macroresponse_posconst->clear();
}
void MainWindow::on_p_macros_clearresponse_posabs_clicked()
{
    ui->plainTextEdit_macroresponse_posabs->clear();
}
void MainWindow::on_p_macros_clearresponse_readpos_clicked()
{
    ui->plainTextEdit_macroresponse_readpos->clear();
}
void MainWindow::on_p_macros_testlift1height_clicked()
{
    if (ui->radio_lift1_default->isChecked())
    {
        int L1Hoper = ui->line_lift1_unload_height->text().toInt(&ok, 10);
        int L1Hsensor = ui->line_lift1_wafersensor_height->text().toInt(&ok, 10);
        int L1Hxy = ui->line_lift1_xyloader_height->text().toInt(&ok, 10);

        f_macros_stopmacro_clicked(); // alle Testmakros stoppen

        QString task = "1";
        QString node = "3"; // Node 3
        QString cmd = "1";  // POS_ABS
        QString fui = "1";  // Motor 1
        node_break = "3";   // Node 3
        motor_break = "1";  // Motor 1

        makrostring = 1; // verzweigt nach Response und Timer nach f_stepteststring();
        L1Hmakrostring = 1; //
        makrostringstep++;
        if (makrostringstep == 1) sendmacrostring(L1Hoper, task, node, cmd, fui);
        else if (makrostringstep == 2) sendmacrostring(L1Hsensor, task, node, cmd, fui);
        else if (makrostringstep == 3) sendmacrostring(L1Hxy, task, node, cmd, fui);
        else if (ui->check_ma_loop_2->isChecked())
        {
            makrostringstep = 1;
            sendmacrostring(L1Hoper, task, node, cmd, fui);
        }
        else
        {
            makrostring = 0;
            L1Hmakrostring = 0;
            makrostringstep = 0;
            if (macrotest->isActive()) macrotest->stop();
        }
    }
    else err_msgbox("Test for SMIF lift not availible");
}
void MainWindow::on_p_macros_testlift1tilt_clicked()
{
    if (ui->radio_lift1_default->isChecked())
    {
        int L1tiltactive = ui->line_lift1_tiltactpos->text().toInt(&ok, 10);
        int L1tiltoff = ui->line_lift1_tiltinactpos->text().toInt(&ok, 10);

        f_macros_stopmacro_clicked(); // alle Testmakros stoppen

        QString task = "1";
        QString node = "3"; // Node 3
        QString cmd = "1";  // POS_ABS
        QString fui = "2";  // Motor 2
        node_break = "3";   // Node 3
        motor_break = "2";  // Motor 2

        makrostring = 1; // verzweigt nach Response und Timer nach f_stepteststring();
        L1Tmakrostring = 1; //
        makrostringstep++;
        if (makrostringstep == 1) sendmacrostring(L1tiltactive, task, node, cmd, fui);
        else if (makrostringstep == 2) sendmacrostring(L1tiltoff, task, node, cmd, fui);
        else if (ui->check_ma_loop_2->isChecked())
        {
            makrostringstep = 1;
            sendmacrostring(L1tiltactive, task, node, cmd, fui);
        }
        else
        {
            makrostring = 0;
            L1Tmakrostring = 0;
            makrostringstep = 0;
            if (macrotest->isActive()) macrotest->stop();
            zaehler = 0;
        }
    }
    else err_msgbox("Tilt Lift 1 not availible");
}
void MainWindow::on_p_macros_testlift2height_clicked() {
    if (ui->radio_lift2_default->isChecked()) {
        int L2Hoper = ui->line_lift2_unload_height->text().toInt(&ok, 10);
        int L2Hsensor = ui->line_lift2_wafersensor_height->text().toInt(&ok, 10);
        int L2Hxy = ui->line_lift2_xyloader_height->text().toInt(&ok, 10);

        f_macros_stopmacro_clicked(); // alle Testmakros stoppen

        QString task = "1";
        QString node = "2"; // Node 2
        QString cmd = "1";  // POS_ABS
        QString fui = "1";  // Motor 1
        node_break = "2";   // Node 2
        motor_break = "1";  // Motor 1

        makrostring =
                1; // verzweigt nach Response und Timer nach f_stepteststring();
        L2Hmakrostring = 1; //
        makrostringstep++;
        if (makrostringstep == 1)
            sendmacrostring(L2Hoper, task, node, cmd, fui);
        else if (makrostringstep == 2)
            sendmacrostring(L2Hsensor, task, node, cmd, fui);
        else if (makrostringstep == 3)
            sendmacrostring(L2Hxy, task, node, cmd, fui);
        else if (ui->check_ma_loop_2->isChecked()) {
            makrostringstep = 1;
            sendmacrostring(L2Hoper, task, node, cmd, fui);
        } else {
            makrostring = 0;
            L2Hmakrostring = 0;
            makrostringstep = 0;
            if (macrotest->isActive())
                macrotest->stop();
        }
    } else
        err_msgbox("Test for SMIF lift not availible");
}
void MainWindow::on_p_macros_testlift2tilt_clicked() {
    if (ui->radio_lift2_default->isChecked()) {
        int L2tiltactive = ui->line_lift2_tiltactpos->text().toInt(&ok, 10);
        int L2tiltoff = ui->line_lift2_tiltinactpos->text().toInt(&ok, 10);

        f_macros_stopmacro_clicked(); // alle Testmakros stoppen

        QString task = "1";
        QString node = "2"; // Node 2
        QString cmd = "1";  // POS_ABS
        QString fui = "2";  // Motor 2
        node_break = "2";   // Node 2
        motor_break = "2";  // Motor 2

        makrostring =
                1; // verzweigt nach Response und Timer nach f_stepteststring();
        L2Tmakrostring = 1; //
        makrostringstep++;
        if (makrostringstep == 1)
            sendmacrostring(L2tiltactive, task, node, cmd, fui);
        else if (makrostringstep == 2)
            sendmacrostring(L2tiltoff, task, node, cmd, fui);
        else if (ui->check_ma_loop_2->isChecked()) {
            makrostringstep = 1;
            sendmacrostring(L2tiltactive, task, node, cmd, fui);
        } else {
            makrostring = 0;
            L2Tmakrostring = 0;
            makrostringstep = 0;
            if (macrotest->isActive())
                macrotest->stop();
        }
    } else
        err_msgbox("Tilt Lift 2 not availible");
}
void MainWindow::on_p_macros_testLDX_clicked() {
    int LDXlift1pos = ui->line_loader_xlift1pos->text().toInt(&ok, 10);
    int LDXlift2pos = ui->line_loader_xlift2pos->text().toInt(&ok, 10);
    int LDXPrea = ui->line_loader_xpreapos->text().toInt(&ok, 10);
    int LDXPreasOff = ui->line_loader_xpreafreepos->text().toInt(&ok, 10);

    f_macros_stopmacro_clicked(); // alle Testmakros stoppen

    QString task = "1";
    QString node = "5"; // Node 5
    QString cmd = "1";  // POS_ABS
    QString fui = "1";  // Motor 1
    node_break = "5";   // Node 5
    motor_break = "1";  // Motor 1

    makrostring = 1; // verzweigt nach Response und Timer nach f_stepteststring();
    LDXmakrostring = 1; //
    makrostringstep++;
    if (makrostringstep == 1)
        sendmacrostring(LDXlift1pos, task, node, cmd, fui);
    else if (makrostringstep == 2)
        sendmacrostring(LDXlift2pos, task, node, cmd, fui);
    else if (makrostringstep == 3)
        sendmacrostring(LDXPrea, task, node, cmd, fui);
    else if (makrostringstep == 4)
        sendmacrostring(LDXPreasOff, task, node, cmd, fui);
    else if (ui->check_ma_loop_2->isChecked()) {
        makrostringstep = 1;
        sendmacrostring(LDXlift1pos, task, node, cmd, fui);
    } else {
        makrostring = 0;
        LDXmakrostring = 0;
        makrostringstep = 0;
        if (macrotest->isActive())
            macrotest->stop();
    }
}
void MainWindow::on_p_macros_testLDY_clicked() {
    int LDYlift1In = ui->line_loader_ylift1inpos->text().toInt(&ok, 10);
    int LDYlift2In = ui->line_loader_ylift2inpos->text().toInt(&ok, 10);
    int LDYOut = ui->line_loader_youtlift->text().toInt(&ok, 10);
    int LDYPrea = ui->line_loader_ypreapos->text().toInt(&ok, 10);

    int msg = 0;

    macromacro = 0;

    if (makrostring == 0)
        msg = err_msgboxTransferOK("Attention! Y-arm moves forward into carrier "
                                   "zone. Ensure that the area is not blocked");
    if (makrostring || msg == 0) {
        f_macros_stopmacro_clicked(); // alle Testmakros stoppen

        QString task = "1";
        QString node = "5"; // Node 5
        QString cmd = "1";  // POS_ABS
        QString fui = "2";  // Motor 2

        node_break = "5";  // Node 5
        motor_break = "2"; // Motor 2

        makrostring =
                1; // verzweigt nach Response und Timer nach f_stepteststring();
        LDYmakrostring = 1; //
        makrostringstep++;
        if (makrostringstep == 1)
            sendmacrostring(LDYlift1In, task, node, cmd, fui);
        else if (makrostringstep == 2)
            sendmacrostring(LDYlift2In, task, node, cmd, fui);
        else if (makrostringstep == 3)
            sendmacrostring(LDYOut, task, node, cmd, fui);
        else if (makrostringstep == 4)
            sendmacrostring(LDYPrea, task, node, cmd, fui);
        else if (ui->check_ma_loop_2->isChecked()) {
            makrostringstep = 1;
            sendmacrostring(LDYlift1In, task, node, cmd, fui);
        } else {
            makrostring = 0;
            LDYmakrostring = 0;
            makrostringstep = 0;
            if (macrotest->isActive())
                macrotest->stop();
        }
    }
}
void MainWindow::on_p_macros_testPAH_clicked() {
    int PAheightaboveLD = ui->line_aboveloader->text().toInt(&ok, 10);
    int PAheightLD = ui->line_loaderheight->text().toInt(&ok, 10);
    int PAheightbelowLD = ui->line_belowloader->text().toInt(&ok, 10);
    int PAheightCH = ui->line_chuckheight->text().toInt(&ok, 10);
    int PAheightPrea = ui->line_preaheight->text().toInt(&ok, 10);

    f_macros_stopmacro_clicked(); // laufenden Testmakro stoppen

    QString task = "1"; // Task 1 (Default)
    QString node = "3"; // Node 3
    QString cmd = "1";  // POS_ABS
    QString fui = "3";  // Motor 3
    node_break = "3";   // Node 3
    motor_break = "3";  // Motor 3

    makrostring = 1; // verzweigt nach Response und Timer nach f_stepteststring();
    PAHmakrostring = 1; //
    makrostringstep++;
    if (makrostringstep == 1)
        sendmacrostring(PAheightaboveLD, task, node, cmd, fui);
    else if (makrostringstep == 2)
        sendmacrostring(PAheightLD, task, node, cmd, fui);
    else if (makrostringstep == 3)
        sendmacrostring(PAheightbelowLD, task, node, cmd, fui);
    else if (makrostringstep == 4)
        sendmacrostring(PAheightCH, task, node, cmd, fui);
    else if (makrostringstep == 5)
        sendmacrostring(PAheightPrea, task, node, cmd, fui);
    else if (ui->check_ma_loop_2->isChecked()) {
        makrostringstep = 1;
        sendmacrostring(PAheightaboveLD, task, node, cmd, fui);
    } else {
        makrostring = 0;
        PAHmakrostring = 0;
        makrostringstep = 0;
        if (macrotest->isActive())
            macrotest->stop();
    }
}
void MainWindow::on_p_macros_testPAP_clicked() {
    int PAPangle = ui->line_preasensangle->text().toInt(&ok, 10);
    int PAP0 = 0;

    f_macros_stopmacro_clicked(); // laufenden Testmakro stoppen

    QString task = "1";
    QString node = "4"; // Node 4
    QString cmd = "1";  // POS_ABS
    QString fui = "2";  // Motor 2
    node_break = "4";   // Node 4
    motor_break = "2";  // Motor 2

    makrostring = 1; // verzweigt nach Response und Timer nach f_stepteststring();
    PAPmakrostring = 1;
    makrostringstep++;
    if (makrostringstep == 1)
        sendmacrostring(PAPangle, task, node, cmd, fui);
    else if (makrostringstep == 2)
        sendmacrostring(PAP0, task, node, cmd, fui);
    else if (ui->check_ma_loop_2->isChecked()) {
        makrostringstep = 1;
        sendmacrostring(PAPangle, task, node, cmd, fui);
    } else {
        makrostring = 0;
        PAPmakrostring = 0;
        makrostringstep = 0;
        if (macrotest->isActive())
            macrotest->stop();
    }
}
void MainWindow::on_p_macros_testPAR_clicked() {
    int PARrotpos = ui->line_wobrotpos->text().toInt(&ok, 10);
    int PAR0 = 0;

    f_macros_stopmacro_clicked(); // laufenden Testmakro stoppen

    QString task = "1";
    QString node = "4"; // Node 4
    QString cmd = "1";  // POS_ABS
    QString fui = "1";  // Motor 1
    node_break = "4";   // Node 4
    motor_break = "1";  // Motor 1

    makrostring = 1; // verzweigt nach Response und Timer nach f_stepteststring();
    PARmakrostring = 1; //
    makrostringstep++;
    if (makrostringstep == 1)
        sendmacrostring(PARrotpos, task, node, cmd, fui);
    else if (makrostringstep == 2)
        sendmacrostring(PAR0, task, node, cmd, fui);
    else if (ui->check_ma_loop_2->isChecked()) {
        makrostringstep = 1;
        sendmacrostring(PARrotpos, task, node, cmd, fui);
    } else {
        makrostring = 0;
        PARmakrostring = 0;
        makrostringstep = 0;
        if (macrotest->isActive())
            macrotest->stop();
    }
}
void MainWindow::on_p_macros_testPAT_clicked() {
    int PATtilt = ui->line_wobbtiltangle->text().toInt(&ok, 10);
    int PAT0 = 0;

    f_macros_stopmacro_clicked(); // laufenden Testmakro stoppen

    QString task = "1";
    QString node = "4"; // Node 4
    QString cmd = "1";  // POS_ABS
    QString fui = "3";  // Motor 3
    node_break = "4";   // Node 4
    motor_break = "3";  // Motor 3

    makrostring = 1; // verzweigt nach Response und Timer nach f_stepteststring();
    PATmakrostring = 1; //
    makrostringstep++;
    if (makrostringstep == 1)
        sendmacrostring(PATtilt, task, node, cmd, fui);
    else if (makrostringstep == 2)
        sendmacrostring(PAT0, task, node, cmd, fui);
    else if (ui->check_ma_loop_2->isChecked()) {
        makrostringstep = 1;
        sendmacrostring(PATtilt, task, node, cmd, fui);
    } else {
        makrostring = 0;
        PATmakrostring = 0;
        makrostringstep = 0;
        if (macrotest->isActive())
            macrotest->stop();
    }
}
void MainWindow::on_p_macros_testWCH_clicked() {
    int WCHaboveCH = ui->line_wc_abovechuckheight->text().toInt(&ok, 10);
    int WCHCH = ui->line_wc_chuckheight->text().toInt(&ok, 10);
    int WCHbelowCH = ui->line_wc_belowchuckheight->text().toInt(&ok, 10);

    f_macros_stopmacro_clicked(); // laufenden Testmakro stoppen

    QString task = "1";
    QString node = "5"; // Node 5
    QString cmd = "1";  // POS_ABS
    QString fui = "3";  // Motor 3
    node_break = "5";   // Node 5
    motor_break = "3";  // Motor 3

    makrostring = 1; // verzweigt nach Response und Timer nach f_stepteststring();
    WCHmakrostring = 1; //
    makrostringstep++;
    if (makrostringstep == 1)
        sendmacrostring(WCHaboveCH, task, node, cmd, fui);
    else if (makrostringstep == 2)
        sendmacrostring(WCHCH, task, node, cmd, fui);
    else if (makrostringstep == 3)
        sendmacrostring(WCHbelowCH, task, node, cmd, fui);
    else if (ui->check_ma_loop_2->isChecked()) {
        makrostringstep = 1;
        sendmacrostring(WCHaboveCH, task, node, cmd, fui);
    } else {
        makrostring = 0;
        WCHmakrostring = 0;
        makrostringstep = 0;
        if (macrotest->isActive())
            macrotest->stop();
    }
}
void MainWindow::on_p_macros_testWCP_clicked()
{
    int WCPleft = ui->line_wc_leftpos->text().toInt(&ok, 10);
    int WCPmiddle = ui->line_wc_middlepos->text().toInt(&ok, 10);
    int WCPright = ui->line_wc_rightpos->text().toInt(&ok, 10);

    f_macros_stopmacro_clicked(); // laufenden Testmakro stoppen

    QString task = "1";
    QString node = "6"; // Node 6
    QString cmd = "1";  // POS_ABS
    QString fui = "3";  // Motor 3
    node_break = "6";   // Node 6
    motor_break = "3";  // Motor 3

    makrostring = 1; // verzweigt nach Response und Timer nach f_stepteststring();
    WCPmakrostring = 1; //
    makrostringstep++;
    if (makrostringstep == 1) sendmacrostring(WCPleft, task, node, cmd, fui);
    else if (makrostringstep == 2) sendmacrostring(WCPmiddle, task, node, cmd, fui);
    else if (makrostringstep == 3) sendmacrostring(WCPright, task, node, cmd, fui);
    else if (makrostringstep == 4) sendmacrostring(WCPmiddle, task, node, cmd, fui);
    else if (ui->check_ma_loop_2->isChecked())
    {
        makrostringstep = 1;
        sendmacrostring(WCPleft, task, node, cmd, fui);
    }
    else
    {
        makrostring = 0;
        WCPmakrostring = 0;
        makrostringstep = 0;
        if (macrotest->isActive()) macrotest->stop();
        sendmacrostring(WCPmiddle, task, node, cmd, fui);
    }
}
void MainWindow::f_macros_stopmacro_clicked() {
    makrostring = 0;

    PAHmakrostring = 0;
    PAPmakrostring = 0;
    PARmakrostring = 0;
    PATmakrostring = 0;
    PAHmakrostring = 0;
    WCHmakrostring = 0;
    WCPmakrostring = 0;
    LDXmakrostring = 0;
    LDYmakrostring = 0;
    L1Hmakrostring = 0;
    L1Tmakrostring = 0;
    L2Hmakrostring = 0;
    L2Tmakrostring = 0;

    if (macrotest->isActive())
        macrotest->stop();
    macromacro = 0;
}
void MainWindow::on_p_macros_stopmacro_clicked() {
    makrostring = 0;

    PAHmakrostring = 0;
    PAPmakrostring = 0;
    PARmakrostring = 0;
    PATmakrostring = 0;
    PAHmakrostring = 0;
    WCHmakrostring = 0;
    WCPmakrostring = 0;
    LDXmakrostring = 0;
    LDYmakrostring = 0;
    L1Hmakrostring = 0;
    L1Tmakrostring = 0;
    L2Hmakrostring = 0;
    L2Tmakrostring = 0;

    if (macrotest->isActive())
        macrotest->stop();
    macromacro = 0;

    if (node_break != "0" && motor_break != "0") {
        // FN_break senden: Node, Motor
        tmpstr = 0;
        QString tmp = ui->line_loader_xlift1pos->text();
        tmpstr.append("$SET_3=");
        tmpstr.append(node_break.toLatin1()); // Node
        tmpstr.append(",");
        tmpstr.append(motor_break.toLatin1()); // Motor
        tmpstr.append("\r\n");
        cmdfeeder = 0; // warten auf Response überschreiben
        serialSendFeeder(tmpstr);

        node_break = "0";  // Node löschen
        motor_break = "0"; // kein motor
    }

    //    makrostringstep = 0;
}
void MainWindow::sendmacrostring(int value, QString task, QString node,QString cmd, QString fui)
{
    int arr[4];

    int *byte = dez2byte(value, arr);
    abspostmp = QString::number(value);
    ui->line_macro_target->setText(abspostmp);  // Sollposition

    tmpstr = "&X0,0,";
    tmpstr.append(node.toLatin1());
    tmpstr.append(",");
    tmpstr.append(task.toLatin1());
    tmpstr.append(",0,0,0,");
    tmpstr.append(cmd.toLatin1());
    tmpstr.append(",");
    tmpstr.append(fui.toLatin1());
    tmpstr.append(",");
    tmpstr.append(QString::number(byte[3]).toLatin1());
    tmpstr.append(",");
    tmpstr.append(QString::number(byte[2]).toLatin1());
    tmpstr.append(",");
    tmpstr.append(QString::number(byte[1]).toLatin1());
    tmpstr.append(",");
    tmpstr.append(QString::number(byte[0]).toLatin1());
    tmpstr.append(",");
    tmpstr.append(ui->spinBox_macro_motpara_2->text().toLatin1());
    tmpstr.append(",\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::f_stepteststring(void)
{
    if (PAHmakrostring) on_p_macros_testPAH_clicked();
    else if (PAPmakrostring) on_p_macros_testPAP_clicked();
    else if (PARmakrostring) on_p_macros_testPAR_clicked();
    else if (PATmakrostring) on_p_macros_testPAT_clicked();
    else if (WCHmakrostring) on_p_macros_testWCH_clicked();
    else if (WCPmakrostring) on_p_macros_testWCP_clicked();
    else if (LDXmakrostring) on_p_macros_testLDX_clicked();
    else if (LDYmakrostring) on_p_macros_testLDY_clicked();
    else if (L1Hmakrostring) on_p_macros_testlift1height_clicked();
    else if (L1Tmakrostring) on_p_macros_testlift1tilt_clicked();
    else if (L2Hmakrostring) on_p_macros_testlift2height_clicked();
    else if (L2Tmakrostring) on_p_macros_testlift2tilt_clicked();
}
void MainWindow::on_p_macros_clear_statistics_clicked()
{
    ui->line_macro_maxdiff_target->clear();
    ui->line_macro_maxdiff->clear();
    ui->line_macro_maxdiff_count->clear();
    ui->line_macro_diff->clear();
    ui->line_macro_count->clear();
    ui->line_macro_target->clear();
    zaehler = 0;
}
// ---------------- SMIF1 -------------------------------
void MainWindow::on_p_SMIF_startISIM_clicked() // Software ISIM per Dosbox starten
{
    QDesktopServices::openUrl(QUrl("file:///" + SMIFlink, QUrl::TolerantMode));
}
void MainWindow::on_p_SMIF_INIT_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_INIT); // "$SMIF_1="
    tmpstr.append("1");      // Lift 1
    tmpstr.append("\r\n");
    feedertimeout = 60000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_status_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_STATUS); //
    tmpstr.append("1");        // Lift 1
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_begin_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_BEGIN); // "$SMIF_3"
    tmpstr.append("1");       // Lift 1
    tmpstr.append("\r\n");
    feedertimeout = 40000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_end_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_END); // "$SMIF_4"
    tmpstr.append("1");     // Lift 1
    tmpstr.append("\r\n");
    feedertimeout = 40000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_home_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_HOME); // "$SMIF_2"
    tmpstr.append("1");      // Lift 1
    tmpstr.append("\r\n");
    feedertimeout = 40000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_retract_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_RETRACT); // "$SMIF_9"
    tmpstr.append("1");         // Lift 1
    tmpstr.append("\r\n");
    feedertimeout = 40000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_MAP_clicked()
{
    waitLDout = 20;
    on_p_LD_Yout_clicked(); // LDYout position sicherstellen
}
void MainWindow::on_p_SMIF_Get_clicked() {
    if (SMIF_listselwafer() == 0) {
        err_msgbox("please select slot"); // alle selektierten Wafer auflisten
    } else
        SMIF_getwafer();
}
void MainWindow::on_p_SMIF_PUT_clicked() {
    SMIF_listselwafer(); // alle selektierten Wafer auflisten
    //   qDebug()<< "VECselslots1.indexOf(1)"<< VECselslots1.indexOf(1);
    //   qDebug()<< "VECselslots2.indexOf(1)"<< VECselslots2.indexOf(1);
    //   qDebug()<< "VECselslots1.indexOf(idxloop1)"<<
    //   VECselslots1.indexOf(idxloop1); qDebug()<< "idxloop1"<< idxloop1;

    SMIF_putwafer();
}
void MainWindow::SMIF_getwafer()
{
    static int flag = 0;

    feedertimeout = 40000;

    tmpstr = 0;

    SMIFactive = 1;

    tmpstr = ISE_WGET; // "$SMIF_5"
    tmpstr.append("1,");
    if (ui->groupBox_SMIF_Lift1->isChecked()) {
        idxloop1 = VECselslots1.indexOf(
                    1, idxloop1); // index zeigt auf den nächsten selektierten slot
        if (idxloop1 == -1 && idxwaf != 0) {
            qDebug() << "SMIF_getwafer() -> idxloop1 == -1 && idxwaf != 0";
            idxloop1 = 0;
            idxloop1 = VECselslots1.indexOf(
                        1, idxloop1); // index zeigt auf den nächsten selektierten slot
        }
        if (idxloop1 != -1) {
            qDebug() << "SMIF_getwafer() -> idxloop1 == -1";
            tmpstr.append(QString::number(VECselslots1.indexOf(1, idxloop1) + 1).toLatin1());
            SMIF_actslot(VECselslots1.indexOf(1, idxloop1) + 1); // Slot sperren
            idxwaf = idxloop1; // Index des GET Wafers
            if (idxloop1 <= 24)
                idxloop1++; // Index erhöhen für den nächsten selektierten Slot
            else
                idxloop1 = 0;
        }

    //    err_msgbox("selsktierer Slot"+tmpstr);
        //    //    err_msgbox("selsktierer Slot"+tmpstr);
    //    else flag = 1;      // 0=kein Slot ausgewählt
    }
    tmpstr.append(",");
    QString l = ui->line_smif_logistic->text();
    if (l.toInt(&ok, 10) > 1)
        l = "1";
    else if (l.toInt(&ok, 10) < 1)
        l = "0";
    tmpstr.append(l.toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);

    //    deactslot(VECselslots1.indexOf(1,PAwaf)+1);// Slot wieder freigeben
}
void MainWindow::on_p_SMIF_Zdown_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_ZDOWN); // "$SMIF_7"
    tmpstr.append("1,");      // Lift 1
    QString hub = ui->line_SMIF_zstroke->text();
    if (hub.toInt(&ok, 10) > 160)
        hub = "160";
    else if (hub.toInt(&ok, 10) < 0)
        hub = "0";
    tmpstr.append(hub.toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_Zup_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_ZUP); // "$SMIF_8"
    tmpstr.append("1,");    // Lift 1
    QString hub = ui->line_SMIF_zstroke->text();
    if (hub.toInt(&ok, 10) > 160)
        hub = "160";
    else if (hub.toInt(&ok, 10) < 0)
        hub = "0";
    tmpstr.append(hub.toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::SMIF_putwafer() {
    feedertimeout = 40000;
    tmpstr = 0;

    SMIFactive = 1;

    tmpstr = ISE_WPUTZ; // $SMIF_=
    tmpstr.append("1,");
    if (ui->groupBox_SMIF_Lift1->isChecked())
    {
        tmpstr.append(QString::number(idxwaf + 1).toLatin1()); // index zeigt auf Slot waf1
        SMIF_deactslot(VECselslots1.indexOf(1, idxwaf) + 1); // Slot wieder freigeben
    }
    else tmpstr.append("0"); // kein gültiger Slot
    tmpstr.append(",");
    QString l = ui->line_smif_logistic->text();
    if (l.toInt(&ok, 10) > 1) l = "1";
    tmpstr.append(l.toLatin1());
    tmpstr.append(",");
    QString hub = ui->line_SMIF_zstroke->text();
    if (hub.toInt(&ok, 10) > 160) hub = "160";
    else if (hub.toInt(&ok, 10) < 0) hub = "0";
    tmpstr.append(hub.toLatin1());
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::SMIF_deletslots(int liftnr) // Wafermap löschen
{
    if (liftnr == 1) {
        ui->lineEdit_L1S1_2->setStyleSheet("background-color: white");
        ui->check_slot1_3->hide();

        ui->lineEdit_L1S2_2->setStyleSheet("background-color: white");
        ui->check_slot2_3->hide();

        ui->lineEdit_L1S3_2->setStyleSheet("background-color: white");
        ui->check_slot3_3->hide();

        ui->lineEdit_L1S4_2->setStyleSheet("background-color: white");
        ui->check_slot4_3->hide();

        ui->lineEdit_L1S5_2->setStyleSheet("background-color: white");
        ui->check_slot5_3->hide();

        ui->lineEdit_L1S6_2->setStyleSheet("background-color: white");
        ui->check_slot6_3->hide();

        ui->lineEdit_L1S7_2->setStyleSheet("background-color: white");
        ui->check_slot7_3->hide();

        ui->lineEdit_L1S8_2->setStyleSheet("background-color: white");
        ui->check_slot8_3->hide();

        ui->lineEdit_L1S9_2->setStyleSheet("background-color: white");
        ui->check_slot9_3->hide();

        ui->lineEdit_L1S10_2->setStyleSheet("background-color: white");
        ui->check_slot10_3->hide();

        ui->lineEdit_L1S11_2->setStyleSheet("background-color: white");
        ui->check_slot11_3->hide();

        ui->lineEdit_L1S12_2->setStyleSheet("background-color: white");
        ui->check_slot12_3->hide();

        ui->lineEdit_L1S13_2->setStyleSheet("background-color: white");
        ui->check_slot13_3->hide();

        ui->lineEdit_L1S14_2->setStyleSheet("background-color: white");
        ui->check_slot14_3->hide();

        ui->lineEdit_L1S15_2->setStyleSheet("background-color: white");
        ui->check_slot15_3->hide();

        ui->lineEdit_L1S16_2->setStyleSheet("background-color: white");
        ui->check_slot16_3->hide();

        ui->lineEdit_L1S17_2->setStyleSheet("background-color: white");
        ui->check_slot17_3->hide();

        ui->lineEdit_L1S18_2->setStyleSheet("background-color: white");
        ui->check_slot18_3->hide();

        ui->lineEdit_L1S19_2->setStyleSheet("background-color: white");
        ui->check_slot19_3->hide();

        ui->lineEdit_L1S20_2->setStyleSheet("background-color: white");
        ui->check_slot20_3->hide();

        ui->lineEdit_L1S21_2->setStyleSheet("background-color: white");
        ui->check_slot21_3->hide();

        ui->lineEdit_L1S22_2->setStyleSheet("background-color: white");
        ui->check_slot22_3->hide();

        ui->lineEdit_L1S23_2->setStyleSheet("background-color: white");
        ui->check_slot23_3->hide();

        ui->lineEdit_L1S24_2->setStyleSheet("background-color: white");
        ui->check_slot24_3->hide();

        ui->lineEdit_L1S25_2->setStyleSheet("background-color: white");
        ui->check_slot25_3->hide();
    }
}
void MainWindow::SMIF_deselslot() // Slotauswahlboxen einblenden
{
    if (ui->groupBox_SMIF_Lift1->isChecked()) {
        ui->check_slot1_3->setEnabled(true);
        ui->check_slot2_3->setEnabled(true);
        ui->check_slot3_3->setEnabled(true);
        ui->check_slot4_3->setEnabled(true);
        ui->check_slot5_3->setEnabled(true);
        ui->check_slot6_3->setEnabled(true);
        ui->check_slot7_3->setEnabled(true);
        ui->check_slot8_3->setEnabled(true);
        ui->check_slot9_3->setEnabled(true);
        ui->check_slot10_3->setEnabled(true);
        ui->check_slot11_3->setEnabled(true);
        ui->check_slot12_3->setEnabled(true);
        ui->check_slot13_3->setEnabled(true);
        ui->check_slot14_3->setEnabled(true);
        ui->check_slot15_3->setEnabled(true);
        ui->check_slot16_3->setEnabled(true);
        ui->check_slot17_3->setEnabled(true);
        ui->check_slot18_3->setEnabled(true);
        ui->check_slot19_3->setEnabled(true);
        ui->check_slot20_3->setEnabled(true);
        ui->check_slot21_3->setEnabled(true);
        ui->check_slot22_3->setEnabled(true);
        ui->check_slot23_3->setEnabled(true);
        ui->check_slot24_3->setEnabled(true);
        ui->check_slot25_3->setEnabled(true);
    }
}
int MainWindow::SMIF_listselwafer() // Slotliste wird aktualisiert
{
    int ret = 1;
    VECselslots1.clear();
    VECselslots2.clear();
    for (int i = 0; i < 25;
         i++) // size von QVector<int> muss initialisiert werden
    {
        VECselslots1.append(0);
        VECselslots2.append(0);
    }
    qDebug() << "listselwafer() -> VECselslots1.size()" << VECselslots1.size();

    if (ui->groupBox_SMIF_Lift1->isChecked()) {
        if (ui->check_slot1_3->isChecked())
            VECselslots1[0] = 1; // alle selektierten Wafer listen
        else
            VECselslots1[0] = 0;
        if (ui->check_slot2_3->isChecked())
            VECselslots1[1] = 1;
        else
            VECselslots1[1] = 0;
        if (ui->check_slot3_3->isChecked())
            VECselslots1[2] = 1;
        else
            VECselslots1[2] = 0;
        if (ui->check_slot4_3->isChecked())
            VECselslots1[3] = 1;
        else
            VECselslots1[3] = 0;
        if (ui->check_slot5_3->isChecked())
            VECselslots1[4] = 1;
        else
            VECselslots1[4] = 0;
        if (ui->check_slot6_3->isChecked())
            VECselslots1[5] = 1;
        else
            VECselslots1[5] = 0;
        if (ui->check_slot7_3->isChecked())
            VECselslots1[6] = 1;
        else
            VECselslots1[6] = 0;
        if (ui->check_slot8_3->isChecked())
            VECselslots1[7] = 1;
        else
            VECselslots1[7] = 0;
        if (ui->check_slot9_3->isChecked())
            VECselslots1[8] = 1;
        else
            VECselslots1[8] = 0;
        if (ui->check_slot10_3->isChecked())
            VECselslots1[9] = 1;
        else
            VECselslots1[9] = 0;
        if (ui->check_slot11_3->isChecked())
            VECselslots1[10] = 1;
        else
            VECselslots1[10] = 0;
        if (ui->check_slot12_3->isChecked())
            VECselslots1[11] = 1;
        else
            VECselslots1[11] = 0;
        if (ui->check_slot13_3->isChecked())
            VECselslots1[12] = 1;
        else
            VECselslots1[12] = 0;
        if (ui->check_slot14_3->isChecked())
            VECselslots1[13] = 1;
        else
            VECselslots1[13] = 0;
        if (ui->check_slot15_3->isChecked())
            VECselslots1[14] = 1;
        else
            VECselslots1[14] = 0;
        if (ui->check_slot16_3->isChecked())
            VECselslots1[15] = 1;
        else
            VECselslots1[15] = 0;
        if (ui->check_slot17_3->isChecked())
            VECselslots1[16] = 1;
        else
            VECselslots1[16] = 0;
        if (ui->check_slot18_3->isChecked())
            VECselslots1[17] = 1;
        else
            VECselslots1[17] = 0;
        if (ui->check_slot19_3->isChecked())
            VECselslots1[18] = 1;
        else
            VECselslots1[18] = 0;
        if (ui->check_slot20_3->isChecked())
            VECselslots1[19] = 1;
        else
            VECselslots1[19] = 0;
        if (ui->check_slot21_3->isChecked())
            VECselslots1[20] = 1;
        else
            VECselslots1[20] = 0;
        if (ui->check_slot22_3->isChecked())
            VECselslots1[21] = 1;
        else
            VECselslots1[21] = 0;
        if (ui->check_slot23_3->isChecked())
            VECselslots1[22] = 1;
        else
            VECselslots1[22] = 0;
        if (ui->check_slot24_3->isChecked())
            VECselslots1[23] = 1;
        else
            VECselslots1[23] = 0;
        if (ui->check_slot25_3->isChecked())
            VECselslots1[24] = 1;
        else
            VECselslots1[24] = 0;

        if (VECselslots1.contains(1) == false)
            ret = 0;
    }

    return ret;
}
void MainWindow::SMIF_actslot(int slot) // enable slotnr während des Handlings des Wafers
{
    SMIF_deselslot();
    slot = 1; // derzeit nur 1 Slot auswählbar -> alle werden gesperrt
    switch (slot) {
    case 1:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot1_3->setEnabled(false);
        // break;
        // case 2:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot2_3->setEnabled(false);
        // break;
        // case 3:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot3_3->setEnabled(false);
        // break;
        // case 4:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot4_3->setEnabled(false);
        // break;
        // case 5:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot5_3->setEnabled(false);
        // break;
        // case 6:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot6_3->setEnabled(false);
        // break;
        // case 7:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot7_3->setEnabled(false);
        // break;
        // case 8:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot8_3->setEnabled(false);
        // break;
        // case 9:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot9_3->setEnabled(false);
        // break;
        // case 10:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot10_3->setEnabled(false);
        // break;
        // case 11:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot11_3->setEnabled(false);
        // break;
        // case 12:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot12_3->setEnabled(false);
        // break;
        // case 13:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot13_3->setEnabled(false);
        // break;
        // case 14:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot14_3->setEnabled(false);
        // break;
        // case 15:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot15_3->setEnabled(false);
        // break;
        // case 16:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot16_3->setEnabled(false);
        // break;
        // case 17:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot17_3->setEnabled(false);
        // break;
        // case 18:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot18_3->setEnabled(false);
        // break;
        // case 19:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot19_3->setEnabled(false);
        // break;
        // case 20:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot20_3->setEnabled(false);
        // break;
        // case 21:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot21_3->setEnabled(false);
        // break;
        // case 22:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot22_3->setEnabled(false);
        // break;
        // case 23:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot23_3->setEnabled(false);
        // break;
        // case 24:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot24_3->setEnabled(false);
        // break;
        // case 25:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot25_3->setEnabled(false);
        break;
    }
}
void MainWindow::SMIF_deactslot(int slot) // disable slotnr während des Handlings des Wafers
{
    SMIF_deselslot();
    slot = 1;
    switch (slot) {
    case 1:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot1_3->setEnabled(true);
        break;
    case 2:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot2_3->setEnabled(true);
        break;
    case 3:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot3_3->setEnabled(true);
        break;
    case 4:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot4_3->setEnabled(true);
        break;
    case 5:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot5_3->setEnabled(true);
        break;
    case 6:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot6_3->setEnabled(true);
        break;
    case 7:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot7_3->setEnabled(true);
        break;
    case 8:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot8_3->setEnabled(true);
        break;
    case 9:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot9_3->setEnabled(true);
        break;
    case 10:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot10_3->setEnabled(true);
        break;
    case 11:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot11_3->setEnabled(true);
        break;
    case 12:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot12_3->setEnabled(true);
        break;
    case 13:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot13_3->setEnabled(true);
        break;
    case 14:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot14_3->setEnabled(true);
        break;
    case 15:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot15_3->setEnabled(true);
        break;
    case 16:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot16_3->setEnabled(true);
        break;
    case 17:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot17_3->setEnabled(true);
        break;
    case 18:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot18_3->setEnabled(true);
        break;
    case 19:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot19_3->setEnabled(true);
        break;
    case 20:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot20_3->setEnabled(true);
        break;
    case 21:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot21_3->setEnabled(true);
        break;
    case 22:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot22_3->setEnabled(true);
        break;
    case 23:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot23_3->setEnabled(true);
        break;
    case 24:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot24_3->setEnabled(true);
        break;
    case 25:
        if (ui->groupBox_SMIF_Lift1->isChecked())
            ui->check_slot25_3->setEnabled(true);
        break;
    }
}
void MainWindow::on_p_SMIF_clear_clicked() {
    ui->plainTextEdit_logsmif_cmd->clear();
}
void MainWindow::on_p_SMIF_errorclear_clicked() {
    ui->label_smif1_errcode->clear();
    ui->label_smif1_errcode->setStyleSheet(backWhite);
    ui->label_smiferrortype->clear();
}
// ---------------- SMIF config ------------------------
void MainWindow::on_pushButton_SMIF_seriallog_clicked()
{
    static int state = 0;
    if (state == 0)
    {
        connectSMIF2(1);
        state = 1;
        ui->pushButton_SMIF_seriallog->setStyleSheet(backLightGreen);
        ui->pushButton_ASYST_seriallog->setStyleSheet(backLightGreen);
        serialSendFeeder(smiflogon);
    }
    else
    {
        connectSMIF2(0);
        state = 0;
        ui->pushButton_SMIF_seriallog->setStyleSheet(backLightGrey);
        ui->pushButton_ASYST_seriallog->setStyleSheet(backLightGrey);
        serialSendFeeder(smiflogoff);
    }
}
void MainWindow::on_checkBox_SMIF_statuspoll_clicked(bool checked)
{
    if (checked) serialSendFeeder(smifpolloff);
    else serialSendFeeder(smifpollon);
}
void MainWindow::on_p_smif_getpconf2_clicked() // get pconf2 value
{
    tmpstr = 0;
    tmpstr.append(ISE_PCONF2); // "$SMIF_16="
    tmpstr.append("1");        // Lift 1
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_smif_getpconf3_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_PCONF3); // "$SMIF_17="
    tmpstr.append("1");        // Lift 1
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_smif_getpconf4_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_PCONF4); // "$SMIF_18="
    tmpstr.append("1");        // Lift 1
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_smif_pconf5_clicked() // get pconf5 values
{
    tmpstr = 0;
    tmpstr.append(ISE_PCONF5); // "$SMIF_19="
    tmpstr.append("1");        // Lift 1
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_smif_getpconf6_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_PCONF6); // "$SMIF_20="
    tmpstr.append("1");        // Lift 1
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_smif_gconf2_clicked() {
    tmpstr = 0;
    tmpstr.append(ISE_GCONF2); // "$SMIF_13="
    tmpstr.append("1,");       // Lift 1
    QString val = ui->line_smif_gconf2->text();
    tmpstr.append(val.toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_smif_gconf3_clicked() {
    int ret = err_msgboxTransferOK(
                "Determines scan parameters for the cassette type used. A cassette "
                "without a wafer is required for this. Do you want to continue?");

    if (ret == 0) {
        tmpstr = 0;
        tmpstr.append(ISE_GCONF3); // "$SMIF_12="
        tmpstr.append("1");        // Lift 1
        tmpstr.append("\r\n");
        feedertimeout = 3000;
        serialSendFeeder(tmpstr);
    }
}
void MainWindow::on_p_smif_gconf4_clicked() {
    if (ui->checkBox_SMIF_option4->isChecked()) {
        tmpstr = 0;
        tmpstr.append(ISE_GCONF4); // "$SMIF_13="
        tmpstr.append("1,");       // Lift 1
        QString val = ui->line_smif_gconf4->text();
        tmpstr.append(val.toLatin1());
        tmpstr.append("\r\n");
        feedertimeout = 3000;
        serialSendFeeder(tmpstr);
    } else
        err_msgbox("option not used");
}
void MainWindow::on_checkBox_SMIF_option4_clicked(bool checked) {
    if (checked)
        ui->p_smif_getpconf4->setEnabled(1);
    else
        ui->p_smif_getpconf4->setEnabled(0);
}
void MainWindow::on_p_smif_gconf5_thick_clicked() {
    // GCONF5 Dicke Full_Empty Empty_Full Schalter <CR>

    QString thick = ui->line_smif_getpconf5_thick->text();
    QString fullempty = ui->line_smif_getpconf5_fullempty->text();
    QString emptyfull = ui->line_smif_getpconf5_emptyfull->text();
    QString mode = ui->line_smif_getpconf5_mode->text();

    tmpstr = 0;
    tmpstr.append(ISE_GCONF5); // "$SMIF_14="
    tmpstr.append("1,");       // Lift 1
    tmpstr.append(thick.toLatin1() + ",");
    tmpstr.append(fullempty.toLatin1() + ",");
    tmpstr.append(emptyfull.toLatin1() + ",");
    tmpstr.append(mode.toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_smif_gconf6_clicked() {
    if (ui->checkBox_SMIF_option6->isChecked()) {
        tmpstr = 0;
        tmpstr.append(ISE_GCONF6); // "$SMIF_15="
        tmpstr.append("1");        // Lift 1
        tmpstr.append("\r\n");
        feedertimeout = 3000;
        serialSendFeeder(tmpstr);
    } else
        err_msgbox("option not used");
}
void MainWindow::on_checkBox_SMIF_option6_clicked(bool checked) {
    if (checked)
        ui->p_smif_getpconf6->setEnabled(1);
    else
        ui->p_smif_getpconf6->setEnabled(0);
}
void MainWindow::on_p_SMIF_setdelay_clicked() {
    QString val;
    val = ui->comboBox_SMIF_delay->currentText();
    if (val.toInt(&ok, 10) > 255)
        val = "255";
    tmpstr = 0;
    tmpstr.append("$SET_19="); // set smif delay
    tmpstr.append(val.toLatin1());        // delay value
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_getdelay_clicked() {
    serialSendFeeder("$GET_23\r\n");
}
void MainWindow::on_p_SMIF_get_zstroke_clicked() {
    serialSendFeeder("$GET_22\r\n");
}
void MainWindow::on_p_SMIF_set_zstroke_clicked() {
    QString val;
    val = ui->line_SMIF_zstroke->text();
    if (val.toInt(&ok, 10) > 160)
        val = "160";
    else if (val.toInt(&ok, 10) < 0)
        val = "0";
    tmpstr = 0;
    tmpstr.append("$SET_25="); // set smif delay
    tmpstr.append(val.toLatin1());        // delay value
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_check_loader_releasemotoX_2_clicked(bool checked)
{
    on_check_loader_releasemotoX_clicked(checked);
}
void MainWindow::on_check_loader_releasemotoY_2_clicked(bool checked)
{
    on_check_loader_releasemotoY_clicked(checked);
}
void MainWindow::on_comboCass_Type_smif_activated(int index) {
    store = 0;
    ui->line_cassid_smif->setText(QString::number(index));
    switch (index) {
    case 1:
    SETUP_FILE_partCASS(index); // liest CASS INI-Daten in die Maske ein
    if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x01))
        ui->checkCass_friction_smif->setChecked(
                    1); // friction wafer bitcodiert in Lift1
    else
        ui->checkCass_friction_smif->setChecked(0);
    break;
    case 2:
    SETUP_FILE_partCASS(index);
    if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x02))
        ui->checkCass_friction_smif->setChecked(1);
    else
        ui->checkCass_friction_smif->setChecked(0);
    break;
    case 3:
    SETUP_FILE_partCASS(index);
    if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x04))
        ui->checkCass_friction_smif->setChecked(1);
    else
        ui->checkCass_friction_smif->setChecked(0);
    break;
    case 4:
    SETUP_FILE_partCASS(index);
    if ((ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x08))
        ui->checkCass_friction_smif->setChecked(1);
    else
        ui->checkCass_friction_smif->setChecked(0);
    break;
    }
    on_p_setboardParam_clicked();
    ui->comboCass_Type_smif->setCurrentIndex(index);

  //  f_setSlidecolor();
}
void MainWindow::on_p_copyCass_smif_clicked() {
    int source;
    int dest;

    source = ui->spinBox_sourcecass_smif->text().toInt(&ok, 10);
    dest = ui->spinBox_destinationcass_smif->text().toInt(&ok, 10);

    copy_FILE_partCASS(source, dest);
}
void MainWindow::on_push_wid_cass_Store_smif_clicked()
{
    int tmp = ui->comboCass_Type_smif->currentIndex();
    bool fric = ui->checkCass_friction_smif->isChecked();
    int fbit = 0;

    setfricbit = 1;

    if (tmp != 0)
    {
        if (tmp < 5) // 8inch
        {
            fbit = ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x0F;
            //    qDebug()<<"fbit="<<fbit;
            if (fric)fbit |= (1 << (tmp - 1));
            else fbit &= ~(1 << (tmp - 1));
            ui->combo_8inchsel->setCurrentText(QString::number(fbit));
            //    qDebug()<<"fbit="<<fbit<<"friction: "<<fric;
        }

        STORE_FILE_partCASS(tmp);
        qDebug() << "<<<<<<<on_push_wid_cass_Store_smif_clicked<<<<<<<<<2"<< ui->tabWidget->currentIndex();
    }
    else err_msgbox("select cassette first");
}
void MainWindow::on_p_SMIF_set_Logistic_clicked()
{
    QString val;
    val = ui->line_smif_logistic->text();

    tmpstr = 0;
    tmpstr.append("$SET_28="); // set smif logistic
    tmpstr.append(val.toLatin1());        // logistic value
    tmpstr.append("\r\n");
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_get_Logistic_clicked()
{
    tmpstr = 0;
    tmpstr.append("$GET_28=0\r\n"); // set smif logistic
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_infoerrorcode_clicked()
{
    QString thick = ui->line_SMIF_infoerrorcode->text();
    if (thick != "0" || thick != "1") thick = "0";

    tmpstr = 0;
    tmpstr.append("$SMIF_24="); // "$SMIF_24="
    tmpstr.append(thick.toLatin1());
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_laseroutput_clicked()
{
    tmpstr = 0;
    tmpstr.append("$SMIF_27="); // "$SMIF_27="
    tmpstr.append("0");
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_slotdata_clicked()
{
    tmpstr = 0;
    tmpstr.append("$SMIF_25="); // "$SMIF_25="
    tmpstr.append("0");
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_counter_clicked() {
    tmpstr = 0;
    tmpstr.append("$SMIF_26="); // "$SMIF_26="
    tmpstr.append("0");
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_SMIF_open_clicked()
{

}
void MainWindow::on_p_SMIF_close_clicked()
{

}
void MainWindow::on_p_SMIF_FLSWT_clicked()
{

}
void MainWindow::on_p_SMIF_S_INFO_clicked()
{

}
void MainWindow::on_p_SMIF_ID_clicked()
{

}
void MainWindow::on_p_SMIF_IFLSWT_clicked()
{

}
void MainWindow::on_p_SMIF_S_ID_clicked()
{

}
void MainWindow::on_p_SMIF_SERVICEflag_clicked()
{

}
void MainWindow::on_p_SMIF_S_NULL_clicked()
{

}
void MainWindow::on_p_SMIF_S_AKT_clicked()
{

}
void MainWindow::on_p_SMIF_S_IPOS_clicked()
{

}
void MainWindow::on_p_SMIF_S_DEAKT_clicked()
{

}
// ---------------- pos --------------------------------

// ---------------- MIC --------------------------------
void MainWindow::on_check_MIC_selectall_stateChanged(int arg1)
{
    qDebug() << "arg1" << arg1;
    if (arg1) {
        ui->check_MIC_zdrive->setChecked(1);
        ui->check_MIC_aperture->setChecked(1);
        ui->check_MIC_greyfilter->setChecked(1);
        ui->check_MIC_darkflap->setChecked(1);
        ui->check_MIC_fielddiaphr->setChecked(1);
        ui->check_MIC_lafgreyfilter->setChecked(1);
        ui->check_MIC_lafled->setChecked(1);
        ui->check_MIC_lafoffset->setChecked(1);
        ui->check_MIC_nosepiece->setChecked(1);
        ui->check_MIC_mirror->setChecked(1);
        ui->check_MIC_splitter->setChecked(1);
    }
    else
    {
        ui->check_MIC_zdrive->setChecked(0);
        ui->check_MIC_aperture->setChecked(0);
        ui->check_MIC_greyfilter->setChecked(0);
        ui->check_MIC_darkflap->setChecked(0);
        ui->check_MIC_fielddiaphr->setChecked(0);
        ui->check_MIC_lafgreyfilter->setChecked(0);
        ui->check_MIC_lafled->setChecked(0);
        ui->check_MIC_lafoffset->setChecked(0);
        ui->check_MIC_nosepiece->setChecked(0);
        ui->check_MIC_mirror->setChecked(0);
        ui->check_MIC_splitter->setChecked(0);
    }
}
void MainWindow::on_p_MIC_start_clicked(bool checked)
{
    qDebug() << "checked" << checked;

    if (checked)
    {
        ui->p_MIC_start->setText("STOP");
        ui->p_MIC_start->setStyleSheet(backLightYello);
        int ret = msgboxOK("Press OK if nosepiece safety switch is set.");
        if (ret == 0) {
            MIC_LOOP = 1;
            micloopoff = 0;
            mic_loop();
        }
    }
    else
    {
        ui->p_MIC_start->setText("START");
        ui->p_MIC_start->setStyleSheet(col_greywhite);
        micloopoff = 1;
    }
}
void MainWindow::mic_loop()
{
    static int cycle = 0;

    qDebug() << "cycle" << cycle;

    switch (cycle)
    {
    case 0:
        cycle = 1;
        break;
    case 1: //
        cycle = 2;
        break;
    case 2:
        cycle = 3;
        break;
    case 3:
        cycle = 4;
        break;
    case 4:
        cycle = 5;
        break;
    case 5:
        // neuer Zyklus
        break;
    }
}
void MainWindow::on_p_sys_VacRefresh_clicked()
{
    getAVoper = 1; // Flag zum einmaligen Auslesen der analogen Vakuumwerte
    resetFlags();
    setFlags(3);
}
void MainWindow::f_vactest()
{
    static int vaccntLD = 0;
    static int vaccntPA = 0;
    static int vaccntWC1 = 0;
    static int vaccntWC2 = 0;
    static int vaccntCH4 = 0;
    static int vaccntCH6 = 0;
    static int vaccntCH8 = 0;

    quint8 v = QRandomGenerator::global()->bounded(1, 8);
    qDebug() << "zufallszahl" << v;

    vactest->stop();

    if (vactestflag)
    {
        if (ui->checkBox_vac_randommode->isChecked())
        {
            if (ui->check_vac_loader_3->isChecked())
            {
                vaccntLD++;
                ui->line_vac_SwCnt_LD->setText(QString::number(vaccntLD));
                ui->check_vac_loader_3->setChecked(0);
                serialSendFeeder(vacoffLD);
            }
            else if (ui->check_vac_aligner_3->isChecked())
            {
                vaccntPA++;
                ui->line_vac_SwCnt_PA->setText(QString::number(vaccntPA));
                ui->check_vac_aligner_3->setChecked(0);
                serialSendFeeder(vacoffPA);
            }
            else if (ui->check_vac_wcright_3->isChecked())
            {
                vaccntWC1++;
                ui->line_vac_SwCnt_WC1->setText(QString::number(vaccntWC1));
                ui->check_vac_wcright_3->setChecked(0);
                serialSendFeeder(vacoffWC1);
            }
            else if (ui->check_vac_wcleft_3->isChecked())
            {
                vaccntWC2++;
                ui->line_vac_SwCnt_WC2->setText(QString::number(vaccntWC2));
                ui->check_vac_wcleft_3->setChecked(0);
                serialSendFeeder(vacoffWC2);
            }
            else if (ui->check_vac_chuck4_3->isChecked())
            {
                vaccntCH4++;
                ui->line_vac_SwCnt_CH4->setText(QString::number(vaccntCH4));
                ui->check_vac_chuck4_3->setChecked(0);
                serialSendFeeder(vacoffCH4);
            }
            else if (ui->check_vac_chuck6_3->isChecked())
            {
                vaccntCH6++;
                ui->line_vac_SwCnt_CH6->setText(QString::number(vaccntCH6));
                ui->check_vac_chuck6_3->setChecked(0);
                serialSendFeeder(vacoffCH6);
            }
            else if (ui->check_vac_chuck8_3->isChecked())
            {
                vaccntCH8++;
                ui->line_vac_SwCnt_CH8->setText(QString::number(vaccntCH8));
                ui->check_vac_chuck8_3->setChecked(0);
                serialSendFeeder(vacoffCH8);
            }
            else
            {
                switch (v)
                {
                case 1:
                    ui->check_vac_loader_3->setChecked(1);
                    serialSendFeeder(vaconLD);
                    break;
                case 2:
                    ui->check_vac_aligner_3->setChecked(1);
                    serialSendFeeder(vaconPA);
                    break;
                case 3:
                    ui->check_vac_wcright_3->setChecked(1);
                    serialSendFeeder(vaconWC1);
                    break;
                case 4:
                    ui->check_vac_wcleft_3->setChecked(1);
                    serialSendFeeder(vaconWC2);
                    break;
                case 5:
                    ui->check_vac_chuck4_3->setChecked(1);
                    serialSendFeeder(vaconCH4);
                    break;
                case 6:
                    ui->check_vac_chuck6_3->setChecked(1);
                    serialSendFeeder(vaconCH6);
                    break;
                case 7:
                    ui->check_vac_chuck8_3->setChecked(1);
                    serialSendFeeder(vaconCH8);
                    break;
                default:
                    err_msgbox("not used");
                    break;
                }
            }
        }
        else
        {
            if (ui->check_vac_loader_3->isChecked())
            {
                vaccntLD++;
                ui->line_vac_SwCnt_LD->setText(QString::number(vaccntLD));
                ui->check_vac_loader_3->setChecked(0);
                serialSendFeeder(vaconLD);
            }
            else if (ui->check_vac_aligner_3->isChecked())
            {
                vaccntPA++;
                ui->line_vac_SwCnt_PA->setText(QString::number(vaccntPA));
                ui->check_vac_aligner_3->setChecked(0);
                serialSendFeeder(vaconPA);
            }
            else if (ui->check_vac_wcright_3->isChecked())
            {
                vaccntWC1++;
                ui->line_vac_SwCnt_WC1->setText(QString::number(vaccntWC1));
                ui->check_vac_wcright_3->setChecked(0);
                serialSendFeeder(vaconWC1);
            }
            else if (ui->check_vac_wcleft_3->isChecked())
            {
                vaccntWC2++;
                ui->line_vac_SwCnt_WC2->setText(QString::number(vaccntWC2));
                ui->check_vac_wcleft_3->setChecked(0);
                serialSendFeeder(vaconWC2);
            }
            else if (ui->check_vac_chuck4_3->isChecked())
            {
                vaccntCH4++;
                ui->line_vac_SwCnt_CH4->setText(QString::number(vaccntCH4));
                ui->check_vac_chuck4_3->setChecked(0);
                serialSendFeeder(vaconCH4);
            }
            else if (ui->check_vac_chuck6_3->isChecked())
            {
                vaccntCH6++;
                ui->line_vac_SwCnt_CH6->setText(QString::number(vaccntCH6));
                ui->check_vac_chuck6_3->setChecked(0);
                serialSendFeeder(vaconCH6);
            }
            else if (ui->check_vac_chuck8_3->isChecked())
            {
                vaccntCH8++;
                ui->line_vac_SwCnt_CH8->setText(QString::number(vaccntCH8));
                ui->check_vac_chuck8_3->setChecked(0);
                serialSendFeeder(vaconCH8);
            }
            else if (vaccntLD && ui->check_vac_loader_3->isChecked() == 0)
            {
                ui->check_vac_loader_3->setChecked(1);
                serialSendFeeder(vacoffLD);
            }
            else if (vaccntPA && ui->check_vac_aligner_3->isChecked() == 0)
            {
                ui->check_vac_aligner_3->setChecked(1);
                serialSendFeeder(vacoffPA);
            }
            else if (vaccntWC1 && ui->check_vac_wcright_3->isChecked() == 0)
            {
                ui->check_vac_wcright_3->setChecked(1);
                serialSendFeeder(vacoffWC1);
            }
            else if (vaccntWC2 && ui->check_vac_wcleft_3->isChecked() == 0)
            {
                ui->check_vac_wcleft_3->setChecked(1);
                serialSendFeeder(vacoffWC2);
            }
            else if (vaccntCH4 && ui->check_vac_chuck4_3->isChecked() == 0)
            {
                ui->check_vac_chuck4_3->setChecked(1);
                serialSendFeeder(vacoffCH4);
            }
            else if (vaccntCH6 && ui->check_vac_chuck6_3->isChecked() == 0)
            {
                ui->check_vac_chuck6_3->setChecked(1);
                serialSendFeeder(vacoffCH6);
            }
            else if (vaccntCH8 && ui->check_vac_chuck8_3->isChecked() == 0)
            {
                ui->check_vac_chuck8_3->setChecked(1);
                serialSendFeeder(vacoffCH8);
            }
        }
    }
    else if (vactestflag == 0)
    {
        if (ui->checkBox_vac_randommode->isChecked() == 0)
        {
            if (vaccntLD && ui->check_vac_loader_3->isChecked() == 0)
            {
                ui->check_vac_loader_3->setChecked(1);
                serialSendFeeder(vacoffLD);
            }
            else if (vaccntPA && ui->check_vac_aligner_3->isChecked() == 0)
            {
                ui->check_vac_aligner_3->setChecked(1);
                serialSendFeeder(vacoffPA);
            }
            else if (vaccntWC1 && ui->check_vac_wcright_3->isChecked() == 0)
            {
                ui->check_vac_wcright_3->setChecked(1);
                serialSendFeeder(vacoffWC1);
            }
            else if (vaccntWC2 && ui->check_vac_wcleft_3->isChecked() == 0)
            {
                ui->check_vac_wcleft_3->setChecked(1);
                serialSendFeeder(vacoffWC2);
            }
            else if (vaccntCH4 && ui->check_vac_chuck4_3->isChecked() == 0)
            {
                ui->check_vac_chuck4_3->setChecked(1);
                serialSendFeeder(vacoffCH4);
            }
            else if (vaccntCH6 && ui->check_vac_chuck6_3->isChecked() == 0)
            {
                ui->check_vac_chuck6_3->setChecked(1);
                serialSendFeeder(vacoffCH6);
            }
            else if (vaccntCH8 && ui->check_vac_chuck8_3->isChecked() == 0)
            {
                ui->check_vac_chuck8_3->setChecked(1);
                serialSendFeeder(vacoffCH8);
            }
        }

        vaccntLD = 0;
        vaccntPA = 0;
        vaccntWC1 = 0;
        vaccntWC2 = 0;
        vaccntCH4 = 0;
        vaccntCH6 = 0;
        vaccntCH8 = 0;
    }
}
void MainWindow::on_p_vactest_start_clicked()
{
    if (vactestflag == 0)
    {
        ui->line_vac_SwCnt_LD->setText("");
        ui->line_vac_SwCnt_PA->setText("");
        ui->line_vac_SwCnt_WC1->setText("");
        ui->line_vac_SwCnt_WC2->setText("");
        ui->line_vac_SwCnt_CH4->setText("");
        ui->line_vac_SwCnt_CH6->setText("");
        ui->line_vac_SwCnt_CH8->setText("");

        if (ui->checkBox_vac_randommode->isChecked() == 0)
        {
            if (ui->check_vac_loader_3->isChecked() ||
                    ui->check_vac_aligner_3->isChecked() ||
                    ui->check_vac_wcright_3->isChecked() ||
                    ui->check_vac_wcleft_3->isChecked() ||
                    ui->check_vac_chuck4_3->isChecked() ||
                    ui->check_vac_chuck6_3->isChecked() ||
                    ui->check_vac_chuck8_3->isChecked())
            {
                vactestflag = 1;
                ui->p_vactest_start->setText("Stop");
                if (ui->checkBox_vacSwitchTest->isChecked()) serialSendFeeder("$SET_17=1\r\n");
                else if (ui->checkBox_vacUnitTest->isChecked()) serialSendFeeder("$SET_17=0\r\n");
            }
            else err_msgbox("Please select vacuum channel first.");
        }
        else
        {
            ui->check_vac_loader_3->setChecked(0);
            ui->check_vac_aligner_3->setChecked(0);
            ui->check_vac_wcright_3->setChecked(0);
            ui->check_vac_wcleft_3->setChecked(0);
            ui->check_vac_chuck4_3->setChecked(0);
            ui->check_vac_chuck6_3->setChecked(0);
            ui->check_vac_chuck8_3->setChecked(0);

            ui->line_vac_ERRCnt_LD->setText("");
            ui->line_vac_ERRCnt_PA->setText("");
            ui->line_vac_ERRCnt_WC1->setText("");
            ui->line_vac_ERRCnt_WC2->setText("");
            ui->line_vac_ERRCnt_CH4->setText("");
            ui->line_vac_ERRCnt_CH6->setText("");
            ui->line_vac_ERRCnt_8->setText("");

            vactestflag = 1;
            ui->p_vactest_start->setText("Stop");
            if (ui->checkBox_vacSwitchTest->isChecked()) serialSendFeeder("$SET_17=1\r\n");
            else if (ui->checkBox_vacUnitTest->isChecked()) serialSendFeeder("$SET_17=0\r\n");
        }
    }
    else
    {
        vactestflag = 0;
        ui->p_vactest_start->setText("Start");
    }
}

// ---------------- ASYST --------------------------------
void MainWindow::on_p_LDcenter_2_clicked() {}

void MainWindow::on_p_ASYST_status_clicked()
{
    cmdASYSTstat = 1;       // Flag for repeated call

    if(ui->pushButton_ASYST_seriallog->styleSheet() != backLightGreen) on_pushButton_SMIF_seriallog_clicked();
    else if(ui->checkBox_ASYST_statuspoll->isChecked() == FALSE) on_checkBox_SMIF_statuspoll_clicked(1);
    else
    {
        cmdASYSTstat = 0;
        tmpstr = 0;
        tmpstr.append(ASYST_STATUS); // "$ASYST_1="
        tmpstr.append(STATUS);       //
        tmpstr.append("\r\n");
        feedertimeout = 3000;
        serialSendFeeder(tmpstr);
    }
}
void MainWindow::on_pushButton_ASYST_seriallog_clicked()
{
    on_pushButton_SMIF_seriallog_clicked();
}
void MainWindow::on_checkBox_ASYST_statuspoll_clicked(bool checked)
{
    on_checkBox_SMIF_statuspoll_clicked(checked);
}
void MainWindow::on_p_ASYST_clear_clicked()
{
    ui->plainTextEdit_logsmif_asystcmd->clear();
}
void MainWindow::on_tableWidget_ASYST_readconfig_cellPressed(int row, int column)
{
    qDebug()<<"cellPressed row clicked"<<row<<"column"<<column;
    QComboBox *P4 = new QComboBox;
    QComboBox *P16 = new QComboBox;
    QComboBox *P41 = new QComboBox;

    P4->addItems(QStringList() << "ON" << "OFF");
    P16->addItems(QStringList() << "SEND" << "RECV" << "BOTH");
    P41->addItems(QStringList() << "2400" << "4800" << "9600" << "19200");

    P4->setCurrentIndex(1);
    P16->setCurrentIndex(2);
    P41->setCurrentIndex(2);

    P4->setFrame(0);
    P16->setFrame(0);
    P41->setFrame(0);

    switch (row)
    {
    case 0:
    case 1:
    case 2:
        if(column == 2) ui->tableWidget_ASYST_readconfig->setCellWidget(row,2,P4);
        break;
    case 3:
        if(column == 2) ui->tableWidget_ASYST_readconfig->setCellWidget(row,2,P16);
        break;
    case 5:
        if(column == 5) ui->tableWidget_ASYST_readconfig->setCellWidget(row,5,P41);
        break;
    default:
        break;
    }


   // ui->tableWidget_ASYST_readconfig->tool
}
void MainWindow::on_p_ASYST_readconfig_clicked()
{
    cmdASYSTlog = 1;       // Flag for repeated call

    if(ui->pushButton_ASYST_seriallog->styleSheet() != backLightGreen) on_pushButton_SMIF_seriallog_clicked();
    else if(ui->checkBox_ASYST_statuspoll->isChecked() == FALSE) on_checkBox_SMIF_statuspoll_clicked(1);
    else
    {
        cmdASYSTlog = 0;
        tmpstr = 0;
        tmpstr.append(ASYST_RCONFIG); // "$ASYST_4="
        tmpstr.append(cmdNULL);       // kein Function
        tmpstr.append("\r\n");
        feedertimeout = 3000;
        serialSendFeeder(tmpstr);

        ui->p_ASYST_setconfig->setDisabled(0);
    }
}
void MainWindow::on_p_ASYST_setconfig_clicked()
{
    QByteArray confdata(ASYST_SCONFIG);     // "$ASYST_3="
    confdata.append(cmdNULL);               // kein Function
    confdata.append(",");                   // Trennzeichen

    // Spalte "Data" ist ein QLabel Widget, Spalte "Set to" ist ein QComboBox Widget oder ein QString Widget
    QLabel *dataP4 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(0,1));
    QComboBox *setP4 = qobject_cast<QComboBox*>(ui->tableWidget_ASYST_readconfig->cellWidget(0,2));
    if(setP4)
    {
        if(setP4->currentText() != dataP4->text())
        {
            if(setP4->currentText() == "OFF") confdata.append("0,"); //setP << setP4->currentText();
            else if(setP4->currentText() == "ON") confdata.append("1,");
        }
        else
        {
            if(dataP4->text() == "OFF") confdata.append("0,"); //setP << setP4->currentText();
            else if(dataP4->text() == "ON") confdata.append("1,");
        }
    }
    else
    {
        if(dataP4->text() == "OFF") confdata.append("0,"); //setP << setP4->currentText();
        else if(dataP4->text() == "ON") confdata.append("1,");
    }

    QLabel *dataP6 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(1,1));
    QComboBox *setP6 = qobject_cast<QComboBox*>(ui->tableWidget_ASYST_readconfig->cellWidget(1,2));
    if(setP6)
    {
        if(setP6->currentText() != dataP6->text())
        {
            if(setP6->currentText() == "OFF") confdata.append("0,");
            else if(setP6->currentText() == "ON") confdata.append("1,");
        }
        else
        {
            if(dataP6->text() == "OFF") confdata.append("0,");
            else if(dataP6->text() == "ON") confdata.append("1,");
        }
    }
    else
    {
        if(dataP6->text() == "OFF") confdata.append("0,");
        else if(dataP6->text() == "ON") confdata.append("1,");
    }

    QLabel *dataP13 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(2,1));
    QComboBox *setP13 = qobject_cast<QComboBox*>(ui->tableWidget_ASYST_readconfig->cellWidget(2,2));
    if(setP13)
    {
        if(setP13->currentText() != dataP13->text())
        {
            if(setP13->currentText() == "OFF") confdata.append("0,"); //setP << setP4->currentText();
            else if(setP13->currentText() == "ON") confdata.append("1,");
        }
        else
        {
            if(dataP13->text() == "OFF") confdata.append("0,"); //setP << setP4->currentText();
            else if(dataP13->text() == "ON") confdata.append("1,");
        }
    }
    else
    {
        if(dataP13->text() == "OFF") confdata.append("0,"); //setP << setP4->currentText();
        else if(dataP13->text() == "ON") confdata.append("1,");
    }

    QLabel *dataP16 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(3,1));
    QComboBox *setP16 = qobject_cast<QComboBox*>(ui->tableWidget_ASYST_readconfig->cellWidget(3,2));
    if(setP16)
    {
        if(setP16->currentText() != dataP16->text())
        {
            if(setP16->currentText() == "SEND") confdata.append("0,");
            else if(setP16->currentText() == "RECV") confdata.append("1,");
            else if(setP16->currentText() == "BOTH") confdata.append("2,");
        }
        else
        {
            if(dataP16->text() == "SEND") confdata.append("0,");
            else if(dataP16->text() == "RECV") confdata.append("1,");
            else if(dataP16->text() == "BOTH") confdata.append("2,");
        }
    }
    else
    {
        if(dataP16->text() == "SEND") confdata.append("0,");
        else if(dataP16->text() == "RECV") confdata.append("1,");
        else if(dataP16->text() == "BOTH") confdata.append("2,");
    }

    QLabel *dataP30 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(4,1));
    QTableWidgetItem *setP30 = ui->tableWidget_ASYST_readconfig->item(4,2);
    if(setP30)
    {
        if(setP30->text() != "" && setP30->text() != dataP30->text()) confdata.append(QString::number(setP30->text().toUInt(&ok,10)).toLatin1() + ",");
        else confdata.append(QString::number(dataP30->text().toUInt(&ok,10)).toLatin1() + ",");
    }
    else confdata.append(QString::number(dataP30->text().toUInt(&ok,10)).toLatin1() + ",");

    QLabel *dataP31 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(5,1));
    QTableWidgetItem *setP31 = ui->tableWidget_ASYST_readconfig->item(5,2);
    if(setP31)
    {
        if(setP31->text() != "" && setP31->text() != dataP31->text()) confdata.append(QString::number(setP31->text().toUInt(&ok,10)).toLatin1() + ",");
        else confdata.append(QString::number(dataP31->text().toUInt(&ok,10)).toLatin1() + ",");
    }
    else confdata.append(QString::number(dataP31->text().toUInt(&ok,10)).toLatin1() + ",");

    QLabel *dataP33 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(6,1));
    QTableWidgetItem *setP33 = ui->tableWidget_ASYST_readconfig->item(6,2);
    if(setP33)
    {
        if(setP33->text() != "" && setP33->text() != dataP33->text()) confdata.append(QString::number(dataP33->text().toUInt(&ok,10)).toLatin1() + ",");
        else confdata.append(QString::number(dataP33->text().toUInt(&ok,10)).toLatin1() + ",");
    }
    else confdata.append(QString::number(dataP33->text().toUInt(&ok,10)).toLatin1() + ",");

    QLabel *dataP34 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(7,1));
    QTableWidgetItem *setP34 = ui->tableWidget_ASYST_readconfig->item(7,2);
    if(setP31)
    {
        if(setP34->text() != "" && setP34->text() != dataP34->text()) confdata.append(QString::number(setP34->text().toUInt(&ok,10)).toLatin1() + ",");
        else confdata.append(QString::number(dataP34->text().toUInt(&ok,10)).toLatin1() + ",");
    }
    else confdata.append(QString::number(dataP34->text().toUInt(&ok,10)).toLatin1() + ",");

    QLabel *dataP35 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(8,1));
    QTableWidgetItem *setP35 = ui->tableWidget_ASYST_readconfig->item(8,2);
    if(setP35)
    {
        if(setP35->text() != "" && setP35->text() != dataP35->text()) confdata.append(QString::number(setP35->text().toUInt(&ok,10)).toLatin1() + ",");
        else confdata.append(QString::number(dataP35->text().toUInt(&ok,10)).toLatin1() + ",");
    }
    else confdata.append(QString::number(dataP35->text().toUInt(&ok,10)).toLatin1() + ",");

    QLabel *dataP36 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(0,4));
    QTableWidgetItem *setP36 = ui->tableWidget_ASYST_readconfig->item(0,5);
    if(setP36)
    {
        if(setP36->text() != "" && setP36->text() != dataP36->text()) confdata.append(QString::number(setP36->text().toUInt(&ok,10)).toLatin1() + ",");
        else confdata.append(QString::number(dataP36->text().toUInt(&ok,10)).toLatin1() + ",");
    }
    else confdata.append(QString::number(dataP36->text().toUInt(&ok,10)).toLatin1() + ",");

    QLabel *dataP37 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(1,4));
    QTableWidgetItem *setP37 = ui->tableWidget_ASYST_readconfig->item(1,5);
    if(setP37)
    {
        if(setP37->text() != "" && setP37->text() != dataP37->text()) confdata.append(QString::number(setP37->text().toUInt(&ok,10)).toLatin1() + ",");
        else confdata.append(QString::number(dataP37->text().toUInt(&ok,10)).toLatin1() + ",");
    }
    else confdata.append(QString::number(dataP37->text().toUInt(&ok,10)).toLatin1() + ",");

    QLabel *dataP38 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(2,4));
    QTableWidgetItem *setP38 = ui->tableWidget_ASYST_readconfig->item(2,5);
    if(setP38)
    {
        if(setP38->text() != "" && setP38->text() != dataP38->text()) confdata.append(QString::number(setP38->text().toUInt(&ok,10)).toLatin1() + ",");
        else confdata.append(QString::number(dataP38->text().toUInt(&ok,10)).toLatin1() + ",");
    }
    else confdata.append(QString::number(dataP38->text().toUInt(&ok,10)).toLatin1() + ",");

    QLabel *dataP39 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(3,4));
    QTableWidgetItem *setP39 = ui->tableWidget_ASYST_readconfig->item(3,5);
    if(setP39)
    {
        if(setP39->text() != "" && setP39->text() != dataP39->text()) confdata.append(QString::number(setP39->text().toUInt(&ok,10)).toLatin1() + ",");
        else confdata.append(QString::number(dataP39->text().toUInt(&ok,10)).toLatin1() + ",");
    }
    else confdata.append(QString::number(dataP39->text().toUInt(&ok,10)).toLatin1() + ",");

    QLabel *dataP40 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(4,4));
    QTableWidgetItem *setP40 = ui->tableWidget_ASYST_readconfig->item(4,5);
    if(setP40)
    {
        if(setP40->text() != "" && setP40->text() != dataP40->text()) confdata.append(QString::number(setP40->text().toUInt(&ok,10)).toLatin1() + ",");
        else confdata.append(QString::number(dataP40->text().toUInt(&ok,10)).toLatin1() + ",");
    }
    else confdata.append(QString::number(dataP40->text().toUInt(&ok,10)).toLatin1() + ",");

    QLabel *dataP41 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(5,4));
    QComboBox *setP41 = qobject_cast<QComboBox*>(ui->tableWidget_ASYST_readconfig->cellWidget(5,5));
    if(setP41)
    {
        if(setP41->currentText() != dataP41->text())
        {
            if(setP41->currentText() == "2400") confdata.append("0,");
            else if(setP41->currentText() == "4800") confdata.append("1,");
            else if(setP41->currentText() == "9600") confdata.append("2,");
            else if(setP41->currentText() == "19200") confdata.append("3,");
        }
        else
        {
            if(dataP41->text() == "2400") confdata.append("0,");
            else if(dataP41->text() == "4800") confdata.append("1,");
            else if(dataP41->text() == "9600") confdata.append("2,");
            else if(dataP41->text() == "19200") confdata.append("3,");
        }
    }
    else
    {
        if(dataP41->text() == "2400") confdata.append("0,");
        else if(dataP41->text() == "4800") confdata.append("1,");
        else if(dataP41->text() == "9600") confdata.append("2,");
        else if(dataP41->text() == "19200") confdata.append("3,");
    }

    QLabel *dataP63 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(6,4));
    QTableWidgetItem *setP63 = ui->tableWidget_ASYST_readconfig->item(6,5);
    if(setP63)
    {
        if(setP63->text() != "" && setP63->text() != dataP63->text()) confdata.append(QString::number(setP63->text().toUInt(&ok,10)).toLatin1() + ",");
        else confdata.append(QString::number(dataP63->text().toUInt(&ok,10)).toLatin1() + ",");
    }
    else confdata.append(QString::number(dataP63->text().toUInt(&ok,10)).toLatin1() + ",");

    QLabel *dataP67 = qobject_cast<QLabel*>(ui->tableWidget_ASYST_readconfig->cellWidget(7,4));
    QTableWidgetItem *setP67 = ui->tableWidget_ASYST_readconfig->item(7,5);
    if(setP67)
    {
        if(setP67->text() != "" && setP67->text() != dataP67->text()) confdata.append(QString::number(setP67->text().toUInt(&ok,10)).toLatin1());
        else confdata.append(QString::number(dataP67->text().toUInt(&ok,10)).toLatin1());
    }
    else confdata.append(QString::number(dataP67->text().toUInt(&ok,10)).toLatin1());

    confdata.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(confdata);
}
void MainWindow::on_p_ASYST_INIT_clicked()
{
    tmpstr = 0;
    tmpstr.append(ASYST_CMD);   // "$ASYST_2="
    tmpstr.append(cmdCALIB);     // "2"
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_ASYST_stage_clicked()
{
    tmpstr = 0;
    tmpstr.append(ASYST_CMD);   // "$ASYST_2="
    tmpstr.append(cmdSTAGE);     // "18"
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_ASYST_home_clicked()
{
    tmpstr = 0;
    tmpstr.append(ASYST_CMD);   // "$ASYST_2="
    tmpstr.append(cmdHOME);     // "7"
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_ASYST_lock_clicked()
{
    tmpstr = 0;
    tmpstr.append(ASYST_CMD);   // "$ASYST_2="
    tmpstr.append(cmdLOCK);     // "8"
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_ASYST_MAP_clicked()
{
    waitLDout = 20;
    on_p_LD_Yout_clicked(); // LDYout position sicherstellen
}
void MainWindow::on_p_ASYST_stop_clicked()
{
    tmpstr = 0;
    tmpstr.append(ASYST_CMD);   // "$ASYST_2="
    tmpstr.append(cmdSTOP);     // "19"
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_ASYST_tweek_dwn_clicked()
{
    tmpstr = 0;
    tmpstr.append(ASYST_CMD);   // "$ASYST_2="
    tmpstr.append(cmdTWEEKDN);     // "20"
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_ASYST_tweek_up_clicked()
{
    tmpstr = 0;
    tmpstr.append(ASYST_CMD);   // "$ASYST_2="
    tmpstr.append(cmdTWEEKUP);     // "21"
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_p_ASYST_unlock_clicked()
{
    tmpstr = 0;
    tmpstr.append(ASYST_CMD);   // "$ASYST_2="
    tmpstr.append(cmdUNLK);     // "22"
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}
void MainWindow::on_push_wid_cass_Store_ASYST_clicked()
{
    int tmp = ui->comboCass_Type_ASYST->currentIndex();
    bool fric = ui->checkCass_friction_ASYST->isChecked();
    int fbit = 0;

    setfricbit = 1;

    if (tmp != 0)
    {
        if (tmp < 5) // 8inch
        {
            fbit = ui->combo_8inchsel->currentText().toInt(&ok, 10) & 0x0F;
            //    qDebug()<<"fbit="<<fbit;
            if (fric)fbit |= (1 << (tmp - 1));
            else fbit &= ~(1 << (tmp - 1));
            ui->combo_8inchsel->setCurrentText(QString::number(fbit));
            //    qDebug()<<"fbit="<<fbit<<"friction: "<<fric;
        }

        STORE_FILE_partCASS(tmp);
        qDebug() << "<<<<<<<on_push_wid_cass_Store_smif_clicked<<<<<<<<<2"<< ui->tabWidget->currentIndex();
    }
    else err_msgbox("select cassette first");
}
void MainWindow::on_check_loader_releasemotoX_5_clicked(bool checked)
{
    on_check_loader_releasemotoX_clicked(checked);
}
void MainWindow::on_check_loader_releasemotoY_5_clicked(bool checked)
{
    on_check_loader_releasemotoY_clicked(checked);
}
void MainWindow::on_p_ASYST_reset_clicked()
{
    tmpstr = 0;
    tmpstr.append(ASYST_CMD);       // "$ASYST_2="
    tmpstr.append(cmdRESET);        // Reset Alrm
    tmpstr.append("\r\n");
    feedertimeout = 3000;
    serialSendFeeder(tmpstr);
}

